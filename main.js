!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return o(n||e)},u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";function r(){k.render(w.createElement(pe,null),$("#content")[0])}function o(){return ue}function i(e){return/\.(hex|uf2)$/i.test(e)}function a(e){return/\.blocks$/i.test(e)}function s(e){return/\.ts$/i.test(e)}function c(e){return/\.(pxt|mkcd)$/i.test(e)}function l(){if((t=N.parseQueryString((location.hash||"#").slice(1).replace(/%23access_token/,"access_token"))).access_token){var e=pxt.storage.getLocal("oauthState");e&&e==t.state&&(pxt.storage.setLocal("access_token",t.access_token),pxt.storage.removeLocal("oauthState")),location.hash=location.hash.replace(/(%23)?[\#\&\?]*access_token.*/,"")}ae.accessToken=pxt.storage.getLocal("access_token")||"";var t=N.parseQueryString((location.hash||"#").slice(1).replace(/%local_token/,"local_token"));t.local_token&&(pxt.storage.setLocal("local_token",t.local_token),location.hash=location.hash.replace(/(%23)?[\#\&\?]*local_token.*/,"")),ae.localToken=pxt.storage.getLocal("local_token")||""}function u(){null==de&&(de=window.setInterval(d,5e3))}function p(){clearInterval(de),de=null}function d(){if(pxt.appTarget.serial&&(pxt.winrt.isWinRT()||ae.isLocalHost()&&ae.localToken))if(j.shouldUse())j.initAsync(!0).then(function(e){he=e,p(),null==fe&&(fe=window.setInterval(function(){null==de&&e.pingAsync().then(function(){},function(e){pxt.debug("re-starting connection poller"),u()})},4900)),e.onSerial=function(e,t){var n=se.fromUTF8(se.uint8ArrayToString(e));window.postMessage({type:"serial",id:"n/a",data:n},"*")}}).catch(function(e){pxt.log("hidbridge failed to load, "+e),u()});else{pxt.debug("initializing serial pipe");var e=new WebSocket("ws://localhost:"+pxt.options.wsPort+"/"+ae.localToken+"/serial"),t={};e.onopen=function(e){pxt.debug("serial: socket opened"),p()},e.onclose=function(e){pxt.debug("serial: socket closed"),u()},e.onerror=function(e){pxt.debug("serial: error"),u()},e.onmessage=function(e){try{var n=JSON.parse(e.data);n&&"serial"==n.type&&pxt.Util.bufferSerial(t,n.data,n.id)}catch(t){pxt.debug("unknown message: "+e.data)}}}}function f(){window.addEventListener("message",function(e){var t=e.data;if(t&&"screenshot"==t.type){pxt.tickEvent("sim.screenshot");var n=t;pxt.debug("received screenshot"),I.saveAsync(ue.state.header,n.data).done(function(){pxt.debug("screenshot saved")})}},!1)}function h(){pxt.analytics.enable(),pxt.editor.enableControllerAnalytics();var e={};if("undefined"!=typeof window){var t=window.screen;e["screen.width"]=t.width,e["screen.height"]=t.height,e["screen.availwidth"]=t.availWidth,e["screen.availheight"]=t.availHeight,e["screen.innerWidth"]=window.innerWidth,e["screen.innerHeight"]=window.innerHeight,e["screen.devicepixelratio"]=pxt.BrowserUtils.devicePixelRatio()}pxt.tickEvent("editor.loaded",e)}function m(){var e=/^#(\w+)(:([\/\-\+\=\w]+))?$/.exec(window.location.hash);return e?{cmd:e[1],arg:e[3]||""}:{cmd:"",arg:""}}function g(e,t){if(!e)return!1;var n=ue;if(!n)return!1;switch(v(e)&&n.setState({home:!1}),e.cmd){case"doc":pxt.tickEvent("hash.doc"),n.setSideDoc(e.arg,n==this.blockEditor);break;case"follow":return pxt.tickEvent("hash.follow"),n.newEmptyProject(void 0,e.arg),!0;case"newproject":return pxt.tickEvent("hash.newproject"),n.newProject(),pxt.BrowserUtils.changeHash(""),!0;case"newjavascript":return pxt.tickEvent("hash.newjavascript"),n.newProject({prj:pxt.appTarget.blocksprj,filesOverride:{"main.blocks":""}}),pxt.BrowserUtils.changeHash(""),!0;case"gettingstarted":return pxt.tickEvent("hash.gettingstarted"),n.newProject(),pxt.BrowserUtils.changeHash(""),!0;case"tutorial":return pxt.tickEvent("hash.tutorial"),n.startTutorial(e.arg),pxt.BrowserUtils.changeHash(""),!0;case"home":return pxt.tickEvent("hash.home"),n.openHome(),pxt.BrowserUtils.changeHash(""),!0;case"sandbox":case"pub":case"edit":return pxt.tickEvent("hash."+e.cmd),pxt.BrowserUtils.changeHash(""),y(e.arg),!0;case"sandboxproject":case"project":pxt.tickEvent("hash."+e.cmd);var r=se.stringToUint8Array(atob(e.arg));return pxt.BrowserUtils.changeHash(""),N.showLoading("loadingproject",le("loading project...")),ue.importProjectFromFileAsync(r).done(function(){return N.hideLoading("loadingproject")}),!0;case"reload":return t&&pxt.BrowserUtils.changeHash(""),!1}return!1}function v(e){if(!e)return!1;switch(e.cmd){case"follow":case"newproject":case"newjavascript":case"tutorial":case"projects":case"sandbox":case"pub":case"edit":case"sandboxproject":case"project":case"reload":return!0;default:return!1}}function y(e){var t=x.getHeaders().filter(function(t){return t.pubCurrent&&t.pubId==e})[0];N.showLoading("loadingheader",le("loading project...")),(t?ue.loadHeaderAsync(t,null):x.installByIdAsync(e).then(function(e){return ue.loadHeaderAsync(e,null)})).catch(N.handleNetworkError).finally(function(){return N.hideLoading("loadingheader")})}function b(){window.addEventListener("hashchange",function(e){g(m(),!1)})}function _(){if(!pxt.appTarget.appTheme||!pxt.appTarget.appTheme.extendEditor)return Promise.resolve();pxt.debug("loading editor extensions...");var e={};return pxt.BrowserUtils.loadScriptAsync(pxt.webConfig.commitCdnUrl+"editor.js").then(function(){return pxt.editor.initExtensionsAsync(e)}).then(function(e){e.hexFileImporters&&e.hexFileImporters.forEach(function(e){pxt.debug("\tadded hex importer "+e.id),ue.hexFileImporters.push(e)}),e.resourceImporters&&e.resourceImporters.forEach(function(e){pxt.debug("\tadded resource importer "+e.id),ue.resourceImporters.push(e)}),e.deployCoreAsync&&(pxt.debug("\tadded custom deploy core async"),pxt.commands.deployCoreAsync=e.deployCoreAsync),e.showUploadInstructionsAsync&&(pxt.debug("\tadded custom upload instructions async"),pxt.commands.showUploadInstructionsAsync=e.showUploadInstructionsAsync),e.beforeCompile&&(ue.beforeCompile=e.beforeCompile),e.fieldEditors&&e.fieldEditors.forEach(function(e){pxt.blocks.registerFieldEditor(e.selector,e.editor,e.validator)}),e.toolboxOptions&&(e.toolboxOptions.blocklyXml&&J.overrideBaseToolbox(e.toolboxOptions.blocklyXml),e.toolboxOptions.monacoToolbox&&X.overrideToolbox(e.toolboxOptions.monacoToolbox))})}var E=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},w=e("react"),k=e("react-dom"),x=e("./workspace"),C=e("./data"),S=e("./package"),N=e("./core"),T=e("./sui"),O=e("./simulator"),D=e("./compiler"),R=e("./tdlegacy"),A=e("./cmds"),P=e("./appcache"),I=e("./screenshot"),j=e("./hidbridge"),M=e("./share"),L=e("./lang"),F=e("./accessibility"),U=e("./tutorial"),B=e("./editortoolbar"),V=e("./simtoolbar"),q=e("./filelist"),H=e("./container"),W=e("./scriptsearch"),z=e("./projects"),K=e("./extensions"),Y=e("./sounds"),G=e("./make"),J=e("./toolbox"),X=e("./monacoSnippets"),Q=e("./monaco"),Z=e("./pxtjson"),ee=e("./serial"),te=e("./blocks"),ne=e("./serialindicator"),re=e("./draganddrop"),oe=e("./electron"),ie=e("./notification"),ae=pxt.Cloud,se=pxt.Util,ce=pxt.blocks.CategoryMode,le=se.lf;pxsim.util.injectPolyphils();var ue,pe=function(e){function t(t){var n=this;e.call(this,t),this.allEditors=[],this.autoRunBlocksSimulator=pxtc.Util.debounce(function(){se.now()-n.lastChangeTime<1e3||n.state.active&&n.runSimulator({background:!0})},1e3,!0),this.autoRunSimulator=pxtc.Util.debounce(function(){se.now()-n.lastChangeTime<1e3||n.state.active&&n.runSimulator({background:!0})},2e3,!0),this.typecheck=pxtc.Util.debounce(function(){if(!n.editor.isIncomplete()){var e=n.editor.snapshotState();D.typecheckAsync().done(function(t){if(n.editor.setDiagnostics(n.editorFile,e),pxt.appTarget.simulator&&pxt.appTarget.simulator.autoRun){var r=S.mainEditorPkg().outputPkg.files["output.txt"];!r||r.numDiagnosticsOverride||O.driver.runOptions.debug||O.driver.state!=pxsim.SimulatorState.Running&&O.driver.state!=pxsim.SimulatorState.Unloaded||(n.editor==n.blocksEditor?n.autoRunBlocksSimulator():n.autoRunSimulator())}})}},1e3,!1),this.markdownChangeHandler=se.debounce(function(){n.state.currFile&&/\.md$/i.test(n.state.currFile.name)&&n.setSideMarkdown(n.editor.getCurrentSource())},4e3,!1),this.editorChangeHandler=se.debounce(function(){n.editor.isIncomplete()||(n.saveFileAsync().done(),n.typecheck()),n.markdownChangeHandler()},500,!1),this.updatingEditorFile=!1,this.hexFileImporters=[{id:"default",canImport:function(e){return e.meta.cloudId=="ks/"+pxt.appTarget.id||e.meta.cloudId==pxt.CLOUD_ID+pxt.appTarget.id||se.startsWith(e.meta.cloudId,pxt.CLOUD_ID+pxt.appTarget.id)},importAsync:function(e,t){var r={target:pxt.appTarget.id,editor:t.meta.editor,name:t.meta.name,meta:{},pubId:"",pubCurrent:!1},o=JSON.parse(t.source);return x.installAsync(r,o).then(function(e){return n.loadHeaderAsync(e,null)})}}],this.resourceImporters=[],this.closeOnEscape=function(e){27===e.keyCode&&(e.preventDefault(),n.toggleSimulatorFullscreen())},this.debouncedSaveProjectName=se.debounce(function(){n.saveProjectNameAsync().done()},2e3,!1),document.title=pxt.appTarget.title||pxt.appTarget.name,this.reload=!1,this.settings=JSON.parse(pxt.storage.getLocal("editorSettings")||"{}");var r=this.shouldShowHomeScreen();this.state={showFiles:!1,home:r,active:"visible"==document.visibilityState,collapseEditorTools:pxt.appTarget.simulator.headless||pxt.BrowserUtils.isMobile()},this.settings.editorFontSize||(this.settings.editorFontSize=/mobile/i.test(navigator.userAgent)?15:19),this.settings.fileHistory||(this.settings.fileHistory=[]),r&&this.homeLoaded()}return E(t,e),t.prototype.shouldShowHomeScreen=function(){var e=m(),t=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly(),n=pxt.appTarget.appTheme.allowParentController||"#editor"==window.location.hash;return!t&&!n&&!v(e)},t.prototype.updateVisibility=function(){var e=this,t="visible"==document.visibilityState;if(pxt.debug("page visibility: "+t),this.setState({active:t}),t)if(x.isSessionOutdated()){pxt.debug("workspace changed, reloading...");var n=this.state.header?this.state.header.id:"";x.initAsync().done(function(){return!e.state.home&&n?e.loadHeaderAsync(x.getHeader(n)):Promise.resolve()})}else this.state.resumeOnVisibility&&!this.state.running&&(this.setState({resumeOnVisibility:!1}),this.runSimulator());else this.state.running&&(this.stopSimulator(),this.setState({resumeOnVisibility:!0})),this.saveFileAsync().done()},t.prototype.saveSettings=function(){var e=this.settings;if(!this.reload){var t=this.editorFile;if(t&&t.epkg.getTopHeader()&&this.editor.hasHistory()){var n={id:t.epkg.getTopHeader().id,name:t.getName(),pos:this.editor.getViewState()};for(e.fileHistory=e.fileHistory.filter(function(e){return e.id!=n.id||e.name!=n.name});e.fileHistory.length>100;)e.fileHistory.pop();e.fileHistory.unshift(n)}pxt.storage.setLocal("editorSettings",JSON.stringify(this.settings))}},t.prototype.componentDidUpdate=function(){this.saveSettings(),this.editor.domUpdate(),O.setState(this.state.header?this.state.header.editor:"",this.state.tutorialOptions&&!!this.state.tutorialOptions.tutorial),this.editor.resize()},t.prototype.fireResize=function(){if(document.createEvent){var e=document.createEvent("Event");e.initEvent("resize",!0,!0),window.dispatchEvent(e)}else document.fireEvent("onresize")},t.prototype.updateEditorLogo=function(e,t){if(pxt.appTarget.appTheme.hideMenuBar){var n=document.getElementById("editorlogo");n&&(n.style.left=e+"px",n.style.display="block",n.style.background=t||"")}},t.prototype.saveFileAsync=function(){var e=this;return this.editorFile?this.saveTypeScriptAsync().then(function(){var t=e.editor.getCurrentSource();return t!=e.editorFile.content&&O.makeDirty(),e.editor.isIncomplete()?Promise.resolve():e.editorFile.setContentAsync(t)}):Promise.resolve()},t.prototype.isEmbedSimActive=function(){return this.state.embedSimView},t.prototype.isBlocksActive=function(){return!this.state.embedSimView&&this.editor==this.blocksEditor&&this.editorFile&&"main.blocks"==this.editorFile.name},t.prototype.isJavaScriptActive=function(){return!this.state.embedSimView&&this.editor==this.textEditor&&this.editorFile&&"main.ts"==this.editorFile.name},t.prototype.isAnyEditeableJavaScriptOrPackageActive=function(){return this.editor==this.textEditor&&this.editorFile&&!this.editorFile.isReadonly()&&/(\.ts|pxt.json)$/.test(this.editorFile.name)},t.prototype.openJavaScript=function(e){if(void 0===e&&(e=!0),this.isJavaScriptActive())return this.state.embedSimView&&this.setState({embedSimView:!1}),void(e&&this.textEditor.editor.focus());this.textEditor&&(this.textEditor.giveFocusOnLoading=e),this.isBlocksActive()?this.blocksEditor.openTypeScript():this.setFile(S.mainEditorPkg().files["main.ts"])},t.prototype.openBlocks=function(){var e=this;this.isBlocksActive()?this.state.embedSimView&&this.setState({embedSimView:!1}):(this.isJavaScriptActive()||this.shouldTryDecompile&&!this.state.embedSimView?this.textEditor.openBlocks():this.isAnyEditeableJavaScriptOrPackageActive()?this.saveFileAsync().then(function(){return D.newProject(),D.getBlocksAsync()}).done(function(t){pxt.blocks.initBlocks(t),e.blocksEditor.updateBlocksInfo(t),e.setFile(S.mainEditorPkg().files["main.blocks"])}):this.setFile(S.mainEditorPkg().files["main.blocks"]),this.shouldTryDecompile=!1)},t.prototype.openSettings=function(){this.setFile(S.mainEditorPkg().lookupFile("this/pxt.json"))},t.prototype.openSerial=function(e){if(pxt.appTarget.serial&&pxt.appTarget.serial.useEditor&&(this.editor!=this.serialEditor||this.serialEditor.isSim!=e)){var t=S.mainEditorPkg();if(t){t.lookupFile("this/"+pxt.SERIAL_EDITOR_FILE)||t.setFile(pxt.SERIAL_EDITOR_FILE,"serial\n"),this.serialEditor.setSim(e);var n="serial."+(e?"simulator":"device")+"EditorOpened";pxt.tickEvent(n),this.setFile(t.lookupFile("this/"+pxt.SERIAL_EDITOR_FILE))}}},t.prototype.openPreviousEditor=function(){"monacoEditor"==this.prevEditorId?this.openJavaScript(!1):this.openBlocks()},t.prototype.openTypeScriptAsync=function(){var e=this;return this.saveTypeScriptAsync(!0).then(function(){var t=e.state.header;t&&(t.editor=pxt.JAVASCRIPT_PROJECT_NAME,t.pubCurrent=!1)})},t.prototype.openSimView=function(){this.state.embedSimView?this.startStopSimulator():(this.setState({embedSimView:!0}),this.startSimulator())},t.prototype.typecheckNow=function(){this.saveFileAsync().done(),this.typecheck()},t.prototype.initEditors=function(){var e=this;this.textEditor=new Q.Editor(this),this.pxtJsonEditor=new Z.Editor(this),this.serialEditor=new ee.Editor(this),this.blocksEditor=new te.Editor(this);var t=function(){e.editorFile&&(e.editorFile.inSyncWithEditor&&pxt.tickActivity("edit","edit."+e.editor.getId().replace(/Editor$/,"")),e.editorFile.markDirty()),e.lastChangeTime=se.now(),e.state.running&&pxt.appTarget.simulator&&pxt.appTarget.simulator.stopOnChange&&e.stopSimulator(),e.editorChangeHandler()};this.allEditors=[this.pxtJsonEditor,this.blocksEditor,this.serialEditor,this.textEditor],this.allEditors.forEach(function(e){return e.changeCallback=t}),this.editor=this.allEditors[this.allEditors.length-1]},t.prototype.componentWillMount=function(){this.initEditors(),this.initDragAndDrop()},t.prototype.componentDidMount=function(){var e=this;this.allEditors.forEach(function(e){return e.prepare()}),O.init($("#boardview")[0],{highlightStatement:function(t){e.editor&&e.editor.highlightStatement(t)},restartSimulator:function(){N.hideDialog(),e.runSimulator()},editor:this.state.header?this.state.header.editor:""}),(pxt.appTarget.appTheme.allowParentController||pxt.appTarget.appTheme.allowPackageExtensions||pxt.appTarget.appTheme.allowSimulatorTelemetry)&&pxt.editor.bindEditorMessages(this),this.forceUpdate()},t.prototype.pickEditorFor=function(e){return this.allEditors.filter(function(t){return t.acceptsFile(e)})[0]},t.prototype.updateEditorFile=function(e){var t=this;if(void 0===e&&(e=null),this.state.active&&(this.state.currFile!=this.editorFile||e)&&!this.updatingEditorFile){this.updatingEditorFile=!0,this.saveSettings();var n=this.state.highContrast;return this.saveFileAsync().then(function(){t.editorFile=t.state.currFile;var n=t.editor;return t.prevEditorId=n.getId(),t.editor=e||t.pickEditorFor(t.editorFile),t.allEditors.forEach(function(e){return e.setVisible(e==t.editor)}),n?n.unloadFileAsync():Promise.resolve()}).then(function(){return t.editor.loadFileAsync(t.editorFile,n)}).then(function(){t.saveFileAsync().done(),t.editor!=t.textEditor&&t.editor!=t.blocksEditor||t.typecheck();var e=t.settings.fileHistory.filter(function(e){return e.id==t.state.header.id&&e.name==t.editorFile.getName()})[0];e&&t.editor.setViewState(e.pos),H.SideDocs.notify({type:"fileloaded",name:t.editorFile.getName(),locale:pxt.Util.localeInfo()}),t.state.showBlocks&&t.editor==t.textEditor&&t.textEditor.openBlocks()}).finally(function(){t.forceUpdate(),t.updatingEditorFile=!1})}},t.prototype.setFile=function(e){e&&("main.ts"===e.name&&(this.shouldTryDecompile=!0),this.setState({currFile:e,showBlocks:!1,embedSimView:!1}))},t.prototype.setSideFile=function(e){var t=this,n=this.state.header;n&&(n.editor=this.getPreferredEditor(),n.pubCurrent=!1);var r=e.name,o=this.state.currFile.name;if(r!=o&&S.File.blocksFileNameRx.test(r)){pxt.tickEvent("sidebar.showBlocks");var i=e.getVirtualFileName(),a=S.mainEditorPkg().lookupFile("this/"+i);o==i?this.textEditor.openBlocks():a&&this.textEditor.decompileAsync(a.name).then(function(n){if(n.success)t.setFile(e);else{t.setFile(a);var r=!1;n.diagnostics.forEach(function(e){return r=r||9266===e.code}),t.textEditor.showConversionFailedDialog(e.name,r)}})}else(this.isTextEditor()||this.isPxtJsonEditor())&&(this.textEditor.giveFocusOnLoading=!1),this.setFile(e)},t.prototype.removeFile=function(e,t){var n=this;void 0===t&&(t=!1);var r=function(){S.mainEditorPkg().removeFileAsync(e.name).then(function(){return S.mainEditorPkg().saveFilesAsync(!0)}).then(function(){return n.reloadHeaderAsync()}).done()};t?r():N.confirmAsync({header:le("Remove {0}",e.name),body:le("You are about to remove a file from your project. You can't undo this. Are you sure?"),agreeClass:"red",agreeIcon:"trash",agreeLbl:le("Remove it")}).done(function(e){e&&r()})},t.prototype.updateFileAsync=function(e,t,n){var r=this,o=S.mainEditorPkg();return o.setFile(e,t),o.updateConfigAsync(function(t){return t.files.indexOf(e)<0?t.files.push(e):0}).then(function(){return n&&r.setFile(o.lookupFile("this/"+e)),o.savePkgAsync()}).then(function(){return r.reloadHeaderAsync()})},t.prototype.setSideMarkdown=function(e){var t=this.refs.sidedoc;t&&t.setMarkdown(e)},t.prototype.setSideDoc=function(e,t){void 0===t&&(t=!0);var n=this.refs.sidedoc;n&&(e?n.setPath(e,t):n.collapse())},t.prototype.setTutorialStep=function(e){this.typecheckNow();var t=this.refs.tutorialcard;if(t&&e>-1){t.focusInitialized=!1;var n=this.state.tutorialOptions;n.tutorialStep=e,this.setState({tutorialOptions:n}),n.tutorialStepInfo[e].fullscreen?this.showTutorialHint():U.TutorialContent.refresh()}},t.prototype.handleMessage=function(e){var t=this;switch(e.type){case"popoutcomplete":this.setState({sideDocsCollapsed:!0,sideDocsLoadUrl:""});break;case"tutorial":switch(e.subtype){case"loaded":var n=e;n.toolboxSubset&&Object.keys(n.toolboxSubset).length>0&&this.editor.filterToolbox({blocks:n.toolboxSubset,defaultState:pxt.editor.FilterState.Hidden},ce.Basic);var r=this.state.tutorialOptions;r.tutorialReady=!0,r.tutorialStepInfo=n.stepInfo,this.setState({tutorialOptions:r}),r.tutorialStepInfo[0].fullscreen?this.showTutorialHint():U.TutorialContent.refresh(),N.hideLoading("tutorial");break;case"error":var o=e;pxt.reportException(o.message),N.errorNotification(le("We're having trouble loading this tutorial, please try again later.")),this.setState({tutorialOptions:void 0});var i=S.mainEditorPkg().header;i.isDeleted=!0,x.saveAsync(i,{}).then(function(){t.openHome()}).finally(function(){N.hideLoading("tutorial")})}}},t.prototype.reloadHeaderAsync=function(){return this.loadHeaderAsync(this.state.header,this.state.editorState)},t.prototype.loadHeaderAsync=function(e,t,n){var r=this;return e?(this.stopSimulator(!0),pxt.blocks.cleanBlocks(),this.clearSerial(),se.jsonMergeFrom(t||{},this.state.editorState||{}),S.loadPkgAsync(e.id).then(function(){O.makeDirty(),D.newProject();var o=r.settings.fileHistory.filter(function(t){return t.id==e.id})[0],i=S.getEditorPkg(S.mainPkg),a=i.getMainFile();o&&(a=i.lookupFile(o.name)||a),o||e.editor!=pxt.JAVASCRIPT_PROJECT_NAME||S.File.tsFileNameRx.test(a.getName())||!a.getVirtualFileName()||(a=i.lookupFile("this/"+a.getVirtualFileName())||a),S.File.blocksFileNameRx.test(a.getName())&&a.getVirtualFileName()&&(a.content||(a=i.lookupFile("this/"+a.getVirtualFileName())||a)),r.setState({home:!1,showFiles:!1,editorState:t,tutorialOptions:n?r.state.tutorialOptions:void 0,header:e,projectName:e.name,currFile:a,sideDocsLoadUrl:""}),"main.ts"===a.name&&(r.shouldTryDecompile=!0),S.getEditorPkg(S.mainPkg).onupdate=function(){r.loadHeaderAsync(e,r.state.editorState).done()},S.mainPkg.getCompileOptionsAsync().catch(function(e){if(e instanceof pxt.cpp.PkgConflictError){var t=e,n=function(e){return{label:le("Remove {0}",e.id),class:"pink",icon:"trash",onclick:function(){N.showLoading("removedep",le("Removing {0}...",e.id)),S.mainEditorPkg().removeDepAsync(e.id).then(function(){return r.reloadHeaderAsync()}).done(function(){return N.hideLoading("removedep")})}}};N.dialogAsync({hideCancel:!0,buttons:[n(t.pkg1),n(t.pkg0)],header:le("Packages cannot be used together"),body:le("Packages '{0}' and '{1}' cannot be used together, because they use incompatible settings ({2}).",t.pkg1.id,t.pkg0.id,t.settingName)})}}).done();var s=r.pickEditorFor(a),c=i.lookupFile("this/README.md");c&&c.content&&c.content.trim()?r.setSideMarkdown(c.content):S.mainPkg&&S.mainPkg.config&&S.mainPkg.config.documentation&&r.setSideDoc(S.mainPkg.config.documentation,s==r.blocksEditor)}).finally(function(){pxt.BrowserUtils.changeHash("#editor",!0),document.getElementById("root").focus(),r.editorLoaded()})):Promise.resolve()},t.prototype.removeProject=function(){var e=this;S.mainEditorPkg().header&&N.confirmDelete(S.mainEditorPkg().header.name,function(){var t=S.mainEditorPkg().header;return t.isDeleted=!0,x.saveAsync(t,{}).then(function(){x.getHeaders().length>0?e.openHome():e.newProject()})})},t.prototype.importHexFile=function(e){var t=this;e&&pxt.cpp.unpackSourceFromHexFileAsync(e).done(function(e){return t.importHex(e)})},t.prototype.importBlocksFiles=function(e){var t=this;e&&ts.pxtc.Util.fileReadAsTextAsync(e).done(function(n){t.newProject({filesOverride:{"main.blocks":n,"main.ts":"  "},name:e.name.replace(/\.blocks$/i,"")||le("Untitled")})})},t.prototype.importTypescriptFile=function(e){var t=this;e&&ts.pxtc.Util.fileReadAsTextAsync(e).done(function(n){t.newProject({filesOverride:{"main.blocks":"","main.ts":n||"  "},name:e.name.replace(/\.ts$/i,"")||le("Untitled")})})},t.prototype.convertTouchDevelopToTypeScriptAsync=function(e){return R.td2tsAsync(e)},t.prototype.importHex=function(e,t){var n=this;void 0===t&&(t=!1);pxt.appTarget.id;if(!e||!e.meta)return N.warningNotification(le("Sorry, we could not recognize this file.")),void(t&&this.openHome());var r=this.hexFileImporters.filter(function(t){return t.canImport(e)})[0];r?(pxt.tickEvent("import."+r.id),N.showLoading("importhex",le("loading project...")),r.importAsync(this,e).done(function(){return N.hideLoading("importhex")},function(e){pxt.reportException(e,{importer:r.id}),N.hideLoading("importhex"),N.errorNotification(le("Oops, something went wrong when importing your project")),t&&n.openHome()})):(N.warningNotification(le("Sorry, we could not import this project.")),pxt.tickEvent("warning.importfailed"),t&&this.openHome())},t.prototype.importProjectFile=function(e){var t=this;e&&ts.pxtc.Util.fileReadAsBufferAsync(e).then(function(e){return pxt.lzmaDecompressAsync(e)}).then(function(e){var n=JSON.parse(e);t.importHex(n)}).catch(function(e){N.warningNotification(le("Sorry, we could not import this project.")),t.openHome()})},t.prototype.importFile=function(e){if(e&&!pxt.shell.isReadOnly())if(i(e.name))this.importHexFile(e);else if(a(e.name))this.importBlocksFiles(e);else if(s(e.name))this.importTypescriptFile(e);else if(c(e.name))this.importProjectFile(e);else{var t=this.resourceImporters.filter(function(t){return t.canImport(e)})[0];t?t.importAsync(this,e).done():N.warningNotification(le("Oops, don't know how to load this file!"))}},t.prototype.importProjectAsync=function(e,t){var n=this,r=e.header;return r||(r={target:pxt.appTarget.id,editor:pxt.BLOCKS_PROJECT_NAME,name:le("Untitled"),meta:{},pubId:"",pubCurrent:!1}),x.installAsync(r,e.text).then(function(e){return n.loadHeaderAsync(e,t)})},t.prototype.initDragAndDrop=function(){var e=this;re.setupDragAndDrop(document.body,function(e){return e.size<1e6&&i(e.name)||a(e.name)},function(t){t&&(pxt.tickEvent("dragandrop.open"),e.importFile(t[0]))})},t.prototype.openHome=function(){this.stopSimulator(),pxt.BrowserUtils.changeHash("",!0),this.setState({home:!0}),this.homeLoaded()},t.prototype.homeLoaded=function(){pxt.tickEvent("app.home")},t.prototype.editorLoaded=function(){pxt.tickEvent("app.editor")},t.prototype.exitAndSave=function(){this.state.projectName!==le("Untitled")?this.openHome():this.exitAndSaveDialog.show()},t.prototype.exportProjectToFileAsync=function(){return S.mainPkg.compressToFileAsync(this.getPreferredEditor())},t.prototype.getPreferredEditor=function(){return this.editor==this.blocksEditor?pxt.BLOCKS_PROJECT_NAME:pxt.JAVASCRIPT_PROJECT_NAME},t.prototype.exportAsync=function(){return pxt.debug("exporting project"),this.exportProjectToFileAsync().then(function(e){return window.btoa(se.uint8ArrayToString(e))})},t.prototype.importProjectFromFileAsync=function(e){var t=this;return pxt.lzmaDecompressAsync(e).then(function(e){var n=JSON.parse(e);return t.importHex(n)}).catch(function(){return t.newProject()})},t.prototype.saveProjectToFileAsync=function(){S.mainPkg;return this.exportProjectToFileAsync().then(function(e){var t=S.genFileName(".mkcd");pxt.BrowserUtils.browserDownloadUInt8Array(e,t,"application/octet-stream")})},t.prototype.addPackage=function(){this.scriptSearch.showAddPackages()},t.prototype.openExtension=function(e,t,n){pxt.tickEvent("app.openextension",{extension:e}),this.extensions.showExtension(e,t,n)},t.prototype.handleExtensionRequest=function(e){this.extensions.handleExtensionRequest(e)},t.prototype.newEmptyProject=function(e,t){this.newProject({filesOverride:{"main.blocks":'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>'},name:e,documentation:t})},t.prototype.newProject=function(e){void 0===e&&(e={}),pxt.tickEvent("app.newproject"),N.showLoading("newproject",le("creating new project...")),this.createProjectAsync(e).then(function(){return Promise.delay(500)}).done(function(){return N.hideLoading("newproject")})},t.prototype.createProjectAsync=function(e){var t=this;this.setSideDoc(void 0),e.prj||(e.prj=pxt.appTarget.blocksprj);var n=pxt.U.clone(e.prj.config);n.name=e.name||le("Untitled"),n.documentation=e.documentation;var r=se.clone(e.prj.files);return e.filesOverride&&se.jsonCopyFrom(r,e.filesOverride),r["pxt.json"]=JSON.stringify(n,null,4)+"\n",x.installAsync({name:n.name,meta:{},editor:e.prj.id,pubId:"",pubCurrent:!1,target:pxt.appTarget.id,temporary:e.temporary},r).then(function(n){return t.loadHeaderAsync(n,{filters:e.filters},e.inTutorial)})},t.prototype.switchTypeScript=function(){var e=S.mainEditorPkg(),t=this.editorFile.getVirtualFileName(),n=e.files[t];this.setFile(n)},t.prototype.saveBlocksToTypeScriptAsync=function(){return this.blocksEditor.saveToTypeScript()},t.prototype.saveTypeScriptAsync=function(e){var t=this;if(void 0===e&&(e=!1),!this.editor||!this.state.currFile||this.editorFile.epkg!=S.mainEditorPkg()||this.reload)return Promise.resolve();var n=Promise.resolve().then(function(){return e?t.textEditor.loadMonacoAsync():Promise.resolve()}).then(function(){return t.editor.saveToTypeScript().then(function(n){if(!n)return Promise.resolve();var r=S.mainEditorPkg(),o=t.editorFile.getVirtualFileName();return se.assert(o!=t.editorFile.name),r.setContentAsync(o,n).then(function(){if(e){var n=r.files[o];t.setFile(n)}})})});return e?N.showLoadingAsync("switchtojs",le("switching to JavaScript..."),n,0):n},t.prototype.resetWorkspace=function(){return this.reload=!0,x.resetAsync().done(function(){return window.location.reload()},function(){return window.location.reload()})},t.prototype.reset=function(){var e=this;N.confirmAsync({header:le("Reset"),body:le("You are about to clear all projects. Are you sure? This operation cannot be undone."),agreeLbl:le("Reset"),agreeClass:"red focused",agreeIcon:"sign out",disagreeLbl:le("Cancel")}).then(function(t){return t?he?he.disconnectAsync().then(function(){return e.resetWorkspace()}):e.resetWorkspace():Promise.resolve()})},t.prototype.promptRenameProjectAsync=function(){var e=this;if(!this.state.header)return Promise.resolve(!1);var t={header:le("Rename your project"),agreeLbl:le("Save"),agreeClass:"green",input:le("Enter your project name here")};return N.confirmAsync(t).then(function(n){return n&&t.inputValue?new Promise(function(n,r){e.setState({projectName:t.inputValue},function(){return n()})}).then(function(){return e.saveProjectNameAsync()}).then(function(){return!0}):Promise.resolve(!1)})},t.prototype.saveAndCompile=function(){var e=this;if(this.state.header)return this.setState({isSaving:!0}),(this.state.projectName!==le("Untitled")?Promise.resolve(!0):this.promptRenameProjectAsync()).then(function(){return e.saveProjectNameAsync()}).then(function(){return e.saveFileAsync()}).then(function(){!pxt.appTarget.compile.hasHex||pxt.appTarget.compile.useMkcd?e.saveProjectToFileAsync().finally(function(){e.setState({isSaving:!1})}).done():e.compile(!0)})},t.prototype.beforeCompile=function(){},t.prototype.compile=function(e){var t=this;void 0===e&&(e=!1),/webusb=1/i.test(window.location.href)&&pxt.usb.initAsync().catch(function(e){}),this.beforeCompile();var n=void 0;if(!pxt.appTarget.compile.useModulator&&pxt.BrowserUtils.isBrowserDownloadInSameWindow()&&(n=window.open("")),pxt.tickEvent("compile"),pxt.debug("compiling..."),this.state.compiling)pxt.tickEvent("compile.double");else{var r=this.state.running;this.setState({compiling:!0}),this.clearSerial(),this.editor.beforeCompile(),r&&this.stopSimulator();var o=this.editor.snapshotState();D.compileAsync({native:!0,forceEmit:!0,preferredEditor:this.getPreferredEditor()}).then(function(r){t.editor.setDiagnostics(t.editorFile,o);var i=pxt.outputName();return r.outfiles[i]?(r.saveOnly=e,r.userContextWindow=n,r.downloadFileBaseName=S.genFileName(""),r.confirmAsync=N.confirmAsync,e?pxt.commands.saveOnlyAsync(r):pxt.commands.deployCoreAsync(r).catch(function(e){if(e.notifyUser)N.warningNotification(e.message);else{var t=le(pxt.appTarget.appTheme.useUploadMessage?"Upload failed, please try again.":"Download failed, please try again.");N.warningNotification(t)}if(pxt.reportException(e),n)try{n.close()}catch(e){}})):(pxt.tickEvent("compile.noemit"),N.warningNotification(le("Compilation failed, please check your code for errors.")),Promise.resolve())}).catch(function(e){if(pxt.reportException(e),N.errorNotification(le("Compilation failed, please contact support.")),n)try{n.close()}catch(e){}}).finally(function(){t.setState({compiling:!1,isSaving:!1}),r&&t.runSimulator()}).done()}},t.prototype.overrideTypescriptFile=function(e){this.textEditor&&this.textEditor.overrideFile(e)},t.prototype.overrideBlocksFile=function(e){this.blocksEditor&&this.blocksEditor.overrideFile(e)},t.prototype.startStopSimulator=function(){this.state.running?this.stopSimulator():this.startSimulator()},t.prototype.restartSimulator=function(){this.stopSimulator(),this.startSimulator()},t.prototype.toggleTrace=function(e){this.state.tracing?(this.editor.clearHighlightedStatements(),O.setTraceInterval(0)):O.setTraceInterval(void 0!=e?e:O.SLOW_TRACE_INTERVAL),this.setState({tracing:!this.state.tracing}),this.restartSimulator()},t.prototype.startSimulator=function(){var e=this;pxt.tickEvent("simulator.start"),this.saveFileAsync().then(function(){return e.runSimulator()})},t.prototype.stopSimulator=function(e){pxt.tickEvent("simulator.stop"),O.stop(e),this.setState({running:!1})},t.prototype.proxySimulatorMessage=function(e){O.proxy({type:"custom",content:e})},t.prototype.toggleSimulatorCollapse=function(){var e=this.state;!e.running&&e.collapseEditorTools&&this.startStopSimulator(),e.collapseEditorTools?this.expandSimulator():this.collapseSimulator()},t.prototype.expandSimulator=function(){pxt.appTarget.simulator.headless?O.unhide():this.startSimulator(),this.setState({collapseEditorTools:!1})},t.prototype.collapseSimulator=function(){var e=this;O.hide(function(){e.setState({collapseEditorTools:!0})})},t.prototype.toggleSimulatorFullscreen=function(){this.state.fullscreen?document.removeEventListener("keydown",this.closeOnEscape):document.addEventListener("keydown",this.closeOnEscape),this.closeFlyout(),this.setState({fullscreen:!this.state.fullscreen})},t.prototype.closeFlyout=function(){this.editor.closeFlyout()},t.prototype.toggleMute=function(){O.mute(!this.state.mute),this.setState({mute:!this.state.mute})},t.prototype.openInstructions=function(){var e=this,t=this.state.running;t&&this.stopSimulator(),G.makeAsync().finally(function(){t&&e.startSimulator()})},t.prototype.clearSerial=function(){this.serialEditor.clear();var e=this.refs.simIndicator,t=this.refs.devIndicator;e&&e.clear(),t&&t.clear()},t.prototype.hwDebug=function(){var e=Promise.resolve();return this.state.running&&O.driver.runOptions.debug||(e=this.runSimulator({debug:!0})),e.then(function(){return O.driver.setHwDebugger({postMessage:function(e){pxt.HWDBG.handleMessage(e)}}),pxt.HWDBG.postMessage=function(e){return O.driver.handleHwDebuggerMsg(e)},Promise.join(D.compileAsync({debug:!0,native:!0}),j.initAsync()).then(function(e){return pxt.HWDBG.startDebugAsync(e[0],e[1])})})},t.prototype.runSimulator=function(e){var t=this;void 0===e&&(e={});var n=this.editor?this.editor.getId().replace(/Editor$/,""):"unknown";e.background?pxt.tickActivity("autorun","autorun."+n):pxt.tickEvent(e.debug?"debug":"run",{editor:n}),e.background||this.editor.beforeCompile(),this.state.tracing&&(e.trace=!0),this.stopSimulator();var r=this.editor.snapshotState();return D.compileAsync(e).then(function(n){t.clearSerial(),t.editor.setDiagnostics(t.editorFile,r),n.outfiles[pxtc.BINARY_JS]?(O.run(S.mainPkg,e.debug,n,t.state.mute,t.state.highContrast),t.setState({running:!0,showParts:O.driver.runOptions.parts.length>0})):e.background||N.warningNotification(le("Oops, we could not run this project. Please check your code for errors."))})},t.prototype.editText=function(){var e=this;this.editor!=this.textEditor&&(this.updateEditorFile(this.textEditor).then(function(){e.textEditor.editor.focus()}),this.forceUpdate())},t.prototype.importFileDialog=function(){var e,t=this,n=".mkcd";pxt.appTarget.compile&&pxt.appTarget.compile.hasHex&&(n=".hex"),pxt.appTarget.compile&&pxt.appTarget.compile.useUF2&&(n=".uf2"),N.confirmAsync({header:le("Open {0} file",n),onLoaded:function(t){e=t.find("input")[0]},htmlBody:'<div class="ui form">\n  <div class="ui field">\n    <label id="selectFileToOpenLabel">'+le("Select a {0} file to open.",n)+'</label>\n    <input type="file" tabindex="0" autofocus aria-describedby="selectFileToOpenLabel" class="ui blue fluid focused"></input>\n  </div>\n</div>'}).done(function(n){n&&(pxt.tickEvent("app.open.file"),t.importFile(e.files[0]))})},t.prototype.importProjectDialog=function(){this.importDialog.show()},t.prototype.showReportAbuse=function(){var e,t,n=this,r=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";N.confirmAsync({header:le("Report Abuse"),onLoaded:function(o){e=o.find("input"),t=o.find("textarea"),n.state.header&&n.state.header.pubCurrent&&n.state.header.pubId&&e.val(r+n.state.header.pubId)},agreeLbl:le("Submit"),htmlBody:'<div class="ui form">\n  <div class="ui field">\n    <label>'+le("What is the URL of the offensive project?")+'</label>\n    <input type="url" class="focused" tabindex="0" autofocus placeholder="Enter project URL here..."></input>\n  </div>\n  <div class="ui field">\n    <label>'+le("Why do you find it offensive?")+"</label>\n    <textarea></textarea>\n  </div>\n</div>"}).done(function(n){if(n){pxt.tickEvent("app.reportabuse.send");var r=pxt.Cloud.parseScriptId(e.val());r?(N.infoNotification(le("Sending abuse report...")),ae.privatePostAsync(r+"/abusereports",{text:t.val()}).then(function(e){N.infoNotification(le("Report sent. Thank you!"))}).catch(function(e){404==e.statusCode?N.warningNotification(le("Oops, we could not find this script.")):N.handleNetworkError(e)})):N.errorNotification(le("Sorry, the project url looks invalid."))}})},t.prototype.importUrlDialog=function(){var e,t=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";N.confirmAsync({header:le("Open project URL"),onLoaded:function(t){e=t.find("input")[0]},htmlBody:'<div class="ui form">\n<div class="ui icon violet message">\n    <i class="user icon"></i>\n    <div class="content">\n        <h3 class="header">\n            '+le("User-provided content")+"\n        </h3>\n        <p>\n            "+le("The content below is provided by a user, and is not endorsed by Microsoft.")+"\n            "+le("If you think it's not appropriate, please report abuse through Settings -> Report Abuse.")+'\n        </p>\n    </div>\n</div>\n  <div class="ui field">\n    <label id="selectUrlToOpenLabel">'+le("Copy the URL of the project.")+'</label>\n    <input type="url" tabindex="0" autofocus aria-describedby="selectUrlToOpenLabel" placeholder="'+t+'..." class="ui blue fluid"></input>\n  </div>\n</div>'}).done(function(t){if(t){pxt.tickEvent("app.open.url");var n=pxt.Cloud.parseScriptId(e.value);n?y(n):N.errorNotification(le("Sorry, the project url looks invalid."))}})},t.prototype.launchFullEditor=function(){se.assert(pxt.shell.isSandboxMode());var e=pxt.appTarget.appTheme.embedUrl;/\/$/.test(e)||(e+="/");var t=S.mainPkg,n=S.getEditorPkg(t);pxt.shell.isReadOnly()?(n.header.pubId,e+="#pub:"+n.header.pubId,window.open(e,"_blank")):this.exportAsync().done(function(t){pxt.tickEvent("sandbox.openfulleditor"),e+="#project:"+t,window.open(e,"_blank")})},t.prototype.anonymousPublishAsync=function(){var e=this;pxt.tickEvent("publish"),this.setState({publishing:!0});var t=S.mainPkg,n=S.getEditorPkg(t);return this.saveProjectNameAsync().then(function(){return e.saveFileAsync()}).then(function(){return t.filesToBePublishedAsync(!0)}).then(function(r){if(n.header.pubCurrent)return Promise.resolve(n.header.pubId);var o={description:t.config.description},i=e.blocksEditor.contentSize();return i&&(o.blocksHeight=i.height,o.blocksWidth=i.width),x.anonymousPublishAsync(n.header,r,o).then(function(e){return e.id})}).finally(function(){e.setState({publishing:!1})}).catch(function(e){throw N.errorNotification(e.message),e})},t.prototype.updateHeaderName=function(e){this.setState({projectName:e}),this.debouncedSaveProjectName()},t.prototype.saveProjectNameAsync=function(){if(!this.state.projectName||!this.state.header)return Promise.resolve();try{return this.updateHeaderNameAsync(this.state.projectName)}catch(e){return pxt.reportException(e),Promise.resolve()}},t.prototype.updateHeaderNameAsync=function(e){var t=this;if(S.mainPkg.config.name==e)return Promise.resolve();S.mainPkg.config.name=e,pxt.debug("saving project name to "+e);var n=S.mainEditorPkg().lookupFile("this/"+pxt.CONFIG_NAME),r=JSON.parse(n.content);return r.name=e,n.setContentAsync(JSON.stringify(r,null,4)+"\n").then(function(){t.state.header&&t.setState({projectName:e})})},t.prototype.isTextEditor=function(){return this.editor==this.textEditor},t.prototype.isPxtJsonEditor=function(){return this.editor==this.pxtJsonEditor},t.prototype.isBlocksEditor=function(){return this.editor==this.blocksEditor},t.prototype.about=function(){var e=pxt.appTarget.compileService,t=pxt.appTarget.description||pxt.appTarget.title,n=pxt.appTarget.appTheme.githubUrl;N.confirmAsync({header:le("About {0}",pxt.appTarget.name),hideCancel:!0,agreeLbl:le("Ok"),agreeClass:"positive focused",htmlBody:"\n"+(t?"<p>"+se.htmlEscape(t)+"</p>":"")+"\n"+(n?"<p>"+le("{0} version:",se.htmlEscape(pxt.appTarget.name))+' <a class="focused" href="'+se.htmlEscape(n)+"/releases/tag/v"+se.htmlEscape(pxt.appTarget.versions.target)+'" aria-label="'+le("{0} version : {1}",se.htmlEscape(pxt.appTarget.name),se.htmlEscape(pxt.appTarget.versions.target))+'" target="_blank">'+se.htmlEscape(pxt.appTarget.versions.target)+"</a></p>":"")+"\n<p>"+le("{0} version:","Microsoft MakeCode")+' <a href="https://github.com/Microsoft/pxt/releases/tag/v'+se.htmlEscape(pxt.appTarget.versions.pxt)+'" aria-label="'+le("{0} version: {1}","Microsoft MakeCode",se.htmlEscape(pxt.appTarget.versions.pxt))+'" target="_blank">'+se.htmlEscape(pxt.appTarget.versions.pxt)+"</a></p>\n"+(e&&e.githubCorePackage&&e.gittag?"<p>"+le("{0} version:","C++ runtime")+' <a href="'+se.htmlEscape("https://github.com/"+e.githubCorePackage+"/releases/tag/"+e.gittag)+'" aria-label="'+le("{0} version: {1}","C++ runtime",se.htmlEscape(e.gittag))+'" target="_blank">'+se.htmlEscape(e.gittag)+"</a></p>":"")+"\n"}).done()},t.prototype.share=function(){var e=this.state.header;this.shareEditor.show(e)},t.prototype.selectLang=function(){this.languagePicker.show()},t.prototype.renderBlocksAsync=function(e){return D.getBlocksAsync().then(function(t){return D.decompileSnippetAsync(e.ts,t)}).then(function(e){var t=pxt.blocks.render(e,{snippetMode:!0}),n=t.getAttribute("viewBox").split(/\s+/).map(function(e){return parseInt(e)});return pxt.blocks.layout.blocklyToSvgAsync(t,n[0],n[1],n[2],n[3])}).then(function(e){return e.xml})},t.prototype.startTutorial=function(e,t){pxt.tickEvent("tutorial.start"),pxt.Cloud.isNavigatorOnline()?(N.showLoading("tutorial",le("starting tutorial...")),this.startTutorialAsync(e,t)):N.errorNotification(le("No Internet access, please connect and try again."))},t.prototype.startTutorialAsync=function(e,t){var n=this,r=t||e.split("/").reverse()[0].replace("-"," ");return Y.initTutorial(),Promise.resolve().then(function(){var t={tutorial:e,tutorialName:r,tutorialStep:0};n.setState({tutorialOptions:t,editorState:{searchBar:!1},tracing:void 0}),n.refs.tutorialcontent.setPath(e)}).then(function(){return n.createProjectAsync({name:r,inTutorial:!0})}).catch(function(e){N.hideLoading("tutorial"),N.handleNetworkError(e)})},t.prototype.completeTutorial=function(){var e=this;pxt.tickEvent("tutorial.complete"),N.showLoading("leavingtutorial",le("leaving tutorial...")),this.exitTutorialAsync().then(function(){var t=S.mainEditorPkg().header;return e.loadHeaderAsync(t)}).done(function(){N.hideLoading("leavingtutorial")})},t.prototype.exitTutorial=function(){var e=this;pxt.tickEvent("tutorial.exit"),N.showLoading("leavingtutorial",le("leaving tutorial...")),this.exitTutorialAsync().done(function(){N.hideLoading("leavingtutorial"),e.openHome()})},t.prototype.exitTutorialAsync=function(){var e=this,t=S.mainEditorPkg().header,n=S.mainEditorPkg().getAllFiles();return x.saveAsync(t,n).then(function(){return Promise.delay(500)}).finally(function(){e.setState({tutorialOptions:void 0,tracing:void 0,editorState:void 0}),N.resetFocus()})},t.prototype.toggleHighContrast=function(){var e=this,t=!this.state.highContrast;pxt.tickEvent("app.highcontrast",{on:t?1:0}),this.setState({highContrast:t},function(){return e.restartSimulator()}),N.highContrast=t,this.editor&&this.editor.isReady&&this.editor.setHighContrast(t)},t.prototype.showTutorialHint=function(){this.refs.tutorialhint.showHint();var e=this.state.tutorialOptions;pxt.tickEvent("tutorial.showhint",{tutorial:e.tutorial,step:e.tutorialStep})},t.prototype.setBanner=function(e){this.setState({bannerVisible:e})},t.prototype.renderCore=function(){var e=this;ue=this,this.editor&&this.editor.isReady&&this.updateEditorFile();ae.isLoggedIn()&&this.getData("cloud:me/settings?format=nonsensitive");var t=pxt.appTarget.appTheme,n=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing,r=pxt.shell.isSandboxMode(),o=!this.editor.isVisible||this.getPreferredEditor()==pxt.BLOCKS_PROJECT_NAME,i=!(r||t.hideSideDocs),a=this.state.tutorialOptions,s=!!a&&!!a.tutorial,c=this.state.home&&!r,l=!!this.state.header,u=t.hideMenuBar,p=t.hideEditorToolbar,d=pxt.appTarget.simulator.headless,f=t.selectLanguage,h=!p&&this.editor.hasEditorToolbar(),m=pxt.appTarget.serial&&!!pxt.appTarget.serial.useEditor,g=i&&this.state.sideDocsLoadUrl&&!this.state.sideDocsCollapsed,v=(this.state.hideEditorFloats||this.state.collapseEditorTools)&&(!s||d),y=this.state.collapseEditorTools&&(!s||d),b=oe.isElectron||pxt.winrt.isWinRT(),_=t.hideCookieNotice||b||!!pxt.storage.getLocal("cookieconsent")||r;document.title=this.state.header?this.state.header.name+" - "+pxt.appTarget.name:pxt.appTarget.name;var E=T.cx([v?" hideEditorFloats":"",y?" collapsedEditorTools":"",this.state.fullscreen?"fullscreensim":"",this.state.highContrast?"hc":"",g?"sideDocs":"",pxt.shell.layoutTypeClass(),c?"inHome":"",s?"tutorial":"",pxt.options.light?"light":"",pxt.BrowserUtils.isTouchEnabled()?"has-touch":"",u?"hideMenuBar":"",h?"":"hideEditorToolbar",this.state.bannerVisible?"notificationBannerVisible":"",r&&this.isEmbedSimActive()?"simView":"","full-abs","dimmable"]);return w.createElement("div",{id:"root",className:E},u?void 0:w.createElement("header",{className:"menubar",role:"banner"},l?w.createElement(F.EditorAccessibilityMenu,{parent:this,highContrast:this.state.highContrast}):void 0,w.createElement(ie.NotificationBanner,{parent:this}),w.createElement(H.MainMenu,{parent:this})),s?w.createElement("div",{id:"maineditor",className:r?"sandbox":"",role:"main"},w.createElement(U.TutorialCard,{ref:"tutorialcard",parent:this})):void 0,w.createElement("div",{id:"simulator"},w.createElement("aside",{id:"filelist",className:"ui items"},w.createElement("label",{htmlFor:"boardview",id:"boardviewLabel",className:"accessible-hidden","aria-hidden":"true"},le("Simulator")),w.createElement("div",{id:"boardview",className:"ui vertical editorFloat",role:"region","aria-labelledby":"boardviewLabel"}),w.createElement(V.SimulatorToolbar,{parent:this}),w.createElement("div",{className:"ui item portrait hide"},pxt.options.debug&&!this.state.running?w.createElement(T.Button,{key:"debugbtn",class:"teal",icon:"xicon bug",text:"Sim Debug",onClick:function(){return e.runSimulator({debug:!0})}}):"",pxt.options.debug?w.createElement(T.Button,{key:"hwdebugbtn",class:"teal",icon:"xicon chip",text:"Dev Debug",onClick:function(){return e.hwDebug()}}):""),m?w.createElement("div",{id:"serialPreview",className:"ui editorFloat portrait hide"},w.createElement(ne.SerialIndicator,{ref:"simIndicator",isSim:!0,onClick:function(){return e.openSerial(!0)}}),w.createElement(ne.SerialIndicator,{ref:"devIndicator",isSim:!1,onClick:function(){return e.openSerial(!1)}})):void 0,r||o||this.editor==this.serialEditor?void 0:w.createElement(q.FileList,{parent:this}))),w.createElement("div",{id:"maineditor",className:r?"sandbox":"",role:"main"},this.allEditors.map(function(e){return e.displayOuter()})),c?w.createElement("div",{id:"homescreen",className:"full-abs",role:"main"},w.createElement("div",{className:"ui home projectsdialog"},w.createElement("div",{className:"menubar",role:"banner"},w.createElement(F.HomeAccessibilityMenu,{parent:this,highContrast:this.state.highContrast})," }",w.createElement(z.ProjectsMenu,{parent:this})),w.createElement(z.Projects,{parent:this,ref:function(t){return e.home=t}}))):void 0,s?w.createElement(U.TutorialHint,{ref:"tutorialhint",parent:this}):void 0,s?w.createElement(U.TutorialContent,{ref:"tutorialcontent",parent:this}):void 0,h?w.createElement("div",{id:"editortools",role:"complementary","aria-label":le("Editor toolbar")},w.createElement(B.EditorToolbar,{ref:"editortools",parent:this})):void 0,i?w.createElement(H.SideDocs,{ref:"sidedoc",parent:this,sideDocsCollapsed:this.state.sideDocsCollapsed,docsUrl:this.state.sideDocsLoadUrl}):void 0,r?void 0:w.createElement(W.ScriptSearch,{parent:this,ref:function(t){return e.scriptSearch=t}}),r?void 0:w.createElement(K.Extensions,{parent:this,ref:function(t){return e.extensions=t}}),c?w.createElement(z.ImportDialog,{parent:this,ref:function(t){return e.importDialog=t}}):void 0,r?void 0:w.createElement(z.ExitAndSaveDialog,{parent:this,ref:function(t){return e.exitAndSaveDialog=t}}),r||!n?void 0:w.createElement(M.ShareEditor,{parent:this,ref:function(t){return e.shareEditor=t}}),f?w.createElement(L.LanguagePicker,{parent:this,ref:function(t){return e.languagePicker=t}}):void 0,r?w.createElement(H.SandboxFooter,{parent:this}):void 0,_?void 0:w.createElement(H.CookieMessage,{parent:this,cookieConsented:_,cookieKey:"cookieconsent"}),u?w.createElement("div",{id:"editorlogo"},w.createElement("a",{className:"poweredbylogo"})):void 0)},t}(C.Component);n.ProjectView=pe;var de,fe,he,me={workspace:x,require:e,core:N,getEditor:o,monaco:Q,blocks:te,compiler:D,pkg:S,getsrc:function(){pxt.log(ue.editor.getCurrentSource())},sim:O,apiAsync:N.apiAsync,showIcons:function(){var e=["cancel","certificate","checkmark","cloud","cloud upload","copy","disk outline","download","dropdown","edit","file outline","find","folder","folder open","help circle","keyboard","lock","play","puzzle","search","setting","settings","share alternate","sign in","sign out","square","stop","translate","trash","undo","upload","user","wizard","configure","align left"];N.confirmAsync({header:"Icons",htmlBody:e.map(function(e){return"<i style='font-size:2em' class=\"ui icon "+e+'"></i>&nbsp;'+e+"&nbsp; "}).join("\n")})},assembleCurrent:function(){D.compileAsync({native:!0}).then(function(){return D.assembleAsync(o().editorFile.content)}).then(function(e){var t=e.words;pxt.debug("["+t.map(function(e){return"0x"+e.toString(16)}).join(",")+"]")})},log:function(e){console.log(e)}};window.E=me,pxt.winrt.captureInitialActivation(),$(document).ready(function(){pxt.setupWebConfig(window.pxtConfig);var t=pxt.webConfig;pxt.options.debug=/dbg=1/i.test(window.location.href),pxt.options.light=/light=1/i.test(window.location.href)||pxt.BrowserUtils.isARM()||pxt.BrowserUtils.isIE();var n=/wsport=(\d+)/i.exec(window.location.href);if(n?(pxt.options.wsPort=parseInt(n[1])||3233,pxt.BrowserUtils.changeHash(window.location.hash.replace(n[0],""))):pxt.options.wsPort=3233,S.setupAppTarget(window.pxtTargetBundle),h(),!pxt.BrowserUtils.isBrowserSupported()&&!/skipbrowsercheck=1/i.exec(window.location.href))return pxt.tickEvent("unsupported"),window.location.href="/browsers",void N.showLoading("browsernotsupported",le("Sorry, this browser is not supported."));l();var o=m();P.init(function(){try{pxt.BrowserUtils.isIFrame()&&"pub"===o.cmd?location.hash="#pub:"+o.arg:ue&&!ue.home.state.visible&&ue.state&&ue.state.header&&!ue.state.header.isDeleted&&(location.hash="#reload"),location.reload()}catch(e){pxt.reportException(e),location.reload()}}),pxt.docs.requireMarked=function(){return e("marked")};var i=function(e,t){return void 0===t&&(t=!1),ue.importHex(e,t)},a=/^(https:\/\/[^/]+)/.exec(window.location.href);a&&(ae.apiRoot=a[1]+"/api/");var s=/ws=(\w+)/.exec(window.location.href),c=pxt.shell.isSandboxMode()||pxt.shell.isReadOnly();s?x.setupWorkspace(s[1]):pxt.appTarget.appTheme.allowParentController?x.setupWorkspace("iframe"):c?x.setupWorkspace("mem"):pxt.winrt.isWinRT()?x.setupWorkspace("uwp"):ae.isLocalHost()&&x.setupWorkspace("fs"),Promise.resolve().then(function(){var e=/(live)?lang=([a-z]{2,}(-[A-Z]+)?)/i.exec(window.location.href);e&&window.location.hash.indexOf(e[0])>=0&&(L.setCookieLang(e[2]),pxt.BrowserUtils.changeHash(window.location.hash.replace(e[0],"")));var n=e?e[2]:L.getCookieLang()||pxt.appTarget.appTheme.defaultLocale||navigator.userLanguage||navigator.language,r=!pxt.appTarget.appTheme.disableLiveTranslations||e&&!!e[1];return n&&pxt.tickEvent("locale."+n+(r?".live":"")),L.initialLang=n,se.updateLocalizationAsync(pxt.appTarget.id,!1,t.commitCdnUrl,n,pxt.appTarget.versions.pxtCrowdinBranch,pxt.appTarget.versions.targetCrowdinBranch,r).then(function(){return se.downloadSimulatorLocalizationAsync(pxt.appTarget.id,t.commitCdnUrl,n,pxt.appTarget.versions.pxtCrowdinBranch,pxt.appTarget.versions.targetCrowdinBranch,r)}).then(function(e){e&&(O.simTranslations=e)})}).then(function(){return pxt.BrowserUtils.initTheme()}).then(function(){return A.initCommandsAsync()}).then(function(){return x.initAsync()}).then(function(){return r(),x.syncAsync()}).then(function(e){return e&&ue.setState({editorState:e}),d(),u(),f(),b(),oe.init(),_()}).then(function(){return pxt.winrt.initAsync(i)}).then(function(){return pxt.winrt.hasActivationProjectAsync()}).then(function(e){var t=ue.settings.fileHistory.filter(function(e){return!!x.getHeader(e.id)})[0],n=x.getHeaders()[0];return t&&(n=x.getHeader(t.id)),ue.shouldShowHomeScreen()&&!e?Promise.resolve():(ue.setState({home:!1}),o.cmd&&g(o,!0)?Promise.resolve():e?pxt.winrt.loadActivationProject():n?ue.loadHeaderAsync(n,ue.state.editorState):(ue.newProject(),Promise.resolve()))}).then(function(){return x.importLegacyScriptsAsync()}).done(function(){$("#loading").remove()}),document.addEventListener("visibilitychange",function(e){ue&&ue.updateVisibility()}),window.addEventListener("unload",function(e){ue&&ue.saveSettings()}),window.addEventListener("resize",function(e){ue&&ue.editor&&ue.editor.resize(e)},!1);var p=window.ipcRenderer;p&&p.on("responseFromApp",function(e,t){try{O.driver.postMessage(JSON.parse(t))}catch(e){}}),window.addEventListener("message",function(e){var t=e.data;if(t){if("parent"==e.data.__proxy){pxt.debug("received parent proxy message"+e.data),delete e.data.__proxy;var n=window.ipcRenderer;n?n.sendToHost("sendToApp",e.data):window.parent&&window!=window.parent&&window.parent.postMessage(e.data,"*")}"tutorial"!=t.type&&"popoutcomplete"!=t.type||ue&&ue.editor&&ue.handleMessage(t),"sidedocready"===t.type&&ae.isLocalHost()&&ae.localToken&&(H.SideDocs.notify({type:"localtoken",localToken:ae.localToken}),U.TutorialContent.notify({type:"localtoken",localToken:ae.localToken}))}},!1)})},{"./accessibility":2,"./appcache":3,"./blocks":5,"./cmds":9,"./compiler":11,"./container":12,"./core":13,"./data":14,"./draganddrop":16,"./editortoolbar":17,"./electron":18,"./extensions":20,"./filelist":21,"./hidbridge":24,"./lang":26,"./make":27,"./monaco":29,"./monacoSnippets":30,"./notification":31,"./package":32,"./projects":33,"./pxtjson":34,"./screenshot":35,"./scriptsearch":36,"./serial":37,"./serialindicator":38,"./share":39,"./simtoolbar":40,"./simulator":41,"./sounds":42,"./sui":44,"./tdlegacy":45,"./toolbox":46,"./tutorial":47,"./workspace":48,marked:121,react:277,"react-dom":148}],2:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.openJavaScript=function(){pxt.tickEvent("accmenu.editor.openJS"),this.props.parent.openJavaScript()},t.prototype.selectLang=function(){pxt.tickEvent("accmenu.editor.importdialog"),this.props.parent.selectLang()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("accmenu.editor.togglecontrast"),this.props.parent.toggleHighContrast()},t.prototype.goHome=function(){pxt.tickEvent("accmenu.editor.home"),this.props.parent.exitAndSave()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.highContrast!=t.highContrast},t.prototype.renderCore=function(){var e=this,t=this.props.parent.state.highContrast,n=pxt.appTarget.appTheme;return o.createElement("div",{className:"ui accessibleMenu borderless fixed menu",role:"menubar"},o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon js",text:lf("Skip to JavaScript editor"),onClick:function(){return e.openJavaScript()}}),n.selectLanguage?o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon globe",text:lf("Select Language"),onClick:function(){return e.selectLang()}}):void 0,n.highContrast?o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",text:t?lf("High Contrast Off"):lf("High Contrast On"),onClick:function(){return e.toggleHighContrast()}}):void 0,o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"home",text:lf("Go Home"),onClick:function(){return e.goHome()}}))},t}(i.Component);n.EditorAccessibilityMenu=s;var c=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.newProject=function(){pxt.tickEvent("accmenu.home.new"),this.props.parent.newProject()},t.prototype.importProjectDialog=function(){pxt.tickEvent("accmenu.home.importdialog"),this.props.parent.importProjectDialog()},t.prototype.selectLang=function(){pxt.tickEvent("accmenu.home.langpicker"),this.props.parent.selectLang()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("accmenu.home.togglecontrast"),this.props.parent.toggleHighContrast()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.highContrast!=t.highContrast},t.prototype.renderCore=function(){var e=this,t=this.state.highContrast,n=pxt.appTarget.appTheme;return o.createElement("div",{className:"ui accessibleMenu borderless fixed menu",role:"menubar"},o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"add circle",text:lf("New Project"),onClick:function(){return e.newProject()}}),o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"upload",text:lf("Import Project"),onClick:function(){return e.importProjectDialog()}}),n.selectLanguage?o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",icon:"xicon globe",text:lf("Select Language"),onClick:function(){return e.selectLang()}}):void 0,n.highContrast?o.createElement(a.Item,{class:(n.invertedMenu?"inverted":"")+" menu",role:"menuitem",text:t?lf("High Contrast Off"):lf("High Contrast On"),onClick:function(){return e.toggleHighContrast()}}):void 0)},t}(i.Component);n.HomeAccessibilityMenu=c},{"./data":14,"./sui":44,react:277}],3:[function(e,t,n){"use strict";var r=e("./core");n.init=function(e){var t=window.applicationCache;pxt.appTarget.appTheme&&pxt.appTarget.appTheme.noReloadOnUpdate||t.addEventListener("updateready",function(){r.infoNotification(lf("Update download complete. Reloading... ")),setTimeout(function(){pxt.tickEvent("appcache.updated"),e()},3e3)},!1)}},{"./core":13}],4:[function(e,t,n){"use strict";function r(){return i||(i=o()),i}function o(){if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}}var i;n.play=function(e,t){if(void 0===t&&(t=1),e){var n=r();if(n){var o=n.createBufferSource();o.buffer=e;var i=n.createGain();i.gain.value=t,o.connect(i),i.connect(n.destination),o.start(0)}}},n.loadAsync=function(e){var t=r();return new Promise(function(n,r){t.decodeAudioData(e,function(e){return n(e)},function(){n(void 0)})})}},{}],5:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./package"),a=e("./core"),s=e("./srceditor"),c=e("./compiler"),l=e("./toolbox"),u=pxt.blocks.CategoryMode,p=pxt.Util,d=p.lf,f=function(e){function t(){e.apply(this,arguments),this.isFirstBlocklyLoad=!0,this.showToolboxCategories=u.Basic}return r(t,e),t.prototype.setVisible=function(t){e.prototype.setVisible.call(this,t),this.isVisible=t;var n="#blocksEditor .blocklyToolboxDiv, #blocksEditor .blocklyWidgetDiv, #blocksEditor .blocklyToolboxDiv";this.isVisible?($(n).show(),this.parent.fireResize()):$(n).hide()},t.prototype.saveToTypeScript=function(){var e=this;if(!this.typeScriptSaveable)return Promise.resolve("");this.clearHighlightedStatements();try{return pxt.blocks.compileAsync(this.editor,this.blockInfo).then(function(t){return e.compilationResult=t,pxt.tickActivity("blocks.compile"),e.compilationResult.source})}catch(e){return pxt.reportException(e),a.errorNotification(d("Sorry, we were not able to convert this program.")),Promise.resolve("")}},t.prototype.updateBlocksInfo=function(e){this.blockInfo=e,this.refreshToolbox()},t.prototype.domUpdate=function(){var e=this;if(this.delayLoadXml){if(this.loadingXml)return;pxt.debug("loading blockly"),this.loadingXml=!0;var t=document.createElement("div");t.className="ui inverted loading";document.getElementById("blocksArea");var n=document.getElementById("blocksEditor");n.appendChild(t),this.loadingXmlPromise=c.getBlocksAsync().then(function(t){e.blockInfo=t;var n,r=e.showSearch,o=e.getDefaultToolbox(e.showToolboxCategories);e.showToolboxCategories!==u.All&&(n=pxt.blocks.initBlocks(e.blockInfo,o,u.All,e.filters,e.extensions));var i=pxt.blocks.initBlocks(e.blockInfo,o,e.showToolboxCategories,e.filters,e.extensions);e.updateToolbox(i,e.showToolboxCategories),e.showToolboxCategories!==u.None&&r?pxt.blocks.initSearch(e.editor,i,n||i,function(e){return c.apiSearchAsync(e).then(function(e){return e})},function(t){return e.updateToolbox(t,e.showToolboxCategories,!0)}):pxt.blocks.removeSearch(),pxt.blocks.initFlyouts(e.editor),pxt.blocks.initExtensions(e.editor,e.extensions,function(t){var n=e.extensions.filter(function(e){return e.name==t})[0],r=pxt.github.parseRepoId(n.installedVersion);pxt.packagesConfigAsync().then(function(t){var o=pxt.github.repoStatus(r,t),i=r.fullName.substr(r.fullName.indexOf("/")+1),a=pxt.Cloud.isLocalHost()&&/^file:/.test(n.installedVersion)&&n.extension.localUrl,s=pxt.Cloud.isLocalHost()&&/debugExtensions/i.test(window.location.href)?"http://localhost:3232/extension.html":a?n.extension.localUrl:"https://"+r.owner+".github.io/"+i+"/";e.parent.openExtension(n.name,s,0==o)})}),pxt.debug("loading block workspace");var a=e.delayLoadXml;e.delayLoadXml=void 0,e.loadBlockly(a),e.resize(),Blockly.svgResize(e.editor),e.isFirstBlocklyLoad=!1}).finally(function(){e.loadingXml=!1,n.removeChild(t),a.hideLoading("loadingblocks")}),this.isFirstBlocklyLoad?a.showLoadingAsync("loadingblocks",d("loading..."),this.loadingXmlPromise).done():this.loadingXmlPromise.done(),this.loadingXmlPromise=null}},t.prototype.saveBlockly=function(){return this.delayLoadXml?this.delayLoadXml:this.serializeBlocks()},t.prototype.serializeBlocks=function(e){var t=pxt.blocks.saveWorkspaceXml(this.editor);return e&&(t=t.replace(/(x|y|id)="[^"]*"/g,"")),pxt.debug(t),t},t.prototype.loadBlockly=function(e){if(this.serializeBlocks()==e)return this.typeScriptSaveable=!0,pxt.debug("blocks already loaded..."),!1;this.typeScriptSaveable=!1,this.editor.clear();try{var t=pxt.blocks.importXml(e||'<block type="'+ts.pxtc.ON_START_TYPE+'"></block>',this.blockInfo,!0),n=Blockly.Xml.textToDom(t);Blockly.Xml.domToWorkspace(n,this.editor),this.initLayout(),this.editor.clearUndo(),this.reportDeprecatedBlocks(),this.typeScriptSaveable=!0}catch(e){return pxt.log(e),this.editor.clear(),this.switchToTypeScript(),this.changeCallback(),!1}return this.changeCallback(),!0},t.prototype.initLayout=function(){var e,t,n=!1;this.editor.getTopBlocks(!1).forEach(function(r){var o=r.getBoundingRectangle().topLeft;(void 0===e||o.x<e)&&(e=o.x),(void 0===t||o.y<t)&&(t=o.y),n=n||r.type!=ts.pxtc.ON_START_TYPE&&0==o.x&&0==o.y}),n?pxt.blocks.layout.flow(this.editor,{useViewWidth:!0}):(this.editor.getTopBlocks(!1).forEach(function(n){return n.moveBy(-e,-t)}),this.editor.scrollX=10,this.editor.scrollY=10,this.editor.resizeContents())},t.prototype.initPrompts=function(){Blockly.alert=function(e,t){return a.confirmAsync({hideCancel:!0,header:d("Alert"),agreeLbl:d("Ok"),agreeClass:"positive",agreeIcon:"checkmark",body:e,size:"tiny"}).then(function(){t&&t()})},Blockly.confirm=function(e,t){return a.confirmAsync({header:d("Confirm"),body:e,agreeLbl:d("Yes"),agreeClass:"cancel",agreeIcon:"cancel",disagreeLbl:d("No"),disagreeClass:"positive",disagreeIcon:"checkmark",size:"tiny"}).then(function(e){t(1==e)})},Blockly.prompt=function(e,t,n){return a.promptAsync({header:e,defaultValue:t,agreeLbl:d("Ok"),disagreeLbl:d("Cancel"),size:"tiny"}).then(function(e){n(e)})}},t.prototype.initToolboxPosition=function(){var e=this,t=Blockly.Toolbox.prototype.position;Blockly.Toolbox.prototype.position=function(){t.call(this),e.resizeToolbox()}},t.prototype.reportDeprecatedBlocks=function(){var e={},t=!1;this.blockInfo.blocks.forEach(function(t){t.attributes.deprecated&&(e[t.attributes.blockId]=0)}),this.editor.getAllBlocks().forEach(function(n){e[n.type]>=0&&(e[n.type]++,t=!0)});for(var n in e)0===e[n]&&delete e[n];t&&pxt.tickEvent("blocks.usingDeprecated",e)},t.prototype.contentSize=function(){return this.editor?pxt.blocks.blocksMetrics(this.editor):void 0},t.prototype.updateFields=function(e,t,n){var r=(new DOMParser).parseFromString(e,"application/xml"),o=r.getElementsByTagName("block");if(o.length>=1){var i=function(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);var n=r.createTextNode(t);e.appendChild(n)},a=o[0];if(t){for(var s=Array.prototype.filter.call(a.childNodes,function(e){return"field"==e.nodeName||"FIELD"==e.nodeName}),c=0;c<s.length;c++)t.hasOwnProperty(s[c].getAttribute("name"))&&(i(s[c],t[s[c].getAttribute("name")]),delete t[s[c].getAttribute("name")]);for(var l in t){var u=r.createElement("field");u.setAttribute("name",l),i(u,t[l]),a.appendChild(u)}}else if(n){var p=Array.prototype.filter.call(a.childNodes,function(e){return"mutation"==e.nodeName||"MUTATION"==e.nodeName});p.length?a.replaceChild(n,p[0]):a.appendChild(n)}return(new XMLSerializer).serializeToString(r)}return e},t.prototype.isIncomplete=function(){return!!this.editor&&this.editor.isDragging()},t.prototype.prepare=function(){var e=this;pxt.blocks.openHelpUrl=function(t){pxt.tickEvent("blocks.help",{url:t});var n=/^\/pkg\/([^#]+)#(.+)$/.exec(t);if(n){var r=i.mainPkg.deps[n[1]];if(r&&"github"==r.verProtocol())return t="/pkg/"+r.verArgument().replace(/#.*$/,"")+"#"+n[2],void window.open(t,n[1])}/^\//.test(t)?e.parent.setSideDoc(t):window.open(t,"docs")},this.prepareBlockly(),this.isReady=!0},t.prototype.prepareBlockly=function(e){var t=this;void 0===e&&(e=this.showToolboxCategories);var n=document.getElementById("blocksEditor");n.innerHTML="";var r=this.getBlocklyOptions(e);p.jsonMergeFrom(r,pxt.appTarget.appTheme.blocklyOptions||{}),this.editor=Blockly.inject(n,r);var o=Blockly.Colours;p.jsonMergeFrom(o,pxt.appTarget.appTheme.blocklyColors||{}),Blockly.Colours=o,this.editor.addChangeListener(function(e){if(Blockly.Events.disableOrphans(e),"ui"!=e.type&&t.changeCallback(),"create"==e.type){t.editor.toolbox_&&(t.editor.toolbox_.lastCategory_&&t.editor.toolbox_.lastCategory_.element_.innerText.trim());var n=e.xml.getAttribute("type");pxt.tickActivity("blocks.create","blocks.create."+n),"SHADOW"==e.xml.tagName&&t.cleanUpShadowBlocks(),t.parent.setState({hideEditorFloats:!1})}if("ui"==e.type)if("category"==e.element){var r=!!e.newValue;t.parent.setState({hideEditorFloats:r}),e.newValue==pxt.blocks.addPackageTitle()?t.addPackage():e.newValue==pxt.blocks.advancedTitle()&&(t.showToolboxCategories===u.All?t.showToolboxCategories=u.Basic:t.showToolboxCategories===u.Basic&&(t.showToolboxCategories=u.All),t.refreshToolbox())}else if("commentOpen"==e.element||"warningOpen"==e.element)e.group&&(e.newValue?t.selectedEventGroup=e.group:e.group==t.selectedEventGroup&&t.currentCommentOrWarning&&(t.currentCommentOrWarning.setVisible(!0),t.selectedEventGroup=void 0));else if("selected"==e.element){t.currentCommentOrWarning&&t.currentCommentOrWarning.setVisible(!1);var o=Blockly.selected;o&&o.warning&&"string"!=typeof o.warning?(o.warning.setVisible(!0),t.currentCommentOrWarning=o.warning):o&&o.comment&&"string"!=typeof o.comment&&(o.comment.setVisible(!0),t.currentCommentOrWarning=o.comment)}}),this.initPrompts(),this.initToolboxPosition(),this.resize()},t.prototype.resize=function(e){var t=document.getElementById("blocksArea"),n=document.getElementById("blocksEditor");t&&n&&this.editor&&(n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px",Blockly.svgResize(this.editor),this.resizeToolbox())},t.prototype.resizeToolbox=function(){var e=document.getElementById("blocksEditor");if(e){var t=e.getElementsByClassName("blocklyToolboxDiv")[0];if(t){this.parent.updateEditorLogo(t.clientWidth);var n=e.offsetHeight;t.style.height=n+"px"}}},t.prototype.hasUndo=function(){return!!this.editor&&0!=this.editor.undoStack_.length},t.prototype.undo=function(){this.editor&&(this.editor.undo(),this.parent.forceUpdate())},t.prototype.hasRedo=function(){return!!this.editor&&0!=this.editor.redoStack_.length},t.prototype.redo=function(){this.editor&&(this.editor.undo(!0),this.parent.forceUpdate())},t.prototype.zoomIn=function(){this.editor&&this.editor.zoomCenter(2)},t.prototype.zoomOut=function(){this.editor&&this.editor.zoomCenter(-2)},t.prototype.closeFlyout=function(){this.editor&&Blockly.hideChaff()},t.prototype.getId=function(){return"blocksArea"},t.prototype.display=function(){return o.createElement("div",null,o.createElement("div",{id:"blocksEditor"}))},t.prototype.addPackage=function(){pxt.tickEvent("blocks.addpackage"),this.editor.toolbox_.clearSelection(),this.parent.addPackage()},t.prototype.getViewState=function(){return{}},t.prototype.setViewState=function(e){},t.prototype.getCurrentSource=function(){return this.editor?this.saveBlockly():this.currSource},t.prototype.acceptsFile=function(e){return"blocks"==e.getExtension()},t.prototype.overrideFile=function(e){this.delayLoadXml?(this.delayLoadXml=e,this.currSource=e):this.loadBlockly(e)},t.prototype.loadFileAsync=function(e){p.assert(!this.delayLoadXml),p.assert(!this.loadingXmlPromise),this.currSource=e.content,this.typeScriptSaveable=!1,this.setDiagnostics(e),this.delayLoadXml=e.content,this.editor.clearUndo(),this.currFile&&this.currFile!=e&&this.filterToolbox(null),this.parent.state.editorState&&this.parent.state.editorState.filters?this.filterToolbox(this.parent.state.editorState.filters):this.filters=null,this.parent.state.editorState&&void 0!=this.parent.state.editorState.searchBar?this.showSearch=this.parent.state.editorState.searchBar:this.showSearch=!0,this.currFile=e;var t=document.getElementById("blocklySearchInputField");return t&&t.value&&(t.value=""),this.extensions=i.allEditorPkgs().map(function(e){return e.getKsPkg()}).map(function(e){return!!e&&e.config}).filter(function(e){return!!e&&!!e.extension&&/^(file:|github:)/.test(e.installedVersion)}),Promise.resolve()},t.prototype.switchToTypeScript=function(){pxt.tickEvent("blocks.switchjavascript"),this.parent.closeFlyout(),this.parent.switchTypeScript()},t.prototype.setDiagnostics=function(e){var t=this;if(p.assert(void 0!=this.editor),this.compilationResult&&!this.delayLoadXml&&!this.loadingXml){this.editor.getAllBlocks().filter(function(e){return!e.disabled}).forEach(function(e){return e.setWarningText(null)});var n=e.epkg.files[e.getVirtualFileName()];if(n&&n.diagnostics){var r=n.diagnostics.filter(function(e){return e.category==ts.pxtc.DiagnosticCategory.Error}),o=this.compilationResult.sourceMap;r.filter(function(e){return e.category==ts.pxtc.DiagnosticCategory.Error}).forEach(function(e){var n=pxt.blocks.findBlockId(o,{start:e.line,length:0});if(n){var r=t.editor.getBlockById(n);if(r){var i=ts.pxtc.flattenDiagnosticMessageText(e.messageText,"\n");r.setWarningText(i)}}})}}},t.prototype.highlightStatement=function(e){if(this.compilationResult&&!this.delayLoadXml&&!this.loadingXml&&e){var t=pxt.blocks.findBlockId(this.compilationResult.sourceMap,{start:e.line,length:e.endLine-e.line});t&&this.editor.highlightBlock(t)}},t.prototype.clearHighlightedStatements=function(){this.editor.highlightBlock(null)},t.prototype.openTypeScript=function(){pxt.tickEvent("blocks.showjavascript"),this.parent.closeFlyout(),this.parent.openTypeScriptAsync().done()},t.prototype.cleanUpShadowBlocks=function(){this.editor.getTopBlocks(!1).filter(function(e){return e.isShadow_}).forEach(function(e){return e.dispose(!1)})},t.prototype.getBlocklyOptions=function(e){void 0===e&&(e=this.showToolboxCategories);var t=pxt.shell.isReadOnly(),n=e!==u.None?document.getElementById("blocklyToolboxDefinitionCategory"):document.getElementById("blocklyToolboxDefinitionFlyout");return{toolbox:t?void 0:n,scrollbars:!0,media:pxt.webConfig.commitCdnUrl+"blockly/media/",sound:!0,trashcan:!1,collapse:!1,comments:!0,disable:!1,readOnly:t,toolboxOptions:{colour:pxt.appTarget.appTheme.coloredToolbox,inverted:pxt.appTarget.appTheme.invertedToolbox},zoom:{enabled:!1,controls:!1,wheel:!0,maxScale:2.5,minScale:.2,scaleSpeed:1.05,startScale:pxt.BrowserUtils.isMobile()?.7:.8},rtl:p.isUserLanguageRtl()}},t.prototype.getDefaultToolbox=function(e){return void 0===e&&(e=this.showToolboxCategories),e!==u.None?l.getBaseToolboxDom().documentElement:(new DOMParser).parseFromString('<xml id="blocklyToolboxDefinition" style="display: none"></xml>',"text/xml").documentElement},t.prototype.filterToolbox=function(e,t){return void 0===t&&(t=this.showToolboxCategories),this.filters=e,this.showToolboxCategories=t,this.refreshToolbox()},t.prototype.refreshToolbox=function(){if(this.blockInfo){var e,t=this.getDefaultToolbox(this.showToolboxCategories);this.showToolboxCategories!==u.All&&(e=pxt.blocks.createToolbox(this.blockInfo,t,u.All,this.filters,this.extensions));var n=pxt.blocks.createToolbox(this.blockInfo,t,this.showToolboxCategories,this.filters,this.extensions);return this.updateToolbox(n,this.showToolboxCategories),pxt.blocks.cachedSearchTb=n,pxt.blocks.cachedSearchTbAll=e||n,n}},t.prototype.updateToolbox=function(e,t,n){if(void 0===t&&(t=this.showToolboxCategories),void 0===n&&(n=!1),!pxt.shell.isReadOnly()){pxt.debug("updating toolbox");var r=this.editor;if(r.toolbox_&&t!==u.None||r.flyout_&&t===u.None){var o=(new XMLSerializer).serializeToString(e);if(o==this.cachedToolbox)return;this.cachedToolbox=o,this.editor.updateToolbox(e),!n&&r.toolbox_&&r.toolbox_.tree_&&r.toolbox_.tree_.setSelectedItem(null)}else this.delayLoadXml=this.getCurrentSource(),this.editor=void 0,this.loadingXml=!1,this.loadingXmlPromise&&(this.loadingXmlPromise.cancel(),this.loadingXmlPromise=null),this.prepareBlockly(t),this.domUpdate(),this.editor.scrollCenter()}},t}(s.Editor);n.Editor=f},{"./compiler":11,"./core":13,"./package":32,"./srceditor":43,"./toolbox":46,react:277}],6:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("react-dom"),a=function(e){function t(t){e.call(this,t),this.state={}}return r(t,e),t.prototype.renderSvg=function(){var e=$(i.findDOMNode(this)),t=pxt.blocks.render(this.props.xml);e.children().remove(),e.append(t)},t.prototype.componentDidMount=function(){this.renderSvg()},t.prototype.componentDidUpdate=function(){this.renderSvg()},t.prototype.render=function(){return o.createElement("div",{style:{width:"100%",minHeight:"10em",direction:"ltr"}})},t}(o.Component);n.BlocksPreview=a},{react:277,"react-dom":148}],7:[function(e,t,n){"use strict";function r(e){return"screenX"in e?e.screenX:e.changedTouches[0].screenX}var o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("react"),a=e("./sui"),s=function(e){function t(){e.apply(this,arguments),this.arrows=[],this.isDragging=!1,this.definitelyDragging=!1,this.cancelClick=!1,this.currentOffset=0,this.index=0,this.childrenElements=[]}return o(t,e),t.prototype.componentWillReceiveProps=function(e){void 0!=e.selectedIndex&&this.setIndex(e.selectedIndex)},t.prototype.render=function(){var e=this;this.childrenElements=[],this.arrows=[];var t=this.state||{},n=t.rightDisabled,r=t.leftDisabled;return i.createElement("div",{className:"ui carouselouter"},i.createElement("span",{className:"carouselarrow left aligned"+(r?" arrowdisabled":""),tabIndex:r?-1:0,onClick:function(){return e.onArrowClick(!0)},ref:function(t){return e.arrows.push(t)}},i.createElement(a.Icon,{icon:"circle angle left"})),i.createElement("div",{className:"carouselcontainer",ref:function(t){return e.container=t}},i.createElement("div",{className:"carouselbody",ref:function(t){return e.dragSurface=t}},i.Children.map(this.props.children,function(t,n){return i.createElement("div",{className:"carouselitem "+(e.props.selectedIndex==n?"selected":""),ref:function(t){return t&&e.childrenElements.push(t)}},t)}))),i.createElement("span",{className:"carouselarrow right aligned"+(n?" arrowdisabled":""),tabIndex:n?-1:0,onClick:function(){return e.onArrowClick(!1)},ref:function(t){return e.arrows.push(t)}},i.createElement(a.Icon,{icon:"circle angle right"})))},t.prototype.onArrowClick=function(e){this.setIndex(e?this.index-this.actualPageLength:this.index+this.actualPageLength)},t.prototype.componentDidMount=function(){var e=this;this.initDragSurface(),this.updateDimensions(),window.addEventListener("resize",function(t){e.updateDimensions()})},t.prototype.componentDidUpdate=function(){this.updateDimensions()},t.prototype.updateDimensions=function(){if(this.container){var e=!1;if(this.containerWidth=this.container.getBoundingClientRect().width,this.getArrowWidth(),this.childrenElements.length){var t=this.childrenElements[0].getBoundingClientRect().width;t!==this.childWidth&&(this.childWidth=t,e=!0),this.actualPageLength=Math.floor(this.containerWidth/this.childWidth)}this.dragSurface.style.width=this.totalLength()+"px",this.updateArrows(),this.index>=this.maxIndex()&&(e=!0,this.index=this.maxIndex()),e&&this.setPosition(this.indexToOffset(this.index))}},t.prototype.initDragSurface=function(){var e=this,t=function(t){e.definitelyDragging=!1,e.dragStart(r(t))},n=function(t){e.isDragging&&(e.dragEnd(),e.definitelyDragging&&(t.preventDefault(),t.stopPropagation()))},o=function(t){e.isDragging&&e.dragEnd()},i=function(t){if(e.isDragging){var n=r(t);Math.abs(n-e.dragStartX)>3&&(e.definitelyDragging=!0),t.stopPropagation(),t.preventDefault(),window.requestAnimationFrame(function(){e.dragMove(n)})}};this.dragSurface.addEventListener("click",function(t){e.definitelyDragging&&(t.stopPropagation(),t.preventDefault())}),window.PointerEvent?(this.dragSurface.addEventListener("pointerdown",t),this.dragSurface.addEventListener("pointerup",n),this.dragSurface.addEventListener("pointerleave",o),this.dragSurface.addEventListener("pointermove",i)):(this.dragSurface.addEventListener("mousedown",t),this.dragSurface.addEventListener("mouseup",n),this.dragSurface.addEventListener("mouseleave",o),this.dragSurface.addEventListener("mousemove",i),pxt.BrowserUtils.isTouchEnabled()&&(this.dragSurface.addEventListener("touchstart",t),this.dragSurface.addEventListener("touchend",n),this.dragSurface.addEventListener("touchcancel",o),this.dragSurface.addEventListener("touchmove",i)))},t.prototype.dragStart=function(e){this.isDragging=!0,this.dragStartX=e,this.dragStartOffset=this.currentOffset,this.animationId&&(window.cancelAnimationFrame(this.animationId),this.animationId=0)},t.prototype.dragEnd=function(){this.isDragging=!1,this.calculateIndex()},t.prototype.dragMove=function(e){this.dragOffset=e-this.dragStartX;var t=this.dragStartOffset+this.dragOffset;this.setPosition(t)},t.prototype.setPosition=function(e){this.dragSurface&&(e=Math.max(Math.min(e,300),this.maxScrollOffset()),this.currentOffset=e,this.dragSurface.style.marginLeft=e+"px")},t.prototype.calculateIndex=function(){if(this.dragSurface){var e=Math.abs(Math.floor(this.currentOffset/this.childWidth)),t=void 0;t=this.currentOffset<this.dragStartOffset?e:e-1,this.setIndex(t,100)}},t.prototype.setIndex=function(e,t){var n=Math.max(Math.min(e,this.maxIndex()),0);t||(t=100*Math.abs(n-this.index)),this.index=n,this.updateArrows(),this.animation=new c(this.currentOffset,this.indexToOffset(this.index),t),this.animationId||(this.animationId=window.requestAnimationFrame(this.easeTowardsIndex.bind(this)))},t.prototype.easeTowardsIndex=function(e){this.dragSurface&&(this.setPosition(this.animation.getPosition(e)),this.animation.isComplete?(this.animation=void 0,this.animationId=0):this.animationId=window.requestAnimationFrame(this.easeTowardsIndex.bind(this)))},t.prototype.indexToOffset=function(e){return e<=0?0:e===this.maxIndex()?-1*(this.totalLength()-this.containerWidth-300+2*this.arrowWidth):-1*(e*this.childWidth-this.childWidth*this.props.bleedPercent/100)},t.prototype.totalLength=function(){return i.Children.count(this.props.children)*this.childWidth+300},t.prototype.getArrowWidth=function(){var e=this;this.arrows.length&&(this.arrowWidth=0,this.arrows.forEach(function(t){t&&(e.arrowWidth=Math.max(t.getBoundingClientRect().width,e.arrowWidth))}))},t.prototype.maxScrollOffset=function(){return Math.min(-1*(this.totalLength()-this.actualPageLength*this.childWidth+300),0)},t.prototype.maxIndex=function(){return Math.max(this.childrenElements.length-this.actualPageLength,0)},t.prototype.updateArrows=function(){var e=this.state||{},t=e.rightDisabled,n=e.leftDisabled,r=this.index===this.maxIndex(),o=0===this.index;r===t&&o===n||this.setState({leftDisabled:o,rightDisabled:r})},t}(i.Component);n.Carousel=s;var c=function(){function e(e,t,n){this.start=e,this.end=t,this.millis=n,this.isComplete=!1,this.slope=(t-e)/n}return e.prototype.getPosition=function(e){if(this.isComplete)return this.end;if(void 0===this.startTime)return this.startTime=e,this.start;var t=e-this.startTime;return t>this.millis?(this.isComplete=!0,this.end):this.start+Math.floor(this.slope*t)},e}()},{"./sui":44,react:277}],8:[function(e,t,n){"use strict";function r(e){return E.filter(function(t){return t.id==e})[0]}function o(e){return v.getAsync(e.id).then(function(t){return e.text||(e.text=m.fixupFileNames(t.files)),e.textRev=t._rev,e.text})}function i(e){var t=r(e);return t?t.text?Promise.resolve(t.text):w.enqueue(e,function(){return o(t)}):Promise.resolve(null)}function a(e){return e.textRev?Promise.resolve():o(e).then(function(){},function(e){})}function s(e,t){if(e.temporary)return Promise.resolve();var n=r(e.id);return y.assert(n.header===e),t&&(e.saveId=null,n.textNeedsSave=!0,n.text=t),w.enqueue(e.id,function(){return(t?a(n).then(function(){return n.textNeedsSave=!1,v.setAsync({id:n.id,files:n.text,_rev:n.textRev}).then(function(e){n.textRev=e})}):Promise.resolve()).then(function(){return g.setAsync(n.header)}).then(function(n){e._rev=n,h.invalidate("header:"+e.id),h.invalidate("header:*"),t&&(h.invalidate("text:"+e.id),e.saveId=null)})})}function c(e,t){var n=e;n.id=y.guidGen(),n.recentUse=y.nowSeconds(),n.modificationTime=n.recentUse,n.target=pxt.appTarget.id;var r={id:n.id,header:n,text:t};return E.push(r),s(n,t).then(function(){return n})}function l(e){return/prj$/.test(e.editor)}function u(e){var t={},n=r(e.id);return i(e.id).then(function(){var r="",o=n.text;r=l(e)?JSON.stringify(o):o[Object.keys(o)[0]]||"";var i={guid:e.id,name:e.name,scriptId:e.pubId,scriptVersion:{time:e.modificationTime,baseSnapshot:"*"},meta:JSON.stringify(e.meta),status:e.pubCurrent?"published":"unpublished",recentUse:e.recentUse,editor:e.editor,script:r,target:pxt.appTarget.id};return pxt.debug("sync up "+e.id+"; "+i.script.length+" chars"),e.saveId=t,b.privatePostAsync("me/installed",{bodies:[i]})}).then(function(n){var r=n.headers[0];return e.blobId=r.scriptVersion.baseSnapshot,e.saveId===t&&(e.blobCurrent=!0),s(e)})}var p=e("./db"),d=e("./core"),f=e("./package"),h=e("./data"),m=e("./workspace"),g=new p.Table("header"),v=new p.Table("text"),y=pxt.Util,b=pxt.Cloud,_=y.lf,E=[],w=new y.PromiseQueue;n.provider={getHeaders:function(){return E.map(function(e){return e.header})},getHeader:function(e){var t=r(e);return t&&!t.header.isDeleted?t.header:null},getTextAsync:i,initAsync:function(e){return g.getAllAsync().then(function(e){E=e.filter(function(e){return e.target||(e.target="microbit"),e.target==pxt.appTarget.id}).map(function(e){return{id:e.id,header:e,text:null}})})},saveAsync:function(e,t){return s(e,t)},installAsync:c,saveToCloudAsync:function(e){return b.isLoggedIn()?u(e):Promise.resolve()},syncAsync:function(){function e(e){pxt.debug("uninstall local "+e.id);var t=r(e.id),n=E.indexOf(t);return y.assert(n>=0),E.splice(n,1),e.isDeleted=!0,w.enqueue(e.id,function(){return g.deleteAsync(e).then(function(){return a(t)}).then(function(){return v.deleteAsync({id:e.id,_rev:t.textRev})})})}function t(t,n){if("deleted"==n.status)return t?e(t):Promise.resolve();var r=t;r||(r={id:n.guid}),h++,y.assert(r.id==n.guid);var i=n.scriptVersion.baseSnapshot;return pxt.debug("sync down "+r.id+" - "+i),y.httpGetJsonAsync(m+i).catch(d.handleNetworkError).then(function(e){y.assert(e.guid==r.id),r.blobCurrent=!0,r.blobId=i,r.modificationTime=n.scriptVersion.time,r.editor=e.editor,r.name=e.name;var o={_default_:e.script};return l(r)&&(o=JSON.parse(e.script)),r.recentUse=n.recentUse,delete r.isDeleted,r.pubId=e.scriptId,r.pubCurrent="published"==e.status,r.saveId=null,r.target=e.target,t||E.push({header:r,text:null,id:r.id}),k[r.id]=1,s(r,o)}).then(function(){return o(--h)})}function n(e){d.infoNotification(e)}function o(e){var t="";0==h&&0==p?t=_("All synced"):(t=_("Syncing")+" (",h&&(t+=_("{0} down",h)),p&&(t+=(h?", ":"")+_("{0} up",p)),t+=")"),n(t)}function i(e){return p++,u(e).then(function(){return o(--p)})}function c(t){var n={guid:t.id,status:"deleted",scriptVersion:{time:y.nowSeconds(),baseSnapshot:"*"}};return b.privatePostAsync("me/installed",{bodies:[n]}).then(function(){return e(t)})}var p=0,h=0,m="",k={};return b.hasAccessToken()?b.privateGetAsync("me/installed?format=short").then(function(n){m=n.blobcontainer;var r=y.toDictionary(n.headers,function(e){return e.guid}),a=y.toDictionary(E,function(e){return e.id}),l=E.map(function(n){var o=n.header;if(r.hasOwnProperty(o.id)){var a=r[o.id];return o.isDeleted?c(o):a.scriptVersion.baseSnapshot==o.blobId?o.blobCurrent?o.recentUse!=a.recentUse?(o.recentUse=a.recentUse,s(o)):Promise.resolve():i(o):o.blobCurrent?t(o,a):i(o)}return o.blobId?e(o):i(o)});return l=l.concat(n.headers.filter(function(e){return!a[e.guid]}).map(function(e){return t(null,e)})),o(0),Promise.all(l)}).then(function(){return n(_("Syncing done"))}).then(function(){return f.notifySyncDone(k)}).then(function(){}).catch(d.handleNetworkError):Promise.resolve(void 0)},resetAsync:function(){return p.destroyAsync().then(function(){pxt.storage.clearLocal(),h.clearCache()})},importLegacyScriptsAsync:function(){function e(e){if(a){pxt.debug("cleaning import iframe"),window.removeEventListener("message",n,!1),e&&(pxt.debug("sending clear command"),a.contentWindow.postMessage({type:"transfer",action:"clear"},"https://"+o));var t=a;setTimeout(function(){return document.documentElement.removeChild(t)},2e3),a=void 0}}function t(n){if(!n.header.length)return pxt.log("done importing scripts"),pxt.storage.setLocal(r,"1"),e(!0),Promise.resolve();var o=n.header.pop(),i=n.text.pop().files;return delete o._id,delete o._rev,delete o.id,pxt.log("importing "+o.name),c(o,i).then(function(){return t(n)})}function n(e){if(e.data&&"transfer"==e.data.type&&"export"==e.data.action&&e.data.data){var n=e.data.data;pxt.debug("received "+n.header.length+" projects"),t(n).done()}}var r="legacyScriptsImported",o=pxt.appTarget.appTheme.legacyDomain;if(!o||!pxt.webConfig.targetUrl||pxt.storage.getLocal(r))return Promise.resolve();var i=pxt.webConfig.targetUrl.replace(/^https:\/\//i,"");if(o==i)return Promise.resolve();if(window.applicationCache.status==window.applicationCache.DOWNLOADING||window.applicationCache.status==window.applicationCache.UPDATEREADY)return pxt.debug("import skipped, app cached updating"),Promise.resolve();pxt.debug("injecting import iframe");var a=document.createElement("iframe");window.addEventListener("message",n,!1),a.setAttribute("style","position:absolute; width:1px; height:1px; right:0em; bottom:0em;");var s="https://"+o+"/api/transfer/"+i+"?storageid="+pxt.storage.storageId();return pxt.debug("transfer from "+s),a.src=s,a.onerror=function(t){pxt.reportException(t),e(!1)},document.documentElement.appendChild(a),Promise.resolve()}}},{"./core":13,"./data":14,"./db":15,"./package":32,"./workspace":48}],9:[function(e,t,n){"use strict";function r(e,t,n){pxt.BrowserUtils.browserDownloadBinText(e,t,n,void 0,function(e){return l.errorNotification(lf("saving file failed..."))});return Promise.resolve()}function o(e){var t="",n="",r=pxt.outputName().replace(/[^.]*/,"");if(pxt.isOutputText()){var o=e.outfiles[pxt.outputName()];n=u.genFileName(r),pxt.debug("saving "+n),t=pxt.BrowserUtils.browserDownloadBinText(o,n,pxt.appTarget.compile.hexMimeType,e.userContextWindow,function(e){return l.errorNotification(lf("saving file failed..."))})}else{var i=e.outfiles[pxt.outputName()];n=u.genFileName(r),pxt.debug("saving "+n),t=pxt.BrowserUtils.browserDownloadBase64(i,n,"application/x-uf2",e.userContextWindow,function(e){return l.errorNotification(lf("saving file failed..."))})}return e.success?e.saveOnly||pxt.BrowserUtils.isBrowserDownloadInSameWindow()?Promise.resolve():pxt.commands.showUploadInstructionsAsync(n,t,l.confirmAsync):l.confirmAsync({header:lf("Compilation failed"),body:lf("Ooops, looks like there are errors in your program."),hideAgree:!0,disagreeLbl:lf("Close")}).then(function(){})}function i(e,t,n){var r=pxt.appTarget.appTheme.boardName||"???",o=pxt.appTarget.appTheme.driveDisplayName||pxt.appTarget.compile.driveName||"???",i=!pxt.BrowserUtils.isIE()&&!pxt.BrowserUtils.isEdge(),a=pxt.appTarget.appTheme.usbDocs,s=pxt.BrowserUtils.hasSaveAs(),c=pxt.appTarget.compile.useUF2,l=s?lf("Click 'Save As' and save the {0} file to the {1} drive to transfer the code into your {2}.",c?".uf2":".hex",o,r):lf("Move the {0} file to the {1} drive to transfer the code into your {2}.",pxt.appTarget.compile.useUF2?".uf2":".hex",o,r);return c&&(l=lf("Press the `reset` button once on the {0}.",r)+" "+l),n({header:lf("Download completed..."),body:l,hideCancel:!0,hideAgree:!0,buttons:[i?{label:e,icon:"download",class:"lightgrey focused",url:t,fileName:e}:void 0,a?{label:lf("Help"),icon:"help",class:"lightgrey focused",url:a}:void 0],timeout:1e4}).then(function(){})}function a(e){pxt.debug("webusb deployment..."),l.infoNotification(lf("Flashing device..."));var t=e.outfiles[pxtc.BINARY_UF2],n=pxtc.UF2.parseFile(Util.stringToUint8Array(atob(t)));return pxt.usb.initAsync().then(function(e){return e.reflashAsync(n)})}function s(e){pxt.debug("HID deployment..."),l.infoNotification(lf("Flashing device..."));var t=e.outfiles[pxtc.BINARY_UF2],n=pxtc.UF2.parseFile(Util.stringToUint8Array(atob(t)));return p.initAsync().then(function(e){return e.reflashAsync(n)})}function c(e){pxt.debug("local deployment..."),l.infoNotification(lf("Uploading .hex file..."));return Util.requestAsync({url:"/api/deploy",headers:{Authorization:d.localToken},method:"POST",data:e,allowHttpErrors:!0}).then(function(e){200!==e.statusCode?l.errorNotification(lf("There was a problem, please try again")):0===e.json.boardCount&&l.warningNotification(lf("Please connect your {0} to your computer and try again",pxt.appTarget.appTheme.boardName))})}var l=e("./core"),u=e("./package"),p=e("./hidbridge"),d=pxt.Cloud;n.browserDownloadDeployCoreAsync=o,n.initCommandsAsync=function(){pxt.commands.browserDownloadAsync=r,pxt.commands.saveOnlyAsync=o,pxt.commands.showUploadInstructionsAsync=i;var e=/forceHexDownload/i.test(window.location.href);return/webusb=1/i.test(window.location.href)&&pxt.appTarget.compile.useUF2?pxt.commands.deployCoreAsync=a:pxt.winrt.isWinRT()?(pxt.appTarget.serial&&pxt.appTarget.serial.useHF2?(pxt.HF2.mkPacketIOAsync=pxt.winrt.mkPacketIOAsync,pxt.commands.deployCoreAsync=s):(pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(pxt.HF2.mkPacketIOAsync=pxt.winrt.mkPacketIOAsync),pxt.commands.deployCoreAsync=pxt.winrt.driveDeployCoreAsync),pxt.commands.browserDownloadAsync=pxt.winrt.browserDownloadAsync,pxt.commands.saveOnlyAsync=function(e){return pxt.winrt.saveOnlyAsync(e).then(function(e){e&&l.infoNotification(lf("file saved!"))}).catch(function(){return l.errorNotification(lf("saving file failed..."))})}):!p.shouldUse()||pxt.appTarget.serial.noDeploy||e?d.isLocalHost()&&d.localToken&&!e?pxt.commands.deployCoreAsync=c:pxt.commands.deployCoreAsync=o:pxt.commands.deployCoreAsync=s,Promise.resolve()}},{"./core":13,"./hidbridge":24,"./package":32}],10:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./sui"),a=e("./blockspreview"),s=(pxt.Util.lf,pxt.Util.repeatMap),c=function(e){function t(t){e.call(this,t),this.state={}}return r(t,e),t.prototype.componentDidUpdate=function(){$(".ui.embed").embed()},t.prototype.render=function(){var e=this,t=this.props,n=t.color||"";n||(t.hardware&&!t.software?n="black":t.software&&!t.hardware&&(n="teal"));var r=t.url?/^[^:]+:\/\//.test(t.url)?t.url:"/"+t.url.replace(/^\.?\/?/,""):void 0,c=r&&/^\//.test(r)?"#doc:"+r:r,l=t.className,u=t.cardType,p=t.imageUrl||(t.youTubeId?"https://img.youtube.com/vi/"+t.youTubeId+"/maxresdefault.jpg":void 0),d=o.createElement("div",{ref:function(t){return e.element=t},className:"ui card "+n+" "+(t.onClick?"link":"")+" "+(l||""),role:t.role,"aria-selected":"option"===t.role?"true":void 0,"aria-label":t.ariaLabel||t.title,title:t.title,onClick:function(e){return t.onClick?t.onClick(e):void 0},tabIndex:t.onClick?t.tabIndex||0:null,onKeyDown:t.onClick?i.fireClickOnEnter:null},t.header||t.blocks||t.javascript||t.hardware||t.software||t.any?o.createElement("div",{key:"header",className:"ui content "+(t.responsive?" tall desktop only":"")},o.createElement("div",{className:"right floated meta"},t.any?o.createElement(i.Icon,{key:"costany",icon:"ui grey circular label tiny"},t.any>0?t.any:null," "):null,s(t.blocks,function(e){return o.createElement(i.Icon,{key:"costblocks"+e,icon:"puzzle orange"})}),s(t.javascript,function(e){return o.createElement(i.Icon,{key:"costjs"+e,icon:"align left blue"})}),s(t.hardware,function(e){return o.createElement(i.Icon,{key:"costhardware"+e,icon:"certificate black"})}),s(t.software,function(e){return o.createElement(i.Icon,{key:"costsoftware"+e,icon:"square teal"})})),t.header):null,t.label||t.blocksXml||t.typeScript||p||"file"==u?o.createElement("div",{className:"ui image"},t.label?o.createElement("label",{className:"ui "+(t.labelClass?t.labelClass:"orange right ribbon")+" label"},t.label):void 0,t.blocksXml?o.createElement(a.BlocksPreview,{key:"promoblocks",xml:t.blocksXml}):void 0,t.typeScript?o.createElement("pre",{key:"promots"},t.typeScript):void 0,p?o.createElement("div",{className:"ui imagewrapper"},o.createElement("div",{className:"ui cardimage",style:{backgroundImage:'url("'+p+'")'}})," "):void 0,"file"==t.cardType?o.createElement("div",{className:"ui fileimage"}):void 0):void 0,t.icon||t.iconContent?o.createElement("div",{className:"ui imagewrapper"},o.createElement("div",{className:"ui button massive fluid "+t.iconColor+" "+(t.iconContent?"iconcontent":"")},t.icon?o.createElement(i.Icon,{icon:"icon "+t.icon}):void 0,t.iconContent||void 0)):void 0,t.shortName||t.name||t.description?o.createElement("div",{className:"content"},t.shortName||t.name?o.createElement("div",{className:"header"},t.shortName||t.name):null,t.description?o.createElement("div",{className:"description tall"},function(e){return e.replace(/`/g,"")}(t.description)):null):void 0,t.time?o.createElement("div",{className:"meta"},t.time?o.createElement("span",{key:"date",className:"date"},pxt.Util.timeSince(t.time)):null):void 0,t.extracontent?o.createElement("div",{className:"extra content"}," ",t.extracontent," "):void 0);return!t.onClick&&r?o.createElement("div",null,o.createElement("a",{href:r,target:"docs",className:"ui widedesktop hide"},d),o.createElement("a",{href:c,className:"ui widedesktop only"},d)):d},t}(o.Component);n.CodeCardView=c},{"./blockspreview":6,"./sui":44,react:277}],11:[function(e,t,n){"use strict";function r(e){var t=f.mainEditorPkg();t.forEachFile(function(e){return e.diagnostics=[]});for(var n="",r=0,o=e;r<o.length;r++)!function(e){if(e.fileName){n+=(e.category==ts.pxtc.DiagnosticCategory.Error?lf("error"):e.category==ts.pxtc.DiagnosticCategory.Warning?lf("warning"):lf("message"))+": "+e.fileName+"("+(e.line+1)+","+(e.column+1)+"): ";var r=t.filterFiles(function(t){return t.getTypeScriptName()==e.fileName})[0];r&&r.diagnostics.push(e)}var o=ts.pxtc.DiagnosticCategory[e.category].toLowerCase();n+=o+" TS"+e.code+": "+ts.pxtc.flattenDiagnosticMessageText(e.messageText,"\n")+"\n"}(o[r]);n||(n=m.lf("Everything seems fine!\n")),t.outputPkg.setFile("output.txt",n).numDiagnosticsOverride=e.filter(function(e){return e.category==ts.pxtc.DiagnosticCategory.Error}).length}function o(e){return function(t){return t.isUserError?(h.errorNotification(t.message),f.mainEditorPkg().outputPkg.setFile("output.txt",t.message).numDiagnosticsOverride=1,e):Promise.reject(t)}}function i(e){return c("assemble",{fileContent:e})}function a(e){return c("compile",{options:e})}function s(e,t){return c("decompile",{options:e,fileName:t})}function c(e,t){return pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t)}function l(){return v||p()}function u(){return _||!y?c("apiInfo",{}).then(function(e){return _=!1,ts.pxtc.localizeApisAsync(e,f.mainPkg)}).then(function(e){y=e}):Promise.resolve()}function p(){var e=f.mainPkg.getCompileOptionsAsync().then(function(e){return e.testMode=!0,c("setOptions",{options:e})}).then(function(){return c("allDiags",{})}).then(r).then(u).catch(o(null));return v||(v=e),e}function d(){return l().then(function(){return y})}var f=e("./package"),h=e("./core"),m=pxt.Util,g=new Promise(function(){});n.compileAsync=function(e){void 0===e&&(e={});var t=f.mainPkg.getTargetOptions();return t.isNative=e.native,t.preferredEditor=e.preferredEditor,f.mainPkg.getCompileOptionsAsync(t).then(function(t){return e.debug&&(t.breakpoints=!0,t.justMyCode=!0),e.trace&&(t.breakpoints=!0,t.justMyCode=!0,t.trace=!0),t.computeUsedSymbols=!0,e.forceEmit&&(t.forceEmit=!0),/test=1/i.test(window.location.href)&&(t.testMode=!0),t}).then(a).then(function(e){var t=f.mainEditorPkg().outputPkg.files[pxtc.BINARY_ASM];return t&&!e.outfiles[pxtc.BINARY_ASM]&&(e.outfiles[pxtc.BINARY_ASM]=t.content),f.mainEditorPkg().outputPkg.setFiles(e.outfiles),r(e.diagnostics),u().then(function(){if(!e.usedSymbols)return e;for(var t=0,n=Object.keys(e.usedSymbols);t<n.length;t++){var r=n[t];e.usedSymbols[r]=m.lookup(y.byQName,r)}return e})}).catch(o(g))},n.assembleAsync=function(e){return i(".startaddr 536887040\n"+e).then(function(t){return i(".startaddr "+(536887296-4*(t.words.length+1))+"\n"+e).then(function(e){return m.assert(e.words.length==t.words.length),e})})},n.decompileAsync=function(e,t,n,o){var i=f.mainPkg.getTargetOptions();return f.mainPkg.getCompileOptionsAsync(i).then(function(t){return t.ast=!0,t.testMode=!0,t.alwaysDecompileOnStart=pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable,s(t,e)}).then(function(e){if(e.success&&t&&n&&o){var i=pxt.blocks.layout.patchBlocksFromOldWorkspace(t,n,e.outfiles[o]);e.outfiles[o]=i}return f.mainEditorPkg().outputPkg.setFiles(e.outfiles),r(e.diagnostics),e})},n.decompileSnippetAsync=function(e,t){var n=f.mainPkg.getTargetOptions();return f.mainPkg.getCompileOptionsAsync(n).then(function(t){return t.fileSystem["___snippet.ts"]=e,t.fileSystem["___snippet.blocks"]="",t.sourceFiles.push("___snippet.ts"),t.sourceFiles.push("___snippet.blocks"),t.ast=!0,s(t,"___snippet.ts")}).then(function(e){return e.outfiles["___snippet.blocks"]})},n.workerOpAsync=c;var v,y,b,_=!1;n.apiSearchAsync=function(e){return u().then(function(){return e.localizedApis=y,e.localizedStrings=Util.getLocalizedStrings(),c("apiSearch",{search:e})})},n.formatAsync=function(e,t){return c("format",{format:{input:e,pos:t}})},n.typecheckAsync=p,n.getApisInfoAsync=d,n.getBlocksAsync=function(){return b?Promise.resolve(b):d().then(function(e){return b=pxtc.getBlocksInfo(e)})},n.newProject=function(){v=null,y=null,b=null,c("reset",{}).done()}},{"./core":13,"./package":32}],12:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=e("./electron"),c=e("./tutorial"),l=e("./container"),u=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.openTutorial=function(e){pxt.tickEvent("docstutorial",{path:e}),this.props.parent.startTutorial(e)},t.prototype.openDocs=function(e){pxt.tickEvent("docs",{path:e}),this.props.parent.setSideDoc(e)},t.prototype.shouldComponentUpdate=function(e,t,n){return!1},t.prototype.render=function(){var e=this,t=pxt.appTarget.appTheme;return o.createElement(a.DropdownMenuItem,{icon:"help circle large",class:"help-dropdown-menuitem",textClass:"landscape only",title:lf("Help")},t.docMenu.map(function(t){return t.tutorial?o.createElement(a.Item,{key:"docsmenututorial"+t.path,role:"menuitem",ariaLabel:t.name,text:Util.rlf(t.name),class:"",onClick:function(){return e.openTutorial(t.path)}}):/^\//.test(t.path)?o.createElement(a.Item,{key:"docsmenu"+t.path,role:"menuitem",ariaLabel:t.name,text:Util.rlf(t.name),class:"",onClick:function(){return e.openDocs(t.path)}}):o.createElement("a",{key:"docsmenulink"+t.path,role:"menuitem","aria-label":t.name,className:"ui item link",href:t.path,target:"docs"},Util.rlf(t.name))}))},t}(i.Component);n.DocsMenuItem=u;var p=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.openSettings=function(){pxt.tickEvent("menu.settings"),this.props.parent.openSettings()},t.prototype.addPackage=function(){pxt.tickEvent("menu.addpackage"),this.props.parent.addPackage()},t.prototype.removeProject=function(){pxt.tickEvent("menu.removeproject"),this.props.parent.removeProject()},t.prototype.showReportAbuse=function(){pxt.tickEvent("menu.reportabuse"),this.props.parent.showReportAbuse()},t.prototype.selectLang=function(){pxt.tickEvent("menu.langpicker"),this.props.parent.selectLang()},t.prototype.toggleHighContrast=function(){pxt.tickEvent("menu.togglecontrast"),this.props.parent.toggleHighContrast()},t.prototype.reset=function(){pxt.tickEvent("menu.reset"),pxt.tickEvent("reset"),this.props.parent.reset()},t.prototype.about=function(){pxt.tickEvent("menu.about"),this.props.parent.about()},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.highContrast&&(t.highContrast=e.highContrast),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.highContrast!=t.highContrast},t.prototype.render=function(){var e=this,t=this.state.highContrast,n=pxt.appTarget.appTheme,r=pxt.appTarget.cloud&&pxt.appTarget.cloud.packages,i=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.publishing&&pxt.appTarget.cloud.importing;return o.createElement(a.DropdownMenuItem,{icon:"setting large",title:lf("More..."),class:"more-dropdown-menuitem"},o.createElement(a.Item,{role:"menuitem",icon:"options",text:lf("Project Settings"),onClick:function(){return e.openSettings()},tabIndex:-1}),r?o.createElement(a.Item,{role:"menuitem",icon:"disk outline",text:lf("Extensions"),onClick:function(){return e.addPackage()},tabIndex:-1}):void 0,o.createElement(a.Item,{role:"menuitem",icon:"trash",text:lf("Delete Project"),onClick:function(){return e.removeProject()},tabIndex:-1}),i?o.createElement(a.Item,{role:"menuitem",icon:"warning circle",text:lf("Report Abuse..."),onClick:function(){return e.showReportAbuse()},tabIndex:-1}):void 0,o.createElement("div",{className:"ui divider"}),n.selectLanguage?o.createElement(a.Item,{icon:"xicon globe",role:"menuitem",text:lf("Language"),onClick:function(){return e.selectLang()},tabIndex:-1}):void 0,n.highContrast?o.createElement(a.Item,{role:"menuitem",text:t?lf("High Contrast Off"):lf("High Contrast On"),onClick:function(){return e.toggleHighContrast()},tabIndex:-1}):void 0,o.createElement(a.Item,{role:"menuitem",icon:"sign out",text:lf("Reset"),onClick:function(){return e.reset()},tabIndex:-1}),o.createElement("div",{className:"ui divider"}),n.privacyUrl?o.createElement("a",{className:"ui item",href:n.privacyUrl,role:"menuitem",title:lf("Privacy & Cookies"),target:"_blank",tabIndex:-1},lf("Privacy & Cookies")):void 0,n.termsOfUseUrl?o.createElement("a",{className:"ui item",href:n.termsOfUseUrl,role:"menuitem",title:lf("Terms Of Use"),target:"_blank",tabIndex:-1},lf("Terms Of Use")):void 0,o.createElement(a.Item,{role:"menuitem",text:lf("About..."),onClick:function(){return e.about()},tabIndex:-1}),s.isPxtElectron?o.createElement(a.Item,{role:"menuitem",text:lf("Check for updates..."),onClick:function(){return s.checkForUpdate()},tabIndex:-1}):void 0,n.feedbackUrl?o.createElement("div",{className:"ui divider"}):void 0,n.feedbackUrl?o.createElement("a",{className:"ui item",href:n.feedbackUrl,role:"menuitem",title:lf("Give Feedback"),target:"_blank",rel:"noopener",tabIndex:-1},lf("Give Feedback")):void 0)},t}(i.Component);n.SettingsMenuItem=p;var d=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.brandIconClick=function(){pxt.tickEvent("menu.brand"),this.props.parent.exitAndSave()},t.prototype.orgIconClick=function(){pxt.tickEvent("menu.org")},t.prototype.goHome=function(){pxt.tickEvent("menu.home"),this.props.parent.exitAndSave()},t.prototype.share=function(){pxt.tickEvent("menu.share"),this.props.parent.share()},t.prototype.launchFullEditor=function(){pxt.tickEvent("sandbox.openfulleditor"),this.props.parent.launchFullEditor()},t.prototype.openSimView=function(){pxt.tickEvent("menu.simView"),this.props.parent.openSimView()},t.prototype.openBlocks=function(){pxt.tickEvent("menu.blocks"),this.props.parent.openBlocks()},t.prototype.openJavaScript=function(e){void 0===e&&(e=!0),pxt.tickEvent("menu.javascript"),this.props.parent.openJavaScript(e)},t.prototype.exitTutorial=function(){pxt.tickEvent("menu.exitTutorial"),this.props.parent.exitTutorial()},t.prototype.render=function(){var e=this,t=this.props.parent.state,n=t.home,r=t.header,i=t.highContrast;if(n)return o.createElement("div",null);var s=pxt.appTarget.appTheme,u=pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing,p=pxt.shell.isSandboxMode(),d=this.props.parent.state.tutorialOptions,f=!!d&&!!d.tutorial,h=s.docMenu&&s.docMenu.length&&!p&&!f,m=this.props.parent.state.running,g=p?s.portraitLogo:s.rightLogo,v=this.props.parent.isEmbedSimActive(),y=this.props.parent.isBlocksActive(),b=this.props.parent.isJavaScriptActive(),_=m?lf("Stop the simulator"):lf("Start the simulator");return o.createElement("div",{id:"mainmenu",className:"ui borderless fixed "+(s.invertedMenu?"inverted":"")+" menu",role:"menubar","aria-label":lf("Main menu")},p?o.createElement("div",{className:"left menu"},o.createElement("span",{id:"logo",className:"ui item logo"},o.createElement("img",{className:"ui mini image",src:Util.toDataUri(g),tabIndex:0,onClick:function(){return e.launchFullEditor()},onKeyDown:a.fireClickOnEnter,alt:s.boardName+" Logo"}))):o.createElement("div",{className:"left menu"},o.createElement("a",{"aria-label":lf("{0} Logo",s.boardName),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo brand",tabIndex:0,onClick:function(){return e.brandIconClick()},onKeyDown:a.fireClickOnEnter},s.logo||s.portraitLogo?o.createElement("img",{className:"ui logo "+(s.logo?" portrait hide":""),src:Util.toDataUri(s.logo||s.portraitLogo),alt:lf("{0} Logo",s.boardName)}):o.createElement("span",{className:"name"},s.boardName),s.portraitLogo?o.createElement("img",{className:"ui mini image portrait only",src:Util.toDataUri(s.portraitLogo),alt:lf("{0} Logo",s.boardName)}):null),s.betaUrl?o.createElement("a",{href:""+s.betaUrl,className:"ui red mini corner top left attached label betalabel",role:"menuitem"},lf("Beta")):void 0,f?null:o.createElement(a.Item,{class:"icon openproject",role:"menuitem",textClass:"landscape only",icon:"home large",ariaLabel:lf("Home screen"),text:lf("Home"),onClick:function(){return e.goHome()}}),!f&&r&&u?o.createElement(a.Item,{class:"icon shareproject",role:"menuitem",textClass:"widedesktop only",ariaLabel:lf("Share Project"),text:lf("Share"),icon:"share alternate large",onClick:function(){return e.share()}}):null,f?o.createElement(a.Item,{class:"tutorialname",tabIndex:-1,textClass:"landscape only",text:d.tutorialName}):null),f||s.blocksOnly?void 0:o.createElement("div",{className:"ui item link editor-menuitem"},o.createElement("div",{className:"ui grid padded"},p?o.createElement(a.Item,{class:"sim-menuitem thin portrait only",role:"menuitem",textClass:"landscape only",text:lf("Simulator"),icon:v&&m?"stop":"play",active:v,onClick:function(){return e.openSimView()},title:v?_:lf("Show Simulator")}):void 0,o.createElement(a.Item,{class:"blocks-menuitem",role:"menuitem",textClass:"landscape only",text:lf("Blocks"),icon:"xicon blocks",active:y,onClick:function(){return e.openBlocks()},title:lf("Convert code to Blocks")}),o.createElement(a.Item,{class:"javascript-menuitem",role:"menuitem",textClass:"landscape only",text:lf("JavaScript"),icon:"xicon js",active:b,onClick:function(){return e.openJavaScript(!1)},title:lf("Convert code to JavaScript")}),o.createElement("div",{className:"ui item toggle"}))),f?o.createElement(c.TutorialMenuItem,{parent:this.props.parent}):void 0,o.createElement("div",{className:"right menu"},h?o.createElement(l.DocsMenuItem,{parent:this.props.parent}):void 0,p||f?void 0:o.createElement(l.SettingsMenuItem,{parent:this.props.parent,highContrast:i}),p&&!s.hideEmbedEdit?o.createElement(a.Item,{role:"menuitem",icon:"external",textClass:"mobile hide",text:lf("Edit"),onClick:function(){return e.launchFullEditor()}}):void 0,f?o.createElement(a.ButtonMenuItem,{class:"exit-tutorial-btn",role:"menuitem",icon:"external",text:lf("Exit tutorial"),textClass:"landscape only",onClick:function(){return e.exitTutorial()}}):void 0,p?void 0:o.createElement("a",{href:s.organizationUrl,"aria-label":lf("{0} Logo",s.organization),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo organization",onClick:function(){return e.orgIconClick()}},s.organizationWideLogo||s.organizationLogo?o.createElement("img",{className:"ui logo "+(s.organizationWideLogo?" portrait hide":""),src:Util.toDataUri(s.organizationWideLogo||s.organizationLogo),alt:lf("{0} Logo",s.organization)}):o.createElement("span",{className:"name"},s.organization),s.organizationLogo?o.createElement("img",{className:"ui mini image portrait only",src:Util.toDataUri(s.organizationLogo),alt:lf("{0} Logo",s.organization)}):null)))},t}(i.Component);n.MainMenu=d;var f=function(e){function t(){e.apply(this,arguments),this.firstLoad=!0,this.openingSideDoc=!1}return r(t,e),t.notify=function(e){var t=document.getElementById("sidedocsframe");t&&t.contentWindow&&t.contentWindow.postMessage(e,"*")},t.prototype.setPath=function(e,t){this.openingSideDoc=!0;var n=(pxt.webConfig.docsUrl||"/--docs")+"#doc:"+e+":"+(t?"blocks":"js")+":"+pxt.Util.localeInfo();this.setUrl(n)},t.prototype.setMarkdown=function(e){var t=pxt.webConfig.docsUrl||"/--docs",n=this.props.parent.isBlocksEditor()?"blocks":"js",r=t+"#md:"+encodeURIComponent(e)+":"+n+":"+pxt.Util.localeInfo();this.setUrl(r)},t.prototype.setUrl=function(e){var t=document.getElementById("sidedocsframe");t?t.src=e:this.props.parent.setState({sideDocsLoadUrl:e});var n=this.firstLoad&&(pxt.BrowserUtils.isMobile()||pxt.options.light);this.props.parent.setState({sideDocsCollapsed:n}),this.firstLoad=!1},t.prototype.collapse=function(){this.props.parent.setState({sideDocsCollapsed:!0})},t.prototype.popOut=function(){t.notify({type:"popout"})},t.prototype.toggleVisibility=function(){var e=this.props.parent.state;this.props.parent.setState({sideDocsCollapsed:!e.sideDocsCollapsed}),document.getElementById("sidedocstoggle").focus()},t.prototype.componentDidUpdate=function(){this.props.parent.editor.resize();var e=document.getElementById("sidedocstoggle");this.openingSideDoc&&e&&(e.focus(),this.openingSideDoc=!1)},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.sideDocsCollapsed&&(t.sideDocsCollapsed=e.sideDocsCollapsed),void 0!=e.docsUrl&&(t.docsUrl=e.docsUrl),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.sideDocsCollapsed!=t.sideDocsCollapsed||this.state.docsUrl!=t.docsUrl},t.prototype.renderCore=function(){var e=this,t=this.state,n=t.sideDocsCollapsed,r=t.docsUrl;return r?o.createElement("div",null,o.createElement("button",{id:"sidedocstoggle",role:"button","aria-label":n?lf("Expand the side documentation"):lf("Collapse the side documentation"),className:"ui icon button",onClick:function(){return e.toggleVisibility()}},o.createElement(a.Icon,{icon:"icon large inverted "+(n?"book":"chevron right")}),n?o.createElement(a.Icon,{icon:"large inverted chevron left hover"}):void 0),o.createElement("div",{id:"sidedocs"},o.createElement("div",{id:"sidedocsframe-wrapper"},o.createElement("iframe",{id:"sidedocsframe",src:r,title:lf("Documentation"),"aria-atomic":"true","aria-live":"assertive",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups"})),o.createElement("div",{id:"sidedocsbar"},o.createElement("a",{className:"ui icon link",role:"link",tabIndex:0,"data-content":lf("Open documentation in new tab"),"aria-label":lf("Open documentation in new tab"),onClick:function(){return e.popOut()},onKeyDown:a.fireClickOnEnter},o.createElement(a.Icon,{icon:"external"}))))):null},t}(i.Component);n.SideDocs=f;var h=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.compile=function(){pxt.tickEvent("sandboxfooter.compile"),this.props.parent.compile()},t.prototype.shouldComponentUpdate=function(e,t,n){return!1},t.prototype.renderCore=function(){var e=this,t=pxt.appTarget.appTheme,n=lf("Download your code to the {0}",t.boardName);return o.createElement("div",{className:"ui horizontal small divided link list sandboxfooter"},t.organizationUrl&&t.organization?o.createElement("a",{className:"item",target:"_blank",rel:"noopener",href:t.organizationUrl},t.organization):void 0,o.createElement("a",{target:"_blank",className:"item",href:t.termsOfUseUrl,rel:"noopener"},lf("Terms of Use")),o.createElement("a",{target:"_blank",className:"item",href:t.privacyUrl,rel:"noopener"},lf("Privacy")),o.createElement("span",{className:"item"},o.createElement("a",{className:"ui thin portrait only",title:n,onClick:function(){return e.compile()}},o.createElement(a.Icon,{icon:"icon "+(pxt.appTarget.appTheme.downloadIcon||"download")}),pxt.appTarget.appTheme.useUploadMessage?lf("Upload"):lf("Download"))))},t}(i.Component);n.SandboxFooter=h;var m=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.cookieConsented&&(t.cookieConsented=e.cookieConsented),Object.keys(t).length>0&&this.setState(t)},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.cookieConsented!=t.cookieConsented},t.prototype.renderCore=function(){var e=this,t=this.props,n=(t.cookieConsented,t.cookieKey);pxt.appTarget.appTheme,pxt.shell.isSandboxMode(),s.isElectron||pxt.winrt.isWinRT();return o.createElement("div",{id:"cookiemsg",className:"ui teal inverted black segment",role:"alert"},o.createElement("button",{"aria-label":lf("Close"),tabIndex:0,className:"ui right floated icon button clear inverted",onClick:function(){pxt.storage.setLocal(n,"1"),e.props.parent.forceUpdate()}},o.createElement(a.Icon,{icon:"remove"})),lf("By using this site you agree to the use of cookies for analytics.")+" ",o.createElement("a",{target:"_blank",className:"ui link",href:pxt.appTarget.appTheme.privacyUrl,rel:"noopener"},lf("Learn more")))},t}(i.Component);n.CookieMessage=m},{"./container":12,"./data":14,"./electron":18,"./sui":44,"./tutorial":47,react:277}],13:[function(e,t,n){"use strict";function r(e){if(pxt.debug("hideloading: "+e),void 0!=k[e]){var t=w.indexOf(e);t>-1&&w.splice(t,1),delete k[e]}else pxt.debug("Loading not in queue, disregard: "+e);w.length>0?i():($(".ui.dimmer.loading .loadingcontent").remove(),$(".ui.dimmer.loading").dimmer("hide"),E||a(),setTimeout(function(){$(".ui.dimmer.loading").dimmer("hide")},200))}function o(e,t){pxt.debug("showloading: "+e),a(),$(".ui.dimmer.loading").dimmer("show"),$(".ui.dimmer.loading").html('\n  <div class="content loadingcontent">\n    <div class="ui text large loader msg" aria-live="assertive">'+_("Please wait")+"</div>\n  </div>\n"),w.push(e),k[e]=t,i()}function i(){if(w.length){var e=w[w.length-1],t=k[e];$(".ui.dimmer.loading .msg").text(t)}}function a(){$("#content").dimmer({dimmerName:"loading"}).dimmer({closable:!1}),E=!0}function s(e){clearTimeout(x[e]),r(e)}function c(e,t){var r=Date.now(),o=C[e]||0,i=$("#msg");n.highContrast?i.children().each(function(e,t){t.classList.contains("hc")||t.classList.add("hc")}):i.children().each(function(e,t){t.classList.contains("hc")&&t.classList.remove("hc")}),r-o<100?$("#"+e+"msg").text(t):(C[e]=r,$("#"+e+"msg").finish().text(t).fadeIn("fast").delay(3e3).fadeOut("slow"))}function l(e){pxt.log("warning: "+e),c("warn",e)}function u(e){var t=e.buttons?e.buttons.filter(function(e){return!!e}):[],n=(e.logos||[]).filter(function(e){return!!e}).map(function(e){return'<img class="ui logo" src="'+b.toDataUri(e)+'" />'}).join(" "),r='\n  <div role="dialog" class="ui '+(e.size||"small")+' modal">\n    '+(e.hasCloseIcon?'<i class="close icon"></i>':"")+'\n    <div role="heading" class="header">\n        '+b.htmlEscape(e.header)+'\n    </div>\n    <div class="content">\n      '+(e.body?"<p>"+b.htmlEscape(e.body)+"</p>":"")+"\n      "+(e.htmlBody||"")+"\n      "+(e.input?'<div class="ui fluid action input">\n         <input class="userinput focused" spellcheck="false" placeholder="'+b.htmlEscape(e.input)+'" type="text">\n         </div>':"")+"\n      "+(e.copyable?'<div class="ui fluid action input">\n         <input class="linkinput focused" readonly spellcheck="false" type="text" value="'+b.htmlEscape(e.copyable)+'">\n         <button class="ui teal right labeled icon button copybtn" data-content="'+_("Copied!")+'">\n            '+_("Copy")+'\n            <i class="copy icon"></i>\n         </button>\n      </div>':"")+"\n    </div>";r+='<div class="actions">',r+=n,e.hideCancel||t.push({label:e.disagreeLbl||_("Cancel"),class:e.disagreeClass||"cancel",icon:e.disagreeIcon||"cancel"});for(var o=0,i=0,a=t;i<a.length;i++){var s=a[i];r+="\n      <"+(s.url?"a":"button")+' class="ui right labeled icon button approve '+(s.class||"positive")+' focused" data-btnid="'+o+++'" '+(s.url?'href="'+s.url+'"':"")+" "+(s.fileName?'download="'+b.htmlEscape(s.fileName)+'"':"")+' target="_blank">\n        '+b.htmlEscape(s.label)+'\n        <i class="'+(s.icon||"checkmark")+' icon"></i>\n      </'+(s.url?"a":"button")+">"}r+="</div>",r+="</div>";var c=$(r);if(e.copyable&&d(c),e.input){var l=c.find(".userinput");l.on("change",function(t){return e.inputValue=l.val()})}var u=!1,p=e.modalContext||"#root";return $(p).append(c),e.onLoaded&&e.onLoaded(c),c.find("img").on("load",function(){c.modal("refresh")}),c.find(".ui.accordion").accordion(),new Promise(function(n,r){var o,i=document.activeElement,a=e.timeout?setTimeout(function(){a=0,o.modal("hide")},e.timeout):0,s=function(e){if(!u){u=!0,a&&clearTimeout(a);var r=e.attr("data-btnid");if(r){var o=t[+r];if(o.onclick)return n(o.onclick())}return n()}};(o=c.modal({observeChanges:!0,closeable:!e.hideCancel,context:p,onHidden:function(){c.remove(),o.remove(),null!=i&&i.focus()},onApprove:s,onDeny:s,onHide:function(){u||(u=!0,a&&clearTimeout(a),n())},onVisible:function(){g(o.get(0),!0)}})).modal("show")})}function p(e){e.buttons||(e.buttons=[]);var t=0;return e.hideAgree||e.buttons.push({label:e.agreeLbl||_("Go ahead!"),class:e.agreeClass,icon:e.agreeIcon,onclick:function(){t=1}}),e.deleteLbl&&e.buttons.push({label:e.deleteLbl,class:"delete red",icon:"trash",onclick:function(){t=2}}),u(e).then(function(){return t})}function d(e){var t=e.find(".copybtn");t.click(function(){try{var n=e.find(".linkinput")[0];n.focus(),n.setSelectionRange(0,n.value.length),document.execCommand("copy"),t.popup({on:"manual",inline:!0}),t.popup("show")}catch(e){}})}function f(e){e&&(e.firstTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToLastTagBinding),e.lastTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToFirstTagBinding),e.firstTag===e.lastTag&&(e.firstTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToFirstTagBinding),e.lastTag.removeEventListener("keydown",e.targetArea.focusDataInfo.giveFocusToLastTagBinding)))}function h(e){("number"==typeof e.which?e.which:e.keyCode)!==n.TAB_KEY||e.shiftKey?e.currentTarget.classList.contains("focused")||(f(this),g(this.targetArea,!0,!1)):(e.preventDefault(),f(this),g(this.targetArea,!0))}function m(e){("number"==typeof e.which?e.which:e.keyCode)===n.TAB_KEY&&e.shiftKey?(e.preventDefault(),f(this),g(this.targetArea,!0,!1),this.lastTag.focus()):e.currentTarget.classList.contains("focused")||(f(this),g(this.targetArea,!0,!1))}function g(e,t,n,r){if(void 0===t&&(t=!1),void 0===n&&(n=!0),void 0===r&&(r=!1),(t||e===document.activeElement||!e.contains(document.activeElement))&&(f(e.focusDataInfo),!r)){var o=e.getElementsByClassName("focused");if(0!=o.length){var i=o[0],a=o.length>1?o[o.length-1]:i,s={};s.firstTag=i,s.lastTag=a,s.targetArea=e,s.giveFocusToLastTagBinding=m.bind(s),s.giveFocusToFirstTagBinding=h.bind(s),e.focusDataInfo=s,i!==a&&i.addEventListener("keydown",s.giveFocusToLastTagBinding),a.addEventListener("keydown",s.giveFocusToFirstTagBinding),n&&i.focus()}}}var v=e("react-dom"),y=pxt.Cloud,b=pxt.Util,_=b.lf,E=!1;n.TAB_KEY=9,n.ENTER_KEY=13,n.SPACE_KEY=32,n.isLoading=function(){return!!$(".ui.loading.dimmer .loadingcontent")[0]};var w=[],k={};n.hideLoading=r,n.showLoading=o;var x={};n.showLoadingAsync=function(e,t,n,r){return void 0===r&&(r=700),clearTimeout(x[e]),x[e]=setTimeout(function(){o(e,t)},r),n.finally(function(){s(e)})},n.cancelAsyncLoading=s,n.navigateInWindow=function(e){window.location.href=e},n.findChild=function(e,t){var n=$(v.findDOMNode(e));return t?n.find(t):n},n.parseQueryString=function(e){var t={};return e.replace(/\+/g," ").replace(/([^&=]+)=?([^&]*)/g,function(e,n,r){return t[decodeURIComponent(n)]=decodeURIComponent(r),""}),t};var C={};n.errorNotification=function(e){pxt.tickEvent("notification.error",{message:e}),c("err",e)},n.warningNotification=l,n.infoNotification=function(e){pxt.debug(e),c("info",e)},n.handleNetworkError=function(e,t){var n=parseInt(e.statusCode);if(e.isOffline||0===n)l(_("Network request failed; you appear to be offline"));else if(!isNaN(n)&&200!==n){if(t&&-1!==t.indexOf(n))return e;l(_("Network request failed"))}throw e},n.dialogAsync=u,n.hideDialog=function(){$(".modal").modal("hide")},n.confirmAsync=p,n.confirmDelete=function(e,t){p({header:_("Would you like to delete '{0}'?",e),body:_("It will be deleted for good. No undo."),agreeLbl:_("Delete"),agreeClass:"red",agreeIcon:"trash"}).then(function(e){e&&t().done()}).done()},n.promptAsync=function(e){e.buttons||(e.buttons=[]);var t="";return e.hideAgree||e.buttons.push({label:e.agreeLbl||_("Go ahead!"),class:e.agreeClass,icon:e.agreeIcon,onclick:function(){var e=document.getElementById("promptDialogInput");t=e.value}}),e.htmlBody='<div class="ui fluid icon input">\n                            <input class="focused" type="text" id="promptDialogInput" value="'+e.defaultValue+'">\n                        </div>',e.onLoaded=function(){var e=document.getElementById("promptDialogInput");e&&(e.setSelectionRange(0,9999),e.onkeyup=function(e){("number"==typeof e.which?e.which:e.keyCode)===n.ENTER_KEY&&(e.preventDefault(),document.getElementsByClassName("approve positive").item(0).click())})},u(e).then(function(){return t})},n.shareLinkAsync=function(e){var t='\n  <div class="ui small modal">\n    <div class="header">\n        '+b.htmlEscape(e.header)+'\n    </div>\n    <div class="content">\n      <p>'+b.htmlEscape(e.body||"")+'</p>\n      <div class="ui fluid action input">\n         <input class="linkinput" readonly spellcheck="false" type="text" value="'+b.htmlEscape(e.link)+'">\n         <button class="ui teal right labeled icon button copybtn" data-content="'+_("Copied!")+'">\n            '+_("Copy")+'\n            <i class="copy icon"></i>\n         </button>\n      </div>\n    </div>\n    <div class="actions">\n      <div class="ui approve right labeled icon button '+(e.okClass||"teal")+'">\n        '+b.htmlEscape(e.okLabel||_("Ok"))+'\n        <i class="'+(e.okIcon||"checkmark")+' icon"></i>\n      </div>\n    </div>\n  </div>\n  ',n=$(t);d(n);var r=!1;return $("body.main").append(n),new Promise(function(e,t){return n.modal({onHidden:function(){n.remove()},onHide:function(){r||(r=!0,e(!1))}}).modal("show")})},n.scrollIntoView=function(e,t){if(void 0===t&&(t=0),e.length){var n=e.offsetParent(),r=Math.max(e.position().top-t,0),o=e.position().top+e.outerHeight(!0)+t,i=$(n).scrollTop(),a=$(n).height(),s=i;r<i?s=r:o>i+a&&(s=o-a),s!=i&&n.scrollTop(s)}},n.resetFocus=function(){var e=document.getElementById("content");e.tabIndex=0,e.focus(),e.blur(),e.tabIndex=-1},n.initializeFocusTabIndex=g,n.apiAsync=function(e,t){return(t?y.privatePostAsync(e,t):y.privateGetAsync(e)).then(function(t){return console.log("*"),console.log("*******",e,"---\x3e"),console.log("*"),console.log(t),console.log("*"),t},function(e){console.log(e.message)})}},{"react-dom":148}],14:[function(e,t,n){"use strict";function r(e,t){var n=f(t),r=n.components;r.indexOf(e)<0&&(r.push(e),e.subscriptions.push(n))}function o(e){var t=e.subscriptions;0!=t.length&&(e.subscriptions=[],t.forEach(function(t){var n=t.components.indexOf(e);n>=0&&t.components.splice(n,1)}))}function i(e){return e.api.expirationTime?null==e.data||Date.now()-e.lastRefresh>e.api.expirationTime(e.path):null!=e.data}function a(e){return!(!e.data||e.data instanceof Error)&&/^cloud:(me\/settings|ptr-pkg-)/.test(e.path)}function s(){C={},c()}function c(){var e=k.values(C).filter(function(e){return a(e)}).map(function(e){return{path:e.path,data:e.data}});pxt.storage.setLocal("apiCache2",JSON.stringify(e))}function l(e,t){return e.path.slice(0,t.length)==t}function u(e){a(e)&&c();var t=e.callbackOnce;t.length>0&&(e.callbackOnce=[],k.nextTick(function(){return t.forEach(function(e){return e()})})),e.components.length>0&&k.nextTick(function(){return e.components.forEach(function(e){return e.forceUpdate()})})}function p(e){var t=/^([\w\-]+):/.exec(e);return t&&x[t[1]]||k.oops("bad data protocol: "+e),x[t[1]]}function d(e){if(!(e.queued||e.api.isOffline&&e.api.isOffline())){e.queued=!0;var t=function(t){e.data=t,e.lastRefresh=Date.now(),e.queued=!1,u(e)};e.api.isSync?t(e.api.getSync(e.path)):e.api.getAsync(e.path).done(t)}}function f(e){return C.hasOwnProperty(e)||(C[e]={path:e,data:null,lastRefresh:0,queued:!1,callbackOnce:[],components:[],api:p(e)}),C[e]}function h(e,t){r(e,t);var n=f(t);return n.api.isSync?n.api.getSync(n.path):((i(n)||n.data instanceof Error)&&d(n),n.data)}function m(e,t){k.assert(!x[e]),k.assert(!!t.getSync||!!t.getAsync),k.assert(!!t.getSync!=!!t.getAsync),t.isSync=!!t.getSync,x[e]=t}function g(e){var t=/^([\w\-]+):(.*)/.exec(e);return t?t[2]:(k.oops("protocol missing in: "+e),e)}function v(e){k.values(C).forEach(function(t){l(t,e)&&(t.lastRefresh=0,t.components.length>0&&d(f(t.path)))})}var y=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},b=e("react"),_=e("./core"),E=e("./gallery"),w=pxt.Cloud,k=pxt.Util,x={};m("cloud",{getAsync:function(e){return w.privateGetAsync(g(e)).catch(_.handleNetworkError)},expirationTime:function(e){return 6e4},isOffline:function(){return!w.isOnline()}}),m("cloud-search",{getAsync:function(e){return w.privateGetAsync(g(e)).catch(function(e){return _.handleNetworkError(e,[404])})},expirationTime:function(e){return 6e4},isOffline:function(){return!w.isOnline()}}),m("gallery",{getAsync:function(e){return E.loadGalleryAsync(g(decodeURIComponent(e))).catch(function(e){return Promise.resolve(e)})},expirationTime:function(e){return 36e5}}),m("td-cloud",{getAsync:function(e){return k.httpGetJsonAsync("https://www.touchdevelop.com/api/"+g(e)).catch(_.handleNetworkError)},expirationTime:function(e){return 6e4}}),m("gh-search",{getAsync:function(e){return pxt.targetConfigAsync().then(function(t){return pxt.github.searchAsync(g(e),t?t.packages:void 0)}).catch(_.handleNetworkError)},expirationTime:function(e){return 6e4},isOffline:function(){return!w.isOnline()}}),m("gh-pkgcfg",{getAsync:function(e){return pxt.github.pkgConfigAsync(g(e)).catch(_.handleNetworkError)},expirationTime:function(e){return 6e4},isOffline:function(){return!w.isOnline()}}),m("target-config",{getAsync:function(e){return pxt.targetConfigAsync().catch(_.handleNetworkError)},expirationTime:function(e){return 6e4},isOffline:function(){return!w.isOnline()}});var C={};n.clearCache=s,n.mountVirtualApi=m,n.stripProtocol=g,n.invalidate=v,n.getAsync=function(e){var t=f(e);return t.api.isSync?Promise.resolve(t.api.getSync(t.path)):w.isOnline()&&i(t)?new Promise(function(e,n){t.callbackOnce.push(function(){e(t.data)}),d(t)}):Promise.resolve(t.data)};var S=function(e){function t(t){e.call(this,t),this.subscriptions=[],this.renderCoreOk=!1,this.state={}}return y(t,e),t.prototype.getData=function(e){return this.renderCoreOk||k.oops("Override renderCore() not render()"),h(this,e)},t.prototype.componentWillUnmount=function(){o(this)},t.prototype.child=function(e){return _.findChild(this,e)},t.prototype.renderCore=function(){return null},t.prototype.render=function(){return o(this),this.renderCoreOk=!0,this.renderCore()},t}(b.Component);n.Component=S,n.wrapWorkspace=function(e){return{initAsync:e.initAsync,resetAsync:function(){return e.resetAsync().then(function(){s()})},getHeaders:e.getHeaders,getHeader:e.getHeader,syncAsync:function(){return e.syncAsync().then(function(e){return v("header:*"),v("text:*"),e})},getTextAsync:e.getTextAsync,saveAsync:function(t,n){return e.saveAsync(t,n).then(function(){v("header:"+t.id),v("text:"+t.id)})},saveToCloudAsync:e.saveToCloudAsync,saveScreenshotAsync:e.saveScreenshotAsync,installAsync:e.installAsync}},JSON.parse(pxt.storage.getLocal("apiCache2")||"[]").forEach(function(e){f(e.path).data=e.data})},{"./core":13,"./gallery":23,react:277}],15:[function(e,t,n){"use strict";function r(){return pxt.debug("db: in memory..."),c=!0,s=new a("pxt-"+pxt.storage.storageId(),{adapter:"memory"}),i.resolve(s)}function o(){if(s)return i.resolve(s);if(pxt.shell.isSandboxMode()||pxt.shell.isReadOnly())return r();var e=new a("pxt-"+pxt.storage.storageId(),{revs_limit:2});return e.get("pouchdbsupportabletest").catch(function(t){return t&&t.error&&"indexed_db_went_bad"==t.name?r():(s=e,i.resolve(s))})}var i=e("bluebird");window.Promise=i;var a=e("pouchdb");e("pouchdb/extras/memory"),i.config({warnings:{wForgottenReturn:!1}});var s=void 0,c=!1;n.getDbAsync=o,n.destroyAsync=function(){return s?s.destroy():i.resolve()};var l=function(){function e(e){this.name=e}return e.prototype.getAsync=function(e){var t=this;return o().then(function(n){return n.get(t.name+"--"+e)}).then(function(t){return t.id=e,t})},e.prototype.getAllAsync=function(){var e=this;return o().then(function(t){return t.allDocs({include_docs:!0,startkey:e.name+"--",endkey:e.name+"--￿"})}).then(function(e){return e.rows.map(function(e){return e.doc})})},e.prototype.deleteAsync=function(e){return o().then(function(t){return t.remove(e)})},e.prototype.forceSetAsync=function(e){var t=this;return this.getAsync(e.id).then(function(n){return e._rev=n._rev,t.setAsync(e)},function(n){return t.setAsync(e)})},e.prototype.setAsync=function(e){return e.id&&!e._id&&(e._id=this.name+"--"+e.id),o().then(function(t){return t.put(e)}).then(function(e){return e.rev})},e}();n.Table=l;var u=function(){function e(){this.memCache={},this.table=new l("translations")}return e.prototype.key=function(e,t,n){return e+"-"+t+"-"+(n||"")},e.prototype.getAsync=function(e,t,n){var r=this.key(e,t,n),o=this.memCache[r];return o?(pxt.debug("translation cache live hit "+r),i.resolve(o)):(pxt.debug("translation cache: load "+r),this.table.getAsync(r).then(function(e){return pxt.debug("translation cache hit "+r),e},function(e){pxt.debug("translation cache miss "+r)}))},e.prototype.setAsync=function(e,t,n,r,o){var i=this.key(e,t,n),a={id:i,etag:r,strings:o};pxt.debug("translation cache: save "+i+"-"+r);var s=pxt.Util.clone(a);return s.cached=!0,delete s._rev,this.memCache[i]=s,this.table.forceSetAsync(a).then(function(){},function(e){pxt.log("translate cache: conflict for "+i)})},e}();ts.pxtc.Util.translationDb=new u},{bluebird:51,pouchdb:133,"pouchdb/extras/memory":131}],16:[function(e,t,n){"use strict";n.setupDragAndDrop=function(e,t,n){document&&document.createElement&&document.createElement("span");e.addEventListener("paste",function(e){if(e.clipboardData){var r=Util.toArray(e.clipboardData.files).filter(t);if(r.length>0)e.stopPropagation(),e.preventDefault(),n(r);else if(e.clipboardData.items&&e.clipboardData.items.length>0){var o=e.clipboardData.items[0].getAsFile();o&&(e.stopPropagation(),e.preventDefault(),n([o]))}}}),e.addEventListener("dragover",function(e){for(var t=e.dataTransfer.types,n=!1,r=0;r<t.length;++r)"Files"==t[r]&&(n=!0);return!n||(e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="copy",!1)},!1),e.addEventListener("drop",function(e){var t=Util.toArray(e.dataTransfer.files);return t.length>0&&(e.stopPropagation(),e.preventDefault(),n(t)),!1},!1),e.addEventListener("dragend",function(e){return!1},!1)}},{}],17:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.saveProjectName=function(e,t){pxt.tickEvent("editortools.projectrename",{view:t}),this.props.parent.updateHeaderName(e)},t.prototype.compile=function(e){pxt.tickEvent("editortools.download",{view:e,collapsed:this.getCollapsedState()}),this.props.parent.compile()},t.prototype.saveFile=function(e){pxt.tickEvent("editortools.save",{view:e,collapsed:this.getCollapsedState()}),this.props.parent.saveAndCompile()},t.prototype.undo=function(e){pxt.tickEvent("editortools.undo",{view:e,collapsed:this.getCollapsedState()}),this.props.parent.editor.undo()},t.prototype.redo=function(e){pxt.tickEvent("editortools.redo",{view:e,collapsed:this.getCollapsedState()}),this.props.parent.editor.redo()},t.prototype.zoomIn=function(e){pxt.tickEvent("editortools.zoomIn",{view:e,collapsed:this.getCollapsedState()}),this.props.parent.editor.zoomIn()},t.prototype.zoomOut=function(e){pxt.tickEvent("editortools.zoomOut",{view:e,collapsed:this.getCollapsedState()}),this.props.parent.editor.zoomOut()},t.prototype.startStopSimulator=function(e){pxt.tickEvent("editortools.startStopSimulator",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()}),this.props.parent.startStopSimulator()},t.prototype.restartSimulator=function(e){pxt.tickEvent("editortools.restart",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()}),this.props.parent.restartSimulator()},t.prototype.toggleTrace=function(e){pxt.tickEvent("editortools.trace",{view:e,collapsed:this.getCollapsedState(),headless:this.getHeadlessState()}),this.props.parent.toggleTrace()},t.prototype.toggleCollapse=function(e){pxt.tickEvent("editortools.toggleCollapse",{view:e,collapsedTo:""+!this.props.parent.state.collapseEditorTools}),this.props.parent.toggleSimulatorCollapse()},t.prototype.getCollapsedState=function(){return""+this.props.parent.state.collapseEditorTools},t.prototype.getHeadlessState=function(){return pxt.appTarget.simulator.headless?"true":"false"},t.prototype.render=function(){var e=this,t=this.props.parent.state,n=t.home,r=t.tutorialOptions,i=t.hideEditorFloats,s=t.collapseEditorTools,c=t.projectName,l=t.showParts,u=t.compiling,p=t.isSaving,d=t.running;if(n)return o.createElement("div",null);var f=pxt.shell.isSandboxMode(),h=pxt.shell.isReadOnly(),m=!!r&&r.tutorial,g=(i||s)&&!m;if(!(this.props.parent.isBlocksEditor()||this.props.parent.isTextEditor()))return o.createElement("div",null);var v=pxt.appTarget.appTheme,y=pxt.appTarget.compile.hasHex,b=pxt.appTarget.simulator,_=(!f&&l&&b&&(b.instructions||b.parts&&pxt.options.debug),lf("Download your code to the {0}",v.boardName)),E=!!u,w=d?lf("Stop the simulator"):lf("Start the simulator"),k=(lf("Open assembly instructions"),lf("Restart the simulator")),x=g?lf("Show the simulator"):lf("Hide the simulator"),C=b.headless,S=this.props.parent.editor.hasUndo(),N=this.props.parent.editor.hasRedo(),T=!m,O=!m&&!h,D=!m&&!h,R=!m,A=!b.hideRestart,P=b.enableTrace,I=this.props.parent.state.tracing,j=I?lf("Disable Slow-Mo"):lf("Slow-Mo"),M=pxt.appTarget.appTheme.downloadIcon||"download",L=pxt.appTarget.appTheme.useUploadMessage?lf("Upload"):lf("Download"),F="",U="";return p?(F="disabled",U="loading disabled"):E&&(F="loading disabled",U="disabled"),o.createElement("div",{className:"ui equal width grid right aligned padded"},o.createElement("div",{className:"column mobile only"},g?o.createElement("div",{className:"ui equal width grid"},o.createElement("div",{className:"left aligned column"},o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:g?"toggle up":"toggle down",class:"collapse-button "+(g?"collapsed":"")+" "+(i?"disabled":""),ariaLabel:lf("{0}, {1}",x,i?lf("Disabled"):""),title:x,onClick:function(){return e.toggleCollapse("mobile")}}),C?o.createElement(a.Button,{class:"play-button "+(d?"stop":"play"),key:"runmenubtn",icon:d?"stop":"play",title:w,onClick:function(){return e.startStopSimulator("mobile")}}):void 0,C&&A?o.createElement(a.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:k,onClick:function(){return e.restartSimulator("mobile")}}):void 0,C&&P?o.createElement(a.Button,{key:"tracebtn",class:"trace-button "+(I?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("mobile")}}):void 0,y?o.createElement(a.Button,{class:"primary download-button download-button-full "+F,icon:M,title:_,ariaLabel:lf("Download your code"),onClick:function(){return e.compile("mobile")}}):void 0)),o.createElement("div",{className:"right aligned column"},h?void 0:o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:"save",class:"editortools-btn save-editortools-btn "+U,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("mobile")}}),D?o.createElement(a.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn} "+(S?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("mobile")}}):void 0)),o.createElement("div",{className:"right aligned column"},R?o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn("mobile")}}),o.createElement(a.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut("mobile")}})):void 0)):o.createElement("div",{className:"ui equal width grid"},o.createElement("div",{className:"left aligned two wide column"},o.createElement("div",{className:"ui vertical icon small buttons"},o.createElement(a.Button,{class:"play-button "+(d?"stop":"play"),key:"runmenubtn",icon:d?"stop":"play",title:w,onClick:function(){return e.startStopSimulator("mobile")}}),A?o.createElement(a.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:k,onClick:function(){return e.restartSimulator("mobile")}}):void 0),T?o.createElement("div",{className:"row",style:{paddingTop:"1rem"}},o.createElement("div",{className:"ui vertical icon small buttons"},o.createElement(a.Button,{icon:g?"toggle up":"toggle down",class:"collapse-button "+(g?"collapsed":""),title:x,ariaLabel:lf("{0}, {1}",x,g?lf("Collapsed"):"Expanded"),onClick:function(){return e.toggleCollapse("mobile")}}))):void 0),o.createElement("div",{className:"three wide column"}),o.createElement("div",{className:"column"},o.createElement("div",{className:"ui grid"},h||!D?void 0:o.createElement("div",{className:"row"},o.createElement("div",{className:"column"},o.createElement("div",{className:"ui icon large buttons"},o.createElement(a.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn "+(S?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("mobile")}})))),o.createElement("div",{className:"row",style:h||!D?void 0:{paddingTop:0}},o.createElement("div",{className:"column"},o.createElement("div",{className:"ui icon large buttons"},P?o.createElement(a.Button,{key:"tracebtn",class:"trace-button "+(I?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("mobile")}}):void 0,y?o.createElement(a.Button,{class:"primary download-button download-button-full "+F,icon:M,title:_,onClick:function(){return e.compile("mobile")}}):void 0))))))),o.createElement("div",{className:"column tablet only"},g?o.createElement("div",{className:"ui grid seven column"},C?o.createElement("div",{className:"left aligned six wide column"},o.createElement("div",{className:"ui icon buttons"},o.createElement(a.Button,{icon:g?"toggle up":"toggle down",class:"collapse-button "+(g?"collapsed":"")+" "+(i?"disabled":""),ariaLabel:lf("{0}, {1}",x,i?lf("Disabled"):""),title:x,onClick:function(){return e.toggleCollapse("tablet")}}),o.createElement(a.Button,{role:"menuitem",class:"play-button "+(d?"stop":"play"),key:"runmenubtn",icon:d?"stop":"play",title:w,onClick:function(){return e.startStopSimulator("tablet")}}),A?o.createElement(a.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:k,onClick:function(){return e.restartSimulator("tablet")}}):void 0,P?o.createElement(a.Button,{key:"tracebtn",class:"trace-button "+(I?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("tablet")}}):void 0,y?o.createElement(a.Button,{class:"primary download-button download-button-full "+F,icon:M,title:_,onClick:function(){return e.compile("tablet")}}):void 0)):o.createElement("div",{className:"left aligned six wide column"},o.createElement("div",{className:"ui icon buttons"},o.createElement(a.Button,{icon:g?"toggle up":"toggle down",class:"collapse-button "+(g?"collapsed":"")+" "+(i?"disabled":""),ariaLabel:lf("{0}, {1}",x,i?lf("Disabled"):""),title:x,onClick:function(){return e.toggleCollapse("tablet")}}),y?o.createElement(a.Button,{class:"primary download-button download-button-full "+F,icon:M,text:L,title:_,onClick:function(){return e.compile("tablet")}}):void 0)),o.createElement("div",{className:"column four wide"},h?void 0:o.createElement(a.Button,{icon:"save",class:"small editortools-btn save-editortools-btn "+U,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("tablet")}})),o.createElement("div",{className:"column six wide right aligned"},D?o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn "+(S?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("tablet")}}),o.createElement(a.Button,{icon:"xicon redo",class:"editortools-btn redo-editortools-btn "+(N?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Red"),N?"":lf("Disabled")),title:lf("Redo"),onClick:function(){return e.redo("tablet")}})):void 0,R?o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn("tablet")}}),o.createElement(a.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut("tablet")}})):void 0)):o.createElement("div",{className:"ui grid"},o.createElement("div",{className:"left aligned two wide column"},o.createElement("div",{className:"ui vertical icon small buttons"},o.createElement(a.Button,{role:"menuitem",class:"play-button "+(d?"stop":"play"),key:"runmenubtn",icon:d?"stop":"play",title:w,onClick:function(){return e.startStopSimulator("tablet")}}),A?o.createElement(a.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:k,onClick:function(){return e.restartSimulator("tablet")}}):void 0),T?o.createElement("div",{className:"row",style:{paddingTop:"1rem"}},o.createElement("div",{className:"ui vertical icon small buttons"},o.createElement(a.Button,{icon:g?"toggle up":"toggle down",class:"collapse-button "+(g?"collapsed":""),title:x,ariaLabel:lf("{0}, {1}",x,g?lf("Collapsed"):"Expanded"),onClick:function(){return e.toggleCollapse("tablet")}}))):void 0),o.createElement("div",{className:"three wide column"}),o.createElement("div",{className:"five wide column"},o.createElement("div",{className:"ui grid right aligned"},y?o.createElement("div",{className:"row"},o.createElement("div",{className:"column"},o.createElement(a.Button,{role:"menuitem",class:"primary large fluid download-button download-button-full "+F,icon:M,text:L,title:_,onClick:function(){return e.compile("tablet")}}))):void 0,O?o.createElement("div",{className:"row",style:y?{paddingTop:0}:{}},o.createElement("div",{className:"column"},o.createElement("div",{className:"ui item large right labeled fluid input projectname-input projectname-tablet",title:lf("Pick a name for your project")},o.createElement("label",{htmlFor:"fileNameInput1",id:"fileNameInputLabel1",className:"accessible-hidden"},lf("Type a name for your project")),o.createElement("input",{id:"fileNameInput1",type:"text","aria-labelledby":"fileNameInputLabel1",placeholder:lf("Pick a name..."),value:c||"",onChange:function(t){return e.saveProjectName(t.target.value,"tablet")}}),o.createElement(a.Button,{icon:"save",class:"large right attached editortools-btn save-editortools-btn "+U,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("tablet")}})))):void 0)),o.createElement("div",{className:"six wide column right aligned"},o.createElement("div",{className:"ui grid right aligned"},D||R?o.createElement("div",{className:"row"},o.createElement("div",{className:"column"},D?o.createElement("div",{className:"ui icon large buttons"},o.createElement(a.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn} "+(S?"":"disabled"),title:lf("Undo"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),onClick:function(){return e.undo()}}),o.createElement(a.Button,{icon:"xicon redo",class:"editortools-btn redo-editortools-btn} "+(N?"":"disabled"),title:lf("Redo"),ariaLabel:lf("{0}, {1}",lf("Redo"),N?"":lf("Disabled")),onClick:function(){return e.redo()}})):void 0,R?o.createElement("div",{className:"ui icon large buttons"},o.createElement(a.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn()}}),o.createElement(a.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut()}})):void 0)):void 0,P?o.createElement("div",{className:"row",style:D||R?{paddingTop:0}:{}},o.createElement("div",{className:"column"},o.createElement(a.Button,{key:"tracebtn",class:"large trace-button "+(I?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("tablet")}}))):void 0)))),o.createElement("div",{className:"column computer only"},o.createElement("div",{className:"ui grid equal width"},o.createElement("div",{id:"downloadArea",className:"ui column items"},C?o.createElement("div",{className:"ui item"},o.createElement("div",{className:"ui icon large buttons"},T?o.createElement(a.Button,{icon:s?"toggle right":"toggle left",class:"large collapse-button "+(g?"collapsed":""),title:x,onClick:function(){return e.toggleCollapse("computer")}}):void 0,o.createElement(a.Button,{role:"menuitem",class:"large play-button "+(d?"stop":"play"),key:"runmenubtn",icon:d?"stop":"play",title:w,onClick:function(){return e.startStopSimulator("computer")}}),A?o.createElement(a.Button,{key:"restartbtn",class:"large restart-button",icon:"refresh",title:k,onClick:function(){return e.restartSimulator("computer")}}):void 0,P?o.createElement(a.Button,{key:"tracebtn",class:"large trace-button "+(I?"orange":""),icon:"xicon turtle",title:j,onClick:function(){return e.toggleTrace("computer")}}):void 0,y?o.createElement(a.Button,{icon:M,class:"primary large download-button "+F,title:_,onClick:function(){return e.compile("computer")}}):void 0)):o.createElement("div",{className:"ui item"},T?o.createElement(a.Button,{icon:s?"toggle right":"toggle left",class:"large collapse-button "+(g?"collapsed":""),title:x,onClick:function(){return e.toggleCollapse("computer")}}):void 0,y?o.createElement(a.Button,{icon:M,class:"primary huge fluid download-button "+F,text:L,title:_,onClick:function(){return e.compile("computer")}}):void 0)),O?o.createElement("div",{className:"column left aligned"},o.createElement("div",{className:"ui right labeled input projectname-input projectname-computer",title:lf("Pick a name for your project")},o.createElement("label",{htmlFor:"fileNameInput2",id:"fileNameInputLabel2",className:"accessible-hidden"},lf("Type a name for your project")),o.createElement("input",{id:"fileNameInput2",type:"text","aria-labelledby":"fileNameInputLabel2",placeholder:lf("Pick a name..."),value:c||"",onChange:function(t){return e.saveProjectName(t.target.value,"computer")}}),o.createElement(a.Button,{icon:"save",class:"small right attached editortools-btn save-editortools-btn "+U,title:lf("Save"),ariaLabel:lf("Save the project"),onClick:function(){return e.saveFile("computer")}}))):void 0,o.createElement("div",{className:"column right aligned"},D?o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:"xicon undo",class:"editortools-btn undo-editortools-btn "+(S?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Undo"),S?"":lf("Disabled")),title:lf("Undo"),onClick:function(){return e.undo("computer")}}),o.createElement(a.Button,{icon:"xicon redo",class:"editortools-btn redo-editortools-btn "+(N?"":"disabled"),ariaLabel:lf("{0}, {1}",lf("Redo"),N?"":lf("Disabled")),title:lf("Redo"),onClick:function(){return e.redo("computer")}})):void 0,R?o.createElement("div",{className:"ui icon small buttons"},o.createElement(a.Button,{icon:"plus circle",class:"editortools-btn zoomin-editortools-btn",title:lf("Zoom In"),onClick:function(){return e.zoomIn("computer")}}),o.createElement(a.Button,{icon:"minus circle",class:"editortools-btn zoomout-editortools-btn",title:lf("Zoom Out"),onClick:function(){return e.zoomOut("computer")}})):void 0))))},t}(i.Component);n.EditorToolbar=s},{"./data":14,"./sui":44,react:277}],18:[function(e,t,n){"use strict";function r(e,t){if(s){var n={type:e,args:t};setTimeout(function(){s.send(JSON.stringify(n))},150)}}var o,i=e("./core"),a=pxt.Cloud;!function(e){e[e.Critical=1]="Critical",e[e.Notification=2]="Notification",e[e.Prompt=3]="Prompt"}(o||(o={}));var s=null;n.isPxtElectron=/[?&]electron=1/.test(window.location.href),n.isIpcRenderer=!!window.ipcRenderer,n.isElectron=n.isPxtElectron||n.isIpcRenderer,n.init=function(){function e(e){var t=/^https:\/\//.test(e.targetVersion),n=lf("To continue using {0}, you must install an update.",e.appName||lf("this application")),o=lf("Update");t&&(n=lf("To continue using {0}, you must install an update from the website.",e.appName||lf("this application")),o=lf("Go to website")),i.confirmAsync({header:lf("Critical update required"),body:n,agreeLbl:o,disagreeLbl:lf("Quit"),disagreeClass:"red",size:"medium"}).then(function(t){t?(pxt.tickEvent("update.acceptedCritical"),i.showLoading("downloadingupdate",lf("Downloading update...")),r("update",{targetVersion:e.targetVersion,type:e.type})):(pxt.tickEvent("update.refusedCritical"),r("quit"))})}function t(e){var t=/^https:\/\//.test(e.targetVersion),n=lf("Version {0} available",e.targetVersion),a=lf("A new version of {0} is ready to download and install. The app will restart during the update. Update now?",e.appName||lf("this application")),s=lf("Update");t&&(n=lf("Update available from website"),a=lf("A new version of {0} is available from the website.",e.appName||lf("this application")),s=lf("Go to website")),e.type===o.Notification?i.infoNotification(lf("A new version is available. Select 'Check for updates...' in the menu.",e.targetVersion)):e.type===o.Prompt&&i.confirmAsync({header:n,body:a,agreeLbl:s,disagreeLbl:lf("Not now"),size:"medium"}).then(function(n){n?(e.isInitialCheck?pxt.tickEvent("update.acceptedInitial"):pxt.tickEvent("update.accepted"),t||i.showLoading("downloadingupdate",lf("Downloading update...")),r("update",{targetVersion:e.targetVersion,type:e.type})):e.isInitialCheck?pxt.tickEvent("update.refusedInitial"):pxt.tickEvent("update.refused")})}function c(){i.confirmAsync({body:lf("You are using the latest version available."),header:lf("Good to go!"),agreeLbl:lf("Ok"),hideCancel:!0})}function l(){p(lf("Unable to check for updates"),lf("Ok"))}function u(e){var t=e&&e.type===o.Critical;i.hideLoading("downloadingupdate"),p(lf("There was an error downloading the update"),t?lf("Quit"):lf("Ok")).finally(function(){t&&r("quit")})}function p(e,t){return i.confirmAsync({header:e,body:lf("Please ensure you are connected to the Internet and try again later."),agreeClass:"red",agreeIcon:"cancel",agreeLbl:t,hideCancel:!0})}n.isElectron&&a.isLocalHost()&&a.localToken&&(pxt.log("initializing electron socket"),(s=new WebSocket("ws://localhost:"+pxt.options.wsPort+"/"+a.localToken+"/electron")).onopen=function(e){pxt.log("electron: socket opened"),r("ready")},s.onclose=function(e){pxt.log("electron: socket closed"),s=null},s.onmessage=function(n){try{var r=JSON.parse(n.data);switch(r.type){case"critical-update":e(r.args);break;case"update-available":t(r.args);break;case"update-not-available":c();break;case"update-check-error":l();break;case"update-download-error":u(r.args);break;case"telemetry":var o=r.args;if(!o)return void pxt.debug("invalid telemetry message: "+n.data);pxt.tickEvent(o.event,o.data);default:pxt.debug("unknown electron message: "+n.data)}}catch(e){pxt.debug("unknown electron message: "+n.data)}})},n.sendMessage=r,n.checkForUpdate=function(){pxt.tickEvent("menu.electronupdate"),r("check-for-update")}},{"./core":13}],19:[function(e,t,n){"use strict";function r(e,t){var n=p.mainEditorPkg();t.resp=n.getAllFiles()}function o(e,t){var n=p.mainEditorPkg(),r=ts.pxtc.escapeIdentifier(e),o=n.getAllFiles();t.resp={json:o[r+".json"],code:o[r+".ts"],jres:o[r+".jres"]}}function i(e,t,n){function r(e,t){return void 0!==e&&(!o.files[i+t]||o.files[i+t].content!=e)}var o=p.mainEditorPkg(),i=ts.pxtc.escapeIdentifier(e),a=!1;return r(n.json,".json")&&(a=!0,o.setFile(i+".json",n.json)),r(n.code,".ts")&&(a=!0,o.setFile(i+".ts",n.code)),r(n.jres,".jres")&&(a=!0,o.setFile(i+".jres",n.jres)),a?o.updateConfigAsync(function(e){return void 0!==n.json&&e.files.indexOf(i+".json")<0&&e.files.push(i+".json"),void 0!==n.code&&e.files.indexOf(i+".ts")<0&&e.files.push(i+".ts"),void 0!==n.jres&&e.files.indexOf(i+".jres")<0&&e.files.push(i+".jres"),o.savePkgAsync()}):Promise.resolve()}function a(e){return{type:"pxtpkgext",event:e}}function s(e,t){return void 0===t&&(t=!0),{type:"pxtpkgext",id:e.id,extId:e.extId,success:t}}function c(e){return{readUserCode:l(e.readUserCode),console:l(e.console)}}function l(e){switch(e){case f.NotYetPrompted:case f.Denied:return u.PermissionResponses.Denied;case f.Granted:return u.PermissionResponses.Granted;case f.NotAvailable:default:return u.PermissionResponses.NotAvailable}}var u=pxt.editor,p=e("./package");!function(e){e[e.Console=0]="Console",e[e.ReadUserCode=1]="ReadUserCode"}(n.Permissions||(n.Permissions={}));var d=n.Permissions;!function(e){e[e.Granted=0]="Granted",e[e.Denied=1]="Denied",e[e.NotAvailable=2]="NotAvailable",e[e.NotYetPrompted=3]="NotYetPrompted"}(n.PermissionStatus||(n.PermissionStatus={}));var f=n.PermissionStatus,h=function(){function e(e){this.host=e,this.statuses={},this.nameToExtId={},this.extIdToName={},this.consent={},this.pendingRequests=[],this.queueLock=!1,this.streams={}}return e.prototype.streamingExtensions=function(){return Object.keys(this.streams)},e.prototype.handleExtensionMessage=function(e){this.handleRequestAsync(e).catch(function(e){})},e.prototype.sendEvent=function(e,t){this.host.send(e,a(t))},e.prototype.setConsent=function(e,t){this.consent[e]=t},e.prototype.hasConsent=function(e){return this.consent[e]},e.prototype.getExtId=function(e){return this.nameToExtId[e]||(this.nameToExtId[e]=Util.guidGen(),this.extIdToName[this.nameToExtId[e]]=e),this.nameToExtId[e]},e.prototype.sendResponse=function(e){this.host.send(this.extIdToName[e.extId],e)},e.prototype.handleRequestAsync=function(e){var t=this,n=s(e);if(!this.hasConsent(e.extId))return n.success=!1,n.error="",this.sendResponse(n),Promise.reject("No consent");switch(e.action){case"extinit":n.target=pxt.appTarget,this.sendResponse(n);break;case"extdatastream":return this.permissionOperation(e.extId,d.Console,n,function(e,n){return t.handleDataStreamRequest(e,n)});case"extquerypermission":var a=this.getPermissions(e.extId),l=n;l.resp=c(a),this.sendResponse(l);break;case"extrequestpermission":return this.requestPermissionsAsync(e.extId,n,e.body);case"extusercode":return this.permissionOperation(e.extId,d.ReadUserCode,n,r);case"extreadcode":o(this.extIdToName[e.extId],n),this.sendResponse(n);break;case"extwritecode":i(this.extIdToName[e.extId],0,e.body).done(function(){return t.sendResponse(n)})}return Promise.resolve()},e.prototype.permissionOperation=function(e,t,n,r){var o=this;return this.checkPermissionAsync(e,t).then(function(t){t?(r(o.extIdToName[e],n),o.sendResponse(n)):(n.success=!1,n.error="permission denied",o.sendResponse(n))}).catch(function(e){n.success=!1,n.error=e,o.sendResponse(n)})},e.prototype.getPermissions=function(e){return this.statuses[e]||(this.statuses[e]={console:f.NotYetPrompted,readUserCode:f.NotYetPrompted}),this.statuses[e]},e.prototype.queuePermissionRequest=function(e,t){var n=this;return new Promise(function(r,o){var i={extId:e,permissions:[t],resolver:r};n.pendingRequests.push(i),n.queueLock||1!==n.pendingRequests.length||(n.queueLock=!0,n.nextPermissionRequest())})},e.prototype.nextPermissionRequest=function(){var e=this;if(this.pendingRequests.length){var t=this.pendingRequests.shift();t.permissions=t.permissions.filter(function(n){return e.hasNotBeenPrompted(t.extId,n)}),t.permissions.length?this.host.promptForPermissionAsync(this.extIdToName[t.extId],t.permissions).done(function(n){t.resolver(n),e.nextPermissionRequest()}):this.nextPermissionRequest()}else this.queueLock=!1},e.prototype.checkPermissionAsync=function(e,t){var n,r=this,o=this.getPermissions(e);switch(t){case d.Console:n=o.console;break;case d.ReadUserCode:n=o.readUserCode}return n===f.NotYetPrompted?this.queuePermissionRequest(e,t).then(function(n){var o=n?f.Granted:f.Denied;switch(t){case d.Console:r.statuses[e].console=o;break;case d.ReadUserCode:r.statuses[e].readUserCode=o}return n}):Promise.resolve(n===f.Granted)},e.prototype.requestPermissionsAsync=function(e,t,n){var r=this,o=[];return n.readUserCode&&o.push(this.checkPermissionAsync(e,d.ReadUserCode)),n.console&&o.push(this.checkPermissionAsync(e,d.Console)),Promise.all(o).then(function(){return c(r.getPermissions(e))}).then(function(e){t.resp=e})},e.prototype.hasNotBeenPrompted=function(e,t){var n,r=this.getPermissions(e);switch(t){case d.Console:n=r.console;break;case d.ReadUserCode:n=r.readUserCode}return n===f.NotYetPrompted},e.prototype.handleDataStreamRequest=function(e,t){this.streams[e]=!0},e}();n.ExtensionManager=h},{"./package":32}],20:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=e("./extensionManager"),c=function(e){function t(t){e.call(this,t),this.state={visible:!1,consent:!1},this.manager=new s.ExtensionManager(this),window.addEventListener("message",this.processMessage.bind(this),!1)}return r(t,e),t.prototype.processMessage=function(e){var t=this,n=e.data;if("serial"===n.type){var r=n,o=this.manager.streamingExtensions();if(o&&o.length){var i=r.data||"",a=r.id||"?";o.forEach(function(e){t.send(e,{type:"pxtpkgext",event:"extconsole",body:{source:a,sim:r.sim,data:i}})})}}},t.prototype.hide=function(){var e=this;this.setState({visible:!1}),t.getFrame(this.state.extension,!0).style.display="none",this.props.parent.reloadHeaderAsync().done(function(){e.send(e.state.extension,{type:"pxtpkgext",event:"exthidden"})})},t.prototype.showExtension=function(e,t,n){var r=this,o=!n||this.manager.hasConsent(this.manager.getExtId(e));this.setState({visible:!0,extension:e,url:t,consent:o},function(){r.send(e,{type:"pxtpkgext",event:"extshown"})})},t.prototype.submitConsent=function(){this.manager.setConsent(this.manager.getExtId(this.state.extension),!0),this.setState({consent:!0})},t.prototype.initializeFrame=function(){this.manager.setConsent(this.manager.getExtId(this.state.extension),!0);var e=t.getFrame(this.state.extension,!0);e.style.display="block",e.src||(e.src=this.state.url+"#"+this.manager.getExtId(this.state.extension))},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.visible!=t.visible||this.state.extension!=t.extension||this.state.permissionRequest!=t.permissionRequest||this.state.consent!=t.consent},t.prototype.updateDimensions=function(){if(this.extensionWrapper){var e=this.extensionWrapper.getAttribute("data-frame");if(e){var n=t.getFrame(e,!1),r=document.getElementsByClassName("extensiondialog")[0];if(r&&n){var o=r.getBoundingClientRect();n.width=this.extensionWrapper.clientWidth+"px",n.height=this.extensionWrapper.clientHeight+"px",n.style.top=o.top+this.extensionWrapper.offsetTop+"px",n.style.left=o.left+this.extensionWrapper.offsetLeft+"px"}}}},t.prototype.componentDidMount=function(){window.addEventListener("resize",this.updateDimensions)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateDimensions)},t.prototype.componentDidUpdate=function(){this.updateDimensions()},t.prototype.handleExtensionRequest=function(e){this.manager.handleExtensionMessage(e)},t.prototype.send=function(e,n){var r=t.getFrame(e,!1);r?r.contentWindow.postMessage(n,"*"):console.warn("Attempting to post message to unloaded extesnion "+e)},t.prototype.promptForPermissionAsync=function(e,t){var n=this;return new Promise(function(r,o){n.permissionCb=r,n.setState({permissionRequest:t,permissionExtName:e})})},t.prototype.onPermissionDecision=function(e){this.permissionCb(e),this.permissionCb=void 0,this.setState({permissionRequest:null,permissionExtName:null})},t.getCustomContent=function(){return document.getElementById("custom-content")},t.getFrame=function(e,t){var n=this.getCustomContent().getElementsByClassName("extension-frame-"+e)[0];return!n&&t&&(n=this.createFrame(e)),n},t.createFrame=function(e){var t=this.getCustomContent(),n=document.createElement("iframe");n.className="extension-frame extension-frame-"+e,n.allowFullscreen=!0,n.setAttribute("sandbox","allow-same-origin allow-scripts"),n.sandbox.value="allow-scripts allow-same-origin";return n.frameBorder="0",n.style.display="none",t.appendChild(n),n},t.prototype.getIconForPermission=function(e){switch(e){case s.Permissions.Console:return"terminal";case s.Permissions.ReadUserCode:return"code"}return""},t.prototype.getDisplayNameForPermission=function(e){switch(e){case s.Permissions.Console:return lf("Console output");case s.Permissions.ReadUserCode:return lf("Read your code")}return""},t.prototype.getDescriptionForPermission=function(e){switch(e){case s.Permissions.Console:return lf("The extension will be able to read any console output (including device data) streamed to the editor");case s.Permissions.ReadUserCode:return lf("The extension will be able to read the code in the current project")}return""},t.prototype.renderCore=function(){var e=this,t=this.state,n=t.visible,r=t.extension,i=(t.url,t.consent),s=t.permissionRequest,c=t.permissionExtName,l=!i,u=(pxt.appTarget.appTheme,l?lf("Agree"):void 0),p=u?[{label:u,onClick:function(){e.submitConsent()}}]:void 0;return!l&&n&&this.initializeFrame(),o.createElement(a.Modal,{open:n,className:l?"extensionconsentdialog":"extensiondialog",size:"fullscreen",closeIcon:!1,onClose:function(){return e.hide()},dimmer:!0,actions:p,onPositionChanged:function(){return e.updateDimensions()},closeOnDimmerClick:!0},i?o.createElement("div",{id:"extensionWrapper","data-frame":r,ref:function(t){return e.extensionWrapper=t}},s?o.createElement(a.Modal,{className:"extensionpermissiondialog basic",size:"fullscreen",closeIcon:!1,dimmer:!0,open:!0,dimmerClassName:"permissiondimmer"},o.createElement("div",{className:"permissiondialoginner"},o.createElement("div",{className:"permissiondialogheader"},lf("Permission Request")),o.createElement("div",{className:"permissiondialogbody"},lf("Extension {0} is requesting the following permission(s):",c)),o.createElement("div",{className:"ui inverted list"},s.map(function(t){return o.createElement("div",{className:"item"},o.createElement(a.Icon,{icon:e.getIconForPermission(t)+" icon"}),o.createElement("div",{className:"content"},o.createElement("div",{className:"header"},e.getDisplayNameForPermission(t)),o.createElement("div",{className:"description"},e.getDescriptionForPermission(t))))}))),o.createElement("div",{className:"actions"},o.createElement(a.Button,{text:lf("Deny"),class:"deny inverted",onClick:function(){return e.onPermissionDecision(!1)}}),o.createElement(a.Button,{text:lf("Approve"),class:"approve inverted green",onClick:function(){return e.onPermissionDecision(!0)}}))):void 0):o.createElement("div",null,o.createElement("div",{className:"ui form"},o.createElement("div",{className:"ui icon violet message"},o.createElement(a.Icon,{icon:"user"}),o.createElement("div",{className:"content"},o.createElement("h3",{className:"header"},"User-provided content"),o.createElement("p",null,lf("This content is provided by a user, and is not endorsed by Microsoft."),o.createElement("br",null),lf("If you think it's not appropriate, please report abuse through Settings -> Report Abuse.")))))))},t}(i.Component);n.Extensions=c},{"./data":14,"./extensionManager":19,"./sui":44,react:277}],21:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=e("./package"),c=e("./core"),l=function(e){function t(t){e.call(this,t),this.state={expands:{}}}return r(t,e),t.prototype.removePkg=function(e,t){var n=this;e.stopPropagation(),c.confirmAsync({header:lf("Remove {0} package",t.getPkgId()),body:lf("You are about to remove a package from your project. Are you sure?"),agreeClass:"red",agreeIcon:"trash",agreeLbl:lf("Remove it")}).done(function(e){e&&s.mainEditorPkg().removeDepAsync(t.getPkgId()).then(function(){return n.props.parent.reloadHeaderAsync()}).done()})},t.prototype.removeFile=function(e,t){e.stopPropagation(),this.props.parent.removeFile(t)},t.prototype.updatePkg=function(e,t){var n=this;e.stopPropagation(),s.mainEditorPkg().updateDepAsync(t.getPkgId()).then(function(){return n.props.parent.reloadHeaderAsync()}).done()},t.prototype.filesOf=function(e){var t=this,n="this"==e.getPkgId(),r=this.props.parent;return e.sortedFiles().map(function(i){var s=t.getData("open-meta:"+i.getName());return o.createElement("a",{key:i.getName(),onClick:function(){return r.setSideFile(i)},tabIndex:0,role:"treeitem","aria-label":r.state.currFile==i?lf("{0}, it is the current opened file in the JavaScript editor",i.name):i.name,onKeyDown:a.fireClickOnEnter,className:(r.state.currFile==i?"active ":"")+(e.isTopLevel()?"":"nested ")+"item"},i.name," ",s.isSaved?"":"*",/\.ts$/.test(i.name)?o.createElement(a.Icon,{icon:"align left"}):/\.blocks$/.test(i.name)?o.createElement(a.Icon,{icon:"puzzle"}):void 0,s.isReadonly?o.createElement(a.Icon,{icon:"lock"}):null,s.numErrors?o.createElement("span",{className:"ui label red"},s.numErrors):null,n&&/\.blocks$/i.test(i.getName())?o.createElement(a.Button,{class:"primary label",icon:"trash",title:lf("Delete file {0}",i.name),onClick:function(e){return t.removeFile(e,i)},onKeyDown:function(e){return e.stopPropagation()}}):"")})},t.prototype.packageOf=function(e){var t=this,n=this.state.expands,r=e.getPkgId()!=pxt.appTarget.id&&"built"!=e.getPkgId()&&e.getPkgId()!=pxt.appTarget.corepkg&&!e.getKsPkg().config.core&&e.getKsPkg().level<=1,i=e.getKsPkg()&&"github"==e.getKsPkg().verProtocol();return[o.createElement("div",{key:"hd-"+e.getPkgId(),className:"header link item",role:"treeitem","aria-expanded":n[e.getPkgId()],"aria-label":lf("{0}, {1}",e.getPkgId(),n[e.getPkgId()]?lf("expanded"):lf("collapsed")),onClick:function(){return t.togglePkg(e)},tabIndex:0,onKeyDown:a.fireClickOnEnter},o.createElement(a.Icon,{icon:"chevron "+(n[e.getPkgId()]?"down":"right")+" icon"}),i?o.createElement(a.Button,{class:"primary label",icon:"refresh",title:lf("Refresh package {0}",e.getPkgId()),onClick:function(n){return t.updatePkg(n,e)},onKeyDown:function(e){return e.stopPropagation()}}):"",r?o.createElement(a.Button,{class:"primary label",icon:"trash",title:lf("Delete package {0}",e.getPkgId()),onClick:function(n){return t.removePkg(n,e)},onKeyDown:function(e){return e.stopPropagation()}}):"",e.getPkgId())].concat(n[e.getPkgId()]?this.filesOf(e):[])},t.prototype.togglePkg=function(e){var t=this.state.expands;t[e.getPkgId()]=!t[e.getPkgId()],this.forceUpdate()},t.prototype.filesWithHeader=function(e){return e.isTopLevel()?this.filesOf(e):this.packageOf(e)},t.prototype.toggleVisibility=function(){this.props.parent.setState({showFiles:!this.props.parent.state.showFiles})},t.prototype.addCustomBlocksFile=function(){var e=this;c.confirmAsync({header:lf("Add custom blocks?"),body:lf("A new JavaScript file, custom.ts, will be added to your project. You can define custom functions and blocks in that file.")}).then(function(t){if(t)return e.props.parent.updateFileAsync("custom.ts","\n/**\n * "+lf("Use this file to define custom functions and blocks.")+"\n * "+lf("Read more at {0}",pxt.appTarget.appTheme.homeUrl+"blocks/custom")+'\n */\n\nenum MyEnum {\n    //% block="one"\n    One,\n    //% block="two"\n    Two\n}\n\n/**\n * '+lf("Custom blocks")+'\n */\n//% weight=100 color=#0fbc11 icon=""\nnamespace custom {\n    /**\n     * TODO: '+lf("describe your function here")+"\n     * @param n "+lf("describe parameter here")+", eg: 5\n     * @param s "+lf("describe parameter here")+', eg: "Hello"\n     * @param e '+lf("describe parameter here")+"\n     */    \n    //% block\n    export function foo(n: number, s: string, e: MyEnum): void {\n        // Add code here\n    }\n\n    /**\n     * TODO: "+lf("describe your function here")+"\n     * @param value "+lf("describe value here")+", eg: 5\n     */    \n    //% block\n    export function fib(value: number): number {\n        return value <= 1 ? value : fib(value -1) + fib(value - 2);\n    }\n}\n",!0)})},t.prototype.renderCore=function(){var e=this,t=!!this.props.parent.state.showFiles,n=pxt.appTarget.appTheme,r=t&&!s.mainEditorPkg().files["custom.ts"];return o.createElement("div",{role:"tree",className:"ui tiny vertical "+(n.invertedMenu?"inverted":"")+" menu filemenu landscape only"},o.createElement("div",{role:"treeitem","aria-expanded":t,"aria-label":lf("File explorer toolbar"),key:"projectheader",className:"link item",onClick:function(){return e.toggleVisibility()},tabIndex:0,onKeyDown:a.fireClickOnEnter},lf("Explorer"),o.createElement(a.Icon,{icon:"chevron "+(t?"down":"right")+" icon"}),r?o.createElement(a.Button,{class:"primary label",icon:"plus",title:lf("Add custom blocks?"),onClick:function(t){e.addCustomBlocksFile(),t.stopPropagation()},onKeyDown:function(e){return e.stopPropagation()}}):void 0),t?Util.concat(s.allEditorPkgs().map(function(t){return e.filesWithHeader(t)})):void 0)},t}(i.Component);n.FileList=l},{"./core":13,"./data":14,"./package":32,"./sui":44,react:277}],22:[function(e,t,n){"use strict";function r(e){return g.filter(function(t){return t.id==e})[0]}function o(e,t){return f.requestAsync({url:"/api/"+e,headers:{Authorization:h.localToken},method:t?"POST":"GET",data:t||void 0}).then(function(e){return e.json}).catch(p.handleNetworkError)}function i(e){var t=r(e.path);t||(t={id:e.path,header:null,text:null,fsText:null},g.push(t));var n=e.files.map(function(e){return e.mtime});n.sort(function(e,t){return t-e});var o=Math.round(n[0]/1e3)||f.nowSeconds(),i={target:l,name:e.config.name,meta:{},editor:pxt.JAVASCRIPT_PROJECT_NAME,pubId:e.config.installedVersion,pubCurrent:!1,_rev:null,id:e.path,recentUse:o,modificationTime:o,blobId:null,blobCurrent:!1,isDeleted:!1,icon:e.icon};if(t.header){var a=t.header;a.name=i.name,a.pubId=i.pubId,a.modificationTime=i.modificationTime,a.isDeleted=i.isDeleted,a.icon=i.icon}else t.header=i}function a(e){return o("pkg/"+e.id).then(function(t){if(!e.text){e.text={},e.mtime=0;for(var n=0,r=t.files;n<r.length;n++){var o=r[n];e.text[o.name]=o.content,e.mtime=Math.max(e.mtime,o.mtime)}e.fsText=f.flatClone(e.text)}return e.text})}function s(e,t){if(e.temporary)return Promise.resolve();var n=r(e.id);return f.assert(n.header===e),t?(e.saveId=null,n.textNeedsSave=!0,n.text=t,v.enqueue(e.id,function(){f.assert(!!n.fsText);for(var r={files:[],config:null,path:e.id},a=0,s=Object.keys(n.text);a<s.length;a++){var c=s[a];n.text[c]!==n.fsText[c]&&r.files.push({name:c,mtime:null,content:n.text[c],prevContent:n.fsText[c]})}var l=f.flatClone(n.text);return 0==r.files.length?Promise.resolve():o("pkg/"+e.id,r).then(function(r){n.fsText=l,i(r),d.invalidate("header:"+e.id),d.invalidate("header:*"),t&&(d.invalidate("text:"+e.id),e.saveId=null)}).catch(function(e){return p.errorNotification(m("Save failed!"))})})):Promise.resolve()}function c(){return o("list").then(function(e){e.pkgs.forEach(i),d.invalidate("header:"),d.invalidate("text:")})}var l,u=e("./db"),p=e("./core"),d=e("./data"),f=pxt.Util,h=pxt.Cloud,m=f.lf,g=[],v=new f.PromiseQueue;n.provider={getHeaders:function(){return g.map(function(e){return e.header})},getHeader:function(e){var t=r(e);return t&&!t.header.isDeleted?t.header:null},getTextAsync:function(e){var t=r(e);return t?t.text?Promise.resolve(t.text):v.enqueue(e,function(){return a(t)}):Promise.resolve(null)},initAsync:function(e){return g=[],l=e,c().then(function(){})},saveAsync:function(e,t){return s(e,t)},installAsync:function(e,t){var n=e,o=n.name.replace(/[^a-zA-Z0-9]+/g," ").trim().replace(/ /g,"-");if(r(o)){for(var i=2;r(o+"-"+i);)i++;o+="-"+i,n.name+=" "+i}n.id=o,n.recentUse=f.nowSeconds(),n.modificationTime=n.recentUse,n.target=l;var a={id:n.id,header:n,text:t,fsText:{}};return g.push(a),s(n,t).then(function(){return n})},saveToCloudAsync:function(e){return Promise.resolve()},syncAsync:c,resetAsync:function(){return u.destroyAsync().then(function(){g=[],pxt.storage.clearLocal(),d.clearCache()})},saveScreenshotAsync:function(e,t,n){return o("screenshot/"+e.id,{screenshot:t,icon:n})}}},{"./core":13,"./data":14,"./db":15}],23:[function(e,t,n){"use strict";function r(e,t){if(t){var n=/```(blocks?|typescript)\s*((.|\s)+?)\s*```/i.exec(t);if(n)return{name:e,filesOverride:{"main.blocks":'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',"main.ts":n[2]}}}}function o(e){if(!e)return[];var t=[],n=!1,r=void 0,o="";return e.split(/\r?\n/).forEach(function(e){if(/^##/.test(e))r=e.substr(2).trim();else if(/^```codecard$/.test(e))n=!0;else if(/^```$/.test(e)){if(n=!1,r&&o)try{var i=JSON.parse(o);i&&i.length>0&&t.push({name:r,cards:i})}catch(e){pxt.log("invalid card format in gallery")}o="",r=void 0}else n&&(o+=e+"\n")}),t}n.loadGalleryAsync=function(e){return pxt.Cloud.downloadMarkdownAsync(e,pxt.Util.userLanguage(),pxt.Util.localizeLive).then(function(e){return o(e)})},n.loadExampleAsync=function(e,t){return pxt.Cloud.downloadMarkdownAsync(t,pxt.Util.userLanguage(),pxt.Util.localizeLive).then(function(t){return r(e,t)})}},{}],24:[function(e,t,n){"use strict";function r(e){var t=l.lookup(p,e.result.path);t?t.onOOB(e):console.error("Dropping data for "+e.result.path)}function o(){if(!a){if(!c.isLocalHost()||!c.localToken)return;pxt.debug("initializing hid pipe"),a=pxt.worker.makeWebSocket("ws://localhost:"+pxt.options.wsPort+"/"+c.localToken+"/hid",r)}}function i(){return pxt.HF2.mkPacketIOAsync().then(function(e){var t=new pxt.HF2.Wrapper(e);return t.reconnectAsync(!0).then(function(){return t})})}var a,s=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},c=pxt.Cloud,l=pxt.Util,u=function(e){function t(t){e.call(this,t),this.message=t}return s(t,e),t}(Error);n.HIDError=u;var p={};n.shouldUse=function(){var e=pxt.appTarget.serial;return e&&e.useHF2&&(c.isLocalHost()&&!!c.localToken||pxt.winrt.isWinRT())},pxt.HF2.mkPacketIOAsync=function(){o();var e=!1;pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(e=!0);var t=new f(e);return t.initAsync().then(function(){return t})};var d,f=function(){function e(e){var t=this;void 0===e&&(e=!1),this.rawMode=e,this.onData=function(e){},this.onEvent=function(e){},this.onError=function(e){},this.onSerial=function(e,t){},e&&(this.onEvent=function(e){return t.onData(e)})}return e.prototype.onOOB=function(e){"serial"==e.op?this.onSerial(l.fromHex(e.result.data),e.result.isError):(e.op="event")&&this.onEvent(l.fromHex(e.result.data))},e.prototype.talksAsync=function(e){return a.opAsync("talk",{path:this.dev.path,cmds:e.map(function(e){return{cmd:e.cmd,data:e.data?l.toHex(e.data):""}})}).then(function(e){return e.map(function(e){return l.fromHex(e.data)})})},e.prototype.error=function(e){throw new u(l.lf("USB/HID error on device {0} ({1})",this.dev.product,e))},e.prototype.reconnectAsync=function(){return this.initAsync()},e.prototype.disconnectAsync=function(){return a.opAsync("disconnect",{path:this.dev.path})},e.prototype.sendPacketAsync=function(e){if(this.rawMode)return a.opAsync("send",{path:this.dev.path,data:l.toHex(e),raw:!0});throw new Error("should use talksAsync()!")},e.prototype.sendSerialAsync=function(e,t){return a.opAsync("sendserial",{path:this.dev.path,data:l.toHex(e),isError:t})},e.prototype.initAsync=function(){var e=this;return a.opAsync("list",{}).then(function(t){var n=t.devices,r=n.filter(function(e){return 16896==(65280&e.release)})[0];if(pxt.appTarget.serial&&pxt.appTarget.serial.rawHID&&(r=n[0]),!r)throw new Error("No device connected");e.dev&&delete p[e.dev.path],e.dev=r,p[e.dev.path]=e}).then(function(){return a.opAsync("init",{path:e.dev.path,raw:e.rawMode})})},e}();n.initAsync=function(e){void 0===e&&(e=!1);var t=!1;d||(t=!0,d=i().catch(function(e){return d=null,Promise.reject(e)}));var n;return d.then(function(r){return n=r,e||pxt.winrt.isWinRT()&&!t?n.reconnectAsync():Promise.resolve()}).then(function(){return n})}},{}],25:[function(e,t,n){"use strict";var r=e("./data"),o=e("./memoryworkspace");n.provider={getHeaders:function(){return o.provider.getHeaders()},getHeader:function(e){return o.provider.getHeader(e)},getTextAsync:function(e){return o.provider.getTextAsync(e)},initAsync:function(e){return o.provider.initAsync(e)},saveAsync:function(e,t){return o.provider.saveAsync(e,t).then(function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacesave",project:{header:e,text:t},response:!1})}).then(function(){})},installAsync:function(e,t){return o.provider.installAsync(e,t)},saveToCloudAsync:function(e){return o.provider.saveToCloudAsync(e)},syncAsync:function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacesync",response:!0}).then(function(e){return(e.projects||[]).forEach(o.merge),r.invalidate("header:"),r.invalidate("text:"),e.editor})},resetAsync:function(){return o.provider.resetAsync().then(function(){return pxt.editor.postHostMessageAsync({type:"pxthost",action:"workspacereset",response:!0})}).then(function(){})}}},{"./data":14,"./memoryworkspace":28}],26:[function(e,t,n){"use strict";function r(){var e=new RegExp(pxt.Util.escapeForRegex(d)+"=(.*?)(?:;|$)").exec(document.cookie);return e&&e[1]||null}function o(e){if(p[e]&&e!==r()){pxt.tickEvent("menu.lang.setcookielang."+e);var t=new Date;t.setTime(t.getTime()+24*f*60*60*1e3),document.cookie=d+"="+e+"; expires="+t.toUTCString()}}var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},a=e("react"),s=e("./sui"),c=e("./codecard"),l=e("./data"),u=pxt.Util.lf,p={af:{englishName:"Afrikaans",localizedName:"Afrikaans"},ar:{englishName:"Arabic",localizedName:"العربية"},ca:{englishName:"Catalan",localizedName:"Català"},cs:{englishName:"Czech",localizedName:"Čeština"},da:{englishName:"Danish",localizedName:"Dansk"},de:{englishName:"German",localizedName:"Deutsch"},el:{englishName:"Greek",localizedName:"Ελληνικά"},en:{englishName:"English",localizedName:"English"},"es-ES":{englishName:"Spanish (Spain)",localizedName:"Español (España)"},fi:{englishName:"Finnish",localizedName:"Suomi"},fr:{englishName:"French",localizedName:"Français"},he:{englishName:"Hebrew",localizedName:"עברית"},hu:{englishName:"Hungarian",localizedName:"Magyar"},it:{englishName:"Italian",localizedName:"Italiano"},ja:{englishName:"Japanese",localizedName:"日本語"},ko:{englishName:"Korean",localizedName:"한국어"},nl:{englishName:"Dutch",localizedName:"Nederlands"},no:{englishName:"Norwegian",localizedName:"Norsk"},pl:{englishName:"Polish",localizedName:"Polski"},"pt-BR":{englishName:"Portuguese (Brazil)",localizedName:"Português (Brasil)"},"pt-PT":{englishName:"Portuguese (Portugal)",localizedName:"Português (Portugal)"},ro:{englishName:"Romanian",localizedName:"Română"},ru:{englishName:"Russian",localizedName:"Русский"},"si-LK":{englishName:"Sinhala (Sri Lanka)",localizedName:"සිංහල (ශ්රී ලංකා)"},sr:{englishName:"Serbian",localizedName:"Srpski"},"sv-SE":{englishName:"Swedish (Sweden)",localizedName:"Svenska (Sverige)"},tr:{englishName:"Turkish",localizedName:"Türkçe"},uk:{englishName:"Ukrainian",localizedName:"Українська"},vi:{englishName:"Vietnamese",localizedName:"Tiếng việt"},"zh-CN":{englishName:"Chinese (Simplified, China)",localizedName:"简体中文 (中国)"},"zh-TW":{englishName:"Chinese (Traditional, Taiwan)",localizedName:"中文 (台湾)"}},d="PXT_LANG",f=30,h=["en"];n.getCookieLang=r,n.setCookieLang=o;var m=function(e){function t(t){e.call(this,t),this.state={visible:!1}}return i(t,e),t.prototype.fetchLanguages=function(){if(pxt.appTarget.appTheme.selectLanguage){var e=this.getData("target-config:");return e?e.languages:void 0}},t.prototype.changeLanguage=function(e){p[e]&&(o(e),e!==n.initialLang?(pxt.tickEvent("menu.lang.changelang."+e),location.hash="#reload",location.reload()):(pxt.tickEvent("menu.lang.samelang."+e),this.hide()))},t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.renderCore=function(){var e=this;if(!this.state.visible)return a.createElement("div",null);var t=pxt.appTarget.appTheme,n=this.fetchLanguages(),r=n&&n.length?n:h,o=r.length>4?"large":"small";return a.createElement(s.Modal,{open:this.state.visible,header:u("Select Language"),size:o,onClose:function(){return e.hide()},dimmer:!0,closeIcon:!0,allowResetFocus:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},n?void 0:a.createElement("div",{className:"ui message info"},u("loading...")),n?a.createElement("div",{className:"group"},a.createElement("div",{className:"ui cards centered",role:"listbox"},r.map(function(t){return a.createElement(c.CodeCardView,{className:"card-selected focused",key:t,name:p[t].localizedName,ariaLabel:p[t].englishName,role:"option",description:p[t].englishName,onClick:function(){return e.changeLanguage(t)}})}))):void 0,a.createElement("p",null,a.createElement("br",null),a.createElement("br",null),a.createElement("a",{href:"https://crowdin.com/project/"+t.crowdinProject,target:"_blank","aria-label":u("Help us translate")},u("Help us translate"))))},t}(l.Component);n.LanguagePicker=m},{"./codecard":10,"./data":14,"./sui":44,react:277}],27:[function(e,t,n){"use strict";var r=e("./package"),o=e("./core"),i=e("./compiler");n.makeAsync=function(){return i.compileAsync({native:!0}).then(function(e){var t=r.mainEditorPkg(),n=t.files["main.ts"],i={name:t.header.name||lf("Untitled"),code:n?n.content:'basic.showString("Hi!");',board:JSON.stringify(pxt.appTarget.simulator.boardDefinition)},a=ts.pxtc.computeUsedParts(e);a.length&&(i.parts=a.join(" "),i.partdefs=JSON.stringify(r.mainPkg.computePartDefinitions(a)));var s=e.usedArguments;s&&(i.fnArgs=JSON.stringify(s)),i.package=Util.values(r.mainPkg.deps).filter(function(e){return"this"!=e.id}).map(function(e){return e.id+"="+e._verspec}).join("\n");var c=Object.keys(i).map(function(e){return e+"="+encodeURIComponent(i[e])}).join("&"),l=pxt.webConfig.partsUrl+"?"+c;return o.dialogAsync({hideCancel:!0,header:lf("Make"),size:"large",htmlBody:'\n        <div class="ui container">\n            <div style="position:relative;height:0;padding-bottom:40%;overflow:hidden;">\n                <iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="'+l+'" sandbox="allow-popups allow-forms allow-scripts allow-same-origin"\n                    frameborder="0"></iframe>\n            </div>\n        </div>',buttons:[{label:lf("Open"),url:l,icon:"external"}]})}).then(function(e){})}},{"./compiler":11,"./core":13,"./package":32}],28:[function(e,t,n){"use strict";function r(e,t){return n.projects[e.id]={header:e,text:t},Promise.resolve()}var o=pxt.Util;n.projects={};var i="";n.merge=function(e){var t=e.header;t||(e.header=t={id:o.guidGen(),recentUse:o.nowSeconds(),modificationTime:o.nowSeconds(),target:i,_rev:void 0,blobId:void 0,blobCurrent:void 0,isDeleted:!1,name:lf("Untitled"),meta:{},editor:pxt.BLOCKS_PROJECT_NAME,pubId:void 0,pubCurrent:void 0}),n.projects[e.header.id]=e},n.provider={getHeaders:function(){return Util.values(n.projects).map(function(e){return e.header})},getHeader:function(e){var t=n.projects[e];return t?t.header:void 0},getTextAsync:function(e){var t=n.projects[e];return Promise.resolve(t?t.text:void 0)},initAsync:function(e){return i=e,Promise.resolve()},saveAsync:r,installAsync:function(e,t){var n=e;return n.id=o.guidGen(),n.recentUse=o.nowSeconds(),n.modificationTime=n.recentUse,n.target=pxt.appTarget.id,r(n,t).then(function(){return n})},saveToCloudAsync:function(e){return Promise.resolve()},syncAsync:function(){return Promise.resolve(void 0)},resetAsync:function(){return n.projects={},i="",Promise.resolve()}}},{}],29:[function(e,t,n){"use strict";var r,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=e("react"),a=e("./package"),s=e("./core"),c=e("./srceditor"),l=e("./compiler"),u=e("./sui"),p=e("./data"),d=e("./monacoSnippets"),f=pxt.Util,h=f.lf;!function(e){e[e.Unknown=0]="Unknown",e[e.TypeScript=1]="TypeScript",e[e.Markdown=2]="Markdown"}(r||(r={}));var m=function(e){function t(){var t=this;e.apply(this,arguments),this.fileType=r.Unknown,this.giveFocusOnLoading=!1,this.dragCurrentPos={x:0,y:0},this.onDragBlockThrottled=f.throttle(function(){var e=t.dragCurrentPos,n=e.x,r=e.y,o=t.editor.getTargetAtClientPoint(n,r).position;o&&t.editor.getPosition()!=o&&t.editor.setPosition(o),t.editor.focus()},200),this.highlightDecorations=[]}return o(t,e),t.prototype.hasBlocks=function(){if(!this.currFile)return!0;var e=this.currFile.getVirtualFileName();return e&&null!=a.mainEditorPkg().files[e]},t.prototype.openBlocks=function(){var e=this;pxt.tickEvent("typescript.showBlocks");var t=this.parent.state.header;t&&(t.editor=pxt.BLOCKS_PROJECT_NAME,t.pubCurrent=!1);var n=Promise.resolve().then(function(){if(e.hasBlocks()){var t=e.currFile.getVirtualFileName();if(!t){var n=a.mainEditorPkg();if(!n||!n.files["main.blocks"])return void(n&&e.parent.setFile(n.files["main.ts"]));e.currFile=n.files["main.ts"],t=e.currFile.getVirtualFileName()}var r,o,i=function(t,n){return void 0===n&&(n=!1),s.cancelAsyncLoading("switchtoblocks"),e.forceDiagnosticsUpdate(),e.showConversionFailedDialog(t,n)},c=a.mainEditorPkg();return e.parent.saveFileAsync().then(function(){return l.getBlocksAsync()}).then(function(n){o=n,pxt.blocks.initBlocks(o);var r=pxt.blocks.loadWorkspaceXml(c.files[t].content);return r?pxt.blocks.compileAsync(r,o).then(function(n){var o=n.source;return l.formatAsync(o,0).then(function(n){return l.formatAsync(e.editor.getValue(),0).then(function(o){return n.formatted==o.formatted?(pxt.debug("js not changed, skipping decompile"),pxt.tickEvent("typescript.noChanges"),e.parent.setFile(c.files[t]),[r,!1]):[r,!0]})})}):[r,!0]}).then(function(n){if(!n)return Promise.resolve();var a=n[0];return n[1]?l.decompileAsync(e.currFile.name,o,a,t).then(function(n){if(!n.success){e.currFile.diagnostics=n.diagnostics;var o=!1;return n.diagnostics.forEach(function(e){return o=o||9266===e.code}),i(t,o)}return r=n.outfiles[t],f.assert(!!r),c.setContentAsync(t,r).then(function(){return e.parent.setFile(c.files[t])})}):Promise.resolve()}).catch(function(e){pxt.reportException(e),s.errorNotification(h("Oops, something went wrong trying to convert your code."))})}});s.showLoadingAsync("switchtoblocks",h("switching to blocks..."),n).done()},t.prototype.showConversionFailedDialog=function(e,t){var n=this,r=a.mainEditorPkg().files[e];return t&&pxt.tickEvent("typescript.programTooLarge"),s.confirmAsync({header:h(t?"Program too large":"Oops, there is a problem converting your code."),body:h(t?"Your program is too large to convert into blocks. You can keep working in JavaScript or discard your changes and go back to the previous Blocks version.":"We are unable to convert your JavaScript code back to blocks. You can keep working in JavaScript or discard your changes and go back to the previous Blocks version."),agreeLbl:h("Discard and go to Blocks"),agreeClass:"cancel",agreeIcon:"cancel",disagreeLbl:h("Stay in JavaScript"),disagreeClass:"positive",disagreeIcon:"checkmark",size:"medium",hideCancel:!r}).then(function(e){e?(pxt.tickEvent("typescript.discardText"),n.parent.saveBlocksToTypeScriptAsync().then(function(e){n.overrideFile(e),n.parent.setFile(r)})):pxt.tickEvent("typescript.keepText")})},t.prototype.decompileAsync=function(e){return l.decompileAsync(e)},t.prototype.display=function(){var e=this;return i.createElement("div",{id:"monacoEditorArea",className:"full-abs"},i.createElement(g,{ref:function(t){return e.monacoToolbox=t},parent:this}),i.createElement("div",{id:"monacoEditorInner"}))},t.prototype.addPackage=function(){pxt.tickEvent("monaco.addpackage"),this.hideFlyout(),this.parent.addPackage()},t.prototype.defineEditorTheme=function(e,t){var n=this,r=pxt.appTarget.appTheme.invertedMonaco,o=[];!e&&t&&(this.getNamespaces().forEach(function(e){var t=n.getNamespaceAttrs(e),i=d.isBuiltin(e)?d.getBuiltinCategory(e).blocks:n.nsMap[e];if(t.color&&i){var a=pxt.blocks.convertColour(t.color);a=(r?Blockly.PXTUtils.fadeColour(a,.6,!0):a).replace("#",""),i.forEach(function(e){o.push({token:"identifier.ts "+e.name,foreground:a})}),o.push({token:"identifier.ts "+e,foreground:a})}}),o.push({token:"identifier.ts if",foreground:"5B80A5"}),o.push({token:"identifier.ts else",foreground:"5B80A5"}),o.push({token:"identifier.ts while",foreground:"5BA55B"}),o.push({token:"identifier.ts for",foreground:"5BA55B"}));var i=pxt.appTarget.appTheme.monacoColors||{};monaco.editor.defineTheme("pxtTheme",{base:e?"hc-black":r?"vs-dark":"vs",inherit:!0,rules:o,colors:e?{}:i}),monaco.editor.setTheme("pxtTheme")},t.prototype.setHighContrast=function(e){this.defineEditorTheme(e)},t.prototype.beforeCompile=function(){this.editor&&this.editor.getAction("editor.action.formatDocument").run()},t.prototype.textAndPosition=function(e){for(var t=this.editor.getValue(),n=e.lineNumber,r=e.column,o=0;o<t.length;++o)if(0==n){if(0==r--)break}else"\n"==t[o]&&n--;return{programText:t,charNo:o}},t.prototype.isIncomplete=function(){return!(!this.editor||!this.editor._view)&&this.editor._view.contentWidgets._widgets["editor.widget.suggestWidget"].isVisible},t.prototype.resize=function(e){var t=document.getElementById("monacoEditorArea"),n=this.monacoToolbox&&this.monacoToolbox.getElement();if(t&&this.editor){var r=n&&n.offsetWidth||0;this.editor.layout({width:t.offsetWidth-r,height:t.offsetHeight});var o=this.editor._themeService._theme.colors["editor.background"].rgba;this.parent.updateEditorLogo(r,"rgba("+o.r+","+o.g+","+o.b+","+o.a+")");var i=this.editor?this.editor.getLayoutInfo().contentHeight:0;this.monacoToolbox&&this.monacoToolbox.setToolboxHeight(i)}},t.prototype.prepare=function(){this.isReady=!0},t.prototype.loadMonacoAsync=function(){var e=this;if(this.editor||this.loadingMonaco)return Promise.resolve();this.loadingMonaco=!0,this.extraLibs=Object.create(null);var t=document.getElementById("monacoEditorArea"),n=document.getElementById("monacoEditorInner");return pxt.vs.initMonacoAsync(n).then(function(n){if(e.editor=n,e.loadingMonaco=!1,e.editor.updateOptions({fontSize:e.parent.settings.editorFontSize}),e.editor.addAction({id:"save",label:h("Save"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_S],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.2,run:function(){return Promise.resolve(e.parent.typecheckNow())}}),e.editor.addAction({id:"runSimulator",label:h("Run Simulator"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.Enter],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.21,run:function(){return Promise.resolve(e.parent.runSimulator())}}),pxt.appTarget.compile&&pxt.appTarget.compile.hasHex&&e.editor.addAction({id:"compileHex",label:h("Download"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyMod.Alt|monaco.KeyCode.Enter],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",contextMenuGroupId:"0_pxtnavigation",contextMenuOrder:.22,run:function(){return Promise.resolve(e.parent.compile())}}),e.editor.addAction({id:"zoomIn",label:h("Zoom In"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.NUMPAD_ADD,monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_EQUAL],run:function(){return Promise.resolve(e.zoomIn())}}),e.editor.addAction({id:"zoomOut",label:h("Zoom Out"),keybindings:[monaco.KeyMod.CtrlCmd|monaco.KeyCode.NUMPAD_SUBTRACT,monaco.KeyMod.CtrlCmd|monaco.KeyCode.US_MINUS],run:function(){return Promise.resolve(e.zoomOut())}}),pxt.appTarget.appTheme.hasReferenceDocs){var r=e.editor.createContextKey("editorHasReference",!1);e.editor.addAction({id:"reference",label:h("Help"),keybindingContext:"!editorReadonly && editorHasReference",precondition:"!editorReadonly && editorHasReference",contextMenuGroupId:"navigation",contextMenuOrder:.1,run:function(){return Promise.resolve(e.loadReference())}}),e.editor.onDidChangeCursorPosition(function(t){var n=e.editor.getModel().getWordUntilPosition(t.position);n&&""!=n.word?r.set(!0):r.reset()})}var o=f.isUserLanguageRtl()?monaco.KeyCode.RightArrow:monaco.KeyCode.LeftArrow;e.editor.addAction({id:"jumptoolbox",label:h("Jump to Toolbox"),keybindings:[monaco.KeyMod.CtrlCmd|o],keybindingContext:"!editorReadonly",precondition:"!editorReadonly",run:function(){return Promise.resolve(e.moveFocusToToolbox())}}),e.editor.onDidLayoutChange(function(t){var n=e.editor.getConfiguration().fontInfo.fontSize;e.parent.settings.editorFontSize!=n&&(e.parent.settings.editorFontSize=n,e.forceDiagnosticsUpdate());var r=document.getElementById("monacoEditorToolbox");r&&(r.style.height=e.editor.getLayoutInfo().contentHeight+"px");var o=document.getElementById("monacoFlyoutWidget");o&&(o.style.height=e.editor.getLayoutInfo().contentHeight+"px")});var i=document.getElementById("monacoEditorInner");i.ondragenter=function(e){e.preventDefault(),e.stopPropagation()},i.ondragover=function(t){t.preventDefault(),t.stopPropagation(),e.dragCurrentPos={x:t.clientX,y:t.clientY},e.onDragBlockThrottled(t)},i.ondrop=function(t){var n=t.dataTransfer.getData("text");if(n){t.preventDefault(),t.stopPropagation();var r=e.editor.getTargetAtClientPoint(t.clientX,t.clientY).position,o=e.editor.getModel(),i=e.editor.getPosition(),a=o.getOffsetAt(i);r||(r=i),(n=i.column>1?"\n"+n:void 0!=o.getWordUntilPosition(i)&&""!=o.getWordUntilPosition(i).word?n+"\n":n).indexOf("{{}}")>-1?(a+=n.indexOf("{{}}"),n=n.replace("{{}}","")):a+=n.length,e.editor.pushUndoStop(),e.editor.executeEdits("",[{identifier:{major:0,minor:0},range:new monaco.Range(r.lineNumber,r.column,r.lineNumber,r.column),text:n,forceMoveMarkers:!0,isAutoWhitespaceEdit:!0}]),e.beforeCompile(),e.editor.pushUndoStop();var s=o.getPositionAt(a);e.editor.setPosition(s),e.editor.focus()}},e.editor.onDidFocusEditorText(function(){e.hideFlyout()}),e.editorViewZones=[],e.setupToolbox(t)})},t.prototype.undo=function(){this.editor&&this.editor.trigger("keyboard","undo",null)},t.prototype.redo=function(){this.editor&&this.editor.trigger("keyboard","redo",null)},t.prototype.zoomIn=function(){if(this.editor&&!(this.parent.settings.editorFontSize>=40)){var e=this.editor.getConfiguration().fontInfo.fontSize;this.parent.settings.editorFontSize=e+1,this.editor.updateOptions({fontSize:this.parent.settings.editorFontSize}),this.forceDiagnosticsUpdate()}},t.prototype.zoomOut=function(){if(this.editor&&!(this.parent.settings.editorFontSize<=10)){var e=this.editor.getConfiguration().fontInfo.fontSize;this.parent.settings.editorFontSize=e-1,this.editor.updateOptions({fontSize:this.parent.settings.editorFontSize}),this.forceDiagnosticsUpdate()}},t.prototype.loadReference=function(){f.assert(void 0!=this.editor);var e=this.editor.getPosition(),t=this.editor.getModel().getWordAtPosition(e);if(t){var n=this.editor.getModel().getWordUntilPosition(new monaco.Position(e.lineNumber,t.startColumn-1));if(n&&t){var r=n.word.replace(/([A-Z]+)/g,"-$1"),o=t.word.replace(/([A-Z]+)/g,"-$1");this.parent.setSideDoc("/reference/"+r+"/"+o,!1)}else if(t){o=t.word.replace(/([A-Z]+)/g,"-$1");this.parent.setSideDoc("/reference/"+o,!1)}}},t.prototype.setupToolbox=function(e){var t={getId:function(){return"pxt.flyout.widget"},getDomNode:function(){return this.domNode||(this.domNode=document.createElement("div"),this.domNode.id="monacoFlyoutWidget",this.domNode.style.top="0",this.domNode.className="monacoFlyout",this.domNode.style.display="none",this.domNode.textContent="Flyout"),this.domNode},getPosition:function(){return null}};this.editor.addOverlayWidget(t)},t.prototype.closeFlyout=function(){this.editor&&this.hideFlyout()},t.prototype.hideFlyout=function(){var e=document.getElementById("monacoFlyoutWidget");e.innerHTML="",e.style.display="none",this.monacoToolbox.clearSelection(),this.parent.setState({hideEditorFloats:!1})},t.prototype.showFlyout=function(e,t,n,r,o,i){if(this.editor){var a=document.getElementById("monacoFlyoutWidget"),s=this.parent.settings.editorFontSize;a.style.left=this.editor.getLayoutInfo().lineNumbersLeft+"px",a.style.height=this.editor.getLayoutInfo().contentHeight+"px",a.style.display="block",a.className="monacoFlyout",a.style.transform="none",a.innerHTML="";var c;if(d.isBuiltin(e)){var l=d.getBuiltinCategory(e),u=l.blocks||[];l.name;if(u.forEach(function(e){e.noNamespace=!0}),!l.custom&&this.nsMap[e.toLowerCase()]&&(u=u.concat(this.nsMap[e.toLowerCase()].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)}))),!u||!u.length)return;c=u}else c=this.nsMap[e].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)});if(!pxt.appTarget.appTheme.hideFlyoutHeadings){var p=document.createElement("div");p.className="monacoFlyoutLabel monacoFlyoutHeading";var h=document.createElement("span"),m=("blocklyTreeIcon"+(n?(e||n).toLowerCase():"Default")).replace(/\s/g,"");h.className="monacoFlyoutHeadingIcon blocklyTreeIcon "+m,h.setAttribute("role","presentation"),h.style.display="inline-block",h.style.color=""+t;var g=document.createElement("div");g.className="monacoFlyoutHeadingText",g.style.display="inline-block",g.style.fontSize=s+5+"px",g.textContent=r||""+f.capitalize(e),p.appendChild(h),p.appendChild(g),a.appendChild(p)}var v={},y=[];o&&(y=o);for(var b=0;b<c.length;++b){var _=c[b];v[w=_.attributes.group||"other"]||(v[w]=[]),v[w].push(_)}Object.keys(v).sort().forEach(function(e){-1==y.indexOf(e)&&y.push(e)});for(var E=0;E<y.length;++E){var w=y[E];if("other"!=w){var k=document.createElement("div");k.className="monacoFlyoutLabel blocklyFlyoutGroup";var x=document.createElement("div");x.className="monacoFlyoutLabelText",x.style.display="inline-block",x.style.fontSize=s+"px",x.textContent=pxt.Util.rlf("{id:group}"+w),k.appendChild(x),a.appendChild(k);var C=document.createElement("hr");C.className="monacoFlyoutLabelLine",C.align="left",C.style.width=Math.min(parseInt(i)||x.offsetWidth,350)+"px",k.appendChild(C)}if(v[w]){var S=this.parent.state.editorState?this.parent.state.editorState.filters:void 0,N=S?S.namespaces&&void 0!=S.namespaces[e]?S.namespaces[e]:S.defaultState:void 0;this.createMonacoBlocks(this,a,e,v[w],t,S,N)}}this.parent.setState({hideEditorFloats:!0})}},t.prototype.moveFocusToToolbox=function(){this.monacoToolbox&&this.monacoToolbox.focus()},t.prototype.moveFocusToFlyout=function(){var e=document.getElementById("monacoFlyoutWidget").getElementsByClassName("monacoDraggableBlock")[0];e&&e.focus()},t.prototype.updateToolbox=function(){var e=this;if(pxt.appTarget.appTheme.monacoToolbox&&!pxt.shell.isReadOnly()){this.editor.getLayoutInfo().glyphMarginLeft=200,this.editor.layout();var t=this.getNamespaces().map(function(t){return[t,e.getNamespaceAttrs(t)]});this.monacoToolbox.setState({namespaces:t,showAdvanced:this.showAdvanced})}},t.prototype.getNamespaceAttrs=function(e){var t=d.getBuiltinCategory(e);if(t)return t.attributes.color=pxt.blocks.getNamespaceColor(t.nameid),t.attributes;var n=this.blockInfo.apis.byQName[e];return n&&n.attributes.color?n.attributes:void 0},t.prototype.getNamespaces=function(){var e=this,t=Object.keys(this.nsMap).filter(function(t){return!d.isBuiltin(t)&&!!e.getNamespaceAttrs(t)}),n=pxt.appTarget.runtime||{};return n.loopsBlocks&&!d.loops.removed&&t.push(d.loops.nameid),n.logicBlocks&&!d.logic.removed&&t.push(d.logic.nameid),n.variablesBlocks&&!d.variables.removed&&t.push(d.variables.nameid),n.mathBlocks&&!d.maths.removed&&t.push(d.maths.nameid),n.functionBlocks&&!d.functions.removed&&t.push(d.functions.nameid),n.textBlocks&&!d.text.removed&&t.push(d.text.nameid),n.listsBlocks&&!d.arrays.removed&&t.push(d.arrays.nameid),t},t.prototype.createMonacoBlocks=function(e,t,n,r,o,i,a){var s=this,c=0,l=r.sort(function(e,t){return(t.attributes.weight||50)+(t.attributes.advanced?0:1e3)-((e.attributes.weight||50)+(e.attributes.advanced?0:1e3))}).map(function(r){var l=!1,u=i?i.fns&&void 0!=i.fns[r.name]?i.fns[r.name]:void 0!=a?a:i.defaultState:void 0;if(l=u==pxt.editor.FilterState.Disabled,u!=pxt.editor.FilterState.Hidden){var p=document.createElement("div");p.className="monacoBlock "+(l?"monacoDisabledBlock":""),t.appendChild(p);var d=document.createElement("div");d.className="monacoDraggableBlock",d.tabIndex=0,p.appendChild(d);var h=r.snippet,m=r.attributes.jsDoc,g=r.noNamespace?"":n,v=!1,y=r;if(y.attributes.block)if(y.attributes.defaultInstance)g=y.attributes.defaultInstance;else if(y.kind==pxtc.SymbolKind.Method||y.kind==pxtc.SymbolKind.Property){var b=pxt.blocks.parameterNames(y);g=b.attrNames.this.name,v=!0}else if(y.namespace){var _=s.blockInfo.apis.byQName[y.namespace];if(_.kind===pxtc.SymbolKind.Class)return;if(_.attributes.fixedInstances){var E=f.values(s.blockInfo.apis.byQName).filter(function(e){return e.kind===pxtc.SymbolKind.Variable&&e.attributes.fixedInstance&&e.retType===_.name}).sort(function(e,t){return e.name.localeCompare(t.name)});E.length&&(g=E[0].namespace+"."+E[0].name)}}var w=document.createElement("span");if(r.snippetOnly||(w.className="sig"),w.textContent=h.replace(/^[^(]*\(/,"(").replace(/^\s*\{\{\}\}\n/gm,"").replace(/\{\n\}/g,"{}").replace(/(?:\{\{)|(?:\}\})/g,""),d.title=m,!l){d.draggable=!0,d.onclick=function(t){pxt.tickEvent("monaco.toolbox.itemclick"),e.hideFlyout();var n=e.editor.getModel(),r=e.editor.getPosition(),o=n.getOffsetAt(r),i=g?g+"."+h:h;(i=r.column>1?"\n"+i:void 0!=n.getWordUntilPosition(r)&&""!=n.getWordUntilPosition(r).word?i+"\n":i).indexOf("{{}}")>-1?(o+=i.indexOf("{{}}"),i=i.replace("{{}}","")):o+=i.length,i=i.replace(/(?:\{\{)|(?:\}\})/g,""),e.editor.pushUndoStop(),e.editor.executeEdits("",[{identifier:{major:0,minor:0},range:new monaco.Range(r.lineNumber,r.column,r.lineNumber,r.column),text:i,forceMoveMarkers:!1}]),e.beforeCompile(),e.editor.pushUndoStop();var a=n.getPositionAt(o);e.editor.setPosition(a),e.editor.focus()},d.ondragstart=function(e){pxt.tickEvent("monaco.toolbox.itemdrag");d.cloneNode(!0);setTimeout(function(){t.style.transform="translateX(-9999px)"});var n=g?g+"."+h:h;e.dataTransfer.setData("text",n)},d.ondragend=function(n){t.style.transform="none",e.hideFlyout()};var k=function(){d.style.backgroundColor=l?""+Blockly.PXTUtils.fadeColour(o||"#ddd",.8,!1):""+Blockly.PXTUtils.fadeColour(o||"#ddd",.1,!1)},x=function(){d.style.backgroundColor=l?""+Blockly.PXTUtils.fadeColour(o||"#ddd",.8,!1):""+o};d.onmouseenter=function(e){k()},d.onmouseleave=function(e){x()},d.onfocus=function(e){k()},d.onblur=function(e){x()}}if(!r.snippetOnly){if(v){var C=document.createElement("span");C.textContent=g+".",C.className="sigPrefix",d.appendChild(C)}var S=document.createElement("span");S.textContent=r.name,d.appendChild(S)}if(d.appendChild(w),d.style.fontSize=e.parent.settings.editorFontSize+"px",d.style.backgroundColor=l?""+Blockly.PXTUtils.fadeColour(o||"#ddd",.8,!1):""+o,d.style.borderColor=""+Blockly.PXTUtils.fadeColour(o||"#ddd",.2,!1),r.retType&&"boolean"==r.retType){d.style.borderRadius="0px";var N=d.offsetHeight-2,T=c++;d.id="monacoHexBlock"+T,d.className+=" monacoHexBlock";var O=document.createElement("style");O.innerHTML="\n                        #monacoHexBlock"+T+":before,\n                        #monacoHexBlock"+T+":after {\n                            border-top: "+N/2+"px solid transparent;\n                            border-bottom: "+N/2+"px solid transparent;\n                        }\n                        #monacoHexBlock"+T+":before {\n                            border-right: 17px solid "+o+";\n                        }\n                        #monacoHexBlock"+T+":after {\n                            border-left: 17px solid "+o+";\n                        }\n                    ",p.insertBefore(O,d)}else r.retType&&"void"!=r.retType?d.style.borderRadius="40px":d.style.borderRadius="3px";return d}});l.forEach(function(t,n){var r=f.isUserLanguageRtl();t.onkeydown=function(t){var o="number"==typeof t.which?t.which:t.keyCode;40==o?n<l.length-1&&l[n+1].focus():38==o?n>0&&l[n-1].focus():37==o&&!r||38==o&&r?e.moveFocusToToolbox():27==o?(e.hideFlyout(),e.moveFocusToToolbox()):u.fireClickOnEnter.call(s,t)}})},t.prototype.getId=function(){return"monacoEditor"},t.prototype.getViewState=function(){return this.editor?this.editor.getPosition():{}},t.prototype.getCurrentSource=function(){return this.editor?this.editor.getValue():this.currSource},t.prototype.acceptsFile=function(e){return!0},t.prototype.setValue=function(e){this.editor.setValue(e)},t.prototype.overrideFile=function(e){f.assert(void 0!=this.editor),this.editor.setValue(e)},t.prototype.loadFileAsync=function(e,t){var n=this,o="text";this.currSource=e.content;var i=document.createElement("div");i.className="ui inverted loading dimmer active";var s=document.getElementById("monacoEditorArea"),c=document.getElementById("monacoEditorInner");return s.insertBefore(i,c),this.loadMonacoAsync().then(function(){if(n.editor){var i=e.getExtension(),s={cpp:"cpp",h:"cpp",json:"json",md:"text",ts:"typescript",js:"javascript",svg:"xml",blocks:"xml",asm:"asm"};s.hasOwnProperty(i)&&(o=s[i]);var c=e.isReadonly()||pxt.shell.isReadOnly();n.editor.updateOptions({readOnly:c});var l="pkg:"+e.getName(),u=monaco.editor.getModels().filter(function(e){return e.uri.toString()==l})[0];u||(u=monaco.editor.createModel(a.mainPkg.readFile(e.getName()),o,monaco.Uri.parse(l))),u&&n.editor.setModel(u),n.defineEditorTheme(t),"typescript"==o&&n.beginLoadToolbox(e,t),n.currFile=e,n.setValue(e.content),n.setDiagnostics(e,n.snapshotState()),n.fileType="typescript"==o?r.TypeScript:"md"==i?r.Markdown:r.Unknown,n.fileType==r.Markdown&&n.parent.setSideMarkdown(e.content),n.currFile.setForceChangeCallback(function(e,t){e!=t&&(pxt.debug("File changed (from "+e+", to "+t+"). Reloading editor"),n.loadFileAsync(n.currFile))}),e.isReadonly()||u.onDidChangeContent(function(e){n.clearHighlightedStatements();var t=n.editorViewZones||[];n.editor.changeViewZones(function(e){t.forEach(function(t){e.removeZone(t)})}),n.editorViewZones=[],e.isRedoing||e.isUndoing||n.editor.getValue()||n.editor.setValue(" "),n.updateDiagnostics(),n.changeCallback()}),"typescript"!=o||e.isReadonly()?n.monacoToolbox.hide():n.monacoToolbox.show(),n.resize(),n.hideFlyout(),n.giveFocusOnLoading&&n.editor.focus()}}).finally(function(){s.removeChild(i)})},t.prototype.beginLoadToolbox=function(e,t){var n=this;l.getBlocksAsync().then(function(r){n.blockInfo=r,n.nsMap=n.partitionBlocks(),n.updateToolbox(),n.resize(),pxt.vs.syncModels(a.mainPkg,n.extraLibs,e.getName(),e.isReadonly()),n.defineEditorTheme(t,!0)})},t.prototype.unloadFileAsync=function(){return this.currFile&&this.currFile.getName()=="this/"+pxt.CONFIG_NAME?this.parent.reloadHeaderAsync():Promise.resolve()},t.prototype.snapshotState=function(){return this.editor&&this.editor.getModel()?this.editor.getModel().getLinesContent():null},t.prototype.setViewState=function(e){this.editor&&e&&0!==Object.keys(e).length&&(this.editor.setPosition(e),this.editor.setScrollPosition(e))},t.prototype.setDiagnostics=function(e,t){f.assert(void 0!=this.editor),f.assert(this.currFile==e),this.diagSnapshot=t,this.forceDiagnosticsUpdate()},t.prototype.updateDiagnostics=function(){this.needsDiagUpdate()&&this.forceDiagnosticsUpdate()},t.prototype.needsDiagUpdate=function(){if(!this.annotationLines)return!1;for(var e=this.editor.getModel().getLinesContent(),t=0,n=this.annotationLines;t<n.length;t++){var r=n[t];if(this.diagSnapshot[r]!==e[r])return!0}return!1},t.prototype.forceDiagnosticsUpdate=function(){if(this.fileType==r.TypeScript){var e=this.currFile,t=[];if(e&&e.diagnostics){for(var n=monaco.editor.getModel(monaco.Uri.parse("pkg:"+e.getName())),o=0,i=e.diagnostics;o<i.length;o++)!function(e){function r(n){t.push({severity:monaco.Severity.Error,message:n,startLineNumber:e.line+1,startColumn:e.column,endLineNumber:void 0==e.endLine?o.lineNumber:e.endLine+1,endColumn:void 0==e.endColumn?o.column:e.endColumn})}var o=n.getPositionAt(e.start+e.length);if("string"==typeof e.messageText)r(e.messageText);else for(var i=e.messageText;void 0!=i.next;)r(i.messageText),i=i.next}(i[o]);monaco.editor.setModelMarkers(n,"typescript",t)}}},t.prototype.highlightStatement=function(e){if(e&&this.currFile&&this.currFile.name==e.fileName&&this.editor){var t=this.editor.getModel().getPositionAt(e.start),n=this.editor.getModel().getPositionAt(e.start+e.length);t&&n&&(this.highlightDecorations=this.editor.deltaDecorations(this.highlightDecorations,[{range:new monaco.Range(t.lineNumber,t.column,n.lineNumber,n.column),options:{inlineClassName:"highlight-statement"}}]))}},t.prototype.clearHighlightedStatements=function(){this.highlightDecorations&&this.editor.deltaDecorations(this.highlightDecorations,[])},t.prototype.partitionBlocks=function(){var e={};return this.blockInfo.blocks.forEach(function(t){var n=(t.attributes.blockNamespace||t.namespace).split(".")[0];e[n]||(e[n]=[]),e[n].push(t)}),e},t}(c.Editor);n.Editor=m;var g=function(e){function t(t){e.call(this,t),this.state={showAdvanced:!1}}return o(t,e),t.prototype.getElement=function(){return this.rootElement},t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.setToolboxHeight=function(e){this.rootElement&&(this.rootElement.style.height=e+"px")},t.prototype.clearSelection=function(){this.setState({selectedNs:void 0}),this.selectedIndex=0},t.prototype.setSelectedItem=function(e){this.selectedItem=e},t.prototype.setPreviousItem=function(){if(this.selectedIndex>0){var e=--this.selectedIndex;this.setSelection(this.items[e],e)}},t.prototype.setNextItem=function(){if(this.items.length-1>this.selectedIndex){var e=++this.selectedIndex;this.setSelection(this.items[e],e)}},t.prototype.setSelection=function(e,t){var n=this.props.parent,r=e.ns,o=e.icon,i=e.color,a=e.category,s=e.groups,c=e.labelLineWidth;pxt.tickEvent("monaco.toolbox.click"),this.state.selectedNs==r?(this.clearSelection(),n.closeFlyout()):(this.setState({selectedNs:r}),this.selectedIndex=t,e.advanced&&!this.state.showAdvanced&&this.showAdvanced(),n.showFlyout(r,i,o,a,s,c))},t.prototype.focus=function(){if(this.rootElement)if(this.selectedItem&&this.selectedItem.getTreeRow())this.selectedItem.getTreeRow().focus();else{var e=this.rootElement.getElementsByClassName("blocklyTreeRow")[0];e&&e.focus()}},t.prototype.moveFocusToFlyout=function(){this.props.parent.moveFocusToFlyout()},t.prototype.closeFlyout=function(){this.props.parent.closeFlyout()},t.prototype.addPackage=function(){this.props.parent.addPackage()},t.prototype.componentDidUpdate=function(e,t){pxt.blocks.injectToolboxIconCss()},t.prototype.advancedClicked=function(){pxt.tickEvent("monaco.advanced"),this.showAdvanced()},t.prototype.showAdvanced=function(){var e=this.props.parent;this.setState({showAdvanced:!this.state.showAdvanced}),e.resize()},t.prototype.renderCore=function(){function e(e,t){if(!t||!t.length)return!1;var n=u?u.namespaces&&void 0!=u.namespaces[e]?u.namespaces[e]:u.defaultState:void 0,r=!1;return u&&void 0!==n&&t?Object.keys(t).forEach(function(e){var t=u.fns&&void 0!=u.fns[e]?u.fns[e]:void 0!=n?n:u.defaultState;t!=pxt.editor.FilterState.Disabled&&t!=pxt.editor.FilterState.Visible||(r=!0)}):r=!0,!!r}function t(t,n){return t.sort(function(e,t){var n=e[1],r=t[1];return(r?r.weight||50:50)-(n?n.weight||50:50)}).map(function(t){var o=t[0],i=t[1];if(d.isBuiltin(o)){var a=d.getBuiltinCategory(o),s=a.blocks||[],c=a.name;if(s.forEach(function(e){e.noNamespace=!0}),!a.custom&&r.nsMap[o.toLowerCase()]&&(s=s.concat(r.nsMap[o.toLowerCase()].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)}))),!e(o,s))return;return{ns:o,category:c,color:i.color,icon:i.icon,groups:i.groups,labelLineWidth:i.labelLineWidth,advanced:n,index:p++}}if(e(o,r.nsMap[o].filter(function(e){return!(e.attributes.blockHidden||e.attributes.deprecated)})))return{ns:o,category:c=i.block?i.block:void 0,color:i.color,icon:i.icon,groups:i.groups,labelLineWidth:i.labelLineWidth,injectIconClass:!0,advanced:n,index:p++}}).filter(function(e){return!!e})}var n=this,r=this.props.parent,o=this.state,a=o.namespaces,s=o.showAdvanced,c=o.visible,l=o.selectedNs;if(!a||!c)return i.createElement("div",{style:{display:"none"}});var u=r.parent.state.editorState&&r.parent.state.editorState.filters,p=0,f=a.some(function(e){return e[1].advanced}),h=!pxt.shell.isReadOnly()&&pxt.appTarget.cloud&&pxt.appTarget.cloud.packages,m=t(a.filter(function(e){return!e[1].advanced})),g=f?t(a.filter(function(e){return e[1].advanced}),!0):[];return this.items=m.concat(g),i.createElement("div",{ref:function(e){return n.rootElement=e},id:"monacoEditorToolbox",className:"monacoToolboxDiv"},i.createElement("div",{className:"blocklyTreeRoot"},i.createElement("div",{role:"tree"},m.map(function(e){return i.createElement(v,{key:e.ns,toolbox:n,selected:l==e.ns,treeRow:e,onCategoryClick:n.setSelection.bind(n)})}),f?i.createElement(b,{key:"advancedseparator"}):void 0,f?i.createElement(v,{toolbox:this,treeRow:{ns:"",category:pxt.blocks.advancedTitle(),color:pxt.blocks.getNamespaceColor("advanced"),icon:s?"advancedexpanded":"advancedcollapsed"},onCategoryClick:this.advancedClicked.bind(this)}):void 0,s?g.map(function(e){return i.createElement(v,{key:e.ns,toolbox:n,selected:l==e.ns,treeRow:e,onCategoryClick:n.setSelection.bind(n)})}):void 0,h&&s?i.createElement(y,{treeRow:{ns:"",category:pxt.blocks.addPackageTitle(),color:"#717171",icon:"addpackage"},onClick:this.addPackage.bind(this)}):void 0)))},t}(p.Component);n.MonacoToolbox=g;var v=function(e){function t(t){var n=this;e.call(this,t),this.handleClick=function(){n.props.onCategoryClick&&n.props.onCategoryClick(n.props.treeRow,n.props.treeRow.index)},this.state={selected:t.selected}}return o(t,e),t.prototype.getTreeRow=function(){return this.treeRowElement},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.selected&&(t.selected=e.selected),Object.keys(t).length>0&&this.setState(t)},t.prototype.componentDidUpdate=function(e,t){this.state.selected&&(this.props.toolbox.setSelectedItem(this),this.treeRowElement.focus())},t.prototype.renderCore=function(){var e=this,t=this.props.toolbox,n=this.state.selected,r=function(){pxt.tickEvent("monaco.toolbox.keyboard.prev"),t.setPreviousItem()},o=function(){pxt.tickEvent("monaco.toolbox.keyboard.next"),t.setNextItem()},a=f.isUserLanguageRtl();return i.createElement(_,null,i.createElement(y,i.__spread({ref:function(t){return e.treeRowElement=t}},this.props,{selected:n,onClick:this.handleClick,onKeyDown:function(n){var i="number"==typeof n.which?n.which:n.keyCode;40==i?o():38==i?r():39==i&&!a||37==i&&a?t.moveFocusToFlyout():27==i?t.closeFlyout():u.fireClickOnEnter.call(e,n)}.bind(this)})))},t}(p.Component);n.CategoryItem=v;var y=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.focus=function(){this.treeRow.focus()},t.prototype.getProperties=function(){return this.props.treeRow},t.prototype.renderCore=function(){var e=this,t=this.props,n=t.selected,r=t.onClick,o=t.onKeyDown,a=this.props.treeRow,s=a.ns,c=a.icon,l=a.color,p=a.category,d=a.injectIconClass,h=pxt.appTarget.appTheme,m=pxt.blocks.convertColour(l),g=h.blocklyOptions&&h.blocklyOptions.toolboxOptions&&h.blocklyOptions.toolboxOptions.invertedMultiplier||.3,v={paddingLeft:"0px"},y="blocklyTreeRow";h.coloredToolbox?(v.color=""+m,v.borderLeft="8px solid "+m):h.invertedToolbox?(v.backgroundColor=m||"#ddd",v.color="#fff"):v.borderLeft="8px solid "+m,n&&(y+=" blocklyTreeSelected",h.invertedToolbox?v.backgroundColor=""+Blockly.PXTUtils.fadeColour(l,Blockly.Options.invertedMultiplier,!1):v.backgroundColor=m||"#ddd",v.color="#fff");var b=("blocklyTreeIcon"+(c?(s||c).toLowerCase():"Default")).replace(/\s/g,"");return c&&d&&pxt.blocks.appendToolboxIconCss(b,c),i.createElement("div",{ref:function(t){return e.treeRow=t},className:y,style:v,tabIndex:0,onMouseEnter:function(){h.invertedToolbox&&(e.treeRow.style.backgroundColor=Blockly.PXTUtils.fadeColour(m||"#ddd",g,!1))},onMouseLeave:function(){h.invertedToolbox&&(e.treeRow.style.backgroundColor=m||"#ddd")},onClick:r,onKeyDown:o||u.fireClickOnEnter},i.createElement("span",{className:"blocklyTreeIcon",role:"presentation"}),i.createElement("span",{style:{display:"inline-block"},className:"blocklyTreeIcon "+b,role:"presentation"}),i.createElement("span",{className:"blocklyTreeLabel"},p||""+f.capitalize(s)))},t}(p.Component);n.TreeRow=y;var b=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.renderCore=function(){return i.createElement(_,null,i.createElement("div",{className:"blocklyTreeSeparator"}))},t}(p.Component);n.TreeSeparator=b;var _=function(e){function t(){e.apply(this,arguments)}return o(t,e),t.prototype.renderCore=function(){return i.createElement("div",{role:"treeitem"},this.props.children)},t}(p.Component);n.TreeItem=_},{"./compiler":11,"./core":13,"./data":14,"./monacoSnippets":30,"./package":32,"./srceditor":43,"./sui":44,react:277}],30:[function(e,t,n){"use strict";function r(e){switch(e){case n.loops.nameid:return n.loops;case n.logic.nameid:return n.logic;case n.variables.nameid:return n.variables;case n.maths.nameid:return n.maths;case n.text.nameid:return n.text;case n.arrays.nameid:return n.arrays;case n.functions.nameid:return n.functions}}function o(e,t){var n=r(e);if(t&&n&&(t.name&&(n.name=t.name),void 0!==t.weight&&(n.attributes.weight=t.weight),void 0!==t.advanced&&(n.attributes.advanced=t.advanced),void 0!==t.removed&&(n.removed=t.removed),t.blocks)){var o=100;t.appendBlocks?(o=50,t.blocks.forEach(function(e,t){e.weight?o=e.weight:o--;var r={name:e.name,snippet:e.snippet,snippetOnly:e.snippetOnly,attributes:{weight:o,advanced:e.advanced,jsDoc:e.jsDoc,group:e.group},noNamespace:!0,retType:e.retType};n.blocks.push(r)})):n.blocks=t.blocks.map(function(e,t){return e.weight?o=e.weight:o--,{name:e.name,snippet:e.snippet,snippetOnly:e.snippetOnly,attributes:{weight:o,advanced:e.advanced,jsDoc:e.jsDoc,group:e.group},noNamespace:!0,retType:e.retType}})}}n.loops={name:lf("{id:category}Loops"),nameid:"loops",blocks:[{name:"while",snippet:"while(true) {\n\n}",attributes:{jsDoc:lf("Repeat code while condition is true")}},{name:"for",snippet:"for(let i = 0; i < 5; i++) {\n\n}",attributes:{jsDoc:lf("Repeat code a number of times in a loop")}}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,icon:"loops",weight:50.09,paramDefl:{}}},n.logic={name:lf("{id:category}Logic"),nameid:"logic",blocks:[{name:"if",snippet:"if (true) {\n\n}",attributes:{jsDoc:lf("Runs code if the condition is true")}},{name:"if",snippet:"if (true) {\n\n} else {\n\n}",attributes:{jsDoc:lf("Runs code if the condition is true; else run other code")}},{name:"switch",snippet:"switch(item) {\n    case 0:\n        break;\n    case 1:\n        break;\n}",attributes:{jsDoc:lf("Runs different code based on a value")}}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,weight:50.08,icon:"logic",paramDefl:{}}},n.variables={name:lf("{id:category}Variables"),nameid:"variables",blocks:[{name:"let",snippet:"let item: number",snippetOnly:!0,attributes:{jsDoc:lf("Declares a variable named 'item'")}},{name:"equals",snippet:"item = 0",snippetOnly:!0,attributes:{jsDoc:lf("Assigns a value to a variable")}},{name:"change",snippet:"item += 1",snippetOnly:!0,attributes:{jsDoc:lf("Changes the value of item by 1")}}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,weight:50.07,icon:"variables",paramDefl:{}}},n.maths={name:lf("{id:category}Math"),nameid:"math",blocks:[{name:"plus",snippet:"1 + 1",snippetOnly:!0,attributes:{jsDoc:lf("Adds two numbers together")},retType:"number"},{name:"minus",snippet:"1 - 1",snippetOnly:!0,attributes:{jsDoc:lf("Subtracts the value of one number from another")},retType:"number"},{name:"multiply",snippet:"1 * 1",snippetOnly:!0,attributes:{jsDoc:lf("Multiplies two numbers together")},retType:"number"},{name:"divide",snippet:"1 / 1",snippetOnly:!0,attributes:{jsDoc:lf("Returns the quotient of one number divided by another")},retType:"number"},{name:"remainder",snippet:"1 % 2",snippetOnly:!0,attributes:{jsDoc:lf("Returns the remainder of one number divided by another")},retType:"number"},{name:"max",snippet:"Math.max(1, 2)",attributes:{jsDoc:lf("Returns the largest of two numbers")},retType:"number"},{name:"min",snippet:"Math.min(1, 2)",attributes:{jsDoc:lf("Returns the smallest of two numbers")},retType:"number"},{name:"abs",snippet:"Math.abs(-1)",attributes:{jsDoc:lf("Returns the absolute value of a number")},retType:"number"},{name:"randomRange",snippet:"Math.randomRange(0, 10)",attributes:{jsDoc:lf("Returns a random number between min and max")},retType:"number"},{name:"randomBoolean",snippet:"Math.randomBoolean()",attributes:{jsDoc:lf("Randomly returns either true or false")},retType:"boolean"}],attributes:{callingConvention:ts.pxtc.ir.CallingConvention.Plain,weight:50.06,icon:"math",paramDefl:{}}},n.text={name:lf("{id:category}Text"),nameid:"text",custom:!0,blocks:[{name:"length",snippet:'"".length',snippetOnly:!0,attributes:{jsDoc:lf("Returns the number of characters in a string")},retType:"number"},{name:"concat",snippet:'"" + 5',snippetOnly:!0,attributes:{jsDoc:lf("Combines a string with a number, boolean, string, or other object into one string")},retType:"string"},{name:"compare",snippet:'"".compare("")',attributes:{jsDoc:lf("Compares one string against another alphabetically and returns a number")},retType:"number"},{name:"parseInt",snippet:'parseInt("5")',attributes:{jsDoc:lf("Converts a number written as text into a number")},retType:"number"},{name:"substr",snippet:'"".substr(0, 0)',attributes:{jsDoc:lf("Returns the part of a string starting at a given index with the given length")},retType:"string"},{name:"charAt",snippet:'"".charAt(0)',attributes:{jsDoc:lf("Returns the character at the given index")},retType:"string"}],attributes:{advanced:!0,icon:"text",callingConvention:ts.pxtc.ir.CallingConvention.Plain,paramDefl:{}}},n.arrays={name:lf("{id:category}Arrays"),nameid:"arrays",custom:!0,blocks:[{name:"create",snippet:"let "+lf("{id:snippets}list")+" = [1, 2, 3];",snippetOnly:!0,attributes:{weight:100,jsDoc:lf("Creates a new Array")},retType:"array"},{name:"length",snippet:lf("{id:snippets}list")+".length",snippetOnly:!0,attributes:{weight:99,jsDoc:lf("Returns the number of values in an Array")},retType:"number"},{name:"get",snippet:lf("{id:snippets}list")+"[0]",snippetOnly:!0,attributes:{weight:98,jsDoc:lf("Returns the value in the Array at the given index")}},{name:"set",snippet:lf("{id:snippets}list")+"[0] = 1",snippetOnly:!0,attributes:{weight:97,jsDoc:lf("Overwrites the value in an Array at the given index")}},{name:"push",snippet:lf("{id:snippets}list")+".push(1)",attributes:{weight:96,jsDoc:lf("Adds a value to the end of an Array")}},{name:"pop",snippet:lf("{id:snippets}list")+".pop()",attributes:{weight:95,jsDoc:lf("Removes and returns the value at the end of an Array")},retType:"object"},{name:"insertAt",snippet:lf("{id:snippets}list")+".insertAt(0, 0)",attributes:{weight:50,jsDoc:lf("Inserts a value into the Array at the given index"),advanced:!0}},{name:"removeAt",snippet:lf("{id:snippets}list")+".removeAt(0)",attributes:{weight:49,jsDoc:lf("Removes a value from the Array at the given index and returns it"),advanced:!0},retType:"object"},{name:"shift",snippet:lf("{id:snippets}list")+".shift()",attributes:{weight:48,jsDoc:lf("Removes and returns the value at the front of an Array"),advanced:!0}},{name:"unshift",snippet:lf("{id:snippets}list")+".unshift(0)",attributes:{weight:47,jsDoc:lf("Inserts a value at the beginning of an Array"),advanced:!0}},{name:"indexOf",snippet:'["A", "B", "C"].indexOf("B")',attributes:{weight:46,jsDoc:lf("Returns the first index in the Array that contains the given value or -1 if it does not exist in the Array"),advanced:!0},retType:"number"},{name:"reverse",snippet:lf("{id:snippets}list")+".reverse()",attributes:{weight:45,jsDoc:lf("Reverses the contents of an Array"),advanced:!0}}],attributes:{advanced:!0,color:pxt.blocks.blockColors.arrays.toString(),icon:"arrays",callingConvention:ts.pxtc.ir.CallingConvention.Plain,paramDefl:{}}},n.functions={name:lf("{id:category}Functions"),nameid:"functions",blocks:[{name:"function doSomething",snippet:"function doSomething() {\n\n}",attributes:{jsDoc:lf("Define a function")}},{name:"doSomething",snippet:"doSomething()",attributes:{jsDoc:lf("Call a function")}}],attributes:{advanced:!0,callingConvention:ts.pxtc.ir.CallingConvention.Plain,color:pxt.blocks.blockColors.functions.toString(),icon:"functions",paramDefl:{}}},n.getBuiltinCategory=r,n.isBuiltin=function(e){switch(e){case n.loops.nameid:case n.logic.nameid:case n.variables.nameid:case n.maths.nameid:case n.text.nameid:case n.arrays.nameid:case n.functions.nameid:return!0}return!1},n.overrideCategory=o,n.overrideToolbox=function(e){o(n.loops.nameid,e.loops),o(n.logic.nameid,e.logic),o(n.variables.nameid,e.variables),o(n.maths.nameid,e.maths),o(n.text.nameid,e.text),o(n.arrays.nameid,e.arrays),o(n.functions.nameid,e.functions)}},{}],31:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./sui"),a=e("./electron"),s=pxt.Cloud,c=function(e){function t(t){e.call(this,t),this.delayTime=this.props.delayTime||0,this.doneSleeping=this.sleepDone(),this.bannerType=this.props.bannerType||"default"}return r(t,e),t.prototype.componentDidMount=function(){var e=this;this.doneSleeping&&(this.timer=setTimeout(function(){return e.show()},this.delayTime))},t.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},t.prototype.sleepDone=function(){if(!this.props.sleepTime)return!0;var e=parseInt(pxt.storage.getLocal("lastBannerClosedTime")||"0");return Util.nowSeconds()-e>this.props.sleepTime},t.prototype.show=function(){var e=this;pxt.tickEvent("notificationBanner.show"),this.props.displayTime&&(this.timer=setTimeout(function(){return e.hide("automatic")},this.delayTime+this.props.displayTime)),this.props.parent.setBanner(!0),this.render()},t.prototype.hide=function(e){pxt.tickEvent("notificationBanner."+e+"Close"),pxt.storage.setLocal("lastBannerClosedTime",Util.nowSeconds().toString()),this.props.parent.setBanner(!1),this.render()},t.prototype.render=function(){var e=this;return this.props.parent.state.bannerVisible&&this.doneSleeping?o.createElement("div",{id:"notificationBanner",className:"ui attached "+this.bannerType+" message"},o.createElement("div",{className:"bannerLeft"},o.createElement("div",{className:"content"},this.props.children)),o.createElement("div",{className:"bannerRight"},o.createElement(i.Icon,{icon:"close",tabIndex:0,onClick:function(){e.hide("manual"),clearTimeout(e.timer)}}))):o.createElement("div",null)},t}(o.Component);n.GenericBanner=c;var l=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.render=function(){var e=pxt.appTarget.appTheme,t=a.isElectron||pxt.winrt.isWinRT(),n="localhost"===location.hostname,r="/"!==location.pathname&&-1===(e.appPathNames||[]).indexOf(location.pathname),l=!n&&t&&r;if(pxt.BrowserUtils.isWindows10()&&s.isOnline()&&e.windowsStoreLink&&!t)return o.createElement(c,{parent:this.props.parent,delayTime:1e4,displayTime:45e3,sleepTime:604800},o.createElement(i.Link,{class:"link",target:"_blank",ariaLabel:lf("View app in the Windows store"),href:pxt.appTarget.appTheme.windowsStoreLink,onClick:function(){return pxt.tickEvent("banner.linkClicked")}},o.createElement("img",{className:"bannerIcon",src:Util.pathJoin(pxt.webConfig.commitCdnUrl,"images/windowsstorebag.png")})),o.createElement(i.Link,{class:"link",target:"_blank",ariaLabel:lf("View app in the Windows store"),href:pxt.appTarget.appTheme.windowsStoreLink,onClick:function(){return pxt.tickEvent("banner.linkClicked")}},lf("Want a faster download? Get the app!")));if(l){var u=pxt.appTarget.appTheme.homeUrl+location.search+location.hash;return o.createElement(c,{parent:this.props.parent,bannerType:"negative"},o.createElement(i.Icon,{icon:"warning circle"}),o.createElement("div",{className:"header"},lf("You are viewing an experimental version of the editor")),o.createElement(i.Link,{class:"link",ariaLabel:lf("Go back to live editor"),href:u},lf("Take me back")))}return o.createElement("div",null)},t}(o.Component);n.NotificationBanner=l},{"./electron":18,"./sui":44,react:277}],32:[function(e,t,n){"use strict";function r(e){return e.replace(/\/+/g,"/").replace(/[^\/]+\/\.\.\//g,"").replace(/\/\.\//g,"/")}function o(e){var t=e._editorPkg;if(t)return t;var r=null;e!=n.mainPkg&&(r=o(n.mainPkg));var i=new g(e,r);return e==n.mainPkg&&i.makeTopLevel(),e._editorPkg=i,i}function i(){return o(n.mainPkg)}function a(){return o(n.mainPkg).pkgAndDeps()}var s=e("./workspace"),c=e("./data"),l=e("./core"),u=e("./db"),p=pxt.Util,d=p.lf,f=new u.Table("hostcache"),h={ts:10,blocks:20,json:30,md:40};n.setupAppTarget=function(e){pxt.setAppTarget(e)};var m=function(){function e(e,t,n){this.epkg=e,this.name=t,this.content=n,this.inSyncWithEditor=!0,this.inSyncWithDisk=!0}return e.prototype.isReadonly=function(){return!this.epkg.header},e.prototype.getName=function(){return this.epkg.getPkgId()+"/"+this.name},e.prototype.getTypeScriptName=function(){return this.epkg.isTopLevel()?this.name:"pxt_modules/"+this.epkg.getPkgId()+"/"+this.name},e.prototype.getExtension=function(){var e=/\.([^\.]+)$/.exec(this.name);return e?e[1]:""},e.prototype.getVirtualFileName=function(){return e.blocksFileNameRx.test(this.name)?this.name.replace(e.blocksFileNameRx,".ts"):e.tsFileNameRx.test(this.name)?this.name.replace(e.tsFileNameRx,".blocks"):void 0},e.prototype.weight=function(){return/^main\./.test(this.name)?5:h.hasOwnProperty(this.getExtension())?h[this.getExtension()]:60},e.prototype.markDirty=function(){this.inSyncWithEditor=!1,this.updateStatus()},e.prototype.updateStatus=function(){c.invalidate("open-meta:"+this.getName())},e.prototype.setContentAsync=function(e,t){var n=this;if(p.assert(void 0!==e),this.inSyncWithEditor=!0,e!=this.content){var r=this.content;return this.inSyncWithDisk=!1,this.content=e,this.updateStatus(),this.epkg.saveFilesAsync().then(function(){n.content==e&&(n.inSyncWithDisk=!0,n.updateStatus()),t&&n.forceChangeCallback&&n.forceChangeCallback(r,e)})}return this.updateStatus(),Promise.resolve()},e.prototype.setForceChangeCallback=function(e){this.forceChangeCallback=e},e.tsFileNameRx=/\.ts$/,e.blocksFileNameRx=/\.blocks$/,e}();n.File=m;var g=function(){function e(e,t){this.ksPkg=e,this.topPkg=t,this.files={},this.onupdate=function(){},this.saveScheduled=!1,this.savingNow=0,e&&"workspace"==e.verProtocol()&&(this.header=s.getHeader(e.verArgument()))}return e.prototype.getTopHeader=function(){return this.topPkg.header},e.prototype.makeTopLevel=function(){this.topPkg=this,this.outputPkg=new e(null,this),this.outputPkg.id="built"},e.prototype.updateConfigAsync=function(e){var t=this.files[pxt.CONFIG_NAME];if(t)try{var n=JSON.parse(t.content);return e(n),t.setContentAsync(JSON.stringify(n,null,4)+"\n")}catch(e){}return null},e.prototype.updateDepAsync=function(e){var t=this,n=this.ksPkg.resolveDep(e);if(!n||"github"!=n.verProtocol())return Promise.resolve();var r=pxt.github.parseRepoId(n.verArgument());return pxt.packagesConfigAsync().then(function(e){return pxt.github.latestVersionAsync(r.fullName,e)}).then(function(e){r.tag=e}).then(function(){return pxt.github.pkgConfigAsync(r.fullName,r.tag)}).catch(l.handleNetworkError).then(function(e){return t.addDepAsync(e.name,pxt.github.stringifyRepo(r))})},e.prototype.removeDepAsync=function(e){var t=this;return this.updateConfigAsync(function(t){return delete t.dependencies[e]}).then(function(){return t.saveFilesAsync(!0)})},e.prototype.addDepAsync=function(e,t){var n=this;return this.updateConfigAsync(function(n){return n.dependencies[e]=t}).then(function(){return n.saveFilesAsync(!0)})},e.prototype.getKsPkg=function(){return this.ksPkg},e.prototype.getPkgId=function(){return this.ksPkg?this.ksPkg.id:this.id},e.prototype.isTopLevel=function(){return this.ksPkg&&0==this.ksPkg.level},e.prototype.setFile=function(e,t){var n=new m(this,e,t);return this.files[e]=n,c.invalidate("open-meta:"),n},e.prototype.removeFileAsync=function(e){return delete this.files[e],c.invalidate("open-meta:"),this.updateConfigAsync(function(t){return t.files=t.files.filter(function(t){return t!=e})})},e.prototype.setContentAsync=function(e,t){var n=this.files[e];return n||(n=this.setFile(e,t)),n.setContentAsync(t)},e.prototype.setFiles=function(e){var t=this;this.files=p.mapMap(e,function(e,n){return new m(t,e,n)}),c.invalidate("open-meta:")},e.prototype.updateStatus=function(){c.invalidate("pkg-status:"+this.header.id)},e.prototype.savePkgAsync=function(){var e=this;return this.header.blobCurrent?Promise.resolve():(this.savingNow++,this.updateStatus(),s.saveToCloudAsync(this.header).then(function(){e.savingNow--,e.updateStatus(),e.header.blobCurrent||e.scheduleSave()}))},e.prototype.scheduleSave=function(){var e=this;this.saveScheduled||(this.saveScheduled=!0,setTimeout(function(){e.saveScheduled=!1,e.savePkgAsync().done()},5e3))},e.prototype.getAllFiles=function(){var e=p.mapMap(this.files,function(e,t){return t.content});return delete e[pxt.SERIAL_EDITOR_FILE],e},e.prototype.saveFilesAsync=function(e){var t=this;if(!this.header)return Promise.resolve();var n=this.files[pxt.CONFIG_NAME];if(n)try{var r=JSON.parse(n.content);this.header.name=r.name}catch(e){}return s.saveAsync(this.header,this.getAllFiles()).then(function(){return e?t.savePkgAsync():t.scheduleSave()})},e.prototype.sortedFiles=function(){var e=p.values(this.files);return e.sort(function(e,t){return e.weight()-t.weight()||p.strcmp(e.name,t.name)}),e},e.prototype.forEachFile=function(e){this.pkgAndDeps().forEach(function(t){p.values(t.files).forEach(e)})},e.prototype.getMainFile=function(){return this.sortedFiles()[0]},e.prototype.pkgAndDeps=function(){return this.topPkg!=this?this.topPkg.pkgAndDeps():p.values(this.ksPkg.deps).map(o).concat([this.outputPkg])},e.prototype.filterFiles=function(e){return p.concat(this.pkgAndDeps().map(function(t){return p.values(t.files).filter(e)}))},e.prototype.lookupFile=function(e){return this.filterFiles(function(t){return t.getName()==e})[0]},e}();n.EditorPackage=g;var v=new(function(){function e(){}return e.prototype.readFile=function(e,t){var n=o(e).files[t];return n?n.content:null},e.prototype.writeFile=function(e,t,n,r){if(t!=pxt.CONFIG_NAME&&!r)throw p.oops("trying to write "+e+" / "+t);o(e).files[t].setContentAsync(n,r).done()},e.prototype.getHexInfoAsync=function(e){return pxt.hex.getHexInfoAsync(this,e).catch(l.handleNetworkError)},e.prototype.cacheStoreAsync=function(e,t){return f.forceSetAsync({id:e,val:t}).then(function(){},function(t){pxt.tickEvent("cache.store.failed",{error:t.name}),pxt.log("cache store failed for "+e+": "+t.name)})},e.prototype.cacheGetAsync=function(e){return f.getAsync(e).then(function(e){return e.val},function(e){return null})},e.prototype.downloadPackageAsync=function(e){var t=e.verProtocol(),n=o(e);if("pub"==t)return s.getPublishedScriptAsync(e.verArgument()).then(function(e){return n.setFiles(e)});if("github"==t)return s.getPublishedScriptAsync(e.version()).then(function(e){return n.setFiles(e)});if("workspace"==t)return s.getTextAsync(e.verArgument()).then(function(e){return n.setFiles(e)});if("file"==t){var i=e.verArgument();return"."==i[0]&&(i=r(e.parent.verArgument()+"/"+i)),s.getTextAsync(i).then(function(e){return n.setFiles(e)})}return"embed"==t?(n.setFiles(pxt.getEmbeddedScript(e.verArgument())),Promise.resolve()):Promise.reject("Cannot download "+e.version()+"; unknown protocol")},e}());n.mainPkg=new pxt.MainPackage(v),n.getEditorPkg=o,n.mainEditorPkg=i,n.genFileName=function(e){var t=i().header.name.replace(/[\\\/.?*^:<>|"\x00-\x1F ]/g,"-");return(pxt.appTarget.nickname||pxt.appTarget.id)+"-"+t+e},n.allEditorPkgs=a,n.notifySyncDone=function(e){p.values(n.mainPkg.deps).filter(function(t){return"workspace"==t.verProtocol()&&e.hasOwnProperty(t.verArgument())}).length>0&&o(n.mainPkg).onupdate()},n.loadPkgAsync=function(e){return n.mainPkg=new pxt.MainPackage(v),n.mainPkg._verspec="workspace:"+e,v.downloadPackageAsync(n.mainPkg).catch(l.handleNetworkError).then(function(){return v.readFile(n.mainPkg,pxt.CONFIG_NAME)}).then(function(e){return e?n.mainPkg.installAllAsync().catch(function(e){l.errorNotification(d("Cannot load package: {0}",e.message))}):Promise.resolve()})},c.mountVirtualApi("open-meta",{getSync:function(e){e=c.stripProtocol(e);var t=o(n.mainPkg).lookupFile(e);if(!t)return{};var r={isReadonly:t.isReadonly(),isSaved:t.inSyncWithEditor&&t.inSyncWithDisk,numErrors:t.numDiagnosticsOverride};return null==r.numErrors&&(r.numErrors=t.diagnostics?t.diagnostics.length:0),r}}),c.mountVirtualApi("pkg-status",{getSync:function(e){e=c.stripProtocol(e);var t=a().filter(function(t){return t.header&&t.header.id==e})[0];return t&&t.savingNow?"saving":""}})},{"./core":13,"./data":14,"./db":15,"./workspace":48}],33:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("react-dom"),a=e("./data"),s=e("./sui"),c=e("./core"),l=e("./compiler"),u=e("./codecard"),p=e("./gallery"),d=e("./carousel"),f=function(e){function t(t){e.call(this,t),this.prevUrlData=[],this.prevGalleries={},this.galleryFetchErrors={},this.state={visible:!1}}return r(t,e),t.prototype.fetchGallery=function(e,t){var n=this.getData("gallery:"+encodeURIComponent(t));return n&&(n instanceof Error?this.galleryFetchErrors[e]=!0:this.prevGalleries[t]=Util.concat(n.map(function(e){return e.cards}))),this.prevGalleries[t]||[]},t.prototype.fetchUrlData=function(){var e=pxt.Cloud.parseScriptId(this.state.searchFor);if(e){var t=this.getData("cloud-search:"+e);t&&404!==t.statusCode&&(this.prevUrlData?this.prevUrlData.push(t):this.prevUrlData=[t])}return this.prevUrlData},t.prototype.fetchLocalData=function(){var e=this,t=this.getData("header:*");return this.state.searchFor&&(t=t.filter(function(t){return t.name.toLowerCase().indexOf(e.state.searchFor.toLowerCase())>-1})),t},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.visible!=t.visible||this.state.searchFor!=t.searchFor||this.state.selectedCategory!=t.selectedCategory||this.state.selectedIndex!=t.selectedIndex},t.prototype.setSelected=function(e,t){void 0==t||this.state.selectedCategory==e&&this.state.selectedIndex==t?this.setState({selectedCategory:void 0,selectedIndex:void 0}):this.setState({selectedCategory:e,selectedIndex:t})},t.prototype.componentDidUpdate=function(e,t){this.state.selectedCategory!==t.selectedCategory&&this.ensureSelectedItemVisible()},t.prototype.ensureSelectedItemVisible=function(){var e=this.refs.activeCarousel;if(e){var t=e.getCarouselDOM();this.scrollElementIntoViewIfNeeded(t)}},t.prototype.scrollElementIntoViewIfNeeded=function(e){var t=i.findDOMNode(this.refs.homeContainer),n=e.getBoundingClientRect().top;t.parentElement.scrollTop=t.parentElement.scrollTop+n-30},t.prototype.renderCore=function(){var e=this,t=this.state,n=(t.visible,t.selectedCategory),r=t.selectedIndex,i=pxt.appTarget.appTheme,a=this.getData("target-config:"),u=pxt.Util.userLanguage(),d={};a&&a.localizedGalleries&&a.localizedGalleries[u]&&pxt.Util.jsonCopyFrom(d,a.localizedGalleries[u]),a&&a.galleries&&pxt.Util.jsonCopyFrom(d,a.galleries);this.fetchLocalData(),this.fetchUrlData();this.galleryFetchErrors={};Util.mapMap(d,function(t){return e.fetchGallery(t,d[t])});var f=function(t){pxt.tickEvent("projects.header"),c.showLoading("changeheader",lf("Loading...")),e.props.parent.loadHeaderAsync(t).done(function(){c.hideLoading("changeheader")})},h=function(t){switch(pxt.tickEvent("projects.gallery",{name:t.name}),t.cardType){case"example":g(t,!0);break;case"codeExample":g(t,!1);break;case"tutorial":e.props.parent.startTutorial(t.url,t.name);break;default:var n=/^\/#tutorial:([a-z0A-Z0-9\-\/]+)$/.exec(t.url);n?e.props.parent.startTutorial(n[1]):t.youTubeId&&!t.url?window.open("https://youtu.be/"+t.youTubeId,"yt"):/^https:\/\//i.test(t.url)?window.open(t.url,"_blank"):t.url?/^\//i.test(t.url)?window.open(t.url,"_blank"):c.errorNotification(lf("Sorry, the project url looks invalid.")):e.props.parent.newEmptyProject(t.name.toLowerCase())}},g=function(t,n){c.showLoading("changingcode",lf("Loading...")),p.loadExampleAsync(t.name.toLowerCase(),t.url).done(function(t){if(t)return n?e.props.parent.createProjectAsync(t).then(function(){return l.getBlocksAsync().then(function(e){return l.decompileAsync("main.ts",e)}).then(function(t){pxt.debug("example decompilation: "+t.success),t.success&&e.props.parent.overrideBlocksFile(t.outfiles["main.blocks"])})}).done(function(){c.hideLoading("changingcode")}):e.props.parent.createProjectAsync(t).then(function(){return Promise.delay(500)}).done(function(){return c.hideLoading("changingcode")});c.hideLoading("changingcode")})},v=function(){pxt.tickEvent("projects.importdialog"),e.props.parent.importProjectDialog()},y=function(){pxt.tickEvent("projects.langpicker"),e.props.parent.selectLang()},b=!!i.homeScreenHero,_=(i.betaUrl,s.cx(["ui segment bottom attached tab active tabsegment"]));return o.createElement("div",{ref:"homeContainer",className:_},b?o.createElement("div",{className:"ui segment getting-started-segment",style:{backgroundImage:"url("+encodeURI(i.homeScreenHero)+")"}}):void 0,o.createElement("div",{key:"mystuff_gallerysegment",className:"ui segment gallerysegment mystuff-segment"},o.createElement("div",{className:"ui grid equal width padded heading"},o.createElement("div",{className:"column"},o.createElement("h2",{className:"ui header"},lf("My Projects")," ")),o.createElement("div",{className:"column right aligned"},pxt.appTarget.compile||pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.publishing&&pxt.appTarget.cloud.importing?o.createElement(s.Button,{key:"import",icon:"upload",class:"mini import-dialog-btn",textClass:"landscape only",text:lf("Import"),title:lf("Import a project"),onClick:function(){return v()}}):void 0)),o.createElement("div",{className:"content"},o.createElement(m,{key:"mystuff_carousel",parent:this.props.parent,name:"recent",onClick:function(e){return f(e)}}))),Object.keys(d).map(function(t){return o.createElement("div",{key:t+"_gallerysegment",className:"ui segment gallerysegment"},o.createElement("h2",{className:"ui header heading"},Util.rlf(t)," "),o.createElement("div",{className:"content"},o.createElement(m,{ref:n==t?"activeCarousel":"",key:t+"_carousel",parent:e.props.parent,name:t,path:d[t],onClick:function(e){return h(e)},setSelected:function(n){return e.setSelected(t,n)},selectedIndex:n==t?r:void 0})))}),i.organizationUrl||i.organizationUrl||i.privacyUrl?o.createElement("div",{className:"ui horizontal small divided link list homefooter"},i.organizationUrl&&i.organization?o.createElement("a",{className:"item focused",target:"_blank",rel:"noopener",href:i.organizationUrl},i.organization):void 0,i.selectLanguage?o.createElement(s.Link,{class:"item focused",text:lf("Language"),onClick:function(){return y()},onKeyDown:s.fireClickOnEnter}):void 0,i.termsOfUseUrl?o.createElement("a",{target:"_blank",className:"item focused",href:i.termsOfUseUrl,rel:"noopener"},lf("Terms of Use")):void 0,i.privacyUrl?o.createElement("a",{target:"_blank",className:"item focused",href:i.privacyUrl,rel:"noopener"},lf("Privacy")):void 0):void 0)},t}(a.Component);n.Projects=f;var h=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.brandIconClick=function(){pxt.tickEvent("projects.brand")},t.prototype.orgIconClick=function(){pxt.tickEvent("projects.org")},t.prototype.shouldComponentUpdate=function(e,t,n){return!1},t.prototype.render=function(){var e=this,t=pxt.appTarget.appTheme;pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing;return o.createElement("div",{className:"ui borderless fixed "+(t.invertedMenu?"inverted":"")+" menu",role:"menubar"},o.createElement("div",{className:"left menu"},o.createElement("a",{href:t.logoUrl,"aria-label":lf("{0} Logo",t.boardName),role:"menuitem",target:"blank",rel:"noopener",className:"ui item logo brand",onClick:function(){return e.brandIconClick()}},t.logo||t.portraitLogo?o.createElement("img",{className:"ui logo "+(t.logo?" portrait hide":""),src:Util.toDataUri(t.logo||t.portraitLogo),alt:lf("{0} Logo",t.boardName)}):o.createElement("span",{className:"name"},t.boardName),t.portraitLogo?o.createElement("img",{className:"ui mini image portrait only",src:Util.toDataUri(t.portraitLogo),alt:lf("{0} Logo",t.boardName)}):null)),o.createElement("div",{className:"ui item"},o.createElement(s.Icon,{icon:"icon home large"})," ",lf("Home")),o.createElement("div",{className:"right menu"},o.createElement("a",{href:t.organizationUrl,target:"blank",rel:"noopener",className:"ui item logo organization",onClick:function(){return e.orgIconClick()}},t.organizationWideLogo||t.organizationLogo?o.createElement("img",{className:"ui logo "+(t.organizationWideLogo?" portrait hide":""),src:Util.toDataUri(t.organizationWideLogo||t.organizationLogo),alt:lf("{0} Logo",t.organization)}):o.createElement("span",{className:"name"},t.organization),t.organizationLogo?o.createElement("img",{className:"ui mini image portrait only",src:Util.toDataUri(t.organizationLogo),alt:lf("{0} Logo",t.organization)}):null)),t.betaUrl?o.createElement("a",{href:""+t.betaUrl,className:"ui red mini corner top left attached label betalabel",role:"menuitem"},lf("Beta")):void 0)},t}(a.Component);n.ProjectsMenu=h;var m=function(e){function t(t){e.call(this,t),this.prevGalleries=[],this.prevHeaders=[],this.hasFetchErrors=!1,this.state={}}return r(t,e),t.prototype.componentDidMount=function(){this.props.parent.state.header&&this.latestProject&&this.latestProject.element&&this.latestProject.element.focus()},t.prototype.fetchGallery=function(e){var t=this.getData("gallery:"+encodeURIComponent(e));return t&&(t instanceof Error?this.hasFetchErrors=!0:this.prevGalleries=Util.concat(t.map(function(e){return e.cards}))),this.prevGalleries||[]},t.prototype.fetchLocalData=function(){var e=this.getData("header:*");return this.prevHeaders=e||[],e},t.prototype.newProject=function(){pxt.tickEvent("projects.new"),this.props.parent.newProject()},t.prototype.closeDetail=function(){pxt.tickEvent("projects.detail.close"),this.props.setSelected(void 0)},t.prototype.getCarouselDOM=function(){return i.findDOMNode(this.refs.carousel)},t.prototype.getDetailDOM=function(){return i.findDOMNode(this.refs.detailView)},t.prototype.renderCore=function(){var e=this,t=this.props,n=(t.name,t.path),r=t.selectedIndex,i=(pxt.appTarget.appTheme,function(t,n){e.props.setSelected?(pxt.tickEvent("projects.detail.open"),e.props.setSelected(n)):e.props.onClick(t)});if(n){this.hasFetchErrors=!1;var a=this.fetchGallery(n);return this.hasFetchErrors?o.createElement("div",{className:"ui carouselouter"},o.createElement("div",{className:"carouselcontainer",tabIndex:0,onClick:function(){return e.setState({})}},o.createElement("p",{className:"ui grey inverted segment"},lf("Oops, please connect to the Internet and try again.")))):o.createElement("div",null,o.createElement(d.Carousel,{ref:"carousel",bleedPercent:20,selectedIndex:r},a.map(function(e,t){return o.createElement("div",{key:n+e.name},o.createElement(u.CodeCardView,{className:"example",key:"gallery"+e.name,name:e.name,url:e.url,imageUrl:e.imageUrl,youTubeId:e.youTubeId,label:e.label,labelClass:e.labelClass,onClick:function(){return i(e,t)}}))})),o.createElement("div",{ref:"detailView",className:"detailview "+(a.filter(function(e,t){return t==r}).length>0?"visible":"")},a.filter(function(e,t){return t==r}).length>0?o.createElement("div",{tabIndex:0,className:"close"},o.createElement(s.Icon,{icon:"remove circle",onClick:function(){return e.closeDetail()}})," "):void 0,a.filter(function(e,t){return t==r}).map(function(t){return o.createElement(g,{parent:e.props.parent,name:t.name,key:"detail"+t.name,description:t.description,url:t.url,imageUrl:t.imageUrl,largeImageUrl:t.largeImageUrl,youTubeId:t.youTubeId,onClick:function(){return e.props.onClick(t)},cardType:t.cardType})})))}var c=this.fetchLocalData();return c.unshift({id:"new",name:lf("New Project")}),0==c.length?o.createElement("div",{className:"ui carouselouter"},o.createElement("div",{className:"carouselcontainer"},o.createElement("p",null,lf("This is where you will you find your code.")))):o.createElement(d.Carousel,{bleedPercent:20},c.map(function(t,n){return o.createElement("div",{key:"local"+t.id+t.recentUse},"new"==t.id?o.createElement("div",{className:"ui card link newprojectcard focused",tabIndex:0,title:lf("Creates a new empty project"),onClick:function(){return e.newProject()},onKeyDown:s.fireClickOnEnter},o.createElement("div",{className:"content"},o.createElement(s.Icon,{icon:"huge add circle"}),o.createElement("span",{className:"header"},t.name))):o.createElement(u.CodeCardView,{ref:function(t){1===n&&(e.latestProject=t)},cardType:"file",className:"file",name:t.name,time:t.recentUse,url:t.pubId&&t.pubCurrent?"/"+t.pubId:"",onClick:function(){return i(t)}}))}))},t}(a.Component);n.ProjectsCarousel=m;var g=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.name,n=e.description,r=e.imageUrl,i=e.largeImageUrl,a=e.youTubeId,c=(e.url,e.onClick),l=e.cardType,u=i||r||(a?"https://img.youtube.com/vi/"+a+"/maxresdefault.jpg":void 0),p=lf("Show Instructions");"tutorial"==l?p=lf("Start Tutorial"):"codeExample"==l||"example"==l?p=lf("Open Example"):a&&(p=lf("Play Video"));var d=[{label:p,onClick:c,icon:"",className:"huge positive"}];return o.createElement("div",{className:"ui grid stackable padded"},u?o.createElement("div",{className:"imagewrapper"},o.createElement("div",{className:"image",style:{backgroundImage:'url("'+u+'")'}})):void 0,o.createElement("div",{className:"column eight wide"},o.createElement("div",{className:"segment"},o.createElement("div",{className:"header"}," ",t," "),o.createElement("p",{className:"detail"},n),o.createElement("div",{className:"actions"},d.map(function(e){return o.createElement(s.Button,{key:"action_"+e.label,icon:e.icon,text:e.label,class:"approve "+(e.icon?"icon right labeled":"")+" "+(e.className||""),onClick:function(){e.onClick()},onKeyDown:s.fireClickOnEnter})})))))},t}(a.Component);n.ProjectsDetail=g;var v=function(e){function t(t){e.call(this,t),this.state={visible:!1}}return r(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.close=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.renderCore=function(){var e=this,t=(this.state.visible,function(){pxt.tickEvent("projects.import"),e.hide(),e.props.parent.importFileDialog()}),n=function(){pxt.tickEvent("projects.importurl"),e.hide(),e.props.parent.importUrlDialog()};return o.createElement(s.Modal,{open:this.state.visible,className:"importdialog",header:lf("Import"),size:"small",onClose:function(){return e.close()},dimmer:!0,closeIcon:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},o.createElement("div",{className:"ui cards"},pxt.appTarget.compile?o.createElement(u.CodeCardView,{ariaLabel:lf("Open files from your computer"),className:"focused",role:"button",key:"import",icon:"upload",iconColor:"secondary",name:lf("Import File..."),description:lf("Open files from your computer"),onClick:function(){return t()}}):void 0,pxt.appTarget.cloud&&pxt.appTarget.cloud.sharing&&pxt.appTarget.cloud.publishing&&pxt.appTarget.cloud.importing?o.createElement(u.CodeCardView,{ariaLabel:lf("Open a shared project URL"),className:"focused",role:"button",key:"importurl",icon:"cloud download",iconColor:"secondary",name:lf("Import URL..."),description:lf("Open a shared project URL"),onClick:function(){return n()}}):void 0))},t}(a.Component);n.ImportDialog=v;var y=function(e){function t(t){e.call(this,t),this.state={visible:!1}}return r(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(){this.setState({visible:!0})},t.prototype.componentDidUpdate=function(){if(this.state.visible){var e=document.getElementById("projectNameInput");e&&(e.setSelectionRange(0,9999),e.onkeyup=function(e){("number"==typeof e.which?e.which:e.keyCode)===c.ENTER_KEY&&(e.preventDefault(),document.getElementsByClassName("approve positive").item(0).click())})}},t.prototype.renderCore=function(){var e=this,t=this.state.visible,n=this.props.parent.state.projectName,r=n,i=[{label:lf("Done"),onClick:function(){e.hide(),e.props.parent.state.projectName!=r&&pxt.tickEvent("exitandsave.projectrename"),e.props.parent.updateHeaderNameAsync(r).done(function(){e.props.parent.openHome()})},icon:"check",className:"positive"},{label:lf("Cancel"),icon:"cancel",onClick:function(){pxt.tickEvent("exitandsave.cancel"),e.hide()}}];return o.createElement(s.Modal,{open:t,className:"exitandsave",header:lf("Exit Project"),size:"tiny",onClose:function(){return e.hide()},dimmer:!0,actions:i,closeIcon:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},o.createElement("div",{className:"ui form"},o.createElement(s.Input,{id:"projectNameInput",class:"focused",label:lf("Project Name"),ariaLabel:lf("Type a name for your project"),value:n,onChange:function(e){r=e}})))},t}(a.Component);n.ExitAndSaveDialog=y},{"./carousel":7,"./codecard":10,"./compiler":11,"./core":13,"./data":14,"./gallery":23,"./sui":44,react:277,"react-dom":148}],34:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./package"),a=e("./srceditor"),s=e("./sui"),c=e("./core"),l=pxt.Util,u=l.lf,p=function(e){function t(){e.apply(this,arguments),this.config={},this.changeMade=!1}return r(t,e),t.prototype.prepare=function(){this.isReady=!0},t.prototype.getId=function(){return"pxtJsonEditor"},t.prototype.hasEditorToolbar=function(){return!1},t.prototype.display=function(){var e=this,t=this.config,n=function(){if(e.isSaving=!0,!t.name)return c.errorNotification(u("Please choose a project name. It can't be blank.")),void(e.isSaving=!1);i.mainEditorPkg().lookupFile("this/"+pxt.CONFIG_NAME).setContentAsync(JSON.stringify(e.config,null,4)+"\n").then(function(){i.mainPkg.config.name=t.name,e.parent.setState({projectName:t.name}),e.parent.forceUpdate(),l.nextTick(e.changeCallback),e.isSaving=!1,e.changeMade=!0,e.parent.openPreviousEditor(),c.resetFocus()})},r=(t.card,[]);i.allEditorPkgs().map(function(e){return e.getKsPkg()}).filter(function(e){return!!e&&e.isLoaded&&!!e.config&&!!e.config.yotta&&!!e.config.yotta.userConfigs}).forEach(function(e){return r=r.concat(e.config.yotta.userConfigs)});var a=function(t){var n=l.jsonFlatten(e.config.yotta?e.config.yotta.config:{}),r=l.jsonFlatten(t.config);return!Object.keys(r).some(function(e){return null===r[e]?!!n[e]:n[e]!==r[e]})},p=function(t){var r=l.jsonFlatten(e.config.yotta?e.config.yotta.config:{}),o=l.jsonFlatten(t.config);a(t)?Object.keys(o).forEach(function(e){return delete r[e]}):Object.keys(o).forEach(function(e){return r[e]=o[e]}),Object.keys(r).length?(e.config.yotta||(e.config.yotta={}),Object.keys(r).filter(function(e){return null===r[e]}).forEach(function(e){return delete r[e]}),e.config.yotta.config=l.jsonUnFlatten(r)):e.config.yotta&&(delete e.config.yotta.config,Object.keys(e.config.yotta).length||delete e.config.yotta),n()};return o.createElement("div",{className:"ui content"},o.createElement("h3",{className:"ui small header"},o.createElement("div",{className:"content"},u("Project Settings"))),o.createElement("div",{className:"ui segment form text"},o.createElement(s.Input,{id:"fileNameInput",label:u("Name"),ariaLabel:u("Type a name for your project"),value:t.name,onChange:function(n){t.name=n,e.parent.forceUpdate()}}),r.map(function(e){return o.createElement(s.Checkbox,{key:"userconfig-"+e.description,inputLabel:e.description,checked:a(e),onChange:function(){return p(e)}})}),o.createElement(s.Field,null,o.createElement(s.Button,{text:u("Save"),class:"green "+(this.isSaving?"disabled":""),onClick:function(){return n()}}),o.createElement(s.Button,{text:u("Edit Settings As text"),onClick:function(){return e.editSettingsText()}}))))},t.prototype.isIncomplete=function(){return!this.changeMade},t.prototype.editSettingsText=function(){this.changeMade=!1,this.parent.editText()},t.prototype.getCurrentSource=function(){return JSON.stringify(this.config,null,4)+"\n"},t.prototype.acceptsFile=function(e){if(e.name!=pxt.CONFIG_NAME)return!1;if(e.isReadonly())return!1;try{JSON.parse(e.content);return!0}catch(e){return!1}},t.prototype.loadFileAsync=function(e){return this.config=JSON.parse(e.content),this.setDiagnostics(e,this.snapshotState()),this.changeMade=!1,Promise.resolve()},t.prototype.unloadFileAsync=function(){return this.changeMade?this.parent.reloadHeaderAsync():Promise.resolve()},t}(a.Editor);n.Editor=p},{"./core":13,"./package":32,"./srceditor":43,"./sui":44,react:277}],35:[function(e,t,n){"use strict";function r(e){var t=null;if(e&&e.width>0&&e.height>0){var n=document.createElement("canvas");n.width=305,n.height=200;var r=0,o=0,i=0,a=0;e.height>e.width?(r=0,a=(i=e.width)/n.width*n.height,o=(e.height-a)/2):(o=0,i=(a=e.height)/n.height*n.width,r=(e.width-i)/2),n.getContext("2d").drawImage(e,r,o,i,a,0,0,n.width,n.height),t=n.toDataURL("image/jpeg",85)}return t}var o=e("./workspace"),i=e("./data");n.saveAsync=function(e,t){return pxt.BrowserUtils.loadImageAsync(t).then(function(n){var a=r(n);return o.saveScreenshotAsync(e,t,a).then(function(){i.invalidate("header:"+e.id),i.invalidate("header:*")})})}},{"./data":14,"./workspace":48}],36:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("react-dom"),a=e("./data"),s=e("./sui"),c=e("./package"),l=e("./core"),u=e("./codecard"),p=function(e){function t(t){e.call(this,t),this.prevGhData=[],this.prevUrlData=[],this.prevGalleries=[],this.state={searchFor:"",visible:!1}}return r(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.showAddPackages=function(){this.setState({visible:!0,searchFor:""})},t.prototype.fetchUrlData=function(){if(!this.state.searchFor)return[];var e=pxt.Cloud.parseScriptId(this.state.searchFor);if(e){var t=this.getData("cloud-search:"+e);t&&(404!==t.statusCode?this.prevUrlData=[t]:this.prevUrlData=[])}else this.prevUrlData=[];return this.prevUrlData},t.prototype.fetchGhData=function(){var e=pxt.appTarget.cloud||{};if(!e.packages)return[];var t=e.githubPackages?this.state.searchFor:void 0,n=void 0;if(!t){var r=this.getData("target-config:");n=r&&r.packages?r.packages.preferredRepos:void 0}var o=t||n?this.getData("gh-search:"+(t||n.join("|"))):null;return o&&(this.prevGhData=o),this.prevGhData||[]},t.prototype.fetchBundled=function(){var e=this.state.searchFor,t=pxt.appTarget.bundledpkgs;return Object.keys(t).filter(function(e){return!/prj$/.test(e)}).map(function(e){return JSON.parse(t[e]["pxt.json"])}).filter(function(t){return!e||t.name.toLowerCase().indexOf(e.toLowerCase())>-1}).filter(function(e){return!c.mainPkg.deps[e.name]})},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.visible!=t.visible||this.state.searchFor!=t.searchFor},t.prototype.componentDidUpdate=function(){var e=i.findDOMNode(this.refs.searchInput);e&&e.focus()},t.prototype.renderCore=function(){var e=this;if(!this.state.visible)return o.createElement("div",null);pxt.appTarget.appTheme;var t=this.fetchBundled(),n=this.fetchGhData(),r=this.fetchUrlData();t.sort(function(e,t){return e.core!=t.core?e.core?-1:1:Util.strcmp(e.name,t.name)});var a=function(t){return e.hide(),c.mainEditorPkg().addDepAsync(t.name,"pub:"+t.id).then(function(){return e.props.parent.reloadHeaderAsync()})},p=function(t){pxt.tickEvent("packages.bundled",{name:t.name}),e.hide(),h(t,"*").done()},d=function(t){var n=i.findDOMNode(e.refs.searchInput).value,r=/^\/@(.*)$/.exec(n),o=r&&r[1];if(o){var a=pxt.appTarget.appTheme.homeUrl;/\/$/.test(a)||(a+="/"),o=o.replace(/^\//,""),window.location.href=a+o}else e.setState({searchFor:n})},f=function(t){pxt.tickEvent("packages.github",{name:t.fullName}),e.hide();c.mainEditorPkg();l.showLoading("downloadingpackage",lf("downloading package...")),pxt.packagesConfigAsync().then(function(e){return pxt.github.latestVersionAsync(t.fullName,e)}).then(function(e){return pxt.github.pkgConfigAsync(t.fullName,e).then(function(e){return l.hideLoading("downloadingpackage"),e}).then(function(n){return h(n,"github:"+t.fullName+"#"+e)})}).catch(l.handleNetworkError).finally(function(){return l.hideLoading("downloadingpackage")})},h=function(t,n){return c.mainPkg.findConflictsAsync(t,n).then(function(r){var o=t.core?[]:r.filter(function(e){return c.mainPkg.isPackageInUse(e.pkg0.id)}),i=Promise.resolve(!0);if(o.length)i=i.then(function(){return l.confirmAsync({header:lf("Cannot add {0} package",t.name),hideCancel:!0,agreeLbl:lf("Ok"),body:lf("Remove all the blocks from the {0} package and try again.",o[0].pkg0.id)})}).then(function(){return!1});else if(r.length){var a=1===r.length?lf("Package {0} is incompatible with {1}. Remove {0} and add {1}?",r[0].pkg0.id,t.name):lf("Packages {0} and {1} are incompatible with {2}. Remove them and add {2}?",r.slice(0,-1).map(function(e){return e.pkg0.id}).join(", "),r.slice(-1)[0].pkg0.id,t.name);i=i.then(function(){return l.confirmAsync({header:lf("Some packages will be removed"),agreeLbl:lf("Remove package(s) and add {0}",t.name),agreeClass:"pink focused",body:a})}).then(function(e){if(0!==e){var t=c.mainEditorPkg();return Promise.all(r.map(function(e){return t.removeDepAsync(e.pkg0.id)})).then(function(){return!0})}return Promise.resolve(!1)})}return i.then(function(r){return r?c.mainEditorPkg().addDepAsync(t.name,n).then(function(){return e.props.parent.reloadHeaderAsync()}):Promise.resolve()})})},m=lf("Extensions");return o.createElement(s.Modal,{open:this.state.visible,dimmer:!0,header:m,className:"searchdialog",longer:!0,size:"fullscreen",onClose:function(){return e.setState({visible:!1})},closeIcon:!0,helpUrl:"/packages",closeOnDimmerClick:!0,closeOnEscape:!0,description:lf("Add a package to the project")},o.createElement("div",{className:"ui vertical segment"},o.createElement("div",{className:"ui search"},o.createElement("div",{className:"ui fluid action input",role:"search"},o.createElement("div",{"aria-live":"polite",className:"accessible-hidden"},lf("{0} result matching '{1}'",t.length+n.length+r.length,this.state.searchFor)),o.createElement("input",{ref:"searchInput",className:"focused",type:"text",placeholder:lf("Search or enter project URL..."),onKeyUp:function(e){13==e.keyCode&&d()}}),o.createElement("button",{title:lf("Search"),className:"ui right icon button",onClick:d},o.createElement(s.Icon,{icon:"search"})))),o.createElement("div",{className:"ui cards",role:"listbox"},r.map(function(e){return o.createElement(u.CodeCardView,{key:"url"+e.id,name:e.name,description:e.description,url:"/"+e.id,onClick:function(){return a(e)},color:"red",role:"option"})}),t.map(function(e){return o.createElement(u.CodeCardView,{key:"bundled"+e.name,name:e.name,description:e.description,url:"/"+e.installedVersion,imageUrl:e.icon,onClick:function(){return p(e)},role:"option"})}),n.filter(function(e){return e.status==pxt.github.GitRepoStatus.Approved}).map(function(e){return o.createElement(u.CodeCardView,{name:e.name.replace(/^pxt-/,""),description:e.description,key:"gha"+e.fullName,onClick:function(){return f(e)},url:"github:"+e.fullName,color:"blue",imageUrl:pxt.github.repoIconUrl(e),label:/\bbeta\b/i.test(e.description)?lf("Beta"):void 0,role:"option"})}),n.filter(function(e){return e.status!=pxt.github.GitRepoStatus.Approved}).map(function(e){return o.createElement(u.CodeCardView,{name:e.name.replace(/^pxt-/,""),description:e.description||"",extracontent:lf("User provided package, not endorsed by Microsoft."),key:"ghd"+e.fullName,onClick:function(){return f(e)},imageUrl:pxt.github.repoIconUrl(e),url:"github:"+e.fullName,color:"red",role:"option"})})),!e.state.searchFor||t.length||n.length||r.length?void 0:o.createElement("div",{className:"ui items"},o.createElement("div",{className:"ui item"},lf("We couldn't find any packages matching '{0}'",this.state.searchFor)))))},t}(a.Component);n.ScriptSearch=p},{"./codecard":10,"./core":13,"./data":14,"./package":32,"./sui":44,react:277,"react-dom":148}],37:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./core"),a=e("./srceditor"),s=e("./sui"),c=e("./data"),l=pxt.Util,u=l.lf,p=function(e){function t(t){e.call(this,t),this.parent=t,this.charts=[],this.chartIdx=0,this.sourceMap={},this.consoleBuffer="",this.isSim=!0,this.maxConsoleLineLength=255,this.maxConsoleEntries=100,this.active=!0,this.maxChartTime=18e3,window.addEventListener("message",this.processMessage.bind(this),!1)}return r(t,e),t.prototype.getId=function(){return"serialEditor"},t.prototype.hasHistory=function(){return!1},t.prototype.hasEditorToolbar=function(){return!1},t.prototype.setVisible=function(e){this.isVisible=e,this.isVisible?this.startRecording():this.pauseRecording()},t.prototype.acceptsFile=function(e){return e.name===pxt.SERIAL_EDITOR_FILE},t.prototype.setSim=function(e){this.isSim=e,this.clear()},t.prototype.processMessage=function(e){var t=e.data;if(this.active&&"serial"===t.type){var n=t;if(!!n.sim==this.isSim){var r=n.data||"",o=n.id||"?";if(!this.sourceMap[o]){var i=Object.keys(this.sourceMap).length+1;this.sourceMap[o]=u("source")+i.toString()}var a=this.sourceMap[o],s=/^\s*(([^:]+):)?\s*(-?\d+(\.\d*)?)/i.exec(r);if(s){var c=s[2]||"",l=parseFloat(s[3]);if(!isNaN(l))return void this.appendGraphEntry(a,c,l)}this.appendConsoleEntry(r)}}},t.prototype.appendGraphEntry=function(e,t,n){for(var r=void 0,o=0;o<this.charts.length;++o){var i=this.charts[o];if(i.shouldContain(e,t)){r=i;break}}r||(r=new f(e,t,this.chartIdx),this.chartIdx++,this.charts.push(r),this.chartRoot.appendChild(r.getElement())),r.addPoint(t,n)},t.prototype.appendConsoleEntry=function(e){for(var t=0;t<e.length;++t){var n=e[t];if(this.consoleBuffer+=n,!("\n"!==n&&this.consoleBuffer.length<this.maxConsoleLineLength)){if("\n"===n){var r=this.consoleRoot.lastChild,o=document.createElement("div");if(r&&r.lastChild.textContent==this.consoleBuffer)if(2==r.childNodes.length){var i=parseInt(r.firstChild.textContent);r.firstChild.textContent=(i+1).toString()}else{var a=document.createElement("a");a.className="ui horizontal label",a.textContent="2",r.insertBefore(a,r.lastChild)}else o.appendChild(document.createTextNode(this.consoleBuffer)),this.consoleRoot.appendChild(o)}else(o=document.createElement("span")).appendChild(document.createTextNode(this.consoleBuffer)),this.consoleRoot.appendChild(o);this.consoleBuffer="",this.consoleRoot.scrollTop=this.consoleRoot.scrollHeight,this.consoleRoot.childElementCount>this.maxConsoleEntries&&this.consoleRoot.removeChild(this.consoleRoot.firstChild),this.consoleRoot&&this.consoleRoot.childElementCount>0&&(this.chartRoot&&this.chartRoot.classList.remove("noconsole"),this.consoleRoot&&this.consoleRoot.classList.remove("noconsole"))}}},t.prototype.dropStaleCharts=function(){var e=this,t=l.now();this.charts.forEach(function(n){t-n.lastUpdatedTime>e.maxChartTime&&(e.chartRoot.removeChild(n.rootElement),n.isStale=!0)}),this.charts=this.charts.filter(function(e){return!e.isStale})},t.prototype.pauseRecording=function(){this.active=!1,this.startPauseButton&&this.startPauseButton.setState({active:this.active}),this.charts.forEach(function(e){return e.stop()}),clearInterval(this.chartDropper)},t.prototype.startRecording=function(){this.active=!0,this.startPauseButton&&this.startPauseButton.setState({active:this.active}),this.charts.forEach(function(e){return e.start()}),this.chartDropper=setInterval(this.dropStaleCharts.bind(this),2e4)},t.prototype.toggleRecording=function(){pxt.tickEvent("serial.toggleRecording"),this.active?this.pauseRecording():this.startRecording()},t.prototype.clearNode=function(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)},t.prototype.clear=function(){this.chartRoot&&(this.clearNode(this.chartRoot),this.chartRoot.classList.add("noconsole")),this.consoleRoot&&(this.clearNode(this.consoleRoot),this.consoleRoot.classList.add("noconsole")),this.charts=[],this.consoleBuffer=""},t.prototype.downloadCSV=function(){var e=[];this.charts.forEach(function(t){return Object.keys(t.lines).forEach(function(n){return e.push({name:n+" ("+t.source+")",line:t.lines[n]})})});for(var t=e.map(function(e){return"time (s), "+e.name}).join(", ")+"\r\n",n=e.map(function(e){return e.line.data}),r=n.map(function(e){return e.length}).reduce(function(e,t){return Math.max(e,t)}),o=(this.charts.length,0);o<r;++o)!function(e){t+=n.map(function(t){return e<t.length?(t[e][0]-t[0][0])/1e3+", "+t[e][1]:" , "}).join(", "),t+="\r\n"}(o);pxt.commands.browserDownloadAsync(t,"data.csv","text/csv"),i.infoNotification(u("Exporting data...."))},t.prototype.goBack=function(){pxt.tickEvent("serial.backButton"),this.parent.openPreviousEditor()},t.prototype.display=function(){var e=this;return o.createElement("div",{id:"serialArea"},o.createElement("div",{id:"serialHeader",className:"ui"},o.createElement("div",{className:"leftHeaderWrapper"},o.createElement("div",{className:"leftHeader"},o.createElement(s.Button,{title:u("Go back"),class:"ui icon circular small button editorBack",ariaLabel:u("Go back"),onClick:this.goBack.bind(this)},o.createElement(s.Icon,{icon:"arrow left"})))),o.createElement("div",{className:"rightHeader"},o.createElement(s.Button,{title:u("Export data"),class:"ui icon blue button editorExport",ariaLabel:u("Export data"),onClick:function(){return e.downloadCSV()}},o.createElement(s.Icon,{icon:"download"})),o.createElement(d,{ref:function(t){return e.startPauseButton=t},active:this.active,toggle:this.toggleRecording.bind(this)}),o.createElement("span",{className:"ui small header"},u(this.isSim?"Simulator":"Device")))),o.createElement("div",{id:"serialCharts",className:"noconsole",ref:function(t){return e.chartRoot=t}}),o.createElement("div",{id:"serialConsole",className:"noconsole",ref:function(t){return e.consoleRoot=t}}))},t.prototype.domUpdate=function(){},t}(a.Editor);n.Editor=p;var d=function(e){function t(t){e.call(this,t),this.state={active:this.props.active}}return r(t,e),t.prototype.renderCore=function(){var e=this.props.toggle,t=this.state.active;return o.createElement(s.Button,{title:u(t?"Pause recording":"Start recording"),class:"ui left floated icon button "+(t?"green":"red circular")+" toggleRecord",onClick:e},o.createElement(s.Icon,{icon:t?"pause icon":"circle icon"}))},t}(c.Component);n.StartPauseButton=d;var f=function(){function e(e,t,n){var r=this;this.rootElement=document.createElement("div"),this.lines={},this.isStale=!1,this.lastUpdatedTime=0;var o=pxt.appTarget.serial&&pxt.appTarget.serial.editorTheme,i={interpolation:"bezier",labels:{disabled:!1,fillStyle:"black",fontSize:14},responsive:!0,millisPerPixel:20,grid:{verticalSections:0,borderVisible:!1,millisPerLine:5e3,fillStyle:o&&o.gridFillStyle||"transparent",strokeStyle:o&&o.gridStrokeStyle||"#fff"},tooltip:!0,tooltipFormatter:function(e,t){return r.tooltip(e,t)}};this.lineColors=o&&o.lineColors||["#f00","#00f","#0f0","#ff0"],this.chartIdx=n,this.chart=new SmoothieChart(i),this.rootElement.className="ui segment",this.source=e,this.variable=t.replace(/\..*$/,""),this.rootElement.appendChild(this.makeLabel()),this.rootElement.appendChild(this.makeCanvas())}return e.prototype.tooltip=function(e,t){return t.map(function(e){var t=e.series.timeSeries.__name;return"<span>"+(t?t+": ":"")+e.value+"</span>"}).join("<br/>")},e.prototype.getLine=function(e){var t=this.lines[e];if(!t){var n=this.lineColors[this.chartIdx++%this.lineColors.length];this.lines[e]=t=new TimeSeries,t.__name=l.htmlEscape(e.substring(this.variable.length+1)),this.chart.addTimeSeries(t,{strokeStyle:n,fillStyle:this.hexToHalfOpacityRgba(n),lineWidth:1})}return t},e.prototype.hexToHalfOpacityRgba=function(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,function(e,t,n,r){return t+t+n+n+r+r});var n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!n)return e;var r=n.slice(1,4).map(function(e){return parseInt(e,16)});return r.push(.3),"rgba("+r.join(",")+")"},e.prototype.makeLabel=function(){return this.label=document.createElement("div"),this.label.className="ui orange bottom left attached no-select label seriallabel",this.label.innerText=this.variable||"...",this.label},e.prototype.makeCanvas=function(){var e=document.createElement("canvas");return this.chart.streamTo(e),this.canvas=e,e},e.prototype.getCanvas=function(){return this.canvas},e.prototype.getElement=function(){return this.rootElement},e.prototype.shouldContain=function(e,t){return this.source==e&&this.variable==t.replace(/\..*$/,"")},e.prototype.addPoint=function(e,t){if(this.getLine(e).append(l.now(),t),this.lastUpdatedTime=l.now(),1==Object.keys(this.lines).length){var n=Number(Math.round(Number(t+"e+2"))+"e-2").toString();this.label.innerText=this.variable?this.variable+": "+n:n}else this.label.innerText=this.variable||""},e.prototype.start=function(){this.chart.start()},e.prototype.stop=function(){this.chart.stop()},e}()},{"./core":13,"./data":14,"./srceditor":43,"./sui":44,react:277}],38:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./sui"),a=function(e){function t(t){e.call(this,t),this.state={active:!1},window.addEventListener("message",this.setActive.bind(this))}return r(t,e),t.prototype.setActive=function(e){var t=e.data;this.state.active||"serial"!==t.type||!!t.sim===this.props.isSim&&this.setState({active:!0})},t.prototype.clear=function(){this.setState({active:!1})},t.prototype.render=function(){return this.state.active?o.createElement("div",{title:lf("Open console"),className:"ui label circular",tabIndex:0,onClick:this.props.onClick,onKeyDown:i.fireClickOnEnter},o.createElement("div",{className:"detail"},o.createElement(i.Icon,{icon:"bar graph"})),lf("Show console"),o.createElement("div",{className:"detail"},this.props.isSim?lf("Simulator"):lf("Device"))):o.createElement("div",null)},t}(o.Component);n.SerialIndicator=a},{"./sui":44,react:277}],39:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=e("./package");!function(e){e[e.Screenshot=0]="Screenshot",e[e.Url=1]="Url",e[e.Editor=2]="Editor",e[e.Simulator=3]="Simulator",e[e.Cli=4]="Cli"}(n.ShareMode||(n.ShareMode={}));var c=n.ShareMode,l=function(e){function t(t){e.call(this,t),this.state={currentPubId:void 0,pubCurrent:!1,visible:!1,advancedMenu:!1}}return r(t,e),t.prototype.hide=function(){this.setState({visible:!1})},t.prototype.show=function(e){this.setState({visible:!0,mode:c.Screenshot,pubCurrent:e.pubCurrent,sharingError:!1})},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.visible!=t.visible||this.state.advancedMenu!=t.advancedMenu||this.state.mode!=t.mode||this.state.pubCurrent!=t.pubCurrent||this.state.screenshotId!=t.screenshotId||this.state.currentPubId!=t.currentPubId||this.state.sharingError!=t.sharingError},t.prototype.renderCore=function(){var e=this,t=(this.state.visible,pxt.appTarget.appTheme),n=(pxt.appTarget.cloud,this.props.parent.state.header),r=!!this.state.advancedMenu,i=!!t.hideShareEmbed,l=!!t.socialOptions&&!pxt.BrowserUtils.isUwpEdge(),u=!1,p=this.state.mode,d="",f="";lf("Copy this HTML to your website or blog.");if(n){var h=pxt.appTarget.appTheme.shareUrl||"https://makecode.com/";/\/$/.test(h)||(h+="/");var m=pxt.appTarget.appTheme.embedUrl;/\/$/.test(m)||(m+="/");var g=this.props.parent.getPreferredEditor()==pxt.BLOCKS_PROJECT_NAME,v=(!!n&&n.pubCurrent,(n?n.pubId:void 0)||this.state.currentPubId);if(u=!!v&&n.pubCurrent){d=""+h+v;var y=m+"#pub:"+v;switch(p){case c.Cli:f="pxt target "+pxt.appTarget.id+"\npxt extract "+d,lf("Run this command from a shell.");break;case c.Editor:f=pxt.docs.embedUrl(m,"pub",n.pubId);break;case c.Simulator:var b="81.97%";pxt.appTarget.simulator&&(b=(100/pxt.appTarget.simulator.aspectRatio).toPrecision(4)+"%");var _=m+(pxt.webConfig.runUrl||"--run").replace(/^\//,"");f=pxt.docs.runUrl(_,b,n.pubId);break;case c.Url:f=y;break;default:if(g&&pxt.blocks.layout.screenshotEnabled())this.state.screenshotId==v?f=this.state.screenshotUri?'<a href="'+y+'"><img src="'+this.state.screenshotUri+'" /></a>':lf("Ooops, no screenshot available."):(pxt.debug("rendering share-editor screenshot png"),f=lf("rendering..."),pxt.blocks.layout.toPngAsync(this.props.parent.editor.editor).done(function(t){return e.setState({screenshotId:v,screenshotUri:t})}));else{pxt.debug("rendering share-editor javascript markdown"),f=lf("rendering...");var E=s.getEditorPkg(s.mainPkg),w=E.getMainFile();if(s.File.blocksFileNameRx.test(w.getName())&&w.getVirtualFileName()&&(w=E.lookupFile("this/"+w.getVirtualFileName())||w),s.File.tsFileNameRx.test(w.getName())){var k=w.content;f='<a style="text-decoration: none;" href="'+y+'">'+pxt.docs.renderMarkdown({template:"@body@",markdown:"```javascript\n"+k+"\n```"})+"</a>"}}}}}var x=[{mode:c.Screenshot,label:lf("Screenshot")},{mode:c.Editor,label:lf("Editor")},{mode:c.Simulator,label:lf("Simulator")},{mode:c.Cli,label:lf("Command line")}],C=u?void 0:lf("Publish project"),S=this.props.parent.state.publishing&&!this.state.sharingError,N="",T="";if(l){var O=lf("Check out what I made!"),D=pxt.appTarget.appTheme.socialOptions;D.twitterHandle&&D.orgTwitterHandle?O=lf("Check out what I made with @{0} and @{1}!",D.twitterHandle,D.orgTwitterHandle):D.twitterHandle?O=lf("Check out what I made with @{0}!",D.twitterHandle):D.orgTwitterHandle&&(O=lf("Check out what I made with @{0}!",D.orgTwitterHandle)),N="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(d),T="https://twitter.com/intent/tweet?url="+encodeURIComponent(d)+"&text="+encodeURIComponent(O)+(D.hashtags?"&hashtags="+encodeURIComponent(D.hashtags):""),D.related&&encodeURIComponent(D.related)}var R=function(){pxt.tickEvent("share.facebook"),a.popupWindow(N,lf("Share on Facebook"),600,600)},A=function(){pxt.tickEvent("share.twitter"),a.popupWindow(T,lf("Share on Twitter"),600,600)},P=[];return C&&P.push({label:C,onClick:function(){pxt.tickEvent("menu.embed.publish"),e.setState({sharingError:!1}),e.props.parent.anonymousPublishAsync().catch(function(t){e.setState({sharingError:!0})}).done(function(){e.setState({pubCurrent:!0}),e.forceUpdate()}),e.forceUpdate()},icon:"share alternate",loading:S,className:"primary"}),o.createElement(a.Modal,{open:this.state.visible,className:"sharedialog",header:lf("Share Project"),size:"small",onClose:function(){return e.setState({visible:!1})},dimmer:!0,actions:P,closeIcon:!0,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},o.createElement("div",{className:"ui form"},C?o.createElement("div",null,o.createElement("p",null,lf("You need to publish your project to share it or embed it in other web pages.")+" "+lf("You acknowledge having consent to publish this project.")),this.state.sharingError?o.createElement("p",{className:"ui red inverted segment"},lf("Oops! There was an error. Please ensure you are connected to the Internet and try again.")):void 0):void 0,d&&u?o.createElement("div",null,o.createElement("p",null,lf("Your project is ready! Use the address below to share your projects.")),o.createElement(a.Input,{id:"projectUri",class:"focused mini",readOnly:!0,lines:1,value:d,copy:!0,selectOnClick:!0,"aria-describedby":"projectUriLabel"}),o.createElement("label",{htmlFor:"projectUri",id:"projectUriLabel",className:"accessible-hidden"},lf("This is the read-only internet address of your project.")),l?o.createElement("div",{className:"social-icons"},o.createElement("a",{className:"ui button large icon facebook",tabIndex:0,"aria-label":"Facebook",onClick:function(e){return R(),e.preventDefault(),!1}},o.createElement(a.Icon,{icon:"facebook"})),o.createElement("a",{className:"ui button large icon twitter",tabIndex:0,"aria-label":"Twitter",onClick:function(e){return A(),e.preventDefault(),!1}},o.createElement(a.Icon,{icon:"twitter"}))):void 0):void 0,u&&!i?o.createElement("div",null,o.createElement("div",{className:"ui divider"}),o.createElement(a.Link,{class:"focused",icon:"chevron "+(r?"down":"right"),text:lf("Embed"),ariaExpanded:r,onClick:function(){return e.setState({advancedMenu:!r})}}),r?o.createElement(a.Menu,{pointing:!0,secondary:!0},x.map(function(t){return o.createElement(a.MenuItem,{key:"tab"+t.label,id:"tab"+t.mode,active:p==t.mode,name:t.label,onClick:function(){return e.setState({mode:t.mode})}})})):void 0,r?o.createElement(a.Field,null,o.createElement(a.Input,{id:"embedCode",class:"mini",readOnly:!0,lines:4,value:f,copy:u,disabled:!u,selectOnClick:!0}),o.createElement("label",{htmlFor:"embedCode",id:"embedCodeLabel",className:"accessible-hidden"},lf("This is the read-only code for the selected tab."))):null):void 0))},t}(i.Component);n.ShareEditor=l},{"./data":14,"./package":32,"./sui":44,react:277}],40:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=function(e){function t(){e.apply(this,arguments)}return r(t,e),t.prototype.openInstructions=function(){pxt.tickEvent("simulator.make"),this.props.parent.openInstructions()},t.prototype.startStopSimulator=function(){pxt.tickEvent("simulator.startstop"),this.props.parent.startStopSimulator()},t.prototype.restartSimulator=function(){pxt.tickEvent("simulator.restart"),this.props.parent.restartSimulator()},t.prototype.toggleTrace=function(){pxt.tickEvent("simulator.trace"),this.props.parent.toggleTrace()},t.prototype.toggleMute=function(){pxt.tickEvent("simulator.mute",{view:"computer",muteTo:""+!this.props.parent.state.mute}),this.props.parent.toggleMute()},t.prototype.toggleSimulatorFullscreen=function(){pxt.tickEvent("simulator.fullscreen",{view:"computer",fullScreenTo:""+!this.props.parent.state.fullscreen}),this.props.parent.toggleSimulatorFullscreen()},t.prototype.renderCore=function(){var e=this,t=this.props.parent.state,n=pxt.appTarget.appTheme,r=pxt.appTarget.simulator,i=!pxt.shell.isSandboxMode()&&t.showParts&&r&&(r.instructions||r.parts&&pxt.options.debug),s=t.running,c=t.fullscreen,l=t.tracing,u=t.mute,p=(t.compiling,!!t.tutorialOptions&&!!t.tutorialOptions.tutorial),d=!r.hideRestart,f=r.enableTrace,h=!p&&!r.hideFullscreen,m=!p&&n.hasAudio;n.hideMenuBar,n.hideEditorToolbar;if(r.headless)return o.createElement("div",null);lf("Download your code to the {0}",n.boardName);var g=s?lf("Stop the simulator"):lf("Start the simulator"),v=lf("Open assembly instructions"),y=lf("Restart the simulator"),b=t.tracing?lf("Disable Slow-Mo"):lf("Slow-Mo"),_=c?lf("Exit fullscreen mode"):lf("Launch in fullscreen"),E=u?lf("Unmute audio"):lf("Mute audio");return o.createElement("aside",{className:"ui item grid centered portrait hide simtoolbar",role:"complementary","aria-label":lf("Simulator toolbar")},o.createElement("div",{className:"ui icon tiny buttons "+(c?"massive":""),style:{padding:"0"}},i?o.createElement(a.Button,{icon:"configure",class:"fluid sixty secondary",text:lf("Make"),title:v,onClick:function(){return e.openInstructions()}}):void 0,o.createElement(a.Button,{key:"runbtn",class:"play-button "+(s?"stop":"play"),icon:s?"stop":"play",title:g,onClick:function(){return e.startStopSimulator()}}),d?o.createElement(a.Button,{key:"restartbtn",class:"restart-button",icon:"refresh",title:y,onClick:function(){return e.restartSimulator()}}):void 0,f?o.createElement(a.Button,{key:"debug",class:"trace-button "+(l?"orange":""),icon:"xicon turtle",title:b,onClick:function(){return e.toggleTrace()}}):void 0),o.createElement("div",{className:"ui icon tiny buttons "+(c?"massive":""),style:{padding:"0"}},m?o.createElement(a.Button,{key:"mutebtn",class:"mute-button "+(u?"red":""),icon:u?"volume off":"volume up",title:E,onClick:function(){return e.toggleMute()}}):void 0,h?o.createElement(a.Button,{key:"fullscreenbtn",class:"fullscreen-button",icon:"xicon "+(c?"fullscreencollapse":"fullscreen"),title:_,onClick:function(){return e.toggleSimulatorFullscreen()}}):void 0))},t}(i.Component);n.SimulatorToolbar=s},{"./data":14,"./sui":44,react:277}],41:[function(e,t,n){"use strict";function r(e,t){pxt.appTarget.appTheme.allowParentController&&pxt.BrowserUtils.isIFrame()&&pxt.editor.postHostMessageAsync({type:"pxthost",action:"simevent",subtype:e,exception:t})}function o(){pxsim.U.addClass(n.driver.container,s()),v=!0}function i(e){n.driver&&(a(),n.driver.stop(e),m.empty())}function a(){pxsim.U.removeClass(n.driver.container,s()),v=!1}function s(){return pxt.appTarget.simulator&&pxt.appTarget.simulator.invalidatedClass?pxt.appTarget.simulator.invalidatedClass:"sepia"}function c(){if(pxt.appTarget.simulator&&pxt.appTarget.simulator.stoppedClass)return pxt.appTarget.simulator.stoppedClass}function l(e){function t(e,t,n,r){var o=$('<button class="ui mini button teal" title="'+Util.htmlEscape(n)+'"></button>');return e&&o.addClass("icon").append('<i class="'+e+' icon"></i>'),t&&o.append(Util.htmlEscape(t)),o.click(r)}function r(e,t){for(var n=$("<div><h4>"+p.htmlEscape(e)+"</h4></div>"),r=0,o=Object.keys(t);r<o.length;r++){var i=o[r],a=t[i],s="";switch(typeof a){case"number":s=a+"";break;case"string":s=JSON.stringify(a);break;case"object":s=null==a?"null":void 0!==a.id?"(object)":a.text?a.text:"(unknown)";break;default:p.oops()}var c=i.replace(/___\d+$/,"");n.append("<div>"+p.htmlEscape(c)+": "+p.htmlEscape(s)+"</div>")}return n}if(void 0===e&&(e=null),m.empty(),n.driver.runOptions.debug){var o="tsprj"==d.editor;if(n.driver.state==pxsim.SimulatorState.Paused){var i=t("play",lf("Resume"),lf("Resume execution"),function(){return n.driver.resume(pxsim.SimulatorDebuggerCommand.Resume)}),a=t("xicon stepover",lf("Step over"),lf("Step over next function call"),function(){return n.driver.resume(pxsim.SimulatorDebuggerCommand.StepOver)}),s=t("xicon stepinto",lf("Step into"),lf("Step into next function call"),function(){return n.driver.resume(pxsim.SimulatorDebuggerCommand.StepInto)});m.append(i).append(a),o&&m.append(s)}else if(n.driver.state==pxsim.SimulatorState.Running){var c=t("pause",lf("Pause"),lf("Pause execution on the next instruction"),function(){return n.driver.resume(pxsim.SimulatorDebuggerCommand.Pause)});m.append(c)}if(e&&o){var l=$('<div class="ui segment debuggerview"></div>');l.append(r(p.lf("globals"),e.globals)),e.stackframes.forEach(function(e){var t=e.funcInfo;l.append(r(t.functionName,e.locals))}),$("#debugger").append(l)}}}var u=e("./core"),p=pxt.U;n.FAST_TRACE_INTERVAL=100,n.SLOW_TRACE_INTERVAL=500;var d,f,h,m,g={},v=!1;n.init=function(e,t){$(e).html('\n        <div id="simulators" class=\'simulator\'>\n        </div>\n        <div id="debugger" class="ui item landscape only">\n        </div>\n        '),m=$("#debugger");var o={revealElement:function(e){$(e).transition({animation:pxt.appTarget.appTheme.simAnimationEnter||"fly right in",duration:"0.5s"})},removeElement:function(e,t){pxt.appTarget.simulator.headless?($(e).addClass("simHeadless"),t()):$(e).transition({animation:pxt.appTarget.appTheme.simAnimationExit||"fly right out",duration:"0.5s",onComplete:function(){t&&t(),$(e).remove()}}).error(function(){t&&t(),$(e).remove()})},unhideElement:function(e){$(e).removeClass("simHeadless")},onDebuggerBreakpoint:function(e){l(e);var t=f.breakpoints[e.breakpointId];d&&d.highlightStatement(t),e.exceptionMessage&&u.errorNotification(lf("Program Error: {0}",e.exceptionMessage)),r("stopped",e.exceptionMessage)},onTraceMessage:function(e){var t=f.breakpoints[e.breakpointId];d&&d.highlightStatement(t)},onDebuggerWarning:function(e){for(var t=0,n=e.breakpointIds;t<n.length;t++){var r=n[t],o=f.breakpoints[r];if(o&&!p.startsWith("pxt_modules/",o.fileName)){d&&d.highlightStatement(o);break}}},onDebuggerResume:function(){r("resumed"),d&&d.highlightStatement(null),l()},onStateChanged:function(e){e===pxsim.SimulatorState.Stopped&&r("stopped"),l()},onSimulatorCommand:function(e){switch(e.command){case"restart":t.restartSimulator();break;case"modal":if(i(),!(pxt.shell.isSandboxMode()||e.displayOnceId&&g[e.displayOnceId])){var n={header:e.header,body:e.body,size:"large",copyable:e.copyable,disagreeLbl:lf("Close"),modalContext:e.modalContext},r=pxt.appTarget.simulator.trustedUrls,o=e.linkButtonHref&&r&&-1!==r.indexOf(e.linkButtonHref);o?n.agreeLbl=e.linkButtonLabel:n.hideAgree=!0,g[e.displayOnceId]=!0,u.confirmAsync(n).then(function(t){o&&1==t&&window.open(e.linkButtonHref,"_blank")}).done()}}},onTopLevelCodeEnd:function(){r("toplevelfinished")},stoppedClass:c()};n.driver=new pxsim.SimulatorDriver($("#simulators")[0],o),d=t,l()},n.setState=function(e,t){d&&d.editor!=e&&(d.editor=e,d.highlightStatement(null),l()),h=t},n.makeDirty=o,n.isDirty=function(){return v},n.run=function(e,t,o,i,s){a();var c=o.outfiles[pxtc.BINARY_JS],l=pxt.appTarget.simulator.boardDefinition,u=pxtc.computeUsedParts(o,!0),p=o.usedArguments;f=o;var d={boardDefinition:l,mute:i,parts:u,debug:t,fnArgs:p,highContrast:s,aspectRatio:u.length?pxt.appTarget.simulator.partsAspectRatio:pxt.appTarget.simulator.aspectRatio,partDefinitions:e.computePartDefinitions(u),cdnUrl:pxt.webConfig.commitCdnUrl,localizedStrings:n.simTranslations,refCountingDebug:pxt.options.debug};r("started"),n.driver.run(c,d)},n.mute=function(e){n.driver.mute(e),m.empty()},n.stop=i,n.hide=function(e){pxt.appTarget.simulator.headless||o(),n.driver.hide(e),m.empty()},n.unhide=function(){n.driver.unhide()},n.setTraceInterval=function(e){n.driver.setTraceInterval(e)},n.proxy=function(e){n.driver&&(n.driver.postMessage(e),m.empty())}},{"./core":13}],42:[function(e,t,n){"use strict";function r(e){var t=(pxt.appTarget.appTheme.sounds||{})[e];if(pxt.options.light||!t)return Promise.resolve(void 0);var n=a[t];if(n)return Promise.resolve(n);var r=pxt.webConfig.commitCdnUrl+"sounds/"+t;return Util.requestAsync({url:r,headers:{Accept:"audio/"+t.slice(-3)},responseArrayBuffer:!0}).then(function(e){return i.loadAsync(e.buffer)}).then(function(e){return a[t]=e})}function o(e){pxt.options.light||r(e).done(function(e){return e?i.play(e,s):void 0})}var i=e("./audio"),a={},s=.2;n.tutorialStep=function(){o("tutorialStep")},n.tutorialNext=function(){o("tutorialNext")},n.click=function(){o("click")},n.initTutorial=function(){pxt.options.light||Promise.all([r("tutorialStep"),r("tutorialNext"),r("click")]).done()}},{"./audio":4}],43:[function(e,t,n){"use strict";var r=e("react"),o=function(){function e(e){this.parent=e,this.isVisible=!1,this.changeCallback=function(){},this.isReady=!1}return e.prototype.setVisible=function(e){this.isVisible=e},e.prototype.acceptsFile=function(e){return!1},e.prototype.getViewState=function(){return{}},e.prototype.getCurrentSource=function(){return this.currSource},e.prototype.getId=function(){return"editor"},e.prototype.displayOuter=function(){return r.createElement("div",{className:"full-abs",key:this.getId(),id:this.getId(),style:{display:this.isVisible?"block":"none"}},this.display())},e.prototype.display=function(){return null},e.prototype.beforeCompile=function(){},e.prototype.prepare=function(){this.isReady=!0},e.prototype.resize=function(e){},e.prototype.snapshotState=function(){return null},e.prototype.unloadFileAsync=function(){return Promise.resolve()},e.prototype.isIncomplete=function(){return!1},e.prototype.hasHistory=function(){return!0},e.prototype.hasUndo=function(){return!0},e.prototype.hasRedo=function(){return!0},e.prototype.undo=function(){},e.prototype.redo=function(){},e.prototype.zoomIn=function(){},e.prototype.zoomOut=function(){},e.prototype.closeFlyout=function(){},e.prototype.loadFileAsync=function(e,t){return this.currSource=e.content,this.setDiagnostics(e,this.snapshotState()),Promise.resolve()},e.prototype.domUpdate=function(){},e.prototype.setDiagnostics=function(e,t){},e.prototype.setViewState=function(e){},e.prototype.saveToTypeScript=function(){return Promise.resolve("")},e.prototype.highlightStatement=function(e){},e.prototype.clearHighlightedStatements=function(){},e.prototype.filterToolbox=function(e,t){return void 0===t&&(t=pxt.blocks.CategoryMode.All),null},e.prototype.setHighContrast=function(e){},e.prototype.hasEditorToolbar=function(){return!0},e}();n.Editor=o},{react:277}],44:[function(e,t,n){"use strict";function r(e){return e.filter(function(e){return e&&0!==e.length&&""!=e.trim()}).join(" ")}function o(e,t,n){return void 0===n&&(n=!1),e+" "+(n?"":t.icon&&t.text?"icon icon-and-text":t.icon?"icon":"")+" "+(t.class||"")}function i(e){var t=[e.icon?c.createElement(h,{key:"iconkey",icon:e.icon+(e.text?" icon-and-text ":"")+(e.iconClass?" "+e.iconClass:"")}):null,e.text?c.createElement("span",{key:"textkey",className:"ui text"+(e.textClass?" "+e.textClass:"")},e.text):null];return e.icon&&e.rightIcon&&(t=t.reverse()),t}function a(e){var t="number"==typeof e.which?e.which:e.keyCode;t!==p.ENTER_KEY&&t!==p.SPACE_KEY||(e.preventDefault(),e.currentTarget.click())}var s=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},c=e("react"),l=e("react-dom"),u=e("./data"),p=e("./core");n.cx=r,n.popupWindow=function(e,t,n,r){return window.open(e,t,"resizable=no, copyhistory=no, width="+n+", height="+r+", top="+(screen.height/2-r/2)+", left="+(screen.width/2-n/2))},n.fireClickOnEnter=a;var d=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.popup=function(){if(this.props.popup){var e=this.child("");e.popup({content:this.props.popup}),e.data("hasPopupHide")||(e.data("hasPopupHide","yes"),e.on("click",function(){e.popup("hide")}))}},t.prototype.componentDidMount=function(){this.popup()},t.prototype.componentDidUpdate=function(){this.popup()},t}(u.Component);n.UiElement=d;var f=function(e){function t(){var t=this;e.apply(this,arguments),this.isOpened=!1,this.preventHide=!1,this.menuItemKeyDown=function(e){var n="number"==typeof e.which?e.which:e.keyCode;n===p.TAB_KEY?t.close():n!==p.ENTER_KEY&&n!==p.SPACE_KEY||t.child("").focus()},this.dropDownKeyDown=function(e){var n="number"==typeof e.which?e.which:e.keyCode;n!==p.ENTER_KEY&&n!==p.SPACE_KEY||(t.isOpened?t.child("").dropdown("hide"):t.child("").dropdown("show"))}}return s(t,e),t.prototype.close=function(){this.preventHide=!1,this.child("").dropdown("hide")},t.prototype.componentDidMount=function(){var e=this;this.popup();var t=this.child("");t.on("keydown",this.dropDownKeyDown),t.dropdown({action:function(t,n,r){e.close(),"function"==typeof r.get&&"a"===r.get(0).tagName.toLowerCase()&&window.open(r.get(0).href,"_blank")},fullTextSearch:!0,onChange:function(t,n,r){e.preventHide=!0,r.get(0).focus(),e.props.onChange&&t!=e.props.value&&e.props.onChange(t)},onShow:function(){e.isOpened=!0,e.forceUpdate(),e.child(".item").each(function(t,n){n.onkeydown=e.menuItemKeyDown})},onHide:function(){return e.preventHide?(e.preventHide=!1,!1):(e.isOpened=!1,e.forceUpdate(),!0)}})},t.prototype.componentDidUpdate=function(){this.child("").dropdown("refresh"),this.popup()},t.prototype.renderCore=function(){return c.createElement("div",{className:o("ui dropdown item",this.props),role:"menuitem",title:this.props.title,tabIndex:this.props.tabIndex,"aria-haspopup":"true"},i(this.props),c.createElement("div",{className:"menu",role:"menu","aria-expanded":this.isOpened,"aria-label":lf("Dropdown menu {0}",this.props.title),"aria-hidden":!this.isOpened},this.props.children))},t}(d);n.DropdownMenuItem=f;var h=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){return c.createElement("i",{className:"icon "+this.props.icon,onClick:this.props.onClick,"aria-hidden":!0,role:"presentation"},this.props.children)},t}(u.Component);n.Icon=h;var m=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.text,n=e.title,r=e.ariaLabel;return c.createElement("div",{className:o("ui item link",this.props,!0)+" "+(this.props.active?"active":""),role:this.props.role,"aria-label":r||n||t,title:n||t,tabIndex:this.props.tabIndex||0,key:this.props.value,"data-value":this.props.value,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||a},i(this.props),this.props.children)},t}(u.Component);n.Item=m;var g=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){return c.createElement("div",{className:o("ui item link",this.props,!0)+" "+(this.props.active?"active":""),role:this.props.role,title:this.props.title||this.props.text,tabIndex:this.props.tabIndex||0,key:this.props.value,"data-value":this.props.value,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown||a},c.createElement("div",{className:o("ui button",this.props)},i(this.props),this.props.children))},t}(d);n.ButtonMenuItem=g;var v=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){return c.createElement("button",{className:o("ui button",this.props)+" "+(this.props.disabled?"disabled":""),id:this.props.id,role:this.props.role,title:this.props.title,tabIndex:this.props.tabIndex||0,"aria-label":this.props.ariaLabel,"aria-expanded":this.props.ariaExpanded,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown},i(this.props),this.props.children)},t}(d);n.Button=v;var y=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){return c.createElement("a",{className:o("ui",this.props)+" "+(this.props.disabled?"disabled":""),id:this.props.id,href:this.props.href,target:this.props.target,role:this.props.role,title:this.props.title,tabIndex:this.props.tabIndex||0,"aria-label":this.props.ariaLabel,"aria-expanded":this.props.ariaExpanded,onClick:this.props.onClick,onKeyDown:this.props.onKeyDown},i(this.props),this.props.children)},t}(d);n.Link=y;var b=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.componentDidMount=function(){this.child(".popup-button").popup({position:"bottom right",on:"click",hoverable:!0,delay:{show:50,hide:1e3}})},t.prototype.componentDidUpdate=function(){this.child(".popup-button").popup("refresh")},t.prototype.renderCore=function(){return c.createElement("div",{role:this.props.role},c.createElement("div",{className:o("ui button popup-button",this.props)},i(this.props)),c.createElement("div",{className:"ui popup transition hidden"},this.props.children))},t}(u.Component);n.Popup=b;var _=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){return c.createElement("div",{className:"field"},this.props.label?c.createElement("label",{htmlFor:this.props.ariaLabel?void 0:this.props.htmlFor},this.props.label):null,this.props.ariaLabel&&this.props.htmlFor?c.createElement("label",{htmlFor:this.props.htmlFor,className:"accessible-hidden"},this.props.ariaLabel):"",this.props.children)},t}(u.Component);n.Field=_;var E=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.copy=function(){var e=this.props,t=l.findDOMNode(this);if(e.lines&&1!=e.lines){var n=t.getElementsByTagName("textarea")[0];n.focus(),n.setSelectionRange(0,9999)}else(n=t.getElementsByTagName("input")[0]).focus(),n.setSelectionRange(0,9999);try{var r=document.execCommand("copy");pxt.debug("copy: "+r)}catch(e){}},t.prototype.renderCore=function(){var e=this,t=this.props,n=t.copy&&document.queryCommandSupported("copy")?c.createElement(v,{class:"ui right labeled primary icon button",text:lf("Copy"),icon:"copy",onClick:function(){return e.copy()}}):null,r=this.state&&void 0!==this.state.value?this.state.value:t.value,o=function(n){t.readOnly||e.state&&e.state.value===n||e.setState({value:n}),t.onChange&&t.onChange(n)};return c.createElement(_,{ariaLabel:t.ariaLabel,htmlFor:t.id,label:t.label},c.createElement("div",{className:"ui input"+(t.inputLabel?" labelled":"")+(t.copy?" action fluid":"")+(t.disabled?" disabled":"")},t.inputLabel?c.createElement("div",{className:"ui label"},t.inputLabel):"",t.lines&&1!=t.lines?c.createElement("textarea",{id:t.id,className:"ui input "+(t.class||"")+(t.inputLabel?" labelled":""),rows:t.lines,placeholder:t.placeholder,value:r,readOnly:!!t.readOnly,onClick:function(e){return t.selectOnClick?e.target.setSelectionRange(0,9999):void 0},onChange:function(e){return o(e.target.value)}}):c.createElement("input",{id:t.id,className:t.class||"",type:t.type||"text",placeholder:t.placeholder,value:r,readOnly:!!t.readOnly,onClick:function(e){return t.selectOnClick?e.target.setSelectionRange(0,9999):void 0},onChange:function(e){return o(e.target.value)}}),n))},t}(u.Component);n.Input=E;var w=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){var e=this.props;return c.createElement(_,{label:e.label},c.createElement("div",{className:"ui toggle checkbox"},c.createElement("input",{type:"checkbox",checked:e.checked,onChange:function(t){return e.onChange(t.target.value)}}),e.inputLabel?c.createElement("label",null,e.inputLabel):void 0))},t}(u.Component);n.Checkbox=w;var k=function(e){function t(){e.apply(this,arguments)}return s(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.attached,n=e.basic,o=e.children,i=e.circular,a=e.className,s=e.clearing,l=e.color,u=e.compact,p=e.disabled,d=e.floated,f=e.inverted,h=e.loading,m=e.padded,g=e.piled,v=e.raised,y=e.secondary,b=e.size,_=e.stacked,E=e.tertiary,w=e.textAlign,k=e.vertical,x=r(["ui",l,b,n?"basic":"",i?"circular":"",s?"clearing":"",u?"compact":"",p?"disabled":"",f?"inverted":"",h?"loading":"",g?"piled":"",v?"raised":"",y?"secondary":"",_?"stacked":"",E?"tertiary":"",k?"vertical":"",t?t+" attached":"",m?m+" padded":"",w?"justified"==w?"justified":w+" aligned":"",d?d+" floated":"","segment",a]);return c.createElement("div",{className:x},o)},t}(u.Component);n.Segment=k;var x=function(e){function t(t){var n=this;e.call(this,t),this.handleClick=function(e){var t=n.props.onClick;t&&t(e,n.props)}}return s(t,e),t.prototype.renderCore=function(){var e=this.props,t=e.active,n=e.children,o=e.className,i=e.color,a=e.content,s=e.fitted,l=e.header,u=e.icon,p=e.link,d=e.name,f=e.onClick,m=e.position,g=e.ariaControls,v=e.id,y=r([i,m,t?"active":"",!0===u||u&&!d&&!a?"icon":"",l?"header":"",p||f?"link":"",s?1==s?""+s:"fitted "+s:"","item",o]);return n?c.createElement("div",{className:y,onClick:this.handleClick},n):c.createElement("div",{id:v,tabIndex:t?0:-1,className:y,onClick:this.handleClick,role:"tab","aria-controls":g,"aria-selected":t,"aria-label":a||d},u?c.createElement(h,{icon:u}):void 0,a||d)},t}(u.Component);n.MenuItem=x;var C=function(e){function t(t){var n=this;e.call(this,t),this.handleKeyboardNavigation=function(e){var t="number"==typeof e.which?e.which:e.keyCode,r=37===t||38===t,o=39===t||40===t;if(r||o){for(var i=n.child(".link"),a=-1,s=0;-1===a&&s<i.length;)i.get(s).classList.contains("active")&&(a=s),s++;if(-1!==a){var c;r&&!Util.isUserLanguageRtl()||o&&Util.isUserLanguageRtl()?c=0===a?i.get(i.length-1):i.get(a-1):(o&&!Util.isUserLanguageRtl()||r&&Util.isUserLanguageRtl())&&(c=a===i.length-1?i.get(0):i.get(a+1)),void 0!==c&&(c.click(),c.focus())}}}}return s(t,e),t.prototype.componentDidMount=function(){var e=this;this.child(".link").each(function(t,n){n.onkeydown=e.handleKeyboardNavigation})},t.prototype.renderCore=function(){var e=this.props,t=e.attached,n=e.borderless,o=e.children,i=e.className,a=e.color,s=e.compact,l=e.fixed,u=e.floated,p=e.fluid,d=e.icon,f=e.inverted,h=e.pagination,m=e.pointing,g=e.secondary,v=e.size,y=e.stackable,b=e.tabular,_=e.text,E=e.vertical,w=r(["ui",a,v,n?"borderless":"",s?"compact":"",p?"fluid":"",f?"inverted":"",h?"pagination":"",m?"pointing":"",g?"secondary":"",y?"stackable":"",_?"text":"",E?"vertical":"",t?1==t?"attached":t+" attached ":"",u?1==u?"floated":u+" floated":"",d?1==d?"icon":d+" icon":"",b?1==b?"tabular":b+" tabular":"",l?"tabular "+b:"",i,"menu"]);return c.createElement("div",{className:w,role:"tablist"},o)},t}(u.Component);n.Menu=C;var S=function(e){function t(t){var n=this;e.call(this,t),this.getMountNode=function(){return n.props.mountNode||document.body},this.handleClose=function(e){0!=n.state.open&&n.setState({open:!1});var t=n.props.onClose;t&&t(e,n.props)},this.handleOpen=function(e){var t=n.props.onOpen;t&&t(e,n.props),1!=n.state.open&&n.setState({open:!0,scrolling:!1})},this.setPosition=function(){if(n.ref){var e=n.props.dimmer,t=n.getMountNode(),r=void 0;r=n.ref.parentElement?n.ref.getBoundingClientRect().height:0,e&&(t.classList.add("dimmable"),t.classList.add("dimmed"));var o=-Math.round(r/2),i="home"==n.props.size||r>=window.innerHeight,a={};n.state.marginTop!==o&&(a.marginTop=o),n.state.scrolling!==i&&(a.scrolling=i,i?t.classList.add("scrolling"):t.classList.remove("scrolling")),Object.keys(a).length>0&&(n.setState(a),n.props.onPositionChanged&&n.props.onPositionChanged(n.props))}n.animationId=requestAnimationFrame(n.setPosition)},this.handlePortalMount=function(){var e=n.props.dimmer,t=n.getMountNode();e&&(t.classList.add("dimmable"),t.classList.add("dimmed"),"blurring"!==e||pxt.options.light||t.classList.add("blurring")),n.setPosition()},this.handleRef=function(e){return n.ref=e},this.handlePortalUnmount=function(){var e=n.getMountNode();e.classList.remove("blurring"),e.classList.remove("dimmable"),e.classList.remove("dimmed"),e.classList.remove("scrolling"),n.animationId&&cancelAnimationFrame(n.animationId)},this.id=Util.guidGen(),this.state={open:this.props.open,scrolling:!1}}return s(t,e),t.prototype.componentWillUnmount=function(){this.handlePortalUnmount()},t.prototype.componentWillMount=function(){var e=this.props.open;this.setState({open:e})},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.open&&(t.open=e.open,t.scrolling=!1),Object.keys(t).length>0&&this.setState(t)},t.prototype.renderCore=function(){var e=this,t=this.state.open,n=this.props,o=n.basic,i=n.children,s=n.className,l=n.closeIcon,u=n.closeOnDimmerClick,d=n.closeOnDocumentClick,f=n.closeOnEscape,m=n.dimmer,g=n.dimmerClassName,y=n.size,b=n.longer,_=n.allowResetFocus,E=this.state,w=E.marginTop,k=E.scrolling,x=r(["ui",y,b?"longer":"",o?"basic":"",k?"scrolling":"","modal transition visible active",s]),C=!0===l?"close":l,S=c.createElement("div",{className:x,style:{marginTop:w},ref:this.handleRef,role:"dialog","aria-labelledby":this.props.header?this.id+"title":void 0,"aria-describedby":this.props.description?this.id+"description":this.id+"desc"},this.props.header?c.createElement("div",{id:this.id+"title",className:"header "+(this.props.headerClass||"")},this.props.header,this.props.helpUrl?c.createElement("a",{className:"ui huge icon clear focused",href:this.props.helpUrl,target:"_docs",role:"button","aria-label":lf("Help on {0} dialog",this.props.header)},c.createElement(h,{icon:"help"})):void 0):void 0,this.props.description?c.createElement("label",{id:this.id+"description",className:"accessible-hidden"},this.props.description):void 0,c.createElement("div",{id:this.id+"desc",className:(b?"scrolling":"")+" content"},i),this.props.actions&&this.props.actions.length>0?c.createElement("div",{className:"actions"},this.props.actions.map(function(e){return c.createElement(v,{key:"action_"+e.label,icon:e.icon,text:e.label,class:"approve "+(e.icon?"icon right labeled":"")+" "+(e.className||"")+" "+(e.loading?"loading disabled":"")+" focused",onClick:function(){e.onClick()},onKeyDown:a})})):void 0,l?c.createElement(v,{icon:C,class:"huge clear right floated closeIcon focused",onClick:function(){return e.handleClose(null)},tabIndex:0,ariaLabel:lf("Close dialog")}):void 0),T=m?r([p.highContrast?"hc":"","ui",y,"inverted"===m?"inverted":"",pxt.options.light?"":"transition","page modals dimmer visible active",g]):null;return c.createElement(N,{closeOnRootNodeClick:u,closeOnDocumentClick:d,closeOnEscape:f,className:T,mountNode:this.getMountNode(),onMount:this.handlePortalMount,onUnmount:this.handlePortalUnmount,onClose:this.handleClose,onOpen:this.handleOpen,open:t,allowResetFocus:_},S)},t}(u.Component);n.Modal=S;var N=function(e){function t(t){var n=this;e.call(this,t),this.handleDocumentClick=function(e){var t=n.props,r=t.closeOnDocumentClick,o=t.closeOnRootNodeClick;if(n.rootNode&&n.portalNode&&!n.portalNode.contains(e.target)){var i=n.rootNode.contains(e.target);(r&&!i||o&&i)&&n.close(e)}},this.handleEscape=function(e){27===("number"==typeof e.which?e.which:e.keyCode)&&n.props.closeOnEscape&&(e.preventDefault(),n.close(e))},this.close=function(e){0!=n.state.open&&n.setState({open:!1});var t=n.props.onClose;t&&t(e)},this.open=function(e){var t=n.props.onOpen;t&&t(e),1!=n.state.open&&n.setState({open:!0})},this.mountPortal=function(){if(!n.rootNode){var e=n.props.mountNode,t=void 0===e?document.body:e;n.rootNode=document.createElement("div"),t.appendChild(n.rootNode),document.addEventListener("click",n.handleDocumentClick),document.addEventListener("keydown",n.handleEscape,!0);var r=n.props.onMount;r&&r()}},this.unmountPortal=function(){if(n.rootNode){l.unmountComponentAtNode(n.rootNode),n.rootNode.parentNode.removeChild(n.rootNode),n.rootNode=null,n.portalNode=null,document.removeEventListener("click",n.handleDocumentClick),document.removeEventListener("keydown",n.handleEscape,!0);var e=n.props.onUnmount;e&&e(),null!==n.focusedNodeBeforeOpening&&(n.focusedNodeBeforeOpening.focus(),n.focusedNodeBeforeOpening=null)}},this.focusedNodeBeforeOpening=null}return s(t,e),t.prototype.componentDidMount=function(){this.state.open&&this.renderPortal()},t.prototype.componentDidUpdate=function(e,t){this.state.open&&this.renderPortal(),t.open&&!this.state.open&&this.unmountPortal()},t.prototype.componentWillUnmount=function(){this.unmountPortal()},t.prototype.componentWillMount=function(){var e=this.props.open;this.setState({open:e})},t.prototype.componentWillReceiveProps=function(e){var t={};void 0!=e.open&&(t.open=e.open),Object.keys(t).length>0&&this.setState(t)},t.prototype.renderPortal=function(){var e=this.props,t=e.children,n=e.className,r=(e.open,e.allowResetFocus);this.mountPortal(),this.rootNode.className=n||"",l.unstable_renderSubtreeIntoContainer(this,c.Children.only(t),this.rootNode),null===this.focusedNodeBeforeOpening&&(this.focusedNodeBeforeOpening=document.activeElement),this.portalNode=this.rootNode.firstElementChild,p.initializeFocusTabIndex(this.portalNode,r)},t.prototype.renderCore=function(){return c.createElement("div",null)},t}(u.Component);n.Portal=N},{"./core":13,"./data":14,react:277,"react-dom":148}],45:[function(e,t,n){"use strict";var r,o=e("./package"),i=e("./compiler");n.td2tsAsync=function(e){return r||(r=pxt.worker.makeWebWorker(pxt.webConfig.tdworkerjs)),o.mainPkg.getCompileOptionsAsync().then(function(e){return e.ast=!0,i.workerOpAsync("compileTd",{options:e})}).then(function(t){var n={text:e,useExtensions:!0,apiInfo:t};return r.opAsync("td2ts",n)}).then(function(e){return pxt.debug(e),e.text})}},{"./compiler":11,"./package":32}],46:[function(e,t,n){"use strict";function r(e){o=(new DOMParser).parseFromString(e,"text/xml")}var o,i='<xml id="blocklyToolboxDefinition" style="display: none">\n    <category name="Loops" nameid="loops" colour="#107c10" category="50" web-icon="" iconclass="blocklyTreeIconloops" expandedclass="blocklyTreeIconloops">    \n        <block type="controls_repeat_ext">\n            <value name="TIMES">\n                <shadow type="math_number">\n                    <field name="NUM">4</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="device_while">\n            <value name="COND">\n                <shadow type="logic_boolean"></shadow>\n            </value>\n        </block>\n        <block type="controls_simple_for">\n            <value name="TO">\n                <shadow type="math_number">\n                    <field name="NUM">4</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_for_of">\n            <value name="LIST">\n                <shadow type="variables_get">\n                    <field name="VAR">list</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category name="Logic" nameid="logic" colour="#006970" category="49" web-icon="" iconclass="blocklyTreeIconlogic" expandedclass="blocklyTreeIconlogic">    \n        <label text="Conditionals" web-class="blocklyFlyoutGroup" web-line="1.5"/>\n        <block type="controls_if" gap="8">\n            <value name="IF0">\n                <shadow type="logic_boolean">\n                    <field name="BOOL">TRUE</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="controls_if" gap="8">\n            <mutation else="1"></mutation>\n            <value name="IF0">\n                <shadow type="logic_boolean">\n                    <field name="BOOL">TRUE</field>\n                </shadow>\n            </value>\n        </block>\n        <label text="Comparison" web-class="blocklyFlyoutGroup" web-line="1.5"/>\n        <block type="logic_compare" gap="8">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="logic_compare">\n            <field name="OP">LT</field>\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <label text="Boolean" web-class="blocklyFlyoutGroup" web-line="1.5"/>\n        <block type="logic_operation" gap="8"></block>\n        <block type="logic_operation" gap="8">\n            <field name="OP">OR</field>\n        </block>\n        <block type="logic_negate"></block>\n        <block type="logic_boolean" gap="8"></block>\n        <block type="logic_boolean">\n            <field name="BOOL">FALSE</field>\n        </block>\n    </category>\n    <category name="Variables" nameid="variables" colour="#A80000" custom="VARIABLE" category="48" iconclass="blocklyTreeIconvariables" expandedclass="blocklyTreeIconvariables">\n    </category>\n    <category name="Math" nameid="math" colour="#712672" category="47" web-icon="" iconclass="blocklyTreeIconmath" expandedclass="blocklyTreeIconmath">    \n        <block type="math_arithmetic" gap="8">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_arithmetic" gap="8">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <field name="OP">MINUS</field>\n        </block>\n        <block type="math_arithmetic" gap="8">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <field name="OP">MULTIPLY</field>\n        </block>\n        <block type="math_arithmetic" gap="8">\n            <value name="A">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="B">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <field name="OP">DIVIDE</field>\n        </block>\n        <block type="math_number" gap="8">\n            <field name="NUM">0</field>\n        </block>\n        <block type="math_modulo">\n            <value name="DIVIDEND">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="DIVISOR">\n                <shadow type="math_number">\n                    <field name="NUM">1</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_op2" gap="8">\n            <value name="x">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="y">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="math_op2" gap="8">\n            <value name="x">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <value name="y">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n            <field name="op">max</field>\n        </block>\n        <block type="math_op3">\n            <value name="x">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category name="Functions" nameid="functions" colour="#005a9e" custom="PROCEDURE" category="46" iconclass="blocklyTreeIconfunctions" expandedclass="blocklyTreeIconfunctions" advanced="true">\n    </category>\n    <category colour="#66672C" name="Arrays" nameid="arrays" category="45" web-icon="" iconclass="blocklyTreeIconarrays" expandedclass="blocklyTreeIconarrays" advanced="true">\n        <block type="lists_create_with">\n            <mutation items="1"></mutation>\n            <value name="ADD0">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_create_with">\n            <mutation items="2"></mutation>\n            <value name="ADD0">\n                <shadow type="text">\n                    <field name="TEXT"></field>\n                </shadow>\n            </value>\n            <value name="ADD1">\n                <shadow type="text">\n                    <field name="TEXT"></field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_length"></block>\n        <block type="lists_index_get">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">'+lf("{id:var}list")+'</field>\n                </block>\n            </value>\n            <value name="INDEX">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="lists_index_set">\n            <value name="LIST">\n                <block type="variables_get">\n                    <field name="VAR">'+lf("{id:var}list")+'</field>\n                </block>\n            </value>\n            <value name="INDEX">\n                <shadow type="math_number">\n                    <field name="NUM">0</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n    <category colour="#996600" name="Text" nameid="text" category="46" web-icon="" iconclass="blocklyTreeIcontext" expandedclass="blocklyTreeIcontext" advanced="true">\n        <block type="text"></block>\n        <block type="text_length">\n            <value name="VALUE">\n                <shadow type="text">\n                    <field name="TEXT">'+lf("Hello")+'</field>\n                </shadow>\n            </value>\n        </block>\n        <block type="text_join">\n            <mutation items="2"></mutation>\n            <value name="ADD0">\n                <shadow type="text">\n                    <field name="TEXT">'+lf("Hello")+'</field>\n                </shadow>\n            </value>\n            <value name="ADD1">\n                <shadow type="text">\n                    <field name="TEXT">'+lf("World")+"</field>\n                </shadow>\n            </value>\n        </block>\n    </category>\n</xml>";n.getBaseToolboxDom=function(){return o||r(i),o},n.overrideBaseToolbox=r},{}],47:[function(e,t,n){"use strict";var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=e("react"),i=e("./data"),a=e("./sui"),s=e("./sounds"),c=e("./core"),l=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.openTutorialStep=function(e){var t=this.props.parent.state.tutorialOptions;t.tutorialStep=e,pxt.tickEvent("tutorial.step",{tutorial:t.tutorial,step:e}),this.props.parent.setTutorialStep(e)},t.prototype.render=function(){var e=this,t=this.props.parent.state.tutorialOptions,n=t.tutorialReady,r=t.tutorialStepInfo,i=t.tutorialStep,s=(t.tutorialName,this.props.parent.state,pxt.appTarget.appTheme,i);return n?o.createElement("div",{className:"ui item"},o.createElement("div",{className:"ui item tutorial-menuitem",role:"menubar"},r.map(function(t,r){return r==s?o.createElement("span",{className:"step-label",key:"tutorialStep"+r},o.createElement("a",{className:"ui circular label "+(s==r?"blue selected":"inverted")+" "+(n?"":"disabled"),role:"menuitem","aria-label":lf("Tutorial step {0}. This is the current step",r+1),tabIndex:0,onClick:function(){return e.openTutorialStep(r)},onKeyDown:a.fireClickOnEnter},r+1)):o.createElement("span",{className:"step-label",key:"tutorialStep"+r,"data-tooltip":""+(r+1),"data-inverted":"","data-position":"bottom center"},o.createElement("a",{className:"ui empty circular label "+(n?"":"disabled")+" clear",role:"menuitem","aria-label":lf("Tutorial step {0}",r+1),tabIndex:0,onClick:function(){return e.openTutorialStep(r)},onKeyDown:a.fireClickOnEnter}))}))):o.createElement("div",null)},t}(i.Component);n.TutorialMenuItem=l;var u=function(e){function t(t){e.call(this,t)}return r(t,e),t.notify=function(e){var t=document.getElementById("tutorialcontent");t&&t.contentWindow&&t.contentWindow.postMessage(e,"*")},t.prototype.setPath=function(e){var t=(pxt.webConfig.docsUrl||"/--docs")+"#tutorial:"+e+":"+(this.props.parent.isBlocksEditor()?"blocks":"js")+":"+pxt.Util.localeInfo();this.setUrl(t)},t.prototype.setUrl=function(e){var t=document.getElementById("tutorialcontent");t?t.src=e:this.setState({tutorialUrl:e})},t.prototype.shouldComponentUpdate=function(e,t,n){return this.state.tutorialUrl!=t.tutorialUrl},t.refresh=function(){s.tutorialStep(),$("#root").dimmer({closable:!0,onShow:function(){document.getElementById("tutorialOkButton").focus()}}).dimmer("show")},t.prototype.renderCore=function(){var e=this.state.tutorialUrl;return e?o.createElement("iframe",{id:"tutorialcontent",style:{width:"1px",height:"1px"},src:e,role:"complementary",sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"}):null},t}(i.Component);n.TutorialContent=u;var p=function(e){function t(t){e.call(this,t)}return r(t,e),t.prototype.showHint=function(){this.setState({visible:!0})},t.prototype.renderCore=function(){var e=this,t=this.state.visible,n=this.props.parent.state.tutorialOptions,r=n.tutorialReady,i=n.tutorialStepInfo,s=n.tutorialStep,c=n.tutorialName;if(!r)return o.createElement("div",null);var l=i[s].content,u=i[s].fullscreen?c:lf("Hint"),p=[{label:lf("Ok"),onClick:function(){return e.setState({visible:!1})},icon:"check",className:"green"}];return o.createElement(a.Modal,{open:t,className:"hintdialog",size:"",longer:!0,header:u,closeIcon:!0,onClose:function(){return e.setState({visible:!1})},dimmer:!0,actions:p,closeOnDimmerClick:!0,closeOnDocumentClick:!0,closeOnEscape:!0},o.createElement("div",{dangerouslySetInnerHTML:{__html:l}}))},t}(i.Component);n.TutorialHint=p;var d=function(e){function t(t){var n=this;e.call(this,t),this.closeLightboxOnEscape=function(e){27===("number"==typeof e.which?e.which:e.keyCode)&&n.closeLightbox()}}return r(t,e),t.prototype.previousTutorialStep=function(){var e=this.props.parent.state.tutorialOptions,t=e.tutorialStep-1;e.tutorialStep=t,pxt.tickEvent("tutorial.previous",{tutorial:e.tutorial,step:t}),this.props.parent.setTutorialStep(t)},t.prototype.nextTutorialStep=function(){var e=this.props.parent.state.tutorialOptions,t=e.tutorialStep+1;e.tutorialStep=t,pxt.tickEvent("tutorial.next",{tutorial:e.tutorial,step:t}),this.props.parent.setTutorialStep(t)},t.prototype.finishTutorial=function(){this.closeLightbox(),this.props.parent.completeTutorial()},t.prototype.closeLightbox=function(){s.tutorialNext(),document.documentElement.removeEventListener("keydown",this.closeLightboxOnEscape),c.initializeFocusTabIndex($("#tutorialcard").get(0),!0,void 0,!0);var e=document.getElementsByClassName("tutorialmessage");e.length>0&&e.item(0).focus(),$("#root").dimmer("hide")},t.prototype.componentWillUpdate=function(){$("#tutorialhint").modal("attach events","#tutorialcard .ui.button.hintbutton","show"),document.documentElement.addEventListener("keydown",this.closeLightboxOnEscape)},t.prototype.componentDidUpdate=function(){if(!this.focusInitialized){var e=document.getElementById("tutorialcard");null!==e&&(this.focusInitialized=!0,c.initializeFocusTabIndex(e,!0,!1))}},t.prototype.showHint=function(){this.closeLightbox(),this.props.parent.showTutorialHint()},t.prototype.render=function(){var e=this,t=this.props.parent.state.tutorialOptions,n=t.tutorialReady,r=t.tutorialStepInfo,i=t.tutorialStep;if(!n)return o.createElement("div",null);var s=r[i].headerContent,c=r[i].ariaLabel,l=i,u=r.length,p=n&&l!=u-1,d=l==u-1,f=r[i].hasHint;return f&&(c+=lf("Press Space or Enter to show a hint.")),o.createElement("div",{id:"tutorialcard",className:"ui "+(n?"tutorialReady":"")},o.createElement("div",{className:"ui buttons"},o.createElement("div",{className:"ui segment attached tutorialsegment"},o.createElement("div",{className:"avatar-image",onClick:function(){return e.showHint()},onKeyDown:a.fireClickOnEnter}),f?o.createElement(a.Button,{class:"mini blue hintbutton hidelightbox",text:lf("Hint"),tabIndex:-1,onClick:function(){return e.showHint()},onKeyDown:a.fireClickOnEnter}):void 0,o.createElement("div",{className:"tutorialmessage "+(f?"focused":void 0),role:"alert","aria-label":c,tabIndex:f?0:-1,onClick:function(){f&&e.showHint()},onKeyDown:a.fireClickOnEnter},o.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:s}})),o.createElement(a.Button,{id:"tutorialOkButton",class:"large green okbutton showlightbox focused",text:lf("Ok"),onClick:function(){return e.closeLightbox()},onKeyDown:a.fireClickOnEnter})),p?o.createElement(a.Button,{icon:"right chevron",rightIcon:!0,class:"nextbutton right attached green "+(p?"":"disabled"),text:lf("Next"),ariaLabel:lf("Go to the next step of the tutorial."),onClick:function(){return e.nextTutorialStep()},onKeyDown:a.fireClickOnEnter}):void 0,d?o.createElement(a.Button,{icon:"left checkmark",class:"orange right attached "+(n?"focused":"disabled"),text:lf("Finish"),ariaLabel:lf("Finish the tutorial."),onClick:function(){return e.finishTutorial()},onKeyDown:a.fireClickOnEnter}):void 0))},t}(i.Component);n.TutorialCard=d},{"./core":13,"./data":14,"./sounds":42,"./sui":44,react:277}],48:[function(e,t,n){"use strict";function r(e){void 0===e&&(e=!1),a();var t=d.getHeaders();return e||(t=t.filter(function(e){return!e.isDeleted})),t.sort(function(e,t){return t.recentUse-e.recentUse}),t}function o(e){a();var t=d.getHeader(e);return t&&!t.isDeleted?t:null}function i(){return pxt.storage.getLocal("pxt_workspace_session_id")!=k}function a(){i()&&Util.assert(!1,"trying to access outdated session")}function s(e){return a(),d.getTextAsync(e)}function c(e,t){return a(),(t||e.isDeleted)&&(e.pubCurrent=!1,e.blobCurrent=!1,e.modificationTime=E.nowSeconds()),e.recentUse=E.nowSeconds(),d.saveAsync(e,t)}function l(e,t){return a(),d.installAsync(e,t)}function u(e){if(!e)return e;for(var t in["kind.json","yelm.json"])!e[pxt.CONFIG_NAME]&&e[t]&&(e[pxt.CONFIG_NAME]=e[t],delete e[t]);return e}function p(e){a(),pxt.github.isGithubId(e)&&(e=pxt.github.noramlizeRepoId(e));var t=encodeURIComponent(e);return pxt.packagesConfigAsync().then(function(n){return x.enqueue(e,function(){return _.getAsync(t).then(function(e){return e.files},function(r){return(pxt.github.isGithubId(e)?pxt.github.downloadPackageAsync(e,n).then(function(e){return e.files}):w.downloadScriptFilesAsync(e)).catch(h.handleNetworkError).then(function(e){return _.setAsync({id:t,files:e}).then(function(){return e})})}).then(u)})})}var d,f=e("./db"),h=e("./core"),m=e("./data"),g=e("./cloudworkspace"),v=e("./fileworkspace"),y=e("./memoryworkspace"),b=e("./iframeworkspace"),_=new f.Table("script"),E=pxt.Util,w=pxt.Cloud;E.lf;n.setupWorkspace=function(e){switch(E.assert(!d,"workspace set twice"),pxt.debug("workspace: "+e),e){case"fs":case"file":d=v.provider;break;case"mem":case"memory":d=y.provider;break;case"iframe":d=b.provider;break;case"uwp":d=m.wrapWorkspace(pxt.winrt.workspace.provider);break;case"cloud":default:d=g.provider}},n.getHeaders=r,n.getHeader=o,n.importLegacyScriptsAsync=function(){return a(),d.importLegacyScriptsAsync?d.importLegacyScriptsAsync():Promise.resolve()};var k;n.isSessionOutdated=i,n.initAsync=function(){return d||(d=g.provider),k=Util.guidGen(),pxt.storage.setLocal("pxt_workspace_session_id",k),pxt.debug("workspace session: "+k),d.initAsync(pxt.appTarget.id)},n.getTextAsync=s,n.anonymousPublishAsync=function(e,t,n){var r={};e.saveId=r;var o=JSON.stringify(t,null,2)+"\n",i={name:e.name,target:e.target,description:n.description,editor:e.editor,text:t,meta:{versions:pxt.appTarget.versions,blocksHeight:n.blocksHeight,blocksWidth:n.blocksWidth}};return pxt.debug("publishing script; "+o.length+" bytes"),w.privatePostAsync("scripts",i).then(function(t){return t.shortid&&(t.id=t.shortid),e.pubId=t.shortid,e.pubCurrent=e.saveId===r,e.meta=t.meta,pxt.debug("published; id /"+e.pubId),c(e).then(function(){return t})})},n.saveAsync=c,n.installAsync=l,n.saveScreenshotAsync=function(e,t,n){return a(),d.saveScreenshotAsync?d.saveScreenshotAsync(e,t,n):Promise.resolve()},n.fixupFileNames=u;var x=new E.PromiseQueue;n.getPublishedScriptAsync=p,n.installByIdAsync=function(e){return w.privateGetAsync(e).then(function(t){return p(t.id).then(function(n){return l({name:t.name,pubId:e,pubCurrent:!0,meta:t.meta,editor:t.editor,target:t.target},n)})})},n.saveToCloudAsync=function(e){return a(),d.saveToCloudAsync(e)},n.syncAsync=function(){return a(),d.syncAsync()},n.resetAsync=function(){return a(),d.resetAsync()},m.mountVirtualApi("header",{getSync:function(e){return"*"==(e=m.stripProtocol(e))?r():o(e)}}),m.mountVirtualApi("text",{getAsync:function(e){var t=/^[\w\-]+:([^\/]+)(\/(.*))?/.exec(e);return s(t[1]).then(function(e){return t[3]?e[t[3]]:e})}})},{"./cloudworkspace":8,"./core":13,"./data":14,"./db":15,"./fileworkspace":22,"./iframeworkspace":25,"./memoryworkspace":28}],49:[function(e,t,n){"use strict";t.exports=function(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}},{}],50:[function(e,t,n){"use strict";function r(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function o(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}function i(e,t,n){for(var r,i=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(o(r));return i.join("")}n.byteLength=function(e){return 3*e.length/4-r(e)},n.toByteArray=function(e){var t,n,o,i,a,l=e.length;i=r(e),a=new c(3*l/4-i),n=i>0?l-4:l;var u=0;for(t=0;t<n;t+=4)o=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],a[u++]=o>>16&255,a[u++]=o>>8&255,a[u++]=255&o;return 2===i?(o=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,a[u++]=255&o):1===i&&(o=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,a[u++]=o>>8&255,a[u++]=255&o),a},n.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o="",s=[],c=0,l=n-r;c<l;c+=16383)s.push(i(e,c,c+16383>l?l:c+16383));return 1===r?(t=e[n-1],o+=a[t>>2],o+=a[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=a[t>>10],o+=a[t>>4&63],o+=a[t<<2&63],o+="="),s.push(o),s.join("")};for(var a=[],s=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,p=l.length;u<p;++u)a[u]=l[u],s[l.charCodeAt(u)]=u;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},{}],51:[function(e,t,n){(function(e,r){!function(e){if("object"==typeof n&&void 0!==t)t.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var o;"undefined"!=typeof window?o=window:void 0!==r?o=r:"undefined"!=typeof self&&(o=self),o.Promise=e()}}(function(){var t,n,o;return function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof _dereq_&&_dereq_;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return o(n||e)},u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof _dereq_&&_dereq_,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){"use strict";t.exports=function(e){function t(e){var t=new n(e),r=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),r}var n=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},{}],2:[function(t,n,r){"use strict";function o(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new u(16),this._normalQueue=new u(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=l}function i(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function a(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function s(e){this._normalQueue._pushOne(e),this._queueTick()}var c;try{throw new Error}catch(e){c=e}var l=t("./schedule"),u=t("./queue"),p=t("./util");o.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},o.prototype.hasCustomScheduler=function(){return this._customScheduler},o.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},o.prototype.disableTrampolineIfNecessary=function(){p.hasDevTools&&(this._trampolineEnabled=!1)},o.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},o.prototype.fatalError=function(t,n){n?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},o.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},p.hasDevTools?(o.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?i.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},o.prototype.invoke=function(e,t,n){this._trampolineEnabled?a.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},o.prototype.settlePromises=function(e){this._trampolineEnabled?s.call(this,e):this._schedule(function(){e._settlePromises()})}):(o.prototype.invokeLater=i,o.prototype.invoke=a,o.prototype.settlePromises=s),o.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),r=e.shift();t.call(n,r)}else t._settlePromises()}},o.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},o.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},o.prototype._reset=function(){this._isTickUsed=!1},n.exports=o,n.exports.firstLineError=c},{"./queue":26,"./schedule":29,"./util":36}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){var o=!1,i=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},s=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},c=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=r.propagateFromFunction(),e.prototype._boundValue=r.boundValueFunction());var l=n(i),u=new e(t);u._propagateFrom(this,1);var p=this._target();if(u._setBoundTo(l),l instanceof e){var d={promiseRejectionQueued:!1,promise:u,target:p,bindingPromise:l};p._then(t,a,void 0,u,d),l._then(s,c,void 0,u,d),u._setOnCancel(l)}else u._resolveCallback(p);return u},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},{}],4:[function(e,t,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var o=e("./promise")();o.noConflict=function(){try{Promise===o&&(Promise=r)}catch(e){}return o},t.exports=o},{"./promise":22}],5:[function(e,t,n){"use strict";var r=Object.create;if(r){var o=r(null),i=r(null);o[" size"]=i[" size"]=0}t.exports=function(t){function n(e,n){var r;if(null!=e&&(r=e[n]),"function"!=typeof r){var o="Object "+s.classString(e)+" has no method '"+s.toString(n)+"'";throw new t.TypeError(o)}return r}function r(e){return n(e,this.pop()).apply(e,this)}function o(e){return e[this]}function i(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}var a,s=e("./util"),c=s.canEvaluate;s.isIdentifier;t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(r,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=i;else if(c){var n=a(e);t=null!==n?n:o}else t=o;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,n){"use strict";t.exports=function(t,n,r,o){var i=e("./util"),a=i.tryCatch,s=i.errorObj,c=t._async;t.prototype.break=t.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),c.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=a(e).call(this._boundValue());r===s&&(this._attachExtraTrace(r.e),c.throwLater(r.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),c.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./util"),r=e("./es5").keys,o=n.tryCatch,i=n.errorObj;return function(e,a,s){return function(c){var l=s._boundValue();e:for(var u=0;u<e.length;++u){var p=e[u];if(p===Error||null!=p&&p.prototype instanceof Error){if(c instanceof p)return o(a).call(l,c)}else if("function"==typeof p){var d=o(p).call(l,c);if(d===i)return d;if(d)return o(a).call(l,c)}else if(n.isObject(c)){for(var f=r(p),h=0;h<f.length;++h){var m=f[h];if(p[m]!=c[m])continue e}return o(a).call(l,c)}}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t,n){"use strict";t.exports=function(e){function t(){this._trace=new t.CapturedTrace(n())}function n(){var e=o.length-1;if(e>=0)return o[e]}var r=!1,o=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=o.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=function(){if(r)return new t},t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var o=e.prototype._pushContext,i=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,c=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=o,e.prototype._popContext=i,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=c,r=!1},r=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=n,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},{}],9:[function(t,n,r){"use strict";n.exports=function(n,r){function o(e,t){return{promise:t}}function i(){return!1}function a(e,t,n){var r=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+j.toString(e));r._attachCancellationCallback(e)})}catch(e){return e}}function s(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?j.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function c(){return this._onCancelField}function l(e){this._onCancelField=e}function u(){this._cancellationParent=void 0,this._onCancelField=void 0}function p(e,t){if(0!=(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function d(){var e=this._boundTo;return void 0!==e&&e instanceof n?e.isFulfilled()?e.value():void 0:e}function f(){this._trace=new T(this._peekContext())}function h(e,t){if(M(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=E(e);j.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),j.notEnumerableProp(e,"__stackCleaned__",!0)}}}function m(e,t,r){if(ne.warnings){var o,i=new I(e);if(t)r._attachExtraTrace(i);else if(ne.longStackTraces&&(o=n._peekContext()))o.attachExtraTrace(i);else{var a=E(i);i.stack=a.message+"\n"+a.stack.join("\n")}X("warning",i)||w(i,"",!0)}}function g(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function v(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function y(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],o=t.length-1,i=t[o],a=-1,s=r.length-1;s>=0;--s)if(r[s]===i){a=s;break}for(s=a;s>=0;--s){var c=r[s];if(t[o]!==c)break;t.pop(),o--}t=r}}function b(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],o="    (No stack trace)"===r||B.test(r),i=o&&Z(r);o&&!i&&(q&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function _(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||B.test(r))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}function E(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?_(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:b(t)}}function w(e,t,n){if("undefined"!=typeof console){var r;if(j.isObject(e)){var o=e.stack;r=t+V(o,e)}else r=t+String(e);"function"==typeof R?R(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function k(e,t,n,r){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(e){P.throwLater(e)}"unhandledRejection"===e?X(e,n,r)||o||w(n,"Unhandled rejection "):X(e,r)}function x(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{if(t=e&&"function"==typeof e.toString?e.toString():j.toString(e),/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+C(t)+">, no stack trace)"}function C(e){return e.length<41?e:e.substr(0,38)+"..."}function S(){return"function"==typeof te}function N(e){var t=e.match(ee);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function T(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);te(this,T),t>32&&this.uncycle()}var O,D,R,A=n._getDomain,P=n._async,I=t("./errors").Warning,j=t("./util"),M=j.canAttachTrace,L=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,F=/\((?:timers\.js):\d+:\d+\)/,U=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,B=null,V=null,q=!1,H=!(0==j.env("BLUEBIRD_DEBUG")),W=!(0==j.env("BLUEBIRD_WARNINGS")||!H&&!j.env("BLUEBIRD_WARNINGS")),z=!(0==j.env("BLUEBIRD_LONG_STACK_TRACES")||!H&&!j.env("BLUEBIRD_LONG_STACK_TRACES")),K=0!=j.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(W||!!j.env("BLUEBIRD_W_FORGOTTEN_RETURN"));n.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},n.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),P.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){k("rejectionHandled",O,void 0,this)},n.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},n.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),k("unhandledRejection",D,e,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},n.prototype._warn=function(e,t,n){return m(e,t,n||this)},n.onPossiblyUnhandledRejection=function(e){var t=A();D="function"==typeof e?null===t?e:j.domainBind(t,e):void 0},n.onUnhandledRejectionHandled=function(e){var t=A();O="function"==typeof e?null===t?e:j.domainBind(t,e):void 0};var Y=function(){};n.longStackTraces=function(){if(P.haveItemsQueued()&&!ne.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!ne.longStackTraces&&S()){var e=n.prototype._captureStackTrace,t=n.prototype._attachExtraTrace;ne.longStackTraces=!0,Y=function(){if(P.haveItemsQueued()&&!ne.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");n.prototype._captureStackTrace=e,n.prototype._attachExtraTrace=t,r.deactivateLongStackTraces(),P.enableTrampoline(),ne.longStackTraces=!1},n.prototype._captureStackTrace=f,n.prototype._attachExtraTrace=h,r.activateLongStackTraces(),P.disableTrampolineIfNecessary()}},n.hasLongStackTraces=function(){return ne.longStackTraces&&S()};var G=function(){try{if("function"==typeof CustomEvent){e=new CustomEvent("CustomEvent");return j.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!j.global.dispatchEvent(n)}}if("function"==typeof Event){var e=new Event("CustomEvent");return j.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!j.global.dispatchEvent(n)}}return(e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),j.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!j.global.dispatchEvent(n)}}catch(e){}return function(){return!1}}(),$=j.isNode?function(){return e.emit.apply(e,arguments)}:j.global?function(e){var t="on"+e.toLowerCase(),n=j.global[t];return!!n&&(n.apply(j.global,[].slice.call(arguments,1)),!0)}:function(){return!1},J={promiseCreated:o,promiseFulfilled:o,promiseRejected:o,promiseResolved:o,promiseCancelled:o,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:o},X=function(e){var t=!1;try{t=$.apply(null,arguments)}catch(e){P.throwLater(e),t=!0}var n=!1;try{n=G(e,J[e].apply(null,arguments))}catch(e){P.throwLater(e),n=!0}return n||t};n.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?n.longStackTraces():!e.longStackTraces&&n.hasLongStackTraces()&&Y()),"warnings"in e){var t=e.warnings;ne.warnings=!!t,K=ne.warnings,j.isObject(t)&&"wForgottenReturn"in t&&(K=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!ne.cancellation){if(P.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");n.prototype._clearCancellationData=u,n.prototype._propagateFrom=p,n.prototype._onCancel=c,n.prototype._setOnCancel=l,n.prototype._attachCancellationCallback=s,n.prototype._execute=a,Q=p,ne.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!ne.monitoring?(ne.monitoring=!0,n.prototype._fireEvent=X):!e.monitoring&&ne.monitoring&&(ne.monitoring=!1,n.prototype._fireEvent=i)),n},n.prototype._fireEvent=i,n.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},n.prototype._onCancel=function(){},n.prototype._setOnCancel=function(e){},n.prototype._attachCancellationCallback=function(e){},n.prototype._captureStackTrace=function(){},n.prototype._attachExtraTrace=function(){},n.prototype._clearCancellationData=function(){},n.prototype._propagateFrom=function(e,t){};var Q=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)},Z=function(){return!1},ee=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;j.inherits(T,Error),r.CapturedTrace=T,T.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},r=0,o=this;void 0!==o;++r)t.push(o),o=o._parent;for(r=(e=this._length=r)-1;r>=0;--r){var i=t[r].stack;void 0===n[i]&&(n[i]=r)}for(r=0;r<e;++r){var a=n[t[r].stack];if(void 0!==a&&a!==r){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var s=r>0?t[r-1]:this;a<e-1?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var c=s._length+1,l=r-2;l>=0;--l)t[l]._length=c,c++;return}}}},T.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=E(e),n=t.message,r=[t.stack],o=this;void 0!==o;)r.push(b(o.stack.split("\n"))),o=o._parent;y(r),v(r),j.notEnumerableProp(e,"stack",g(n,r)),j.notEnumerableProp(e,"__stackCleaned__",!0)}};var te=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():x(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,B=e,V=t;var n=Error.captureStackTrace;return Z=function(e){return L.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return B=/@/,V=t,q=!0,function(e){e.stack=(new Error).stack};var o;try{throw new Error}catch(e){o="stack"in e}return"stack"in r||!o||"number"!=typeof Error.stackTraceLimit?(V=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?x(t):t.toString()},null):(B=e,V=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(R=function(e){console.warn(e)},j.isNode&&e.stderr.isTTY?R=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:j.isNode||"string"!=typeof(new Error).stack||(R=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var ne={warnings:W,longStackTraces:!1,cancellation:!1,monitoring:!1};return z&&n.longStackTraces(),{longStackTraces:function(){return ne.longStackTraces},warnings:function(){return ne.warnings},cancellation:function(){return ne.cancellation},monitoring:function(){return ne.monitoring},propagateFromFunction:function(){return Q},boundValueFunction:function(){return d},checkForgottenReturns:function(e,t,n,r,o){if(void 0===e&&null!==t&&K){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var i="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),c=b(s),l=c.length-1;l>=0;--l){var u=c[l];if(!F.test(u)){var p=u.match(U);p&&(i="at "+p[1]+":"+p[2]+":"+p[3]+" ");break}}if(c.length>0)for(var d=c[0],l=0;l<s.length;++l)if(s[l]===d){l>0&&(a="\n"+s[l-1]);break}}var f="a promise was created in a "+n+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+a;r._warn(f,!0,t)}},setBounds:function(e,t){if(S()){for(var n,r,o=e.stack.split("\n"),i=t.stack.split("\n"),a=-1,s=-1,c=0;c<o.length;++c)if(l=N(o[c])){n=l.fileName,a=l.line;break}for(c=0;c<i.length;++c){var l=N(i[c]);if(l){r=l.fileName,s=l.line;break}}a<0||s<0||!n||!r||n!==r||a>=s||(Z=function(e){if(L.test(e))return!0;var t=N(e);return!!(t&&t.fileName===n&&a<=t.line&&t.line<=s)})}},warn:m,deprecated:function(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),m(n)},CapturedTrace:T,fireDomEvent:G,fireGlobalEvent:$}}},{"./errors":12,"./util":36}],10:[function(e,t,n){"use strict";t.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,function(){throw t})},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var r=arguments[1];r instanceof e&&r.suppressUnhandledRejections();return this.caught(n,function(){return r})}}},{}],11:[function(e,t,n){"use strict";t.exports=function(e,t){function n(){return o(this)}var r=e.reduce,o=e.all;e.prototype.each=function(e){return r(this,e,t,0)._then(n,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,o){return r(e,o,t,0)._then(n,void 0,void 0,e,void 0)},e.mapSeries=function(e,n){return r(e,n,t,t)}}},{}],12:[function(e,t,n){"use strict";function r(e,t){function n(r){if(!(this instanceof n))return new n(r);p(this,"message","string"==typeof r?r:t),p(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(n,Error),n}function o(e){if(!(this instanceof o))return new o(e);p(this,"name","OperationalError"),p(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(p(this,"message",e.message),p(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var i,a,s=e("./es5"),c=s.freeze,l=e("./util"),u=l.inherits,p=l.notEnumerableProp,d=r("Warning","warning"),f=r("CancellationError","cancellation error"),h=r("TimeoutError","timeout error"),m=r("AggregateError","aggregate error");try{i=TypeError,a=RangeError}catch(e){i=r("TypeError","type error"),a=r("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<g.length;++v)"function"==typeof Array.prototype[g[v]]&&(m.prototype[g[v]]=Array.prototype[g[v]]);s.defineProperty(m.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),m.prototype.isOperational=!0;var y=0;m.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",o=r.split("\n"),i=0;i<o.length;++i)o[i]=e+o[i];t+=(r=o.join("\n"))+"\n"}return y--,t},u(o,Error);var b=Error.__BluebirdErrorTypes__;b||(b=c({CancellationError:f,TimeoutError:h,OperationalError:o,RejectionError:o,AggregateError:m}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:i,RangeError:a,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:d}},{"./es5":13,"./util":36}],13:[function(e,t,n){var r=function(){"use strict";return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var o={}.hasOwnProperty,i={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t};t.exports={isArray:function(e){try{return"[object Array]"===i.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,n){return e[t]=n.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return a}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,o){return n(e,r,o,t)}}},{}],15:[function(e,t,n){"use strict";t.exports=function(t,n,r){function o(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function i(e){this.finallyHandler=e}function a(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function s(){return l.call(this,this.promise._target()._settledValue())}function c(e){if(!a(this,e))return d.e=e,d}function l(e){var o=this.promise,l=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?l.call(o._boundValue()):l.call(o._boundValue(),e);if(u===r)return u;if(void 0!==u){o._setReturnedNonUndefined();var f=n(u,o);if(f instanceof t){if(null!=this.cancelPromise){if(f._isCancelled()){var h=new p("late cancellation observer");return o._attachExtraTrace(h),d.e=h,d}f.isPending()&&f._attachCancellationCallback(new i(this))}return f._then(s,c,void 0,this,void 0)}}}return o.isRejected()?(a(this),d.e=e,d):(a(this),e)}var u=e("./util"),p=t.CancellationError,d=u.errorObj,f=e("./catch_filter")(r);return o.prototype.isFinallyHandler=function(){return 0===this.type},i.prototype._resultCancelled=function(){a(this.finallyHandler)},t.prototype._passThrough=function(e,t,n,r){return"function"!=typeof e?this.then():this._then(n,r,void 0,new o(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,l,l)},t.prototype.tap=function(e){return this._passThrough(e,1,l)},t.prototype.tapCatch=function(e){var n=arguments.length;if(1===n)return this._passThrough(e,1,void 0,l);var r,o=new Array(n-1),i=0;for(r=0;r<n-1;++r){var a=arguments[r];if(!u.isObject(a))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+u.classString(a)));o[i++]=a}o.length=i;var s=arguments[r];return this._passThrough(f(o,s,this),1,void 0,l)},o}},{"./catch_filter":7,"./util":36}],16:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i,a){function s(e,n,r){for(var i=0;i<n.length;++i){r._pushContext();var a=d(n[i])(e);if(r._popContext(),a===p){r._pushContext();var s=t.reject(p.e);return r._popContext(),s}var c=o(a,r);if(c instanceof t)return c}return null}function c(e,n,o,i){if(a.cancellation()){var s=new t(r),c=this._finallyPromise=new t(r);this._promise=s.lastly(function(){return c}),s._captureStackTrace(),s._setOnCancel(this)}else(this._promise=new t(r))._captureStackTrace();this._stack=i,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}var l=e("./errors").TypeError,u=e("./util"),p=u.errorObj,d=u.tryCatch,f=[];u.inherits(c,i),c.prototype._isResolved=function(){return null===this._promise},c.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},c.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if(void 0!==this._generator.return)this._promise._pushContext(),e=d(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var n=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=n,this._promise._attachExtraTrace(n),this._promise._pushContext(),e=d(this._generator.throw).call(this._generator,n),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},c.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=d(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},c.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=d(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},c.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},c.prototype.promise=function(){return this._promise},c.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},c.prototype._continue=function(e){var n=this._promise;if(e===p)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var r=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(r);var i=o(r,this._promise);if(i instanceof t||null!==(i=s(i,this._yieldHandlers,this._promise))){var a=(i=i._target())._bitField;0==(50397184&a)?(this._yieldedPromise=i,i._proxy(this,null)):0!=(33554432&a)?t._async.invoke(this._promiseFulfilled,this,i._value()):0!=(16777216&a)?t._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled()}else this._promiseRejected(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(r))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,r=c,o=(new Error).stack;return function(){var t=e.apply(this,arguments),i=new r(void 0,void 0,n,o),a=i.promise();return i._generator=t,i._promiseFulfilled(void 0),a}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new l("expecting a function but got "+u.classString(e));f.push(e)},t.spawn=function(e){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return n("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=new c(e,this),o=r.promise();return r._run(t.spawn),o}}},{"./errors":12,"./util":36}],17:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i,a){var s=e("./util");s.canEvaluate,s.tryCatch,s.errorObj;t.join=function(){var e,t=arguments.length-1;if(t>0&&"function"==typeof arguments[t]){e=arguments[t]}var r=[].slice.call(arguments);e&&r.pop();var o=new n(r).promise();return void 0!==e?o.spread(e):o}}},{"./util":36}],18:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i,a){function s(e,t,n,r){this.constructor$(e),this._promise._captureStackTrace();var o=l();this._callback=null===o?t:u.domainBind(o,t),this._preservedValues=r===i?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0)}function c(e,n,o,i){if("function"!=typeof n)return r("expecting a function but got "+u.classString(n));var a=0;if(void 0!==o){if("object"!=typeof o||null===o)return t.reject(new TypeError("options argument must be an object but it is "+u.classString(o)));if("number"!=typeof o.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+u.classString(o.concurrency)));a=o.concurrency}return a="number"==typeof a&&isFinite(a)&&a>=1?a:0,new s(e,n,a,i).promise()}var l=t._getDomain,u=e("./util"),p=u.tryCatch,d=u.errorObj,f=t._async;u.inherits(s,n),s.prototype._asyncInit=function(){this._init$(void 0,-2)},s.prototype._init=function(){},s.prototype._promiseFulfilled=function(e,n){var r=this._values,i=this.length(),s=this._preservedValues,c=this._limit;if(n<0){if(n=-1*n-1,r[n]=e,c>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(c>=1&&this._inFlight>=c)return r[n]=e,this._queue.push(n),!1;null!==s&&(s[n]=e);var l=this._promise,u=this._callback,f=l._boundValue();l._pushContext();var h=p(u).call(f,e,n,i),m=l._popContext();if(a.checkForgottenReturns(h,m,null!==s?"Promise.filter":"Promise.map",l),h===d)return this._reject(h.e),!0;var g=o(h,this._promise);if(g instanceof t){var v=(g=g._target())._bitField;if(0==(50397184&v))return c>=1&&this._inFlight++,r[n]=g,g._proxy(this,-1*(n+1)),!1;if(0==(33554432&v))return 0!=(16777216&v)?(this._reject(g._reason()),!0):(this._cancel(),!0);h=g._value()}r[n]=h}return++this._totalResolved>=i&&(null!==s?this._filter(r,s):this._resolve(r),!0)},s.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},s.prototype._filter=function(e,t){for(var n=t.length,r=new Array(n),o=0,i=0;i<n;++i)e[i]&&(r[o++]=t[i]);r.length=o,this._resolve(r)},s.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return c(this,e,t,null)},t.map=function(e,t,n,r){return c(e,t,n,r)}}},{"./util":36}],19:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var o=s(e).apply(this,arguments),a=r._popContext();return i.checkForgottenReturns(o,a,"Promise.method",r),r._resolveFromSyncValue(o),r}},t.attempt=t.try=function(e){if("function"!=typeof e)return o("expecting a function but got "+a.classString(e));var r=new t(n);r._captureStackTrace(),r._pushContext();var c;if(arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],u=arguments[2];c=a.isArray(l)?s(e).apply(u,l):s(e).call(u,l)}else c=s(e)();var p=r._popContext();return i.checkForgottenReturns(c,p,"Promise.try",r),r._resolveFromSyncValue(c),r},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,n){"use strict";function r(e){return e instanceof Error&&c.getPrototypeOf(e)===Error.prototype}function o(e){var t;if(r(e)){(t=new s(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var n=c.keys(e),o=0;o<n.length;++o){var a=n[o];l.test(a)||(t[a]=e[a])}return t}return i.markAsOriginatingFromRejection(e),e}var i=e("./util"),a=i.maybeWrapAsError,s=e("./errors").OperationalError,c=e("./es5"),l=/^(?:name|message|stack|cause)$/;t.exports=function(e,t){return function(n,r){if(null!==e){if(n){var i=o(a(n));e._attachExtraTrace(i),e._reject(i)}else if(t){var s=[].slice.call(arguments,1);e._fulfill(s)}else e._fulfill(r);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,n){"use strict";t.exports=function(t){function n(e,t){var n=this;if(!i.isArray(e))return r.call(n,e,t);var o=s(t).apply(n._boundValue(),[null].concat(e));o===c&&a.throwLater(o.e)}function r(e,t){var n=this._boundValue(),r=void 0===e?s(t).call(n,null):s(t).call(n,null,e);r===c&&a.throwLater(r.e)}function o(e,t){var n=this;if(!e){var r=new Error(e+"");r.cause=e,e=r}var o=s(t).call(n._boundValue(),e);o===c&&a.throwLater(o.e)}var i=e("./util"),a=t._async,s=i.tryCatch,c=i.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var i=r;void 0!==t&&Object(t).spread&&(i=n),this._then(i,o,void 0,this,e)}return this}}},{"./util":36}],22:[function(t,n,r){"use strict";n.exports=function(){function r(){}function o(e,t){if(null==e||e.constructor!==i)throw new b("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new b("expecting a function but got "+h.classString(t))}function i(e){e!==E&&o(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function a(e){this.promise._resolveCallback(e)}function s(e){this.promise._rejectCallback(e,!1)}function c(e){var t=new i(E);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var l,u=function(){return new b("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},p=function(){return new i.PromiseInspection(this._target())},d=function(e){return i.reject(new b(e))},f={},h=t("./util");l=h.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},h.notEnumerableProp(i,"_getDomain",l);var m=t("./es5"),g=t("./async"),v=new g;m.defineProperty(i,"_async",{value:v});var y=t("./errors"),b=i.TypeError=y.TypeError;i.RangeError=y.RangeError;var _=i.CancellationError=y.CancellationError;i.TimeoutError=y.TimeoutError,i.OperationalError=y.OperationalError,i.RejectionError=y.OperationalError,i.AggregateError=y.AggregateError;var E=function(){},w={},k={},x=t("./thenables")(i,E),C=t("./promise_array")(i,E,x,d,r),S=t("./context")(i),N=S.create,T=t("./debuggability")(i,S),O=(T.CapturedTrace,t("./finally")(i,x,k)),D=t("./catch_filter")(k),R=t("./nodeback"),A=h.errorObj,P=h.tryCatch;return i.prototype.toString=function(){return"[object Promise]"},i.prototype.caught=i.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,r=new Array(t-1),o=0;for(n=0;n<t-1;++n){var i=arguments[n];if(!h.isObject(i))return d("Catch statement predicate: expecting an object but got "+h.classString(i));r[o++]=i}return r.length=o,e=arguments[n],this.then(void 0,D(r,e,this))}return this.then(void 0,e)},i.prototype.reflect=function(){return this._then(p,p,void 0,this,void 0)},i.prototype.then=function(e,t){if(T.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+h.classString(e);arguments.length>1&&(n+=", "+h.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},i.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},i.prototype.spread=function(e){return"function"!=typeof e?d("expecting a function but got "+h.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},i.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},i.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new C(this).promise()},i.prototype.error=function(e){return this.caught(h.originatesFromRejection,e)},i.getNewLibraryCopy=n.exports,i.is=function(e){return e instanceof i},i.fromNode=i.fromCallback=function(e){var t=new i(E);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,r=P(e)(R(t,n));return r===A&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},i.all=function(e){return new C(e).promise()},i.cast=function(e){var t=x(e);return t instanceof i||((t=new i(E))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},i.resolve=i.fulfilled=i.cast,i.reject=i.rejected=function(e){var t=new i(E);return t._captureStackTrace(),t._rejectCallback(e,!0),t},i.setScheduler=function(e){if("function"!=typeof e)throw new b("expecting a function but got "+h.classString(e));return v.setScheduler(e)},i.prototype._then=function(e,t,n,r,o){var a=void 0!==o,s=a?o:new i(E),c=this._target(),u=c._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&u)?this._boundValue():c===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var p=l();if(0!=(50397184&u)){var d,f,m=c._settlePromiseCtx;0!=(33554432&u)?(f=c._rejectionHandler0,d=e):0!=(16777216&u)?(f=c._fulfillmentHandler0,d=t,c._unsetRejectionIsUnhandled()):(m=c._settlePromiseLateCancellationObserver,f=new _("late cancellation observer"),c._attachExtraTrace(f),d=t),v.invoke(m,c,{handler:null===p?d:"function"==typeof d&&h.domainBind(p,d),promise:s,receiver:r,value:f})}else c._addCallbacks(e,t,s,r,p);return s},i.prototype._length=function(){return 65535&this._bitField},i.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},i.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},i.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},i.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},i.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},i.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},i.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},i.prototype._isFinal=function(){return(4194304&this._bitField)>0},i.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},i.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},i.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},i.prototype._setAsyncGuaranteed=function(){v.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},i.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==f)return void 0===t&&this._isBound()?this._boundValue():t},i.prototype._promiseAt=function(e){return this[4*e-4+2]},i.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},i.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},i.prototype._boundValue=function(){},i.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,r=e._promise0,o=e._receiverAt(0);void 0===o&&(o=f),this._addCallbacks(t,n,r,o,null)},i.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=f),this._addCallbacks(n,r,o,i,null)},i.prototype._addCallbacks=function(e,t,n,r,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=null===o?e:h.domainBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:h.domainBind(o,t));else{var a=4*i-4;this[a+2]=n,this[a+3]=r,"function"==typeof e&&(this[a+0]=null===o?e:h.domainBind(o,e)),"function"==typeof t&&(this[a+1]=null===o?t:h.domainBind(o,t))}return this._setLength(i+1),i},i.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},i.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var n=x(e,this);if(!(n instanceof i))return this._fulfill(e);t&&this._propagateFrom(n,2);var r=n._target();if(r!==this){var o=r._bitField;if(0==(50397184&o)){var a=this._length();a>0&&r._migrateCallback0(this);for(var s=1;s<a;++s)r._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&o))this._fulfill(r._value());else if(0!=(16777216&o))this._reject(r._reason());else{var c=new _("late cancellation observer");r._attachExtraTrace(c),this._reject(c)}}else this._reject(u())}},i.prototype._rejectCallback=function(e,t,n){var r=h.ensureErrorObject(e),o=r===e;if(!o&&!n&&T.warnings()){var i="a promise was rejected with a non-error: "+h.classString(e);this._warn(i,!0)}this._attachExtraTrace(r,!!t&&o),this._reject(e)},i.prototype._resolveFromExecutor=function(e){if(e!==E){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)}},i.prototype._settlePromiseFromHandler=function(e,t,n,r){var o=r._bitField;if(0==(65536&o)){r._pushContext();var i;t===w?n&&"number"==typeof n.length?i=P(e).apply(this._boundValue(),n):(i=A).e=new b("cannot .spread() a non-array: "+h.classString(n)):i=P(e).call(t,n);var a=r._popContext();0==(65536&(o=r._bitField))&&(i===k?r._reject(n):i===A?r._rejectCallback(i.e,!1):(T.checkForgottenReturns(i,a,"",r,this),r._resolveCallback(i)))}},i.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},i.prototype._followee=function(){return this._rejectionHandler0},i.prototype._setFollowee=function(e){this._rejectionHandler0=e},i.prototype._settlePromise=function(e,t,n,o){var a=e instanceof i,s=this._bitField,c=0!=(134217728&s);0!=(65536&s)?(a&&e._invokeInternalOnCancel(),n instanceof O&&n.isFinallyHandler()?(n.cancelPromise=e,P(t).call(n,o)===A&&e._reject(A.e)):t===p?e._fulfill(p.call(n)):n instanceof r?n._promiseCancelled(e):a||e instanceof C?e._cancel():n.cancel()):"function"==typeof t?a?(c&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,o,e)):t.call(n,o,e):n instanceof r?n._isResolved()||(0!=(33554432&s)?n._promiseFulfilled(o,e):n._promiseRejected(o,e)):a&&(c&&e._setAsyncGuaranteed(),0!=(33554432&s)?e._fulfill(o):e._reject(o))},i.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,o=e.value;"function"==typeof t?n instanceof i?this._settlePromiseFromHandler(t,r,o,n):t.call(r,o,n):n instanceof i&&n._reject(o)},i.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},i.prototype._settlePromise0=function(e,t,n){var r=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,o,t)},i.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},i.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!=(134217728&t)?this._settlePromises():v.settlePromises(this))}},i.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return v.fatalError(e,h.isNode);(65535&t)>0?v.settlePromises(this):this._ensurePossibleRejectionHandled()}},i.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var r=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},i.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var r=this._rejectionHandlerAt(n),o=this._promiseAt(n),i=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,r,i,t)}},i.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},i.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},i.defer=i.pending=function(){return T.deprecated("Promise.defer","new Promise"),{promise:new i(E),resolve:a,reject:s}},h.notEnumerableProp(i,"_makeSelfResolutionError",u),t("./method")(i,E,x,d,T),t("./bind")(i,E,x,T),t("./cancel")(i,C,d,T),t("./direct_resolve")(i),t("./synchronous_inspection")(i),t("./join")(i,C,x,E,v,l),i.Promise=i,i.version="3.5.0",t("./map.js")(i,C,d,x,E,T),t("./call_get.js")(i),t("./using.js")(i,d,x,N,E,T),t("./timers.js")(i,E,T),t("./generators.js")(i,d,E,x,r,T),t("./nodeify.js")(i),t("./promisify.js")(i,E),t("./props.js")(i,C,x,d),t("./race.js")(i,E,x,d),t("./reduce.js")(i,C,d,x,E,T),t("./settle.js")(i,C,T),t("./some.js")(i,C,d),t("./filter.js")(i,E),t("./each.js")(i,E),t("./any.js")(i),h.toFastProperties(i),h.toFastProperties(i.prototype),c({a:1}),c({b:2}),c({c:3}),c(1),c(function(){}),c(void 0),c(!1),c(new i(E)),T.setBounds(g.firstLineError,h.lastLineError),i}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36}],23:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i){function a(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}function s(e){var r=this._promise=new t(n);e instanceof t&&r._propagateFrom(e,3),r._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var c=e("./util");c.isArray;return c.inherits(s,i),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function e(n,i){var s=r(this._values,this._promise);if(s instanceof t){var l=(s=s._target())._bitField;if(this._values=s,0==(50397184&l))return this._promise._setAsyncGuaranteed(),s._then(e,this._reject,void 0,this,i);if(0==(33554432&l))return 0!=(16777216&l)?this._reject(s._reason()):this._cancel();s=s._value()}if(null!==(s=c.asArray(s)))0!==s.length?this._iterate(s):-5===i?this._resolveEmptyArray():this._resolve(a(i));else{var u=o("expecting an array or an iterable object but got "+c.classString(s)).reason();this._promise._rejectCallback(u,!1)}},s.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,i=!1,a=null,s=0;s<n;++s){var c=r(e[s],o);a=c instanceof t?(c=c._target())._bitField:null,i?null!==a&&c.suppressUnhandledRejections():null!==a?0==(50397184&a)?(c._proxy(this,s),this._values[s]=c):i=0!=(33554432&a)?this._promiseFulfilled(c._value(),s):0!=(16777216&a)?this._promiseRejected(c._reason(),s):this._promiseCancelled(s):i=this._promiseFulfilled(c,s)}i||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},{"./util":36}],24:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e){return!_.test(e)}function o(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function i(e,t,n){var r=d.getDataPropertyOrDefault(e,t+n,y);return!!r&&o(r)}function a(e,t,n){for(var r=0;r<e.length;r+=2){var o=e[r];if(n.test(o))for(var i=o.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===i)throw new v("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function s(e,t,n,r){for(var s=d.inheritedDataKeys(e),c=[],l=0;l<s.length;++l){var u=s[l],p=e[u],f=r===E||E(u,p,e);"function"!=typeof p||o(p)||i(e,u,t)||!r(u,p,e,f)||c.push(u,p)}return a(c,t,n),c}function c(e,t,n,r,o){for(var i=new RegExp(w(t)+"$"),a=s(e,t,i,n),c=0,l=a.length;c<l;c+=2){var u=a[c],f=a[c+1],h=u+t;if(r===k)e[h]=k(u,p,u,f,t,o);else{var m=r(f,function(){return k(u,p,u,f,t,o)});d.notEnumerableProp(m,"__isPromisified__",!0),e[h]=m}}return d.toFastProperties(e),e}function l(e,t,n){return k(e,t,void 0,e,null,n)}var u,p={},d=e("./util"),f=e("./nodeback"),h=d.withAppended,m=d.maybeWrapAsError,g=d.canEvaluate,v=e("./errors").TypeError,y={__isPromisified__:!0},b=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],_=new RegExp("^(?:"+b.join("|")+")$"),E=function(e){return d.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},w=function(e){return e.replace(/([$])/,"\\$")},k=g?u:function(e,r,o,i,a,s){function c(){var o=r;r===p&&(o=this);var i=new t(n);i._captureStackTrace();var a="string"==typeof u&&this!==l?this[u]:e,c=f(i,s);try{a.apply(o,h(arguments,c))}catch(e){i._rejectCallback(m(e),!0,!0)}return i._isFateSealed()||i._setAsyncGuaranteed(),i}var l=function(){return this}(),u=e;return"string"==typeof u&&(e=i),d.notEnumerableProp(c,"__isPromisified__",!0),c};t.promisify=function(e,t){if("function"!=typeof e)throw new v("expecting a function but got "+d.classString(e));if(o(e))return e;var n=l(e,void 0===(t=Object(t)).context?p:t.context,!!t.multiArgs);return d.copyDescriptors(e,n,r),n},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new v("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var n=!!(t=Object(t)).multiArgs,r=t.suffix;"string"!=typeof r&&(r="Async");var o=t.filter;"function"!=typeof o&&(o=E);var i=t.promisifier;if("function"!=typeof i&&(i=k),!d.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=d.inheritedDataKeys(e),s=0;s<a.length;++s){var l=e[a[s]];"constructor"!==a[s]&&d.isClass(l)&&(c(l.prototype,r,o,i,n),c(l,r,o,i,n))}return c(e,r,o,i,n)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,n){"use strict";t.exports=function(t,n,r,o){function i(e){var t,n=!1;if(void 0!==s&&e instanceof s)t=p(e),n=!0;else{var r=u.keys(e),o=r.length;t=new Array(2*o);for(var i=0;i<o;++i){var a=r[i];t[i]=e[a],t[i+o]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,n?-6:-3)}function a(e){var n,a=r(e);return l(a)?(n=a instanceof t?a._then(t.props,void 0,void 0,void 0,void 0):new i(a).promise(),a instanceof t&&n._propagateFrom(a,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,c=e("./util"),l=c.isObject,u=e("./es5");"function"==typeof Map&&(s=Map);var p=function(){function e(e,r){this[t]=e,this[t+n]=r,t++}var t=0,n=0;return function(r){n=r.size,t=0;var o=new Array(2*r.size);return r.forEach(e,o),o}}(),d=function(e){for(var t=new s,n=e.length/2|0,r=0;r<n;++r){var o=e[n+r],i=e[r];t.set(o,i)}return t};c.inherits(i,n),i.prototype._init=function(){},i.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var n;if(this._isMap)n=d(this._values);else{n={};for(var r=this.length(),o=0,i=this.length();o<i;++o)n[this._values[o+r]]=this._values[o]}return this._resolve(n),!0}return!1},i.prototype.shouldCopyValues=function(){return!1},i.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return a(this)},t.props=function(e){return a(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,n){"use strict";function r(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t],e[i+t]=void 0}function o(e){this._capacity=e,this._length=0,this._front=0}o.prototype._willBeOverCapacity=function(e){return this._capacity<e},o.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},o.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+r-3;this._checkCapacity(r);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=n,this._length=r},o.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},o.prototype.length=function(){return this._length},o.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},o.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,r(this,0,this,t,this._front+this._length&t-1)},t.exports=o},{}],27:[function(e,t,n){"use strict";t.exports=function(t,n,r,o){function i(e,i){var c=r(e);if(c instanceof t)return s(c);if(null===(e=a.asArray(e)))return o("expecting an array or an iterable object but got "+a.classString(e));var l=new t(n);void 0!==i&&l._propagateFrom(i,3);for(var u=l._fulfill,p=l._reject,d=0,f=e.length;d<f;++d){var h=e[d];(void 0!==h||d in e)&&t.cast(h)._then(u,p,void 0,l,null)}return l}var a=e("./util"),s=function(e){return e.then(function(t){return i(t,e)})};t.race=function(e){return i(e,void 0)},t.prototype.race=function(){return i(this,void 0)}}},{"./util":36}],28:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i,a){function s(e,n,r,o){this.constructor$(e);var a=d();this._fn=null===a?n:f.domainBind(a,n),void 0!==r&&(r=t.resolve(r))._attachCancellationCallback(this),this._initialValue=r,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function c(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function l(e,t,n,o){return"function"!=typeof t?r("expecting a function but got "+f.classString(t)):new s(e,t,n,o).promise()}function u(e){this.accum=e,this.array._gotAccum(e);var n=o(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(p,void 0,void 0,this,void 0)):p.call(this,n)}function p(e){var n=this.array,r=n._promise,o=h(n._fn);r._pushContext();var i;(i=void 0!==n._eachValues?o.call(r._boundValue(),e,this.index,this.length):o.call(r._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(n._currentCancellable=i);var s=r._popContext();return a.checkForgottenReturns(i,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",r),i}var d=t._getDomain,f=e("./util"),h=f.tryCatch;f.inherits(s,n),s.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},s.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},s.prototype._resultCancelled=function(e){if(e===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel())},s.prototype._iterate=function(e){this._values=e;var n,r,o=e.length;if(void 0!==this._initialValue?(n=this._initialValue,r=0):(n=t.resolve(e[0]),r=1),this._currentCancellable=n,!n.isRejected())for(;r<o;++r){var i={accum:null,value:e[r],index:r,length:o,array:this};n=n._then(u,void 0,void 0,i,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(c,c,void 0,n,this)},t.prototype.reduce=function(e,t){return l(this,e,t,null)},t.reduce=function(e,t,n,r){return l(e,t,n,r)}}},{"./util":36}],29:[function(t,n,o){"use strict";var i,a=t("./util"),s=a.getNativePromise();if(a.isNode&&"undefined"==typeof MutationObserver){var c=r.setImmediate,l=e.nextTick;i=a.isRecentNode?function(e){c.call(r,e)}:function(t){l.call(e,t)}}else if("function"==typeof s&&"function"==typeof s.resolve){var u=s.resolve();i=function(e){u.then(e)}}else i="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,r=document.createElement("div");new MutationObserver(function(){e.classList.toggle("foo"),n=!1}).observe(r,t);var o=function(){n||(n=!0,r.classList.toggle("foo"))};return function(n){var r=new MutationObserver(function(){r.disconnect(),n()});r.observe(e,t),o()}}();n.exports=i},{"./util":36}],30:[function(e,t,n){"use strict";t.exports=function(t,n,r){function o(e){this.constructor$(e)}var i=t.PromiseInspection;e("./util").inherits(o,n),o.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(e,t){var n=new i;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},o.prototype._promiseRejected=function(e,t){var n=new i;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},t.settle=function(e){return r.deprecated(".settle()",".reflect()"),new o(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,n){"use strict";t.exports=function(t,n,r){function o(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function i(e,t){if((0|t)!==t||t<0)return r("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new o(e),i=n.promise();return n.setHowMany(t),n.init(),i}var a=e("./util"),s=e("./errors").RangeError,c=e("./errors").AggregateError,l=a.isArray,u={};a.inherits(o,n),o.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=l(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},o.prototype.init=function(){this._initialized=!0,this._init()},o.prototype.setUnwrap=function(){this._unwrap=!0},o.prototype.howMany=function(){return this._howMany},o.prototype.setHowMany=function(e){this._howMany=e},o.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},o.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},o.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},o.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new c,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},o.prototype._fulfilled=function(){return this._totalResolved},o.prototype._rejected=function(){return this._values.length-this.length()},o.prototype._addRejected=function(e){this._values.push(e)},o.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},o.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},o.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},o.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return i(e,t)},t.prototype.some=function(e){return i(this,e)},t._SomePromiseArray=o}},{"./errors":12,"./util":36}],32:[function(e,t,n){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},i=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,n){"use strict";t.exports=function(t,n){function r(e){return e.then}function o(e){try{return r(e)}catch(e){return c.e=e,c}}function i(e){try{return u.call(e,"_promise0")}catch(e){return!1}}function a(e,r,o){var i=new t(n),a=i;o&&o._pushContext(),i._captureStackTrace(),o&&o._popContext();var l=!0,u=s.tryCatch(r).call(e,function(e){i&&(i._resolveCallback(e),i=null)},function(e){i&&(i._rejectCallback(e,l,!0),i=null)});return l=!1,i&&u===c&&(i._rejectCallback(u.e,!0,!0),i=null),a}var s=e("./util"),c=s.errorObj,l=s.isObject,u={}.hasOwnProperty;return function(e,r){if(l(e)){if(e instanceof t)return e;var s=o(e);if(s===c)return r&&r._pushContext(),u=t.reject(s.e),r&&r._popContext(),u;if("function"==typeof s){if(i(e)){var u=new t(n);return e._then(u._fulfill,u._reject,void 0,u,null),u}return a(e,s,r)}}return e}}},{"./util":36}],34:[function(e,t,n){"use strict";t.exports=function(t,n,r){function o(e){this.handle=e}function i(e){return clearTimeout(this.handle),e}function a(e){throw clearTimeout(this.handle),e}var s=e("./util"),c=t.TimeoutError;o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var l=function(e){return u(+this).thenReturn(e)},u=t.delay=function(e,i){var a,s;return void 0!==i?(a=t.resolve(i)._then(l,null,null,e,void 0),r.cancellation()&&i instanceof t&&a._setOnCancel(i)):(a=new t(n),s=setTimeout(function(){a._fulfill()},+e),r.cancellation()&&a._setOnCancel(new o(s)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};t.prototype.delay=function(e){return u(e,this)};var p=function(e,t,n){var r;r="string"!=typeof t?t instanceof Error?t:new c("operation timed out"):new c(t),s.markAsOriginatingFromRejection(r),e._attachExtraTrace(r),e._reject(r),null!=n&&n.cancel()};t.prototype.timeout=function(e,t){e=+e;var n,s,c=new o(setTimeout(function(){n.isPending()&&p(n,t,s)},e));return r.cancellation()?(s=this.then(),(n=s._then(i,a,void 0,c,void 0))._setOnCancel(c)):n=this._then(i,a,void 0,c,void 0),n}}},{"./util":36}],35:[function(e,t,n){"use strict";t.exports=function(t,n,r,o,i,a){function s(e){setTimeout(function(){throw e},0)}function c(e){var t=r(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function l(e,n){function o(){if(a>=l)return u._fulfill();var i=c(e[a++]);if(i instanceof t&&i._isDisposable()){try{i=r(i._getDisposer().tryDispose(n),e.promise)}catch(e){return s(e)}if(i instanceof t)return i._then(o,s,null,null,null)}o()}var a=0,l=e.length,u=new t(i);return o(),u}function u(e,t,n){this._data=e,this._promise=t,this._context=n}function p(e,t,n){this.constructor$(e,t,n)}function d(e){return u.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function f(e){this.length=e,this.promise=null,this[e-1]=null}var h=e("./util"),m=e("./errors").TypeError,g=e("./util").inherits,v=h.errorObj,y=h.tryCatch,b={};u.prototype.data=function(){return this._data},u.prototype.promise=function(){return this._promise},u.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():b},u.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=t!==b?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},u.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},g(p,u),p.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},f.prototype._resultCancelled=function(){for(var e=this.length,n=0;n<e;++n){var r=this[n];r instanceof t&&r.cancel()}},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var o=arguments[e-1];if("function"!=typeof o)return n("expecting a function but got "+h.classString(o));var i,s=!0;2===e&&Array.isArray(arguments[0])?(e=(i=arguments[0]).length,s=!1):(i=arguments,e--);for(var c=new f(e),p=0;p<e;++p){var m=i[p];if(u.isDisposer(m)){var g=m;(m=m.promise())._setDisposable(g)}else{var b=r(m);b instanceof t&&(m=b._then(d,null,null,{resources:c,index:p},void 0))}c[p]=m}for(var _=new Array(c.length),p=0;p<_.length;++p)_[p]=t.resolve(c[p]).reflect();var E=t.all(_).then(function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return v.e=n.error(),v;if(!n.isFulfilled())return void E.cancel();e[t]=n.value()}w._pushContext(),o=y(o);var r=s?o.apply(void 0,e):o(e),i=w._popContext();return a.checkForgottenReturns(r,i,"Promise.using",w),r}),w=E.lastly(function(){var e=new t.PromiseInspection(E);return l(c,e)});return c.promise=w,w._setOnCancel(c),w},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new p(e,this,o());throw new m}}},{"./errors":12,"./util":36}],36:[function(t,n,o){"use strict";function i(){try{var e=R;return R=null,e.apply(this,arguments)}catch(e){return D.e=e,D}}function a(e){return R=e,i}function s(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function c(e){return"function"==typeof e||"object"==typeof e&&null!==e}function l(e){return s(e)?new Error(y(e)):e}function u(e,t){var n,r=e.length,o=new Array(r+1);for(n=0;n<r;++n)o[n]=e[n];return o[n]=t,o}function p(e,t,n){if(!T.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function d(e,t,n){if(s(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return T.defineProperty(e,t,r),e}function f(e){throw e}function h(e){try{if("function"==typeof e){var t=T.names(e.prototype),n=T.isES5&&t.length>1,r=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=j.test(e+"")&&T.names(e).length>0;if(n||r||o)return!0}return!1}catch(e){return!1}}function m(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}function g(e){return M.test(e)}function v(e,t,n){for(var r=new Array(e),o=0;o<e;++o)r[o]=t+o+n;return r}function y(e){try{return e+""}catch(e){return"[no string representation]"}}function b(e){return null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function _(e){try{d(e,"isOperational",!0)}catch(e){}}function E(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function w(e){return b(e)&&T.propertyIsWritable(e,"stack")}function k(e){return{}.toString.call(e)}function x(e,t,n){for(var r=T.names(e),o=0;o<r.length;++o){var i=r[o];if(n(i))try{T.defineProperty(t,i,T.getDescriptor(e,i))}catch(e){}}}function C(t){return V?e.env[t]:void 0}function S(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(e){}}function N(e,t){return e.bind(t)}var T=t("./es5"),O="undefined"==typeof navigator,D={e:{}},R,A="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:void 0!==this?this:null,P=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var r={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},I=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(T.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var r=[],o=Object.create(null);null!=e&&!t(e);){var i;try{i=n(e)}catch(e){return r}for(var a=0;a<i.length;++a){var s=i[a];if(!o[s]){o[s]=!0;var c=Object.getOwnPropertyDescriptor(e,s);null!=c&&null==c.get&&null==c.set&&r.push(s)}}e=T.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var i in n)if(r.call(n,i))o.push(i);else{for(var a=0;a<e.length;++a)if(r.call(e[a],i))continue e;o.push(i)}return o}}(),j=/this\s*\.\s*\S+\s*=/,M=/^[a-z$_][a-z$_0-9]*$/i,L="stack"in new Error?function(e){return w(e)?e:new Error(y(e))}:function(e){if(w(e))return e;try{throw new Error(y(e))}catch(e){return e}},F=function(e){return T.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var U="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};F=function(e){return T.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?U(e):null}}var B=void 0!==e&&"[object process]"===k(e).toLowerCase(),V=void 0!==e&&void 0!==e.env,q={isClass:h,isIdentifier:g,inheritedDataKeys:I,getDataPropertyOrDefault:p,thrower:f,isArray:T.isArray,asArray:F,notEnumerableProp:d,isPrimitive:s,isObject:c,isError:b,canEvaluate:O,errorObj:D,tryCatch:a,inherits:P,withAppended:u,maybeWrapAsError:l,toFastProperties:m,filledRange:v,toString:y,canAttachTrace:w,ensureErrorObject:L,originatesFromRejection:E,markAsOriginatingFromRejection:_,classString:k,copyDescriptors:x,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:B,hasEnvVariables:V,env:C,global:A,getNativePromise:S,domainBind:N};q.isRecentNode=q.isNode&&function(){var t=e.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),q.isNode&&q.toFastProperties(e);try{throw new Error}catch(e){q.lastLineError=e}n.exports=q},{"./es5":13}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:146}],52:[function(e,t,n){},{}],53:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],54:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],55:[function(e,t,n){(function(t,r){function o(e,t){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(t)?r.showHidden=t:t&&n._extend(r,t),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=i),c(r,e,r.depth)}function i(e,t){var n=o.styles[t];return n?"["+o.colors[n][0]+"m"+e+"["+o.colors[n][1]+"m":e}function a(e,t){return e}function s(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function c(e,t,r){if(e.customInspect&&t&&x(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(r,e);return y(o)||(o=c(e,o,r)),o}var i=l(e,t);if(i)return i;var a=Object.keys(t),m=s(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(t)),k(t)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(t);if(0===a.length){if(x(t)){var g=t.name?": "+t.name:"";return e.stylize("[Function"+g+"]","special")}if(_(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(w(t))return e.stylize(Date.prototype.toString.call(t),"date");if(k(t))return u(t)}var v="",b=!1,E=["{","}"];if(h(t)&&(b=!0,E=["[","]"]),x(t)&&(v=" [Function"+(t.name?": "+t.name:"")+"]"),_(t)&&(v=" "+RegExp.prototype.toString.call(t)),w(t)&&(v=" "+Date.prototype.toUTCString.call(t)),k(t)&&(v=" "+u(t)),0===a.length&&(!b||0==t.length))return E[0]+v+E[1];if(r<0)return _(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var C;return C=b?p(e,t,r,m,a):a.map(function(n){return d(e,t,r,m,n,b)}),e.seen.pop(),f(C,v,E)}function l(e,t){if(b(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return v(t)?e.stylize(""+t,"number"):m(t)?e.stylize(""+t,"boolean"):g(t)?e.stylize("null","null"):void 0}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)T(t,String(a))?i.push(d(e,t,n,r,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))}),i}function d(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),T(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=g(n)?c(e,l.value,null):c(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),b(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e,t,n){var r=0;return e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function h(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function g(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return void 0===e}function _(e){return E(e)&&"[object RegExp]"===C(e)}function E(e){return"object"==typeof e&&null!==e}function w(e){return E(e)&&"[object Date]"===C(e)}function k(e){return E(e)&&("[object Error]"===C(e)||e instanceof Error)}function x(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}function N(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var O=/%[sdj%]/g;n.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(o(arguments[n]));return t.join(" ")}for(var n=1,r=arguments,i=r.length,a=String(e).replace(O,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),s=r[n];n<i;s=r[++n])g(s)||!E(s)?a+=" "+s:a+=" "+o(s);return a},n.deprecate=function(e,o){if(b(r.process))return function(){return n.deprecate(e,o).apply(this,arguments)};if(!0===t.noDeprecation)return e;var i=!1;return function(){if(!i){if(t.throwDeprecation)throw new Error(o);t.traceDeprecation?console.trace(o):console.error(o),i=!0}return e.apply(this,arguments)}};var D,R={};n.debuglog=function(e){if(b(D)&&(D=t.env.NODE_DEBUG||""),e=e.toUpperCase(),!R[e])if(new RegExp("\\b"+e+"\\b","i").test(D)){var r=t.pid;R[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else R[e]=function(){};return R[e]},n.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=h,n.isBoolean=m,n.isNull=g,n.isNullOrUndefined=function(e){return null==e},n.isNumber=v,n.isString=y,n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=b,n.isRegExp=_,n.isObject=E,n.isDate=w,n.isError=k,n.isFunction=x,n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e("./support/isBuffer");var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",N(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!E(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":54,_process:146,inherits:53}],56:[function(e,t,n){(function(t){"use strict";function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=i.prototype:(null===e&&(e=new i(t)),e.length=t),e}function i(e,t,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return a(this,e,t,n)}function a(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?d(e,t,n,r):"string"==typeof t?u(e,t,n):f(e,t)}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function c(e,t,n,r){return s(t),t<=0?o(e,t):void 0!==n?"string"==typeof r?o(e,t).fill(n,r):o(e,t).fill(n):o(e,t)}function l(e,t){if(s(t),e=o(e,t<0?0:0|h(t)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function u(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|m(t,n),a=(e=o(e,r)).write(t,n);return a!==r&&(e=e.slice(0,a)),e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=o(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),i.TYPED_ARRAY_SUPPORT?(e=t).__proto__=i.prototype:e=p(e,t),e}function f(e,t){if(i.isBuffer(t)){var n=0|h(t.length);return 0===(e=o(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||G(t.length)?o(e,0):p(e,t);if("Buffer"===t.type&&X(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function h(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function m(e,t){if(i.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return H(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return K(e).length;default:if(r)return H(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,t>>>=0,n<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return N(this,t,n);case"ascii":return O(this,t,n);case"latin1":case"binary":return D(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=i.from(t,r)),i.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,o);if("number"==typeof t)return t&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,o){function i(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}var l;if(o){var u=-1;for(l=n;l<s;l++)if(i(e,l)===i(t,-1===u?0:l-u)){if(-1===u&&(u=l),l-u+1===c)return u*a}else-1!==u&&(l-=l-u),u=-1}else for(n+c>s&&(n=s-c),l=n;l>=0;l--){for(var p=!0,d=0;d<c;d++)if(i(e,l+d)!==i(t,d)){p=!1;break}if(p)return l}return-1}function _(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function E(e,t,n,r){return Y(H(t,e.length-n),e,n,r)}function w(e,t,n,r){return Y(W(t),e,n,r)}function k(e,t,n,r){return w(e,t,n,r)}function x(e,t,n,r){return Y(K(t),e,n,r)}function C(e,t,n,r){return Y(z(t,e.length-n),e,n,r)}function S(e,t,n){return 0===t&&n===e.length?$.fromByteArray(e):$.fromByteArray(e.slice(t,n))}function N(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i=e[o],a=null,s=i>239?4:i>223?3:i>191?2:1;if(o+s<=n){var c,l,u,p;switch(s){case 1:i<128&&(a=i);break;case 2:128==(192&(c=e[o+1]))&&(p=(31&i)<<6|63&c)>127&&(a=p);break;case 3:c=e[o+1],l=e[o+2],128==(192&c)&&128==(192&l)&&(p=(15&i)<<12|(63&c)<<6|63&l)>2047&&(p<55296||p>57343)&&(a=p);break;case 4:c=e[o+1],l=e[o+2],u=e[o+3],128==(192&c)&&128==(192&l)&&128==(192&u)&&(p=(15&i)<<18|(63&c)<<12|(63&l)<<6|63&u)>65535&&p<1114112&&(a=p)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,r.push(a>>>10&1023|55296),a=56320|1023&a),r.push(a),o+=s}return T(r)}function T(e){var t=e.length;if(t<=Q)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Q));return n}function O(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function D(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function R(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=q(e[i]);return o}function A(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function I(e,t,n,r,o,a){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function M(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function L(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||L(e,t,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(e,t,n,r,23,4),n+4}function U(e,t,n,r,o){return o||L(e,t,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(e,t,n,r,52,8),n+8}function B(e){if((e=V(e).replace(Z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function V(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function q(e){return e<16?"0"+e.toString(16):e.toString(16)}function H(e,t){t=t||1/0;for(var n,r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function W(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function z(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}function K(e){return $.toByteArray(B(e))}function Y(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function G(e){return e!==e}var $=e("base64-js"),J=e("ieee754"),X=e("isarray");n.Buffer=i,n.SlowBuffer=function(e){return+e!=e&&(e=0),i.alloc(+e)},n.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),n.kMaxLength=r(),i.poolSize=8192,i._augment=function(e){return e.__proto__=i.prototype,e},i.from=function(e,t,n){return a(null,e,t,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(e,t,n){return c(null,e,t,n)},i.allocUnsafe=function(e){return l(null,e)},i.allocUnsafeSlow=function(e){return l(null,e)},i.isBuffer=function(e){return!(null==e||!e._isBuffer)},i.compare=function(e,t){if(!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,a=Math.min(n,r);o<a;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!X(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=i.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!i.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},i.byteLength=m,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},i.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?N(this,0,e):g.apply(this,arguments)},i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",t=n.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},i.prototype.compare=function(e,t,n,r,o){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var a=o-r,s=n-t,c=Math.min(a,s),l=this.slice(r,o),u=e.slice(t,n),p=0;p<c;++p)if(l[p]!==u[p]){a=l[p],s=u[p];break}return a<s?-1:s<a?1:0},i.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},i.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},i.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},i.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,e,t,n);case"utf8":case"utf-8":return E(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;i.prototype.slice=function(e,t){var n=this.length;e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r;if(i.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=i.prototype;else{var o=t-e;r=new i(o,void 0);for(var a=0;a<o;++a)r[a]=this[a+e]}return r},i.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},i.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},i.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},i.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*t)),r},i.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),J.read(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),J.read(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),J.read(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),J.read(this,e,!1,52,8)},i.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},i.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||I(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},i.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,255,0),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},i.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},i.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},i.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},i.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},i.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},i.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);I(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},i.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,1,127,-128),i.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},i.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},i.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},i.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||I(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),i.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},i.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},i.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},i.prototype.writeDoubleLE=function(e,t,n){return U(this,e,t,!0,n)},i.prototype.writeDoubleBE=function(e,t,n){return U(this,e,t,!1,n)},i.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,a=r-n;if(this===e&&n<t&&t<r)for(o=a-1;o>=0;--o)e[o+t]=this[o+n];else if(a<1e3||!i.TYPED_ARRAY_SUPPORT)for(o=0;o<a;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},i.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0);var a;if("number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var s=i.isBuffer(e)?e:H(new i(e,r).toString()),c=s.length;for(a=0;a<n-t;++a)this[a+t]=s[a%c]}return this};var Z=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":50,ieee754:98,isarray:102}],57:[function(e,t,n){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return"boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return"number"==typeof e},n.isString=function(e){return"string"==typeof e},n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return"[object RegExp]"===t(e)},n.isObject=function(e){return"object"==typeof e&&null!==e},n.isDate=function(e){return"[object Date]"===t(e)},n.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},n.isFunction=function(e){return"function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e.isBuffer}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":101}],58:[function(e,t,n){function r(e){i.call(this,e),this._options=e,this._iterator=null,this._operations=[]}var o=e("util"),i=e("abstract-leveldown").AbstractIterator;o.inherits(r,i),r.prototype.setDb=function(e){var t=this._iterator=e.iterator(this._options);this._operations.forEach(function(e){t[e.method].apply(t,e.args)})},r.prototype._operation=function(e,t){if(this._iterator)return this._iterator[e].apply(this._iterator,t);this._operations.push({method:e,args:t})},"next end".split(" ").forEach(function(e){r.prototype["_"+e]=function(){this._operation(e,arguments)}}),t.exports=r},{"abstract-leveldown":63,util:55}],59:[function(e,t,n){(function(n,r){function o(e){a.call(this,"string"==typeof e?e:""),this._db=void 0,this._operations=[],this._iterators=[]}var i=e("util"),a=e("abstract-leveldown").AbstractLevelDOWN,s=e("./deferred-iterator");i.inherits(o,a),o.prototype.setDb=function(e){this._db=e,this._operations.forEach(function(t){e[t.method].apply(e,t.args)}),this._iterators.forEach(function(t){t.setDb(e)})},o.prototype._open=function(e,t){return r.nextTick(t)},o.prototype._operation=function(e,t){if(this._db)return this._db[e].apply(this._db,t);this._operations.push({method:e,args:t})},"put get del batch approximateSize".split(" ").forEach(function(e){o.prototype["_"+e]=function(){this._operation(e,arguments)}}),o.prototype._isBuffer=function(e){return n.isBuffer(e)},o.prototype._iterator=function(e){if(this._db)return this._db.iterator.apply(this._db,arguments);var t=new s(e);return this._iterators.push(t),t},t.exports=o,t.exports.DeferredIterator=s}).call(this,{isBuffer:e("../is-buffer/index.js")},e("_process"))},{"../is-buffer/index.js":101,"./deferred-iterator":58,_process:146,"abstract-leveldown":63,util:55}],60:[function(e,t,n){(function(e){function n(e){this._db=e,this._operations=[],this._written=!1}n.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},n.prototype.put=function(e,t){this._checkWritten();var n=this._db._checkKey(e,"key",this._db._isBuffer);if(n)throw n;return this._db._isBuffer(e)||(e=String(e)),this._db._isBuffer(t)||(t=String(t)),"function"==typeof this._put?this._put(e,t):this._operations.push({type:"put",key:e,value:t}),this},n.prototype.del=function(e){this._checkWritten();var t=this._db._checkKey(e,"key",this._db._isBuffer);if(t)throw t;return this._db._isBuffer(e)||(e=String(e)),"function"==typeof this._del?this._del(e):this._operations.push({type:"del",key:e}),this},n.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},n.prototype.write=function(t,n){if(this._checkWritten(),"function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(n):"function"==typeof this._db._batch?this._db._batch(this._operations,t,n):void e.nextTick(n)},t.exports=n}).call(this,e("_process"))},{_process:146}],61:[function(e,t,n){(function(e){function n(e){this.db=e,this._ended=!1,this._nexting=!1}n.prototype.next=function(t){var n=this;if("function"!=typeof t)throw new Error("next() requires a callback argument");return n._ended?t(new Error("cannot call next() after end()")):n._nexting?t(new Error("cannot call next() before previous next() has completed")):(n._nexting=!0,"function"==typeof n._next?n._next(function(){n._nexting=!1,t.apply(null,arguments)}):void e.nextTick(function(){n._nexting=!1,t()}))},n.prototype.end=function(t){if("function"!=typeof t)throw new Error("end() requires a callback argument");return this._ended?t(new Error("end() already called on iterator")):(this._ended=!0,"function"==typeof this._end?this._end(t):void e.nextTick(t))},t.exports=n}).call(this,e("_process"))},{_process:146}],62:[function(e,t,n){(function(n,r){function o(e){if(!arguments.length||void 0===e)throw new Error("constructor requires at least a location argument");if("string"!=typeof e)throw new Error("constructor requires a location string argument");this.location=e,this.status="new"}var i=e("xtend"),a=e("./abstract-iterator"),s=e("./abstract-chained-batch");o.prototype.open=function(e,t){var n=this,o=this.status;if("function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("open() requires a callback argument");"object"!=typeof e&&(e={}),e.createIfMissing=0!=e.createIfMissing,e.errorIfExists=!!e.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(e,function(e){if(e)return n.status=o,t(e);n.status="open",t()})):(this.status="open",r.nextTick(t))},o.prototype.close=function(e){var t=this,n=this.status;if("function"!=typeof e)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(r){if(r)return t.status=n,e(r);t.status="closed",e()})):(this.status="closed",r.nextTick(e))},o.prototype.get=function(e,t,n){var o;if("function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("get() requires a callback argument");return(o=this._checkKey(e,"key",this._isBuffer))?n(o):(this._isBuffer(e)||(e=String(e)),"object"!=typeof t&&(t={}),t.asBuffer=0!=t.asBuffer,"function"==typeof this._get?this._get(e,t,n):void r.nextTick(function(){n(new Error("NotFound"))}))},o.prototype.put=function(e,t,n,o){var i;if("function"==typeof n&&(o=n),"function"!=typeof o)throw new Error("put() requires a callback argument");return(i=this._checkKey(e,"key",this._isBuffer))?o(i):(this._isBuffer(e)||(e=String(e)),null==t||this._isBuffer(t)||r.browser||(t=String(t)),"object"!=typeof n&&(n={}),"function"==typeof this._put?this._put(e,t,n,o):void r.nextTick(o))},o.prototype.del=function(e,t,n){var o;if("function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("del() requires a callback argument");return(o=this._checkKey(e,"key",this._isBuffer))?n(o):(this._isBuffer(e)||(e=String(e)),"object"!=typeof t&&(t={}),"function"==typeof this._del?this._del(e,t,n):void r.nextTick(n))},o.prototype.batch=function(e,t,n){if(!arguments.length)return this._chainedBatch();if("function"==typeof t&&(n=t),"function"==typeof e&&(n=e),"function"!=typeof n)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return n(new Error("batch(array) requires an array argument"));t&&"object"==typeof t||(t={});for(var o,i,a=0,s=e.length;a<s;a++)if("object"==typeof(o=e[a])){if(i=this._checkKey(o.type,"type",this._isBuffer))return n(i);if(i=this._checkKey(o.key,"key",this._isBuffer))return n(i)}if("function"==typeof this._batch)return this._batch(e,t,n);r.nextTick(n)},o.prototype.approximateSize=function(e,t,n){if(null==e||null==t||"function"==typeof e||"function"==typeof t)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof n)throw new Error("approximateSize() requires a callback argument");if(this._isBuffer(e)||(e=String(e)),this._isBuffer(t)||(t=String(t)),"function"==typeof this._approximateSize)return this._approximateSize(e,t,n);r.nextTick(function(){n(null,0)})},o.prototype._setupIteratorOptions=function(e){var t=this;return e=i(e),["start","end","gt","gte","lt","lte"].forEach(function(n){e[n]&&t._isBuffer(e[n])&&0===e[n].length&&delete e[n]}),e.reverse=!!e.reverse,e.keys=0!=e.keys,e.values=0!=e.values,e.limit="limit"in e?e.limit:-1,e.keyAsBuffer=0!=e.keyAsBuffer,e.valueAsBuffer=0!=e.valueAsBuffer,e},o.prototype.iterator=function(e){return"object"!=typeof e&&(e={}),e=this._setupIteratorOptions(e),"function"==typeof this._iterator?this._iterator(e):new a(this)},o.prototype._chainedBatch=function(){return new s(this)},o.prototype._isBuffer=function(e){return n.isBuffer(e)},o.prototype._checkKey=function(e,t){if(null===e||void 0===e)return new Error(t+" cannot be `null` or `undefined`");if(this._isBuffer(e)){if(0===e.length)return new Error(t+" cannot be an empty Buffer")}else if(""===String(e))return new Error(t+" cannot be an empty String")},t.exports=o}).call(this,{isBuffer:e("../../../is-buffer/index.js")},e("_process"))},{"../../../is-buffer/index.js":101,"./abstract-chained-batch":60,"./abstract-iterator":61,_process:146,xtend:313}],63:[function(e,t,n){n.AbstractLevelDOWN=e("./abstract-leveldown"),n.AbstractIterator=e("./abstract-iterator"),n.AbstractChainedBatch=e("./abstract-chained-batch"),n.isLevelDOWN=e("./is-leveldown")},{"./abstract-chained-batch":60,"./abstract-iterator":61,"./abstract-leveldown":62,"./is-leveldown":64}],64:[function(e,t,n){var r=e("./abstract-leveldown");t.exports=function(e){return!(!e||"object"!=typeof e)&&Object.keys(r.prototype).filter(function(e){return"_"!=e[0]&&"approximateSize"!=e}).every(function(t){return"function"==typeof e[t]})}},{"./abstract-leveldown":62}],65:[function(e,t,n){"use strict";function r(e){if(this._capacity=a(e),this._length=0,this._front=0,this._makeCapacity(),s(e)){for(var t=e.length,n=0;n<t;++n)this[n]=e[n];this._length=t}}function o(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t]}function i(e){return e>>>=0,e-=1,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)+1}function a(e){if("number"!=typeof e){if(!s(e))return 16;e=e.length}return i(Math.min(Math.max(16,e),1073741824))}r.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,o=0;o<e;++o)t[o]=this[n+o&r-1];return t},r.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(i=0;i<t;++i)this._checkCapacity(n+1),this[o=this._front+n&this._capacity-1]=arguments[i],n++,this._length=n;return n}for(var o=this._front,i=0;i<t;++i)this[o+n&r-1]=arguments[i],o++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[i=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},r.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},r.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},r.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(a=this._capacity)){for(o=n-1;o>=0;o--){this._checkCapacity(t+1);a=this._capacity;this[i=(this._front-1&a-1^a)-a]=arguments[o],t++,this._length=t,this._front=i}return t}for(var r=this._front,o=n-1;o>=0;o--){var i=(r-1&a-1^a)-a;this[i]=arguments[o],r=i}return this._front=r,this._length=t+n,t+n}if(0===n)return t;this._checkCapacity(t+1);var a=this._capacity;return this[o=(this._front-1&a-1^a)-a]=e,this._length=t+1,this._front=o,t+1},r.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},r.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},r.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},r.prototype.isEmpty=function(){return 0===this._length},r.prototype.clear=function(){this._length=0,this._front=0,this._makeCapacity()},r.prototype.toString=function(){return this.toArray().toString()},r.prototype.valueOf=r.prototype.toString,r.prototype.removeFront=r.prototype.shift,r.prototype.removeBack=r.prototype.pop,r.prototype.insertFront=r.prototype.unshift,r.prototype.insertBack=r.prototype.push,r.prototype.enqueue=r.prototype.push,r.prototype.dequeue=r.prototype.shift,r.prototype.toJSON=r.prototype.toArray,Object.defineProperty(r.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),r.prototype._makeCapacity=function(){for(var e=this._capacity,t=0;t<e;++t)this[t]=void 0},r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(a(1.5*this._capacity+16))},r.prototype._resizeTo=function(e){var t=this._front,n=this._capacity,r=new Array(n),i=this._length;if(o(this,0,r,0,n),this._capacity=e,this._makeCapacity(),this._front=0,t+i<=n)o(r,t,this,0,i);else{var a=i-(t+i&n-1);o(r,t,this,0,a),o(r,0,this,a,i-a)}};var s=Array.isArray;t.exports=r},{}],66:[function(e,t,n){function r(e,t,n){a(this,{type:e,name:e,cause:"string"!=typeof t?t:n,message:t&&"string"!=typeof t?t.message:t},"ewr")}function o(e,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),r.call(this,"CustomError",e,t)}function i(e,t,n){var i=function(n,o){r.call(this,t,n,o),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee)};return i.prototype=n?new n:new o,i}var a=e("prr");o.prototype=new Error,t.exports=function(e){var t=function(t,n){return i(e,t,n)};return{CustomError:o,FilesystemError:t("FilesystemError"),createError:t}}},{prr:147}],67:[function(e,t,n){var r=t.exports.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];t.exports.errno={},t.exports.code={},r.forEach(function(e){t.exports.errno[e.errno]=e,t.exports.code[e.code]=e}),t.exports.custom=e("./custom")(t.exports),t.exports.create=t.exports.custom.createError},{"./custom":66}],68:[function(e,t,n){!function(e,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof n?t.exports=r():(e.PromisePool=r(),e.promisePool=e.PromisePool)}(this,function(){"use strict";var e=function(){this._listeners={}};e.prototype.addEventListener=function(e,t){this._listeners[e]=this._listeners[e]||[],this._listeners[e].indexOf(t)<0&&this._listeners[e].push(t)},e.prototype.removeEventListener=function(e,t){if(this._listeners[e]){var n=this._listeners[e].indexOf(t);n>=0&&this._listeners[e].splice(n,1)}},e.prototype.dispatchEvent=function(e){if(this._listeners[e.type]&&this._listeners[e.type].length)for(var t=this._listeners[e.type].slice(),n=0,r=t.length;n<r;++n)t[n].call(this,e)};var t=function(e){return"function"==typeof e.constructor&&"GeneratorFunction"===e.constructor.name},n=function(e){return{next:function(){var t=e();return t?{value:t}:{done:!0}}}},r=function(e){var t=!1;return{next:function(){return t?{done:!0}:(t=!0,{value:e})}}},o=function(e,o){var i=typeof e;if("object"===i){if("function"==typeof e.next)return e;if("function"==typeof e.then)return r(e)}return"function"===i?t(e)?e():n(e):r(o.resolve(e))},i=function(e,t,n){this.target=e,this.type=t,this.data=n},a=function(t,n,r){if(e.call(this),"number"!=typeof n||Math.floor(n)!==n||n<1)throw new Error("Invalid concurrency");this._concurrency=n,this._options=r||{},this._options.promise=this._options.promise||Promise,this._iterator=o(t,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return a.prototype=new e,a.prototype.constructor=a,a.prototype.concurrency=function(e){return void 0!==e&&(this._concurrency=e,this.active()&&this._proceed()),this._concurrency},a.prototype.size=function(){return this._size},a.prototype.active=function(){return!!this._promise},a.prototype.promise=function(){return this._promise},a.prototype.start=function(){var e=this,t=this._options.promise;return this._promise=new t(function(t,n){e._callbacks={reject:n,resolve:t},e._proceed()}),this._promise},a.prototype._fireEvent=function(e,t){this.dispatchEvent(new i(this,e,t))},a.prototype._settle=function(e){e?this._callbacks.reject(e):this._callbacks.resolve(),this._promise=null,this._callbacks=null},a.prototype._onPooledPromiseFulfilled=function(e,t){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:e,result:t}),this._proceed())},a.prototype._onPooledPromiseRejected=function(e,t){this._size--,this.active()&&(this._fireEvent("rejected",{promise:e,error:t}),this._settle(t||new Error("Unknown error")))},a.prototype._trackPromise=function(e){var t=this;e.then(function(n){t._onPooledPromiseFulfilled(e,n)},function(n){t._onPooledPromiseRejected(e,n)}).catch(function(e){t._settle(new Error("Promise processing failed: "+e))})},a.prototype._proceed=function(){if(!this._done){for(var e=null;this._size<this._concurrency&&!(e=this._iterator.next()).done;)this._size++,this._trackPromise(e.value);this._done=null===e||!!e.done}this._done&&0===this._size&&this._settle()},a.PromisePoolEvent=i,a.PromisePool=a,a})},{}],69:[function(e,t,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function o(e){return"function"==typeof e}function i(e){return"number"==typeof e}function a(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,n,r,i,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(n=this._events[e],s(n))return!1;if(o(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(a(n))for(i=Array.prototype.slice.call(arguments,1),r=(l=n.slice()).length,c=0;c<r;c++)l[c].apply(this,i);return!0},r.prototype.addListener=function(e,t){var n;if(!o(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,o(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(n=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}if(!o(t))throw TypeError("listener must be a function");var r=!1;return n.listener=t,this.on(e,n),this},r.prototype.removeListener=function(e,t){var n,r,i,s;if(!o(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],i=n.length,r=-1,n===t||o(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=i;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],o(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?o(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(o(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},{}],70:[function(e,t,n){(function(n){"use strict";var r=e("./emptyFunction"),o={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,o){return e.addEventListener?(e.addEventListener(t,o,!0),{remove:function(){e.removeEventListener(t,o,!0)}}):("production"!==n.env.NODE_ENV&&console.error("Attempted to listen to events during the capture phase on a browser that does not support the capture phase. Your application will not receive some events."),{remove:r})},registerDefault:function(){}};t.exports=o}).call(this,e("_process"))},{"./emptyFunction":77,_process:146}],71:[function(e,t,n){"use strict";var r=!("undefined"==typeof window||!window.document||!window.document.createElement),o={canUseDOM:r,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};t.exports=o},{}],72:[function(e,t,n){"use strict";var r=/-(.)/g;t.exports=function(e){return e.replace(r,function(e,t){return t.toUpperCase()})}},{}],73:[function(e,t,n){"use strict";var r=e("./camelize"),o=/^-ms-/;t.exports=function(e){return r(e.replace(o,"ms-"))}},{"./camelize":72}],74:[function(e,t,n){"use strict";var r=e("./isTextNode");t.exports=function(e,t){var n=!0;e:for(;n;){var o=e,i=t;if(n=!1,o&&i){if(o===i)return!0;if(r(o))return!1;if(r(i)){e=o,t=i.parentNode,n=!0;continue e}return o.contains?o.contains(i):!!o.compareDocumentPosition&&!!(16&o.compareDocumentPosition(i))}return!1}}},{"./isTextNode":87}],75:[function(e,t,n){"use strict";function r(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}var o=e("./toArray");t.exports=function(e){return r(e)?Array.isArray(e)?e.slice():o(e):[e]}},{"./toArray":95}],76:[function(e,t,n){(function(n){"use strict";function r(e){var t=e.match(l);return t&&t[1].toLowerCase()}var o=e("./ExecutionEnvironment"),i=e("./createArrayFromMixed"),a=e("./getMarkupWrap"),s=e("./invariant"),c=o.canUseDOM?document.createElement("div"):null,l=/^\s*<(\w+)/;t.exports=function(e,t){var o=c;c||("production"!==n.env.NODE_ENV?s(!1,"createNodesFromMarkup dummy not initialized"):s(!1));var l=r(e),u=l&&a(l);if(u){o.innerHTML=u[1]+e+u[2];for(var p=u[0];p--;)o=o.lastChild}else o.innerHTML=e;var d=o.getElementsByTagName("script");d.length&&(t||("production"!==n.env.NODE_ENV?s(!1,"createNodesFromMarkup(...): Unexpected <script> element rendered."):s(!1)),i(d).forEach(t));for(var f=i(o.childNodes);o.lastChild;)o.removeChild(o.lastChild);return f}}).call(this,e("_process"))},{"./ExecutionEnvironment":71,"./createArrayFromMixed":75,"./getMarkupWrap":81,"./invariant":85,_process:146}],77:[function(e,t,n){"use strict";function r(e){return function(){return e}}function o(){}o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},t.exports=o},{}],78:[function(e,t,n){(function(e){"use strict";var n={};"production"!==e.env.NODE_ENV&&Object.freeze(n),t.exports=n}).call(this,e("_process"))},{_process:146}],79:[function(e,t,n){"use strict";t.exports=function(e){try{e.focus()}catch(e){}}},{}],80:[function(e,t,n){"use strict";t.exports=function(){if("undefined"==typeof document)return null;try{return document.activeElement||document.body}catch(e){return document.body}}},{}],81:[function(e,t,n){(function(n){"use strict";var r=e("./ExecutionEnvironment"),o=e("./invariant"),i=r.canUseDOM?document.createElement("div"):null,a={},s=[1,'<select multiple="true">',"</select>"],c=[1,"<table>","</table>"],l=[3,"<table><tbody><tr>","</tr></tbody></table>"],u=[1,'<svg xmlns="http://www.w3.org/2000/svg">',"</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:c,colgroup:c,tbody:c,tfoot:c,thead:c,td:l,th:l};["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","text","tspan"].forEach(function(e){p[e]=u,a[e]=!0}),t.exports=function(e){return i||("production"!==n.env.NODE_ENV?o(!1,"Markup wrapping node not initialized"):o(!1)),p.hasOwnProperty(e)||(e="*"),a.hasOwnProperty(e)||(i.innerHTML="*"===e?"<link />":"<"+e+"></"+e+">",a[e]=!i.firstChild),a[e]?p[e]:null}}).call(this,e("_process"))},{"./ExecutionEnvironment":71,"./invariant":85,_process:146}],82:[function(e,t,n){"use strict";t.exports=function(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}},{}],83:[function(e,t,n){"use strict";var r=/([A-Z])/g;t.exports=function(e){return e.replace(r,"-$1").toLowerCase()}},{}],84:[function(e,t,n){"use strict";var r=e("./hyphenate"),o=/^ms-/;t.exports=function(e){return r(e).replace(o,"-ms-")}},{"./hyphenate":83}],85:[function(e,t,n){(function(e){"use strict";t.exports=function(t,n,r,o,i,a,s,c){if("production"!==e.env.NODE_ENV&&void 0===n)throw new Error("invariant requires an error message argument");if(!t){var l;if(void 0===n)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[r,o,i,a,s,c],p=0;(l=new Error(n.replace(/%s/g,function(){return u[p++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}}).call(this,e("_process"))},{_process:146}],86:[function(e,t,n){"use strict";t.exports=function(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}},{}],87:[function(e,t,n){"use strict";var r=e("./isNode");t.exports=function(e){return r(e)&&3==e.nodeType}},{"./isNode":86}],88:[function(e,t,n){(function(n){"use strict";var r=e("./invariant");t.exports=function(e){var t,o={};e instanceof Object&&!Array.isArray(e)||("production"!==n.env.NODE_ENV?r(!1,"keyMirror(...): Argument must be an object."):r(!1));for(t in e)e.hasOwnProperty(t)&&(o[t]=t);return o}}).call(this,e("_process"))},{"./invariant":85,_process:146}],89:[function(e,t,n){"use strict";t.exports=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null}},{}],90:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;t.exports=function(e,t,n){if(!e)return null;var o={};for(var i in e)r.call(e,i)&&(o[i]=t.call(n,e[i],i,e));return o}},{}],91:[function(e,t,n){"use strict";t.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},{}],92:[function(e,t,n){"use strict";var r;e("./ExecutionEnvironment").canUseDOM&&(r=window.performance||window.msPerformance||window.webkitPerformance),t.exports=r||{}},{"./ExecutionEnvironment":71}],93:[function(e,t,n){"use strict";var r,o=e("./performance");r=o.now?function(){return o.now()}:function(){return Date.now()},t.exports=r},{"./performance":92}],94:[function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty;t.exports=function(e,t){if(e===t)return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(var i=r.bind(t),a=0;a<n.length;a++)if(!i(n[a])||e[n[a]]!==t[n[a]])return!1;return!0}},{}],95:[function(e,t,n){(function(n){"use strict";var r=e("./invariant");t.exports=function(e){var t=e.length;if((Array.isArray(e)||"object"!=typeof e&&"function"!=typeof e)&&("production"!==n.env.NODE_ENV?r(!1,"toArray: Array-like object expected"):r(!1)),"number"!=typeof t&&("production"!==n.env.NODE_ENV?r(!1,"toArray: Object needs a length property"):r(!1)),0===t||t-1 in e||("production"!==n.env.NODE_ENV?r(!1,"toArray: Object should have keys for indices"):r(!1)),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(e){}for(var o=Array(t),i=0;i<t;i++)o[i]=e[i];return o}}).call(this,e("_process"))},{"./invariant":85,_process:146}],96:[function(e,t,n){(function(n){"use strict";var r=e("./emptyFunction");"production"!==n.env.NODE_ENV&&(r=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){var i=0,a="Warning: "+t.replace(/%s/g,function(){return r[i++]});"undefined"!=typeof console&&console.error(a);try{throw new Error(a)}catch(e){}}}),t.exports=r}).call(this,e("_process"))},{"./emptyFunction":77,_process:146}],97:[function(e,t,n){"use strict";function r(e,t,n,r,o,i){this._color=e,this.key=t,this.value=n,this.left=r,this.right=o,this._count=i}function o(e){return new r(e._color,e.key,e.value,e.left,e.right,e._count)}function i(e,t){return new r(e,t.key,t.value,t.left,t.right,t._count)}function a(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function s(e,t){this._compare=e,this.root=t}function c(e,t){if(t.left&&(n=c(e,t.left)))return n;var n=e(t.key,t.value);return n||(t.right?c(e,t.right):void 0)}function l(e,t,n,r){if(t(e,r.key)<=0){if(r.left&&(o=l(e,t,n,r.left)))return o;var o=n(r.key,r.value);if(o)return o}if(r.right)return l(e,t,n,r.right)}function u(e,t,n,r,o){var i,a=n(e,o.key),s=n(t,o.key);if(a<=0){if(o.left&&(i=u(e,t,n,r,o.left)))return i;if(s>0&&(i=r(o.key,o.value)))return i}if(s>0&&o.right)return u(e,t,n,r,o.right)}function p(e,t){this.tree=e,this._stack=t}function d(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e._color=t._color,e._count=t._count}function f(e){for(var t,n,r,s,c=e.length-1;c>=0;--c){if(t=e[c],0===c)return void(t._color=g);if((n=e[c-1]).left===t){if((r=n.right).right&&r.right._color===m)return r=n.right=o(r),s=r.right=o(r.right),n.right=r.left,r.left=n,r.right=s,r._color=n._color,t._color=g,n._color=g,s._color=g,a(n),a(r),c>1&&((l=e[c-2]).left===n?l.left=r:l.right=r),void(e[c-1]=r);if(r.left&&r.left._color===m)return r=n.right=o(r),s=r.left=o(r.left),n.right=s.left,r.left=s.right,s.left=n,s.right=r,s._color=n._color,n._color=g,r._color=g,t._color=g,a(n),a(r),a(s),c>1&&((l=e[c-2]).left===n?l.left=s:l.right=s),void(e[c-1]=s);if(r._color===g){if(n._color===m)return n._color=g,void(n.right=i(m,r));n.right=i(m,r);continue}r=o(r),n.right=r.left,r.left=n,r._color=n._color,n._color=m,a(n),a(r),c>1&&((l=e[c-2]).left===n?l.left=r:l.right=r),e[c-1]=r,e[c]=n,c+1<e.length?e[c+1]=t:e.push(t),c+=2}else{if((r=n.left).left&&r.left._color===m)return r=n.left=o(r),s=r.left=o(r.left),n.left=r.right,r.right=n,r.left=s,r._color=n._color,t._color=g,n._color=g,s._color=g,a(n),a(r),c>1&&((l=e[c-2]).right===n?l.right=r:l.left=r),void(e[c-1]=r);if(r.right&&r.right._color===m)return r=n.left=o(r),s=r.right=o(r.right),n.left=s.right,r.right=s.left,s.right=n,s.left=r,s._color=n._color,n._color=g,r._color=g,t._color=g,a(n),a(r),a(s),c>1&&((l=e[c-2]).right===n?l.right=s:l.left=s),void(e[c-1]=s);if(r._color===g){if(n._color===m)return n._color=g,void(n.left=i(m,r));n.left=i(m,r);continue}if(r=o(r),n.left=r.right,r.right=n,r._color=n._color,n._color=m,a(n),a(r),c>1){var l=e[c-2];l.right===n?l.right=r:l.left=r}e[c-1]=r,e[c]=n,c+1<e.length?e[c+1]=t:e.push(t),c+=2}}}function h(e,t){return e<t?-1:e>t?1:0}t.exports=function(e){return new s(e||h,null)};var m=0,g=1,v=s.prototype;Object.defineProperty(v,"keys",{get:function(){var e=[];return this.forEach(function(t,n){e.push(t)}),e}}),Object.defineProperty(v,"values",{get:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e}}),Object.defineProperty(v,"length",{get:function(){return this.root?this.root._count:0}}),v.insert=function(e,t){for(var n=this._compare,o=this.root,c=[],l=[];o;){var u=n(e,o.key);c.push(o),l.push(u),o=u<=0?o.left:o.right}c.push(new r(m,e,t,null,null,1));for(p=c.length-2;p>=0;--p){o=c[p];l[p]<=0?c[p]=new r(o._color,o.key,o.value,c[p+1],o.right,o._count+1):c[p]=new r(o._color,o.key,o.value,o.left,c[p+1],o._count+1)}for(var p=c.length-1;p>1;--p){var d=c[p-1],o=c[p];if(d._color===g||o._color===g)break;var f=c[p-2];if(f.left===d)if(d.left===o){if(!(h=f.right)||h._color!==m){f._color=m,f.left=d.right,d._color=g,d.right=f,c[p-2]=d,c[p-1]=o,a(f),a(d),p>=3&&((v=c[p-3]).left===f?v.left=d:v.right=d);break}d._color=g,f.right=i(g,h),f._color=m,p-=1}else{if(!(h=f.right)||h._color!==m){d.right=o.left,f._color=m,f.left=o.right,o._color=g,o.left=d,o.right=f,c[p-2]=o,c[p-1]=d,a(f),a(d),a(o),p>=3&&((v=c[p-3]).left===f?v.left=o:v.right=o);break}d._color=g,f.right=i(g,h),f._color=m,p-=1}else if(d.right===o){if(!(h=f.left)||h._color!==m){f._color=m,f.right=d.left,d._color=g,d.left=f,c[p-2]=d,c[p-1]=o,a(f),a(d),p>=3&&((v=c[p-3]).right===f?v.right=d:v.left=d);break}d._color=g,f.left=i(g,h),f._color=m,p-=1}else{var h=f.left;if(!h||h._color!==m){if(d.left=o.right,f._color=m,f.right=o.left,o._color=g,o.right=d,o.left=f,c[p-2]=o,c[p-1]=d,a(f),a(d),a(o),p>=3){var v=c[p-3];v.right===f?v.right=o:v.left=o}break}d._color=g,f.left=i(g,h),f._color=m,p-=1}}return c[0]._color=g,new s(n,c[0])},v.forEach=function(e,t,n){if(this.root)switch(arguments.length){case 1:return c(e,this.root);case 2:return l(t,this._compare,e,this.root);case 3:if(this._compare(t,n)>=0)return;return u(t,n,this._compare,e,this.root)}},Object.defineProperty(v,"begin",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.left;return new p(this,e)}}),Object.defineProperty(v,"end",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.right;return new p(this,e)}}),v.at=function(e){if(e<0)return new p(this,[]);for(var t=this.root,n=[];;){if(n.push(t),t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e)return new p(this,n);if(e-=1,!t.right)break;if(e>=t.right._count)break;t=t.right}return new p(this,[])},v.ge=function(e){for(var t=this._compare,n=this.root,r=[],o=0;n;){var i=t(e,n.key);r.push(n),i<=0&&(o=r.length),n=i<=0?n.left:n.right}return r.length=o,new p(this,r)},v.gt=function(e){for(var t=this._compare,n=this.root,r=[],o=0;n;){var i=t(e,n.key);r.push(n),i<0&&(o=r.length),n=i<0?n.left:n.right}return r.length=o,new p(this,r)},v.lt=function(e){for(var t=this._compare,n=this.root,r=[],o=0;n;){var i=t(e,n.key);r.push(n),i>0&&(o=r.length),n=i<=0?n.left:n.right}return r.length=o,new p(this,r)},v.le=function(e){for(var t=this._compare,n=this.root,r=[],o=0;n;){var i=t(e,n.key);r.push(n),i>=0&&(o=r.length),n=i<0?n.left:n.right}return r.length=o,new p(this,r)},v.find=function(e){for(var t=this._compare,n=this.root,r=[];n;){var o=t(e,n.key);if(r.push(n),0===o)return new p(this,r);n=o<=0?n.left:n.right}return new p(this,[])},v.remove=function(e){var t=this.find(e);return t?t.remove():this},v.get=function(e){for(var t=this._compare,n=this.root;n;){var r=t(e,n.key);if(0===r)return n.value;n=r<=0?n.left:n.right}};var y=p.prototype;Object.defineProperty(y,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(y,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),y.clone=function(){return new p(this.tree,this._stack.slice())},y.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var t=new Array(e.length),n=e[e.length-1];t[t.length-1]=new r(n._color,n.key,n.value,n.left,n.right,n._count);for(c=e.length-2;c>=0;--c)(n=e[c]).left===e[c+1]?t[c]=new r(n._color,n.key,n.value,t[c+1],n.right,n._count):t[c]=new r(n._color,n.key,n.value,n.left,t[c+1],n._count);if((n=t[t.length-1]).left&&n.right){var o=t.length;for(n=n.left;n.right;)t.push(n),n=n.right;var i=t[o-1];t.push(new r(n._color,i.key,i.value,n.left,n.right,n._count)),t[o-1].key=n.key,t[o-1].value=n.value;for(c=t.length-2;c>=o;--c)n=t[c],t[c]=new r(n._color,n.key,n.value,n.left,t[c+1],n._count);t[o-1].left=t[o]}if((n=t[t.length-1])._color===m){var a=t[t.length-2];a.left===n?a.left=null:a.right===n&&(a.right=null),t.pop();for(c=0;c<t.length;++c)t[c]._count--;return new s(this.tree._compare,t[0])}if(n.left||n.right){n.left?d(n,n.left):n.right&&d(n,n.right),n._color=g;for(c=0;c<t.length-1;++c)t[c]._count--;return new s(this.tree._compare,t[0])}if(1===t.length)return new s(this.tree._compare,null);for(var c=0;c<t.length;++c)t[c]._count--;var l=t[t.length-2];return f(t),l.left===n?l.left=null:l.right=null,new s(this.tree._compare,t[0])},Object.defineProperty(y,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(y,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(y,"index",{get:function(){var e=0,t=this._stack;if(0===t.length){var n=this.tree.root;return n?n._count:0}t[t.length-1].left&&(e=t[t.length-1].left._count);for(var r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,t[r].left&&(e+=t[r].left._count));return e},enumerable:!0}),y.next=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.right)for(t=t.right;t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(y,"hasNext",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].right)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}}),y.update=function(e){var t=this._stack;if(0===t.length)throw new Error("Can't update empty node!");var n=new Array(t.length),o=t[t.length-1];n[n.length-1]=new r(o._color,o.key,e,o.left,o.right,o._count);for(var i=t.length-2;i>=0;--i)(o=t[i]).left===t[i+1]?n[i]=new r(o._color,o.key,o.value,n[i+1],o.right,o._count):n[i]=new r(o._color,o.key,o.value,o.left,n[i+1],o._count);return new s(this.tree._compare,n[0])},y.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(y,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}})},{}],98:[function(e,t,n){n.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,l=c>>1,u=-7,p=n?o-1:0,d=n?-1:1,f=e[t+p];for(p+=d,i=f&(1<<-u)-1,f>>=-u,u+=s;u>0;i=256*i+e[t+p],p+=d,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=256*a+e[t+p],p+=d,u-=8);if(0===i)i=1-l;else{if(i===c)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,r),i-=l}return(f?-1:1)*a*Math.pow(2,i-r)},n.write=function(e,t,n,r,o,i){var a,s,c,l=8*i-o-1,u=(1<<l)-1,p=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,h=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+p>=1?d/c:d*Math.pow(2,1-p))*c>=2&&(a++,c/=2),a+p>=u?(s=0,a=u):a+p>=1?(s=(t*c-1)*Math.pow(2,o),a+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,o),a=0));o>=8;e[n+f]=255&s,f+=h,s/=256,o-=8);for(a=a<<o|s,l+=o;l>0;e[n+f]=255&a,f+=h,a/=256,l-=8);e[n+f-h]|=128*m}},{}],99:[function(e,t,n){(function(e){"use strict";function n(){l=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}l=!1}var r,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,a=new o(n),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var c=new e.MessageChannel;c.port1.onmessage=n,r=function(){c.port2.postMessage(0)}}var l,u=[];t.exports=function(e){1!==u.push(e)||l||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],100:[function(e,t,n){arguments[4][53][0].apply(n,arguments)},{dup:53}],101:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function o(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||o(e)||!!e._isBuffer)}},{}],102:[function(e,t,n){var r={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},{}],103:[function(e,t,n){(function(){var e=Array.prototype.slice,t=Array.prototype.forEach,n=function(r){if("object"!=typeof r)throw r+" is not an object";var o=e.call(arguments,1);return t.call(o,function(e){if(e)for(var t in e)"object"==typeof e[t]&&r[t]?n.call(r,r[t],e[t]):r[t]=e[t]}),r};this.extend=n}).call(this)},{}],104:[function(e,t,n){function r(e){this.opts=e||{},this.encodings=o}var o=e("./lib/encodings");t.exports=r,r.prototype._encoding=function(e){return"string"==typeof e&&(e=o[e]),e||(e=o.id),e},r.prototype._keyEncoding=function(e,t){return this._encoding(t&&t.keyEncoding||e&&e.keyEncoding||this.opts.keyEncoding)},r.prototype._valueEncoding=function(e,t){return this._encoding(t&&(t.valueEncoding||t.encoding)||e&&(e.valueEncoding||e.encoding)||this.opts.valueEncoding||this.opts.encoding)},r.prototype.encodeKey=function(e,t,n){return this._keyEncoding(t,n).encode(e)},r.prototype.encodeValue=function(e,t,n){return this._valueEncoding(t,n).encode(e)},r.prototype.decodeKey=function(e,t){return this._keyEncoding(t).decode(e)},r.prototype.decodeValue=function(e,t){return this._valueEncoding(t).decode(e)},r.prototype.encodeBatch=function(e,t){var n=this;return e.map(function(e){var r={type:e.type,key:n.encodeKey(e.key,t,e)};return n.keyAsBuffer(t,e)&&(r.keyEncoding="binary"),e.prefix&&(r.prefix=e.prefix),"value"in e&&(r.value=n.encodeValue(e.value,t,e),n.valueAsBuffer(t,e)&&(r.valueEncoding="binary")),r})};var i=["lt","gt","lte","gte","start","end"];r.prototype.encodeLtgt=function(e){var t=this,n={};return Object.keys(e).forEach(function(r){n[r]=i.indexOf(r)>-1?t.encodeKey(e[r],e):e[r]}),n},r.prototype.createStreamDecoder=function(e){var t=this;return e.keys&&e.values?function(n,r){return{key:t.decodeKey(n,e),value:t.decodeValue(r,e)}}:e.keys?function(n){return t.decodeKey(n,e)}:e.values?function(n,r){return t.decodeValue(r,e)}:function(){}},r.prototype.keyAsBuffer=function(e){return this._keyEncoding(e).buffer},r.prototype.valueAsBuffer=function(e){return this._valueEncoding(e).buffer}},{"./lib/encodings":105}],105:[function(e,t,n){(function(e){function t(e){return e}function r(t){return void 0===t||null===t||e.isBuffer(t)}n.utf8=n["utf-8"]={encode:function(e){return r(e)?e:String(e)},decode:t,buffer:!1,type:"utf8"},n.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"},n.binary={encode:function(t){return r(t)?t:new e(t)},decode:t,buffer:!0,type:"binary"},n.id={encode:function(e){return e},decode:function(e){return e},buffer:!1,type:"id"},["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"].forEach(function(t){n[t]={encode:function(n){return r(n)?n:new e(n,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t}})}).call(this,e("buffer").Buffer)},{buffer:56}],106:[function(e,t,n){var r=e("errno").create,o=r("LevelUPError"),i=r("NotFoundError",o);i.prototype.notFound=!0,i.prototype.status=404,t.exports={LevelUPError:o,InitializationError:r("InitializationError",o),OpenError:r("OpenError",o),ReadError:r("ReadError",o),WriteError:r("WriteError",o),NotFoundError:i,EncodingError:r("EncodingError",o)}},{errno:67}],107:[function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);i.call(this,a(t,{objectMode:!0})),this._iterator=e,this._destroyed=!1,this._decoder=null,t&&t.decoder&&(this._decoder=t.decoder),this.on("end",this._cleanup.bind(this))}var o=e("inherits"),i=e("readable-stream").Readable,a=e("xtend"),s=e("level-errors").EncodingError;t.exports=r,o(r,i),r.prototype._read=function(){var e=this;this._destroyed||this._iterator.next(function(t,n,r){if(!e._destroyed){if(t)return e.emit("error",t);if(void 0===n&&void 0===r)e.push(null);else{if(!e._decoder)return e.push({key:n,value:r});try{var r=e._decoder(n,r)}catch(t){return e.emit("error",new s(t)),void e.push(null)}e.push(r)}}})},r.prototype.destroy=r.prototype._cleanup=function(){var e=this;this._destroyed||(this._destroyed=!0,this._iterator.end(function(t){if(t)return e.emit("error",t);e.emit("close")}))}},{inherits:100,"level-errors":106,"readable-stream":114,xtend:313}],108:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],109:[function(e,t,n){(function(n){function r(e){if(!(this instanceof r))return new r(e);s.call(this,e),c.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",o)}function o(){this.allowHalfOpen||this._writableState.ended||n.nextTick(this.end.bind(this))}t.exports=r;var i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=e("core-util-is");a.inherits=e("inherits");var s=e("./_stream_readable"),c=e("./_stream_writable");a.inherits(r,s),function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}(i(c.prototype),function(e){r.prototype[e]||(r.prototype[e]=c.prototype[e])})}).call(this,e("_process"))},{"./_stream_readable":111,"./_stream_writable":113,_process:146,"core-util-is":57,inherits:100}],110:[function(e,t,n){function r(e){if(!(this instanceof r))return new r(e);o.call(this,e)}t.exports=r;var o=e("./_stream_transform"),i=e("core-util-is");i.inherits=e("inherits"),i.inherits(r,o),r.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":112,"core-util-is":57,inherits:100}],111:[function(e,t,n){(function(n){function r(t,n){var r=e("./_stream_duplex"),o=(t=t||{}).highWaterMark,i=t.objectMode?16:16384;this.highWaterMark=o||0===o?o:i,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!t.objectMode,n instanceof r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(T||(T=e("string_decoder/").StringDecoder),this.decoder=new T(t.encoding),this.encoding=t.encoding)}function o(t){e("./_stream_duplex");if(!(this instanceof o))return new o(t);this._readableState=new r(t,this),this.readable=!0,S.call(this)}function i(e,t,n,r,o){var i=l(t,n);if(i)e.emit("error",i);else if(N.isNullOrUndefined(n))t.reading=!1,t.ended||u(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!o){s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&o){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else!t.decoder||o||r||(n=t.decoder.write(n)),o||(t.reading=!1),t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&p(e)),f(e,t);else o||(t.reading=!1);return a(t)}function a(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function s(e){if(e>=D)e=D;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||N.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=s(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function l(e,t){var n=null;return N.isBuffer(t)||N.isString(t)||N.isNullOrUndefined(t)||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function u(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,p(e)}function p(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(O("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(function(){d(e)}):d(e))}function d(e){O("emit readable"),e.emit("readable"),y(e)}function f(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(function(){h(e,t)}))}function h(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(O("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function m(e){return function(){var t=e._readableState;O("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&C.listenerCount(e,"data")&&(t.flowing=!0,y(e))}}function g(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(function(){v(e,t)}))}function v(e,t){t.resumeScheduled=!1,e.emit("resume"),y(e),t.flowing&&!t.reading&&e.read(0)}function y(e){var t=e._readableState;if(O("flow",t.flowing),t.flowing)do{var n=e.read()}while(null!==n&&t.flowing)}function b(e,t){var n,r=t.buffer,o=t.length,i=!!t.decoder,a=!!t.objectMode;if(0===r.length)return null;if(0===o)n=null;else if(a)n=r.shift();else if(!e||e>=o)n=i?r.join(""):x.concat(r,o),r.length=0;else if(e<r[0].length)n=(u=r[0]).slice(0,e),r[0]=u.slice(e);else if(e===r[0].length)n=r.shift();else{n=i?"":new x(e);for(var s=0,c=0,l=r.length;c<l&&s<e;c++){var u=r[0],p=Math.min(e-s,u.length);i?n+=u.slice(0,p):u.copy(n,s,0,p),p<u.length?r[0]=u.slice(p):r.shift(),s+=p}}return n}function _(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,n.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function E(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function w(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}t.exports=o;var k=e("isarray"),x=e("buffer").Buffer;o.ReadableState=r;var C=e("events").EventEmitter;C.listenerCount||(C.listenerCount=function(e,t){return e.listeners(t).length});var S=e("stream"),N=e("core-util-is");N.inherits=e("inherits");var T,O=e("util");O=O&&O.debuglog?O.debuglog("stream"):function(){},N.inherits(o,S),o.prototype.push=function(e,t){var n=this._readableState;return N.isString(e)&&!n.objectMode&&(t=t||n.defaultEncoding)!==n.encoding&&(e=new x(e,t),t=""),i(this,n,e,t,!1)},o.prototype.unshift=function(e){return i(this,this._readableState,e,"",!0)},o.prototype.setEncoding=function(t){return T||(T=e("string_decoder/").StringDecoder),this._readableState.decoder=new T(t),this._readableState.encoding=t,this};var D=8388608;o.prototype.read=function(e){O("read",e);var t=this._readableState,n=e;if((!N.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return O("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?_(this):p(this),null;if(0===(e=c(e,t))&&t.ended)return 0===t.length&&_(this),null;var r=t.needReadable;O("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&O("length less than watermark",r=!0),(t.ended||t.reading)&&O("reading or ended",r=!1),r&&(O("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=c(n,t));var o;return o=e>0?b(e,t):null,N.isNull(o)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&_(this),N.isNull(o)||this.emit("data",o),o},o.prototype._read=function(e){this.emit("error",new Error("not implemented"))},o.prototype.pipe=function(e,t){function r(e){O("onunpipe"),e===p&&i()}function o(){O("onend"),e.end()}function i(){O("cleanup"),e.removeListener("close",c),e.removeListener("finish",l),e.removeListener("drain",h),e.removeListener("error",s),e.removeListener("unpipe",r),p.removeListener("end",o),p.removeListener("end",i),p.removeListener("data",a),!d.awaitDrain||e._writableState&&!e._writableState.needDrain||h()}function a(t){O("ondata"),!1===e.write(t)&&(O("false write response, pause",p._readableState.awaitDrain),p._readableState.awaitDrain++,p.pause())}function s(t){O("onerror",t),u(),e.removeListener("error",s),0===C.listenerCount(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",l),u()}function l(){O("onfinish"),e.removeListener("close",c),u()}function u(){O("unpipe"),p.unpipe(e)}var p=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=e;break;case 1:d.pipes=[d.pipes,e];break;default:d.pipes.push(e)}d.pipesCount+=1,O("pipe count=%d opts=%j",d.pipesCount,t);var f=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?o:i;d.endEmitted?n.nextTick(f):p.once("end",f),e.on("unpipe",r);var h=m(p);return e.on("drain",h),p.on("data",a),e._events&&e._events.error?k(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",c),e.once("finish",l),e.emit("pipe",p),d.flowing||(O("pipe resume"),p.resume()),e},o.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this);return this}return-1===(o=w(t.pipes,e))?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},o.prototype.on=function(e,t){var r=S.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var o=this._readableState;if(!o.readableListening)if(o.readableListening=!0,o.emittedReadable=!1,o.needReadable=!0,o.reading)o.length&&p(this);else{var i=this;n.nextTick(function(){O("readable nexttick read 0"),i.read(0)})}}return r},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){var e=this._readableState;return e.flowing||(O("resume"),e.flowing=!0,e.reading||(O("resume read 0"),this.read(0)),g(this,e)),this},o.prototype.pause=function(){return O("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(O("pause"),this._readableState.flowing=!1,this.emit("pause")),this},o.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(O("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(o){O("wrapped data"),t.decoder&&(o=t.decoder.write(o)),o&&(t.objectMode||o.length)&&(r.push(o)||(n=!0,e.pause()))});for(var o in e)N.isFunction(e[o])&&N.isUndefined(this[o])&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));return E(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){O("wrapped _read",t),n&&(n=!1,e.resume())},r},o._fromList=b}).call(this,e("_process"))},{"./_stream_duplex":109,_process:146,buffer:56,"core-util-is":57,events:69,inherits:100,isarray:108,stream:295,"string_decoder/":296,util:52}],112:[function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return o(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,c.isNullOrUndefined(n)||e.push(n),o&&o(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}function i(e){if(!(this instanceof i))return new i(e);s.call(this,e),this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){c.isFunction(this._flush)?this._flush(function(e){a(t,e)}):a(t)})}function a(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}t.exports=i;var s=e("./_stream_duplex"),c=e("core-util-is");c.inherits=e("inherits"),c.inherits(i,s),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,n){throw new Error("not implemented")},i.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},i.prototype._read=function(e){var t=this._transformState;c.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},{"./_stream_duplex":109,"core-util-is":57,inherits:100}],113:[function(e,t,n){(function(n){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function o(t,n){var r=e("./_stream_duplex"),o=(t=t||{}).highWaterMark,i=t.objectMode?16:16384;this.highWaterMark=o||0===o?o:i,this.objectMode=!!t.objectMode,n instanceof r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){f(n,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function i(t){var n=e("./_stream_duplex");if(!(this instanceof i||this instanceof n))return new i(t);this._writableState=new o(t,this),this.writable=!0,k.call(this)}function a(e,t,r){var o=new Error("write after end");e.emit("error",o),n.nextTick(function(){r(o)})}function s(e,t,r,o){var i=!0;if(!(w.isBuffer(r)||w.isString(r)||w.isNullOrUndefined(r)||t.objectMode)){var a=new TypeError("Invalid non-string/buffer chunk");e.emit("error",a),n.nextTick(function(){o(a)}),i=!1}return i}function c(e,t,n){return!e.objectMode&&!1!==e.decodeStrings&&w.isString(t)&&(t=new E(t,n)),t}function l(e,t,n,o,i){n=c(t,n,o),w.isBuffer(n)&&(o="buffer");var a=t.objectMode?1:n.length;t.length+=a;var s=t.length<t.highWaterMark;return s||(t.needDrain=!0),t.writing||t.corked?t.buffer.push(new r(n,o,i)):u(e,t,!1,a,n,o,i),s}function u(e,t,n,r,o,i,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function p(e,t,r,o,i){r?n.nextTick(function(){t.pendingcb--,i(o)}):(t.pendingcb--,i(o)),e._writableState.errorEmitted=!0,e.emit("error",o)}function d(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function f(e,t){var r=e._writableState,o=r.sync,i=r.writecb;if(d(r),t)p(e,r,o,t,i);else{var a=v(e,r);a||r.corked||r.bufferProcessing||!r.buffer.length||g(e,r),o?n.nextTick(function(){h(e,r,a,i)}):h(e,r,a,i)}}function h(e,t,n,r){n||m(e,t),t.pendingcb--,r(),b(e,t)}function m(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function g(e,t){if(t.bufferProcessing=!0,e._writev&&t.buffer.length>1){for(var n=[],r=0;r<t.buffer.length;r++)n.push(t.buffer[r].callback);t.pendingcb++,u(e,t,!0,t.length,t.buffer,"",function(e){for(var r=0;r<n.length;r++)t.pendingcb--,n[r](e)}),t.buffer=[]}else{for(r=0;r<t.buffer.length;r++){var o=t.buffer[r],i=o.chunk,a=o.encoding,s=o.callback,c=t.objectMode?1:i.length;if(u(e,t,!1,c,i,a,s),t.writing){r++;break}}r<t.buffer.length?t.buffer=t.buffer.slice(r):t.buffer.length=0}t.bufferProcessing=!1}function v(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function y(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function b(e,t){var n=v(e,t);return n&&(0===t.pendingcb?(y(e,t),t.finished=!0,e.emit("finish")):y(e,t)),n}function _(e,t,r){t.ending=!0,b(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r)),t.ended=!0}t.exports=i;var E=e("buffer").Buffer;i.WritableState=o;var w=e("core-util-is");w.inherits=e("inherits");var k=e("stream");w.inherits(i,k),i.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},i.prototype.write=function(e,t,n){var r=this._writableState,o=!1;return w.isFunction(t)&&(n=t,t=null),w.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),w.isFunction(n)||(n=function(){}),r.ended?a(this,0,n):s(this,r,e,n)&&(r.pendingcb++,o=l(this,r,e,t,n)),o},i.prototype.cork=function(){this._writableState.corked++},i.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||g(this,e))},i.prototype._write=function(e,t,n){n(new Error("not implemented"))},i.prototype._writev=null,i.prototype.end=function(e,t,n){var r=this._writableState;w.isFunction(e)?(n=e,e=null,t=null):w.isFunction(t)&&(n=t,t=null),w.isNullOrUndefined(e)||this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||_(this,r,n)}}).call(this,e("_process"))},{"./_stream_duplex":109,_process:146,buffer:56,"core-util-is":57,inherits:100,stream:295}],114:[function(e,t,n){(function(r){(n=t.exports=e("./lib/_stream_readable.js")).Stream=e("stream"),n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js"),r.browser||"disable"!==r.env.READABLE_STREAM||(t.exports=e("stream"))}).call(this,e("_process"))},{"./lib/_stream_duplex.js":109,"./lib/_stream_passthrough.js":110,"./lib/_stream_readable.js":111,"./lib/_stream_transform.js":112,"./lib/_stream_writable.js":113,_process:146,stream:295}],115:[function(e,t,n){function r(e,t){this._levelup=e,this._codec=t,this.batch=e.db.batch(),this.ops=[],this.length=0}var o=e("./util"),i=e("level-errors").WriteError,a=o.getOptions,s=o.dispatchError;r.prototype.put=function(e,t,n){n=a(n);var r=this._codec.encodeKey(e,n),o=this._codec.encodeValue(t,n);try{this.batch.put(r,o)}catch(e){throw new i(e)}return this.ops.push({type:"put",key:r,value:o}),this.length++,this},r.prototype.del=function(e,t){t=a(t);var n=this._codec.encodeKey(e,t);try{this.batch.del(n)}catch(e){throw new i(e)}return this.ops.push({type:"del",key:n}),this.length++,this},r.prototype.clear=function(){try{this.batch.clear()}catch(e){throw new i(e)}return this.ops=[],this.length=0,this},r.prototype.write=function(e){var t=this._levelup,n=this.ops;try{this.batch.write(function(r){if(r)return s(t,new i(r),e);t.emit("batch",n),e&&e()})}catch(e){throw new i(e)}},t.exports=r},{"./util":117,"level-errors":106}],116:[function(e,t,n){(function(n){function r(e,t){return"function"==typeof e?e:t}function o(e,t,r){if(!(this instanceof o))return new o(e,t,r);var i;if(l.call(this),this.setMaxListeners(1/0),"function"==typeof e?((t="object"==typeof t?t:{}).db=e,e=null):"object"==typeof e&&"function"==typeof e.db&&(t=e,e=null),"function"==typeof t&&(r=t,t={}),(!t||"function"!=typeof t.db)&&"string"!=typeof e){if(i=new w("Must provide a location for the database"),r)return n.nextTick(function(){r(i)});throw i}t=S(t),this.options=d(N,t),this._codec=new C(this.options),this._status="new",f(this,"location",e,"e"),this.open(r)}function i(e,t,n){if(!e._isOpening()&&!e.isOpen())return O(e,new y("Database is not open"),n),!0}function a(e,t,n){O(e,new v(t),n)}function s(e,t,n){O(e,new y(t),n)}function c(e){return function(t,n){T()[e](t,n||function(){})}}var l=e("events").EventEmitter,u=e("util").inherits,p=e("util").deprecate,d=e("xtend"),f=e("prr"),h=e("deferred-leveldown"),m=e("level-iterator-stream"),g=e("level-errors"),v=g.WriteError,y=g.ReadError,b=g.NotFoundError,_=g.OpenError,E=g.EncodingError,w=g.InitializationError,k=e("./util"),x=e("./batch"),C=e("level-codec"),S=k.getOptions,N=k.defaultOptions,T=k.getLevelDOWN,O=k.dispatchError;k.isDefined;u(o,l),o.prototype.open=function(e){var t,r,o=this;return this.isOpen()?(e&&n.nextTick(function(){e(null,o)}),this):this._isOpening()?e&&this.once("open",function(){e(null,o)}):(this.emit("opening"),this._status="opening",this.db=new h(this.location),t=this.options.db||T(),void(r=t(this.location)).open(this.options,function(t){if(t)return O(o,new _(t),e);o.db.setDb(r),o.db=r,o._status="open",e&&e(null,o),o.emit("open"),o.emit("ready")}))},o.prototype.close=function(e){var t=this;if(this.isOpen())this._status="closing",this.db.close(function(){t._status="closed",t.emit("closed"),e&&e.apply(null,arguments)}),this.emit("closing"),this.db=new h(this.location);else{if("closed"==this._status&&e)return n.nextTick(e);"closing"==this._status&&e?this.once("closed",e):this._isOpening()&&this.once("open",function(){t.close(e)})}},o.prototype.isOpen=function(){return"open"==this._status},o.prototype._isOpening=function(){return"opening"==this._status},o.prototype.isClosed=function(){return/^clos/.test(this._status)},o.prototype.get=function(e,t,n){var o,a=this;if(n=r(t,n),!i(this,0,n)){if(null===e||void 0===e||"function"!=typeof n)return s(this,"get() requires key and callback arguments",n);t=k.getOptions(t),o=this._codec.encodeKey(e,t),t.asBuffer=this._codec.valueAsBuffer(t),this.db.get(o,t,function(r,o){if(r)return r=/notfound/i.test(r)||r.notFound?new b("Key not found in database ["+e+"]",r):new y(r),O(a,r,n);if(n){try{o=a._codec.decodeValue(o,t)}catch(e){return n(new E(e))}n(null,o)}})}},o.prototype.put=function(e,t,n,o){var s,c,l=this;if(o=r(n,o),null===e||void 0===e)return a(this,"put() requires a key argument",o);i(this,0,o)||(n=S(n),s=this._codec.encodeKey(e,n),c=this._codec.encodeValue(t,n),this.db.put(s,c,n,function(n){if(n)return O(l,new v(n),o);l.emit("put",e,t),o&&o()}))},o.prototype.del=function(e,t,n){var o,s=this;if(n=r(t,n),null===e||void 0===e)return a(this,"del() requires a key argument",n);i(this,0,n)||(t=S(t),o=this._codec.encodeKey(e,t),this.db.del(o,t,function(t){if(t)return O(s,new v(t),n);s.emit("del",e),n&&n()}))},o.prototype.batch=function(e,t,n){var o,s=this;return arguments.length?(n=r(t,n),Array.isArray(e)?void(i(this,0,n)||(t=S(t),o=(o=s._codec.encodeBatch(e,t)).map(function(e){return e.type||void 0===e.key||void 0===e.value||(e.type="put"),e}),this.db.batch(o,t,function(t){if(t)return O(s,new v(t),n);s.emit("batch",e),n&&n()}))):a(this,"batch() requires an array argument",n)):new x(this,this._codec)},o.prototype.approximateSize=p(function(e,t,n,o){var i,a,c=this;if(o=r(n,o),n=S(n),null===e||void 0===e||null===t||void 0===t||"function"!=typeof o)return s(this,"approximateSize() requires start, end and callback arguments",o);i=this._codec.encodeKey(e,n),a=this._codec.encodeKey(t,n),this.db.approximateSize(i,a,function(e,t){if(e)return O(c,new _(e),o);o&&o(null,t)})},"db.approximateSize() is deprecated. Use db.db.approximateSize() instead"),o.prototype.readStream=o.prototype.createReadStream=function(e){return e=d({keys:!0,values:!0},this.options,e),e.keyEncoding=e.keyEncoding,e.valueEncoding=e.valueEncoding,e=this._codec.encodeLtgt(e),e.keyAsBuffer=this._codec.keyAsBuffer(e),e.valueAsBuffer=this._codec.valueAsBuffer(e),"number"!=typeof e.limit&&(e.limit=-1),new m(this.db.iterator(e),d(e,{decoder:this._codec.createStreamDecoder(e)}))},o.prototype.keyStream=o.prototype.createKeyStream=function(e){return this.createReadStream(d(e,{keys:!0,values:!1}))},o.prototype.valueStream=o.prototype.createValueStream=function(e){return this.createReadStream(d(e,{keys:!1,values:!0}))},o.prototype.toString=function(){return"LevelUP"},t.exports=o,t.exports.errors=e("level-errors"),t.exports.destroy=p(c("destroy"),"levelup.destroy() is deprecated. Use leveldown.destroy() instead"),t.exports.repair=p(c("repair"),"levelup.repair() is deprecated. Use leveldown.repair() instead")}).call(this,e("_process"))},{"./batch":115,"./util":117,_process:146,"deferred-leveldown":59,events:69,"level-codec":104,"level-errors":106,"level-iterator-stream":107,prr:118,util:55,xtend:313}],117:[function(e,t,n){function r(e){return new i(a("Failed to require LevelDOWN (%s). Try `npm install leveldown` if it's missing",e.message))}e("xtend");var o,i=e("level-errors").LevelUPError,a=e("util").format,s={createIfMissing:!0,errorIfExists:!1,keyEncoding:"utf8",valueEncoding:"utf8",compression:!0};t.exports={defaultOptions:s,getOptions:function(e){return"string"==typeof e&&(e={valueEncoding:e}),"object"!=typeof e&&(e={}),e},getLevelDOWN:function(){if(o)return o;var t,n=e("../package.json").devDependencies.leveldown;try{t=e("leveldown/package").version}catch(e){throw r(e)}if(!e("semver").satisfies(t,n))throw new i("Installed version of LevelDOWN ("+t+") does not match required version ("+n+")");try{return o=e("leveldown")}catch(e){throw r(e)}},dispatchError:function(e,t,n){"function"==typeof n?n(t):e.emit("error",t)},isDefined:function(e){return void 0!==e}}},{"../package.json":119,"level-errors":106,leveldown:52,"leveldown/package":52,semver:52,util:55,xtend:313}],118:[function(e,t,n){!function(e,n,r){void 0!==t&&t.exports?t.exports=r():n.prr=r()}(0,this,function(){var e="function"==typeof Object.defineProperty?function(e,t,n){return Object.defineProperty(e,t,n),e}:function(e,t,n){return e[t]=n.value,e},t=function(e,t){var n="object"==typeof t,r=!n&&"string"==typeof t,o=function(e){return n?!!t[e]:!!r&&t.indexOf(e[0])>-1};return{enumerable:o("enumerable"),configurable:o("configurable"),writable:o("writable"),value:e}};return function(n,r,o,i){var a;if(i=t(o,i),"object"==typeof r){for(a in r)Object.hasOwnProperty.call(r,a)&&(i.value=r[a],e(n,a,i));return n}return e(n,r,i)}})},{}],119:[function(e,t,n){t.exports={_args:[[{raw:"levelup@1.3.2",scope:null,escapedName:"levelup",name:"levelup",rawSpec:"1.3.2",spec:"1.3.2",type:"version"},"C:\\gh\\pxt\\node_modules\\pouchdb"]],_from:"levelup@1.3.2",_id:"levelup@1.3.2",_inCache:!0,_location:"/levelup",_nodeVersion:"6.1.0",_npmOperationalInternal:{host:"packages-16-east.internal.npmjs.com",tmp:"tmp/levelup-1.3.2.tgz_1463496525467_0.4644940535072237"},_npmUser:{name:"ralphtheninja",email:"ralphtheninja@riseup.net"},_npmVersion:"3.8.6",_phantomChildren:{},_requested:{raw:"levelup@1.3.2",scope:null,escapedName:"levelup",name:"levelup",rawSpec:"1.3.2",spec:"1.3.2",type:"version"},_requiredBy:["/pouchdb"],_resolved:"https://registry.npmjs.org/levelup/-/levelup-1.3.2.tgz",_shasum:"b321d3071f0e75c2dfaf2f0fe8864e5b9a387bc9",_shrinkwrap:null,_spec:"levelup@1.3.2",_where:"C:\\gh\\pxt\\node_modules\\pouchdb",browser:{leveldown:!1,"leveldown/package":!1,semver:!1},bugs:{url:"https://github.com/level/levelup/issues"},contributors:[{name:"Rod Vagg",email:"r@va.gg",url:"https://github.com/rvagg"},{name:"John Chesley",email:"john@chesl.es",url:"https://github.com/chesles/"},{name:"Jake Verbaten",email:"raynos2@gmail.com",url:"https://github.com/raynos"},{name:"Dominic Tarr",email:"dominic.tarr@gmail.com",url:"https://github.com/dominictarr"},{name:"Max Ogden",email:"max@maxogden.com",url:"https://github.com/maxogden"},{name:"Lars-Magnus Skog",email:"ralphtheninja@riseup.net",url:"https://github.com/ralphtheninja"},{name:"David Björklund",email:"david.bjorklund@gmail.com",url:"https://github.com/kesla"},{name:"Julian Gruber",email:"julian@juliangruber.com",url:"https://github.com/juliangruber"},{name:"Paolo Fragomeni",email:"paolo@async.ly",url:"https://github.com/0x00a"},{name:"Anton Whalley",email:"anton.whalley@nearform.com",url:"https://github.com/No9"},{name:"Matteo Collina",email:"matteo.collina@gmail.com",url:"https://github.com/mcollina"},{name:"Pedro Teixeira",email:"pedro.teixeira@gmail.com",url:"https://github.com/pgte"},{name:"James Halliday",email:"mail@substack.net",url:"https://github.com/substack"},{name:"Jarrett Cruger",email:"jcrugzz@gmail.com",url:"https://github.com/jcrugzz"}],dependencies:{"deferred-leveldown":"~1.2.1","level-codec":"~6.1.0","level-errors":"~1.0.3","level-iterator-stream":"~1.3.0",prr:"~1.0.1",semver:"~5.1.0",xtend:"~4.0.0"},description:"Fast & simple storage - a Node.js-style LevelDB wrapper",devDependencies:{async:"~1.5.0",bustermove:"~1.0.0",delayed:"~1.0.1",faucet:"~0.0.1",leveldown:"^1.1.0",memdown:"~1.1.0","msgpack-js":"~0.3.0",referee:"~1.2.0",rimraf:"~2.4.3","slow-stream":"0.0.4",tap:"~2.3.1",tape:"~4.2.1"},directories:{},dist:{shasum:"b321d3071f0e75c2dfaf2f0fe8864e5b9a387bc9",tarball:"https://registry.npmjs.org/levelup/-/levelup-1.3.2.tgz"},gitHead:"bcc242cfc4ec035f9228a5cd54903cb126659a00",homepage:"https://github.com/level/levelup",keywords:["leveldb","stream","database","db","store","storage","json"],license:"MIT",main:"lib/levelup.js",maintainers:[{name:"rvagg",email:"rod@vagg.org"},{name:"ralphtheninja",email:"ralphtheninja@riseup.net"},{name:"juliangruber",email:"julian@juliangruber.com"}],name:"levelup",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/level/levelup.git"},scripts:{test:"tape test/*-test.js | faucet"},version:"1.3.2"}},{}],120:[function(e,t,n){(function(e){function t(e){return null!=e&&""!==e}n.compare=function(t,n){if(e.isBuffer(t)){for(var r=Math.min(t.length,n.length),o=0;o<r;o++){var i=t[o]-n[o];if(i)return i}return t.length-n.length}return t<n?-1:t>n?1:0};var r=n.lowerBound=function(e){return t(e.gt)?e.gt:t(e.gte)?e.gte:t(e.min)?e.min:t(e.start)&&!e.reverse?e.start:t(e.end)&&e.reverse?e.end:void 0};n.lowerBoundInclusive=function(e){return!t(e.gt)},n.upperBoundInclusive=function(e){return!t(e.lt)};var o=n.lowerBoundExclusive=function(e){return!!t(e.gt)},i=n.upperBoundExclusive=function(e){return!!t(e.lt)},a=n.upperBound=function(e){return t(e.lt)?e.lt:t(e.lte)?e.lte:t(e.max)?e.max:t(e.start)&&e.reverse?e.start:t(e.end)&&!e.reverse?e.end:void 0};n.contains=function(e,s,c){c=c||n.compare;var l=r(e);if(t(l)&&((p=c(s,l))<0||0===p&&o(e)))return!1;var u=a(e);if(t(u)){var p=c(s,u);if(p>0||0===p&&i(e))return!1}return!0},n.filter=function(e,t){return function(r){return n.contains(e,r,t)}}}).call(this,{isBuffer:e("../is-buffer/index.js")})},{"../is-buffer/index.js":101}],121:[function(e,t,n){(function(e){(function(){function e(e){this.tokens=[],this.tokens.links={},this.options=e||p.defaults,this.rules=d.normal,this.options.gfm&&(this.options.tables?this.rules=d.tables:this.rules=d.gfm)}function r(e,t){if(this.options=t||p.defaults,this.links=e,this.rules=f.normal,this.renderer=this.options.renderer||new o,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=f.breaks:this.rules=f.gfm:this.options.pedantic&&(this.rules=f.pedantic)}function o(e){this.options=e||{}}function i(e){this.tokens=[],this.token=null,this.options=e||p.defaults,this.options.renderer=this.options.renderer||new o,this.renderer=this.options.renderer,this.renderer.options=this.options}function a(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function s(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/g,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function c(e,t){return e=e.source,t=t||"",function n(r,o){return r?(o=o.source||o,o=o.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(r,o),n):new RegExp(e,t)}}function l(){}function u(e){for(var t,n,r=1;r<arguments.length;r++){t=arguments[r];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}function p(t,n,r){if(r||"function"==typeof n){r||(r=n,n=null);var o,s,c=(n=u({},p.defaults,n||{})).highlight,l=0;try{o=e.lex(t,n)}catch(e){return r(e)}s=o.length;var d=function(e){if(e)return n.highlight=c,r(e);var t;try{t=i.parse(o,n)}catch(t){e=t}return n.highlight=c,e?r(e):r(null,t)};if(!c||c.length<3)return d();if(delete n.highlight,!s)return d();for(;l<o.length;l++)!function(e){"code"!==e.type?--s||d():c(e.text,e.lang,function(t,n){return t?d(t):null==n||n===e.text?--s||d():(e.text=n,e.escaped=!0,void(--s||d()))})}(o[l])}else try{return n&&(n=u({},p.defaults,n)),i.parse(e.lex(t,n),n)}catch(e){if(e.message+="\nPlease report this to https://github.com/chjj/marked.",(n||p.defaults).silent)return"<p>An error occured:</p><pre>"+a(e.message+"",!0)+"</pre>";throw e}}var d={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};d.bullet=/(?:[*+-]|\d+\.)/,d.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,d.item=c(d.item,"gm")(/bull/g,d.bullet)(),d.list=c(d.list)(/bull/g,d.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+d.def.source+")")(),d.blockquote=c(d.blockquote)("def",d.def)(),d._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",d.html=c(d.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,d._tag)(),d.paragraph=c(d.paragraph)("hr",d.hr)("heading",d.heading)("lheading",d.lheading)("blockquote",d.blockquote)("tag","<"+d._tag)("def",d.def)(),d.normal=u({},d),d.gfm=u({},d.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),d.gfm.paragraph=c(d.paragraph)("(?!","(?!"+d.gfm.fences.source.replace("\\1","\\2")+"|"+d.list.source.replace("\\1","\\3")+"|")(),d.tables=u({},d.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),e.rules=d,e.lex=function(t,n){return new e(n).lex(t)},e.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},e.prototype.token=function(e,t,n){for(var r,o,i,a,s,c,l,u,p,e=e.replace(/^ +$/gm,"");e;)if((i=this.rules.newline.exec(e))&&(e=e.substring(i[0].length),i[0].length>1&&this.tokens.push({type:"space"})),i=this.rules.code.exec(e))e=e.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]||""});else if(i=this.rules.heading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(t&&(i=this.rules.nptable.exec(e))){for(e=e.substring(i[0].length),c={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},u=0;u<c.align.length;u++)/^ *-+: *$/.test(c.align[u])?c.align[u]="right":/^ *:-+: *$/.test(c.align[u])?c.align[u]="center":/^ *:-+ *$/.test(c.align[u])?c.align[u]="left":c.align[u]=null;for(u=0;u<c.cells.length;u++)c.cells[u]=c.cells[u].split(/ *\| */);this.tokens.push(c)}else if(i=this.rules.lheading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(i=this.rules.hr.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,t,!0),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(e)){for(e=e.substring(i[0].length),a=i[2],this.tokens.push({type:"list_start",ordered:a.length>1}),r=!1,p=(i=i[0].match(this.rules.item)).length,u=0;u<p;u++)l=(c=i[u]).length,~(c=c.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(l-=c.length,c=this.options.pedantic?c.replace(/^ {1,4}/gm,""):c.replace(new RegExp("^ {1,"+l+"}","gm"),"")),this.options.smartLists&&u!==p-1&&(a===(s=d.bullet.exec(i[u+1])[0])||a.length>1&&s.length>1||(e=i.slice(u+1).join("\n")+e,u=p-1)),o=r||/\n\n(?!\s*$)/.test(c),u!==p-1&&(r="\n"===c.charAt(c.length-1),o||(o=r)),this.tokens.push({type:o?"loose_item_start":"list_item_start"}),this.token(c,!1,n),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(e))e=e.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===i[1]||"script"===i[1]||"style"===i[1]),text:i[0]});else if(!n&&t&&(i=this.rules.def.exec(e)))e=e.substring(i[0].length),this.tokens.links[i[1].toLowerCase()]={href:i[2],title:i[3]};else if(t&&(i=this.rules.table.exec(e))){for(e=e.substring(i[0].length),c={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},u=0;u<c.align.length;u++)/^ *-+: *$/.test(c.align[u])?c.align[u]="right":/^ *:-+: *$/.test(c.align[u])?c.align[u]="center":/^ *:-+ *$/.test(c.align[u])?c.align[u]="left":c.align[u]=null;for(u=0;u<c.cells.length;u++)c.cells[u]=c.cells[u].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(c)}else if(t&&(i=this.rules.paragraph.exec(e)))e=e.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var f={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};f._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,f._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,f.link=c(f.link)("inside",f._inside)("href",f._href)(),f.reflink=c(f.reflink)("inside",f._inside)(),f.normal=u({},f),f.pedantic=u({},f.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),f.gfm=u({},f.normal,{escape:c(f.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:c(f.text)("]|","~]|")("|","|https?://|")()}),f.breaks=u({},f.gfm,{br:c(f.br)("{2,}","*")(),text:c(f.gfm.text)("{2,}","*")()}),r.rules=f,r.output=function(e,t,n){return new r(t,n).output(e)},r.prototype.output=function(e){for(var t,n,r,o,i="";e;)if(o=this.rules.escape.exec(e))e=e.substring(o[0].length),i+=o[1];else if(o=this.rules.autolink.exec(e))e=e.substring(o[0].length),"@"===o[2]?(n=":"===o[1].charAt(6)?this.mangle(o[1].substring(7)):this.mangle(o[1]),r=this.mangle("mailto:")+n):r=n=a(o[1]),i+=this.renderer.link(r,null,n);else if(this.inLink||!(o=this.rules.url.exec(e))){if(o=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(o[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(o[0])&&(this.inLink=!1),e=e.substring(o[0].length),i+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(o[0]):a(o[0]):o[0];else if(o=this.rules.link.exec(e))e=e.substring(o[0].length),this.inLink=!0,i+=this.outputLink(o,{href:o[2],title:o[3]}),this.inLink=!1;else if((o=this.rules.reflink.exec(e))||(o=this.rules.nolink.exec(e))){if(e=e.substring(o[0].length),t=(o[2]||o[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){i+=o[0].charAt(0),e=o[0].substring(1)+e;continue}this.inLink=!0,i+=this.outputLink(o,t),this.inLink=!1}else if(o=this.rules.strong.exec(e))e=e.substring(o[0].length),i+=this.renderer.strong(this.output(o[2]||o[1]));else if(o=this.rules.em.exec(e))e=e.substring(o[0].length),i+=this.renderer.em(this.output(o[2]||o[1]));else if(o=this.rules.code.exec(e))e=e.substring(o[0].length),i+=this.renderer.codespan(a(o[2],!0));else if(o=this.rules.br.exec(e))e=e.substring(o[0].length),i+=this.renderer.br();else if(o=this.rules.del.exec(e))e=e.substring(o[0].length),i+=this.renderer.del(this.output(o[1]));else if(o=this.rules.text.exec(e))e=e.substring(o[0].length),i+=this.renderer.text(a(this.smartypants(o[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(o[0].length),r=n=a(o[1]),i+=this.renderer.link(r,null,n);return i},r.prototype.outputLink=function(e,t){var n=a(t.href),r=t.title?a(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,r,this.output(e[1])):this.renderer.image(n,r,a(e[1]))},r.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},r.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",r=e.length,o=0;o<r;o++)t=e.charCodeAt(o),Math.random()>.5&&(t="x"+t.toString(16)),n+="&#"+t+";";return n},o.prototype.code=function(e,t,n){if(this.options.highlight){var r=this.options.highlight(e,t);null!=r&&r!==e&&(n=!0,e=r)}return t?'<pre><code class="'+this.options.langPrefix+a(t,!0)+'">'+(n?e:a(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:a(e,!0))+"\n</code></pre>"},o.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},o.prototype.html=function(e){return e},o.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},o.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},o.prototype.list=function(e,t){var n=t?"ol":"ul";return"<"+n+">\n"+e+"</"+n+">\n"},o.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},o.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},o.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},o.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},o.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},o.prototype.strong=function(e){return"<strong>"+e+"</strong>"},o.prototype.em=function(e){return"<em>"+e+"</em>"},o.prototype.codespan=function(e){return"<code>"+e+"</code>"},o.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},o.prototype.del=function(e){return"<del>"+e+"</del>"},o.prototype.link=function(e,t,n){if(this.options.sanitize){try{var r=decodeURIComponent(s(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return""}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:"))return""}var o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>"},o.prototype.image=function(e,t,n){var r='<img src="'+e+'" alt="'+n+'"';return t&&(r+=' title="'+t+'"'),r+=this.options.xhtml?"/>":">"},o.prototype.text=function(e){return e},i.parse=function(e,t,n){return new i(t,n).parse(e)},i.prototype.parse=function(e){this.inline=new r(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},i.prototype.next=function(){return this.token=this.tokens.pop()},i.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},i.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},i.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,n,r,o="",i="";for(n="",e=0;e<this.token.header.length;e++)({header:!0,align:this.token.align[e]}),n+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(o+=this.renderer.tablerow(n),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],n="",r=0;r<t.length;r++)n+=this.renderer.tablecell(this.inline.output(t[r]),{header:!1,align:this.token.align[r]});i+=this.renderer.tablerow(n)}return this.renderer.table(o,i);case"blockquote_start":for(i="";"blockquote_end"!==this.next().type;)i+=this.tok();return this.renderer.blockquote(i);case"list_start":for(var i="",a=this.token.ordered;"list_end"!==this.next().type;)i+=this.tok();return this.renderer.list(i,a);case"list_item_start":for(i="";"list_item_end"!==this.next().type;)i+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(i);case"loose_item_start":for(i="";"list_item_end"!==this.next().type;)i+=this.tok();return this.renderer.listitem(i);case"html":var s=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(s);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.exec=l,p.options=p.setOptions=function(e){return u(p.defaults,e),p},p.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new o,xhtml:!1},p.Parser=i,p.parser=i.parse,p.Renderer=o,p.Lexer=e,p.lexer=e.lex,p.InlineLexer=r,p.inlineLexer=r.output,p.parse=p,void 0!==t&&"object"==typeof n?t.exports=p:"function"==typeof define&&define.amd?define(function(){return p}):this.marked=p}).call(function(){return this||("undefined"!=typeof window?window:e)}())}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],122:[function(e,t,n){(function(n,r,o){function i(e){return"string"==typeof e?"$"+e:JSON.stringify(e)}function a(e){return m.compare(e,this._end)>0}function s(e){return m.compare(e,this._end)>=0}function c(e){return m.compare(e,this._end)<0}function l(e){return m.compare(e,this._end)<=0}function u(e,t){h.call(this,e),this._limit=t.limit,-1===this._limit&&(this._limit=1/0);var n=e._store[e._location];this.keyAsBuffer=!1!==t.keyAsBuffer,this.valueAsBuffer=!1!==t.valueAsBuffer,this._reverse=t.reverse,this._options=t,this._done=0,this._reverse?(this._incr="prev",this._start=m.upperBound(t),this._end=m.lowerBound(t),void 0===this._start?this._tree=n.end:m.upperBoundInclusive(t)?this._tree=n.le(this._start):this._tree=n.lt(this._start),this._end&&(m.lowerBoundInclusive(t)?this._test=s:this._test=a)):(this._incr="next",this._start=m.lowerBound(t),this._end=m.upperBound(t),void 0===this._start?this._tree=n.begin:m.lowerBoundInclusive(t)?this._tree=n.ge(this._start):this._tree=n.gt(this._start),this._end&&(m.upperBoundInclusive(t)?this._test=l:this._test=c))}function p(e){if(!(this instanceof p))return new p(e);f.call(this,"string"==typeof e?e:""),this._location=this.location?i(this.location):"_tree",this._store=this.location?y:this,this._store[this._location]=this._store[this._location]||v(m.compare)}var d=e("inherits"),f=e("abstract-leveldown").AbstractLevelDOWN,h=e("abstract-leveldown").AbstractIterator,m=e("ltgt"),g=r.setImmediate||n.nextTick,v=e("functional-red-black-tree"),y={};d(u,h),u.prototype._next=function(e){var t,n;return this._done++>=this._limit?g(e):this._tree.valid?(t=this._tree.key,n=this._tree.value,this._test(t)?(this.keyAsBuffer&&(t=new o(t)),this.valueAsBuffer&&(n=new o(n)),this._tree[this._incr](),void g(function(){e(null,t,n)})):g(e)):g(e)},u.prototype._test=function(){return!0},p.clearGlobalStore=function(e){e?Object.keys(y).forEach(function(e){delete y[e]}):y={}},d(p,f),p.prototype._open=function(e,t){var n=this;g(function(){t(null,n)})},p.prototype._put=function(e,t,n,r){void 0!==t&&null!==t||(t="");var o=this._store[this._location].find(e);o.valid?this._store[this._location]=o.update(t):this._store[this._location]=this._store[this._location].insert(e,t),g(r)},p.prototype._get=function(e,t,n){var r=this._store[this._location].get(e);if(void 0===r){var i=new Error("NotFound");return g(function(){n(i)})}!1===t.asBuffer||this._isBuffer(r)||(r=new o(String(r))),g(function(){n(null,r)})},p.prototype._del=function(e,t,n){this._store[this._location]=this._store[this._location].remove(e),g(n)},p.prototype._batch=function(e,t,n){for(var r,o,i,a,s=-1,c=e.length,l=this._store[this._location];++s<c;)if(e[s]){if(o=this._isBuffer(e[s].key)?e[s].key:String(e[s].key),r=this._checkKey(o,"key"))return g(function(){n(r)});if(a=l.find(o),"put"===e[s].type){if(i=this._isBuffer(e[s].value)?e[s].value:String(e[s].value),r=this._checkKey(i,"value"))return g(function(){n(r)});l=a.valid?a.update(i):l.insert(o,i)}else l=a.remove()}this._store[this._location]=l,g(n)},p.prototype._iterator=function(e){return new u(this,e)},p.prototype._isBuffer=function(e){return o.isBuffer(e)},p.destroy=function(e,t){var n=i(e);n in y&&delete y[n],g(t)},t.exports=p}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{_process:146,"abstract-leveldown":126,buffer:56,"functional-red-black-tree":97,inherits:100,ltgt:120}],123:[function(e,t,n){(function(e){function n(e){this._db=e,this._operations=[],this._written=!1}n.prototype._serializeKey=function(e){return this._db._serializeKey(e)},n.prototype._serializeValue=function(e){return this._db._serializeValue(e)},n.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},n.prototype.put=function(e,t){this._checkWritten();var n=this._db._checkKey(e,"key",this._db._isBuffer);if(n)throw n;return e=this._serializeKey(e),t=this._serializeValue(t),"function"==typeof this._put?this._put(e,t):this._operations.push({type:"put",key:e,value:t}),this},n.prototype.del=function(e){this._checkWritten();var t=this._db._checkKey(e,"key",this._db._isBuffer);if(t)throw t;return e=this._serializeKey(e),"function"==typeof this._del?this._del(e):this._operations.push({type:"del",key:e}),this},n.prototype.clear=function(){return this._checkWritten(),this._operations=[],"function"==typeof this._clear&&this._clear(),this},n.prototype.write=function(t,n){if(this._checkWritten(),"function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("write() requires a callback argument");return"object"!=typeof t&&(t={}),this._written=!0,"function"==typeof this._write?this._write(n):"function"==typeof this._db._batch?this._db._batch(this._operations,t,n):void e.nextTick(n)},t.exports=n}).call(this,e("_process"))},{_process:146}],124:[function(e,t,n){arguments[4][61][0].apply(n,arguments)},{_process:146,dup:61}],125:[function(e,t,n){(function(n,r){function o(e){if(!arguments.length||void 0===e)throw new Error("constructor requires at least a location argument");if("string"!=typeof e)throw new Error("constructor requires a location string argument");this.location=e,this.status="new"}var i=e("xtend"),a=e("./abstract-iterator"),s=e("./abstract-chained-batch");o.prototype.open=function(e,t){var n=this,o=this.status;if("function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("open() requires a callback argument");"object"!=typeof e&&(e={}),e.createIfMissing=0!=e.createIfMissing,e.errorIfExists=!!e.errorIfExists,"function"==typeof this._open?(this.status="opening",this._open(e,function(e){if(e)return n.status=o,t(e);n.status="open",t()})):(this.status="open",r.nextTick(t))},o.prototype.close=function(e){var t=this,n=this.status;if("function"!=typeof e)throw new Error("close() requires a callback argument");"function"==typeof this._close?(this.status="closing",this._close(function(r){if(r)return t.status=n,e(r);t.status="closed",e()})):(this.status="closed",r.nextTick(e))},o.prototype.get=function(e,t,n){var o;if("function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("get() requires a callback argument");return(o=this._checkKey(e,"key"))?n(o):(e=this._serializeKey(e),"object"!=typeof t&&(t={}),t.asBuffer=0!=t.asBuffer,"function"==typeof this._get?this._get(e,t,n):void r.nextTick(function(){n(new Error("NotFound"))}))},o.prototype.put=function(e,t,n,o){var i;if("function"==typeof n&&(o=n),"function"!=typeof o)throw new Error("put() requires a callback argument");return(i=this._checkKey(e,"key"))?o(i):(e=this._serializeKey(e),t=this._serializeValue(t),"object"!=typeof n&&(n={}),"function"==typeof this._put?this._put(e,t,n,o):void r.nextTick(o))},o.prototype.del=function(e,t,n){var o;if("function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("del() requires a callback argument");return(o=this._checkKey(e,"key"))?n(o):(e=this._serializeKey(e),"object"!=typeof t&&(t={}),"function"==typeof this._del?this._del(e,t,n):void r.nextTick(n))},o.prototype.batch=function(e,t,n){if(!arguments.length)return this._chainedBatch();if("function"==typeof t&&(n=t),"function"==typeof e&&(n=e),"function"!=typeof n)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return n(new Error("batch(array) requires an array argument"));t&&"object"==typeof t||(t={});for(var o,i,a=0,s=e.length;a<s;a++)if("object"==typeof(o=e[a])){if(i=this._checkKey(o.type,"type"))return n(i);if(i=this._checkKey(o.key,"key"))return n(i)}if("function"==typeof this._batch)return this._batch(e,t,n);r.nextTick(n)},o.prototype.approximateSize=function(e,t,n){if(null==e||null==t||"function"==typeof e||"function"==typeof t)throw new Error("approximateSize() requires valid `start`, `end` and `callback` arguments");if("function"!=typeof n)throw new Error("approximateSize() requires a callback argument");if(e=this._serializeKey(e),t=this._serializeKey(t),"function"==typeof this._approximateSize)return this._approximateSize(e,t,n);r.nextTick(function(){n(null,0)})},o.prototype._setupIteratorOptions=function(e){var t=this;return e=i(e),["start","end","gt","gte","lt","lte"].forEach(function(n){e[n]&&t._isBuffer(e[n])&&0===e[n].length&&delete e[n]}),e.reverse=!!e.reverse,e.keys=0!=e.keys,e.values=0!=e.values,e.limit="limit"in e?e.limit:-1,e.keyAsBuffer=0!=e.keyAsBuffer,e.valueAsBuffer=0!=e.valueAsBuffer,e},o.prototype.iterator=function(e){return"object"!=typeof e&&(e={}),e=this._setupIteratorOptions(e),"function"==typeof this._iterator?this._iterator(e):new a(this)},o.prototype._chainedBatch=function(){return new s(this)},o.prototype._isBuffer=function(e){return n.isBuffer(e)},o.prototype._serializeKey=function(e){return this._isBuffer(e)?e:String(e)},o.prototype._serializeValue=function(e){return this._isBuffer(e)||r.browser||null==e?e:String(e)},o.prototype._checkKey=function(e,t){return null===e||void 0===e?new Error(t+" cannot be `null` or `undefined`"):this._isBuffer(e)&&0===e.length?new Error(t+" cannot be an empty Buffer"):""===String(e)?new Error(t+" cannot be an empty String"):void 0},t.exports=o}).call(this,{isBuffer:e("../../../is-buffer/index.js")},e("_process"))},{"../../../is-buffer/index.js":101,"./abstract-chained-batch":123,"./abstract-iterator":124,_process:146,xtend:313}],126:[function(e,t,n){arguments[4][63][0].apply(n,arguments)},{"./abstract-chained-batch":123,"./abstract-iterator":124,"./abstract-leveldown":125,"./is-leveldown":127,dup:63}],127:[function(e,t,n){arguments[4][64][0].apply(n,arguments)},{"./abstract-leveldown":125,dup:64}],128:[function(e,t,n){"use strict";function r(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return u(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),r=t?e:Object.keys(e),o=-1,i=r.length,a="";if(t)for(;++o<i;)a+=n.toIndexableString(r[o]);else for(;++o<i;){var s=r[o];a+=n.toIndexableString(s)+n.toIndexableString(e[s])}return a}return""}function o(e,t){var n,r=t;if("1"===e[t])n=0,t++;else{var o="0"===e[t];t++;var i="",a=e.substring(t,t+d),s=parseInt(a,10)+p;for(o&&(s=-s),t+=d;;){var c=e[t];if("\0"===c)break;i+=c,t++}n=1===(i=i.split(".")).length?parseInt(i,10):parseFloat(i[0]+"."+i[1]),o&&(n-=10),0!==s&&(n=parseFloat(n+"e"+s))}return{num:n,length:t-r}}function i(e,t){var n=e.pop();if(t.length){var r=t[t.length-1];n===r.element&&(t.pop(),r=t[t.length-1]);var o=r.element,i=r.index;Array.isArray(o)?o.push(n):i===e.length-2?o[e.pop()]=n:e.push(n)}}function a(e,t){for(var r=Math.min(e.length,t.length),o=0;o<r;o++){var i=n.collate(e[o],t[o]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function s(e,t){return e===t?0:e>t?1:-1}function c(e,t){for(var r=Object.keys(e),o=Object.keys(t),i=Math.min(r.length,o.length),a=0;a<i;a++){var s=n.collate(r[a],o[a]);if(0!==s)return s;if(0!==(s=n.collate(e[r[a]],t[o[a]])))return s}return r.length===o.length?0:r.length>o.length?1:-1}function l(e){var t=["boolean","number","string","object"].indexOf(typeof e);return~t?null===e?1:Array.isArray(e)?5:t<3?t+2:t+3:Array.isArray(e)?5:void 0}function u(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),n=parseInt(t[1],10),r=e<0,o=r?"0":"2",i=(r?-n:n)-p,a=h.padLeft(i.toString(),"0",d);o+=f+a;var s=Math.abs(parseFloat(t[0]));r&&(s=10-s);var c=s.toFixed(20);return c=c.replace(/\.?0+$/,""),o+=f+c}var p=-324,d=3,f="",h=e("./utils");n.collate=function(e,t){if(e===t)return 0;e=n.normalizeKey(e),t=n.normalizeKey(t);var r=l(e),o=l(t);if(r-o!=0)return r-o;if(null===e)return 0;switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:e<t?-1:1;case"string":return s(e,t)}return Array.isArray(e)?a(e,t):c(e,t)},n.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var r=e.length;e=new Array(r);for(var o=0;o<r;o++)e[o]=n.normalizeKey(t[o])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var i in t)if(t.hasOwnProperty(i)){var a=t[i];void 0!==a&&(e[i]=n.normalizeKey(a))}}}}return e},n.toIndexableString=function(e){return e=n.normalizeKey(e),l(e)+f+r(e)+"\0"},n.parseIndexableString=function(e){for(var t=[],n=[],r=0;;){var a=e[r++];if("\0"!==a)switch(a){case"1":t.push(null);break;case"2":t.push("1"===e[r]),r++;break;case"3":var s=o(e,r);t.push(s.num),r+=s.length;break;case"4":for(var c="";;){var l=e[r];if("\0"===l)break;c+=l,r++}c=c.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(c);break;case"5":var u={element:[],index:t.length};t.push(u.element),n.push(u);break;case"6":var p={element:{},index:t.length};t.push(p.element),n.push(p);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+a)}else{if(1===t.length)return t.pop();i(t,n)}}}},{"./utils":129}],129:[function(e,t,n){"use strict";function r(e,t,n){for(var r="",o=n-e.length;r.length<o;)r+=t;return r}n.padLeft=function(e,t,n){return r(e,t,n)+e},n.padRight=function(e,t,n){return e+r(e,t,n)},n.stringLexCompare=function(e,t){var n,r=e.length,o=t.length;for(n=0;n<r;n++){if(n===o)return 1;var i=e.charAt(n),a=t.charAt(n);if(i!==a)return i<a?-1:1}return r<o?-1:0},n.intToDecimalForm=function(e){var t=e<0,n="";do{n=(t?-Math.ceil(e%10):Math.floor(e%10))+n,e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);return t&&"0"!==n&&(n="-"+n),n}},{}],130:[function(e,t,n){"use strict";function r(){this.store={}}function o(e){if(this.store=new r,e&&Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.add(e[t])}n.Map=r,n.Set=o,r.prototype.mangle=function(e){if("string"!=typeof e)throw new TypeError("key must be a string but Got "+e);return"$"+e},r.prototype.unmangle=function(e){return e.substring(1)},r.prototype.get=function(e){var t=this.mangle(e);if(t in this.store)return this.store[t]},r.prototype.set=function(e,t){var n=this.mangle(e);return this.store[n]=t,!0},r.prototype.has=function(e){return this.mangle(e)in this.store},r.prototype.delete=function(e){var t=this.mangle(e);return t in this.store&&(delete this.store[t],!0)},r.prototype.forEach=function(e){for(var t=Object.keys(this.store),n=0,r=t.length;n<r;n++){var o=t[n];e(this.store[o],o=this.unmangle(o))}},o.prototype.add=function(e){return this.store.set(e,!0)},o.prototype.has=function(e){return this.store.has(e)},o.prototype.delete=function(e){return this.store.delete(e)}},{}],131:[function(e,t,n){t.exports=e("../lib/extras/memory")},{"../lib/extras/memory":132}],132:[function(e,t,n){(function(t,n,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function i(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function a(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function s(e){if(e instanceof ArrayBuffer)return a(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}function c(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&je.call(n)==Me}function l(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=l(e[n]);return t}if(e instanceof Date)return e.toISOString();if(i(e))return s(e);if(!c(e))return e;t={};for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=l(e[n]);void 0!==o&&(t[n]=o)}return t}function u(e,t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];i in e&&(n[i]=e[i])}return n}function p(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}function d(){return ye}function f(e){p()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):d()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function h(){Ne.EventEmitter.call(this),this._listeners={},f(this)}function m(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}function g(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=m.prototype,new n(t)}function v(e,t,n){try{return!e(t,n)}catch(e){var r="Filter function threw: "+e.toString();return g(Ke,r)}}function y(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var o=n&&v(e.filter,r.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function b(e){var t;if(e?"string"!=typeof e?t=g(Be):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=g(qe)):t=g(Ve),t)throw t}function _(e){return 0|Math.random()*e}function E(e,t){t=t||Je.length;var n="",r=-1;if(e){for(;++r<e;)n+=Je[_(t)];return n}for(;++r<36;)switch(r){case 8:case 13:case 18:case 23:n+="-";break;case 19:n+=Je[3&_(16)|8];break;default:n+=Je[_(16)]}return n}function w(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}function k(e){if(!/^\d+\-./.test(e))return g(Ye);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function x(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,o=[r[0],t,[]],i=1,a=r.length;i<a;i++)o=[r[i],{status:"missing"},[o]];return[{pos:n,ids:o}]}function C(e,t){var n,r,o,i={status:"available"};if(e._deleted&&(i.deleted=!0),t)if(e._id||(e._id=E()),r=E(32,16).toLowerCase(),e._rev){if((o=k(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[r,i,[]]]]}],n=o.prefix+1}else e._rev_tree=[{pos:1,ids:[r,i,[]]}],n=1;else if(e._revisions&&(e._rev_tree=x(e._revisions,i),n=e._revisions.start,r=e._revisions.ids[0]),!e._rev_tree){if((o=k(e._rev)).error)return o;n=o.prefix,r=o.id,e._rev_tree=[{pos:n,ids:[r,i,[]]}]}b(e._id),e._rev=n+"-"+r;var a={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var c="_"===s[0];if(c&&!Xe[s]){var l=g(ze,s);throw l.message=ze.message+": "+s,l}c&&!Qe[s]?a.metadata[s.slice(1)]=e[s]:a.data[s]=e[s]}return a}function S(e){for(var t,n,r,o,i=e.rev_tree.slice();o=i.pop();){var a=o.ids,s=a[2],c=o.pos;if(s.length)for(var l=0,u=s.length;l<u;l++)i.push({pos:c+1,ids:s[l]});else{var p=!!a[1].deleted,d=a[0];t&&!(r!==p?r:n!==c?n<c:t<d)||(t=d,n=c,r=p)}}return n+"-"+t}function N(e,t){for(var n,r=e.slice();n=r.pop();)for(var o=n.pos,i=n.ids,a=i[2],s=t(0===a.length,o,i[0],n.ctx,i[1]),c=0,l=a.length;c<l;c++)r.push({pos:o+1,ids:a[c],ctx:s})}function T(e,t){return e.pos-t.pos}function O(e){var t=[];N(e,function(e,n,r,o,i){e&&t.push({rev:n+"-"+r,pos:n,opts:i})}),t.sort(T).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function D(e){for(var t=S(e),n=O(e.rev_tree),r=[],o=0,i=n.length;o<i;o++){var a=n[o];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function R(e){var t=[];return N(e.rev_tree,function(e,n,r,o,i){"available"!==i.status||e||(t.push(n+"-"+r),i.status="missing")}),t}function A(e){for(var t,n=[],r=e.slice();t=r.pop();){var o=t.pos,i=t.ids,a=i[0],s=i[1],c=i[2],l=0===c.length,u=t.history?t.history.slice():[];u.push({id:a,opts:s}),l&&n.push({pos:o+1-u.length,ids:u});for(var p=0,d=c.length;p<d;p++)r.push({pos:o+1,ids:c[p],history:u})}return n.reverse()}function P(e,t){return e.pos-t.pos}function I(e,t,n){for(var r,o=0,i=e.length;o<i;)n(e[r=o+i>>>1],t)<0?o=r+1:i=r;return o}function j(e,t,n){var r=I(e,t,n);e.splice(r,0,t)}function M(e,t){for(var n,r,o=t,i=e.length;o<i;o++){var a=e[o],s=[a.id,a.opts,[]];r?(r[2].push(s),r=s):n=r=s}return n}function L(e,t){return e[0]<t[0]?-1:1}function F(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var o=n.pop(),i=o.tree1,a=o.tree2;(i[1].status||a[1].status)&&(i[1].status="available"===i[1].status||"available"===a[1].status?"available":"missing");for(var s=0;s<a[2].length;s++)if(i[2][0]){for(var c=!1,l=0;l<i[2].length;l++)i[2][l][0]===a[2][s][0]&&(n.push({tree1:i[2][l],tree2:a[2][s]}),c=!0);c||(r="new_branch",j(i[2],a[2][s],L))}else r="new_leaf",i[2][0]=a[2][s]}return{conflicts:r,tree:e}}function U(e,t,n){var r,o=[],i=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,c=e.length;s<c;s++){var l=e[s];if(l.pos===t.pos&&l.ids[0]===t.ids[0])r=F(l.ids,t.ids),o.push({pos:l.pos,ids:r.tree}),i=i||r.conflicts,a=!0;else if(!0!==n){var u=l.pos<t.pos?l:t,p=l.pos<t.pos?t:l,d=p.pos-u.pos,f=[],h=[];for(h.push({ids:u.ids,diff:d,parent:null,parentIdx:null});h.length>0;){var m=h.pop();if(0!==m.diff)for(var g=m.ids[2],v=0,y=g.length;v<y;v++)h.push({ids:g[v],diff:m.diff-1,parent:m.ids,parentIdx:v});else m.ids[0]===p.ids[0]&&f.push(m)}var b=f[0];b?(r=F(b.ids,p.ids),b.parent[2][b.parentIdx]=r.tree,o.push({pos:u.pos,ids:u.ids}),i=i||r.conflicts,a=!0):o.push(l)}else o.push(l)}return a||o.push(t),o.sort(P),{tree:o,conflicts:i||"internal_node"}}function B(e,t){for(var n,r=A(e),o={},i=0,a=r.length;i<a;i++){for(var s=r[i],c=s.ids,l=Math.max(0,c.length-t),u={pos:s.pos+l,ids:M(c,l)},p=0;p<l;p++){var d=s.pos+p+"-"+c[p].id;o[d]=!0}n=n?U(n,u,!0).tree:[u]}return N(n,function(e,t,n){delete o[t+"-"+n]}),{tree:n,revs:Object.keys(o)}}function V(e,t,n){var r=U(e,t),o=B(r.tree,n);return{tree:o.tree,stemmedRevs:o.revs,conflicts:r.conflicts}}function q(e,t){for(var n,r=e.slice(),o=t.split("-"),i=parseInt(o[0],10),a=o[1];n=r.pop();){if(n.pos===i&&n.ids[0]===a)return!0;for(var s=n.ids[2],c=0,l=s.length;c<l;c++)r.push({pos:n.pos+1,ids:s[c]})}return!1}function H(e){return e.ids}function W(e,t){t||(t=S(e));for(var n,r=t.substring(t.indexOf("-")+1),o=e.rev_tree.map(H);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function z(e){return/^_local/.test(e)}function K(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function Y(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function G(e,t){return K([Y(e)],{type:t})}function $(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,o=0;o<r;o++)t+=String.fromCharCode(n[o]);return t}function J(e,t){if("undefined"==typeof FileReader)return t($((new FileReaderSync).readAsArrayBuffer(e)));var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t($(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function X(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}function Q(e){return et(e)}function Z(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function ee(e,t,n,r,o){(n>0||r<t.size)&&(t=Z(t,n,r)),X(t,function(t){e.append(t),o()})}function te(e,t,n,r,o){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),o()}function ne(e,t){function n(){tt(o)}function r(){var e=Q(u.end(!0));t(e),u.destroy()}function o(){var t=l*s,o=t+s;++l<c?p(u,e,t,o,n):p(u,e,t,o,r)}var i="string"==typeof e,a=i?e.length:e.size,s=Math.min(nt,a),c=Math.ceil(a/s),l=0,u=i?new Oe:new Oe.ArrayBuffer,p=i?te:ee;o()}function re(e,t,n,r,o,i,a,s){if(q(t.rev_tree,n.metadata.rev))return r[o]=n,i();var c=t.winningRev||S(t),l="deleted"in t?t.deleted:W(t,c),u="deleted"in n.metadata?n.metadata.deleted:W(n.metadata),p=/^1-/.test(n.metadata.rev);if(l&&!u&&s&&p){var d=n.data;d._rev=c,d._id=n.metadata.id,n=C(d,s)}var f=V(t.rev_tree,n.metadata.rev_tree[0],e);if(s&&(l&&u||!l&&"new_leaf"!==f.conflicts||l&&!u&&"new_branch"===f.conflicts)){var h=g(Ue);return r[o]=h,i()}var m=n.metadata.rev;n.metadata.rev_tree=f.tree,n.stemmedRevs=f.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var v=S(n.metadata),y=W(n.metadata,v),b=l===y?0:l<y?-1:1;a(n,v,y,m===v?y:W(n.metadata,m),!0,b,o,i)}function oe(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function ie(e,t,n,r,o,i,a,s,c){function l(e,t,n){var r=S(e.metadata),o=W(e.metadata,r);if("was_delete"in s&&o)return i[t]=g(Fe,"deleted"),n();if(p&&oe(e)){var c=g(Ue);return i[t]=c,n()}a(e,r,o,o,!1,o?0:1,t,n)}function u(){++f===h&&c&&c()}e=e||1e3;var p=s.new_edits,d=new ke.Map,f=0,h=t.length;t.forEach(function(e,t){if(e._id&&z(e._id)){var r=e._deleted?"_removeLocal":"_putLocal";n[r](e,{ctx:o},function(e,n){i[t]=e||n,u()})}else{var a=e.metadata.id;d.has(a)?(h--,d.get(a).push([e,t])):d.set(a,[[e,t]])}}),d.forEach(function(t,n){function o(){++c<t.length?s():u()}function s(){var s=t[c],u=s[0],d=s[1];if(r.has(n))re(e,r.get(n),u,i,d,o,a,p);else{var f=V([],u.metadata.rev_tree[0],e);u.metadata.rev_tree=f.tree,u.stemmedRevs=f.stemmedRevs||[],l(u,d,o)}}var c=0;s()})}function ae(e){try{return JSON.parse(e)}catch(t){return De.parse(e)}}function se(e,t){return K([new Uint8Array(e)],{type:t})}function ce(e,t){J(e,t)}function le(e){return K([""],{type:e})}function ue(e,t){var n=t.prefix()[0],r=e._cache,o=r.get(n);return o||(o=new ke.Map,r.set(n,o)),o}function pe(){this._batch=[],this._cache=new ke.Map}function de(e){return"winningRev"in e?e.winningRev:S(e)}function fe(e,t){return"deleted"in e?e.deleted:W(e,t)}function he(e,t,n){var r=e.content_type;return new Ie(function(o,i){t.binaryStore.get(e.digest,function(t,a){var s;if(t){if("NotFoundError"!==t.name)return i(t);s=n.binary?G("",r):""}else s=n.binary?se(a,r):a.toString("base64");delete e.stub,delete e.length,e.data=s,o()})})}function me(e,t,n){var r=[];return e.forEach(function(e){e.doc&&e.doc._attachments&&Object.keys(e.doc._attachments).forEach(function(t){var n=e.doc._attachments[t];"data"in n||r.push(n)})}),Ie.all(r.map(function(e){return he(e,t,n)}))}function ge(e,n){function o(){w.docStore=b.sublevel(rt,{valueEncoding:ht}),w.bySeqStore=b.sublevel(ot,{valueEncoding:"json"}),w.attachmentStore=b.sublevel(it,{valueEncoding:"json"}),w.binaryStore=b.sublevel(at,{valueEncoding:"binary"}),w.localStore=b.sublevel(st,{valueEncoding:"json"}),w.metaStore=b.sublevel(ct,{valueEncoding:"json"}),Pe.localAndMetaStores(b,w,function(){w.metaStore.get(ut,function(e,r){void 0===b._updateSeq&&(b._updateSeq=r||0),w.metaStore.get(pt,function(e,r){b._docCount=e?0:r,w.metaStore.get(dt,function(e,r){v=e?E():r,w.metaStore.put(dt,v,function(){t.nextTick(function(){n(null,_)})})})})})})}function i(e){return b.isClosed()?e(new Error("database is closed")):e(null,b._docCount)}function a(e,t){try{e.apply(null,t)}catch(e){t[t.length-1](e)}}function s(){var e=b._queue.peekFront();"read"===e.type?c(e):u(e)}function c(e){for(var n=[e],r=1,o=b._queue.get(r);void 0!==o&&"read"===o.type;)n.push(o),r++,o=b._queue.get(r);var i=0;n.forEach(function(e){var r=e.args,o=r[r.length-1];r[r.length-1]=we(function(e){o.apply(null,e),++i===n.length&&t.nextTick(function(){n.forEach(function(){b._queue.shift()}),b._queue.length&&s()})}),a(e.fun,r)})}function u(e){var n=e.args,r=n[n.length-1];n[n.length-1]=we(function(e){r.apply(null,e),t.nextTick(function(){b._queue.shift(),b._queue.length&&s()})}),a(e.fun,n)}function p(e){return we(function(n){b._queue.push({fun:e,args:n,type:"write"}),1===b._queue.length&&t.nextTick(s)})}function d(e){return we(function(n){b._queue.push({fun:e,args:n,type:"read"}),1===b._queue.length&&t.nextTick(s)})}function f(e){return("0000000000000000"+e).slice(-16)}function h(e){return parseInt(e,10)}function m(e,t){T.destroy(e,t)}var v,b,_=this,w={},k=(e=l(e)).revs_limit,x=e.name;void 0===e.createIfMissing&&(e.createIfMissing=!0);var S,T=e.db,O=$e(T);lt.has(O)?S=lt.get(O):(S=new ke.Map,lt.set(O,S)),S.has(x)?(b=S.get(x),o()):S.set(x,_e(be(x,e,function(t){if(t)return S.delete(x),n(t);(b=S.get(x))._docCount=-1,b._queue=new xe,e.migrate?Pe.toSublevel(x,b,o):o()}))),_.type=function(){return"leveldb"},_._id=function(e){e(null,v)},_._info=function(e){var n={doc_count:b._docCount,update_seq:b._updateSeq,backend_adapter:$e(T)};return t.nextTick(function(){e(null,n)})},_._get=d(function(e,t,n){t=l(t),w.docStore.get(e,function(e,r){if(e||!r)return n(g(Fe,"missing"));var o=de(r);if(fe(r,o)&&!t.rev)return n(g(Fe,"deleted"));o=t.rev?t.rev:o;var i=r.rev_map[o];w.bySeqStore.get(f(i),function(e,t){if(!t)return n(g(Fe));if("_id"in t&&t._id!==r.id)return n(new Error("wrong doc returned"));if(t._id=r.id,"_rev"in t){if(t._rev!==o)return n(new Error("wrong doc returned"))}else t._rev=o;return n(null,{doc:t,metadata:r})})})}),_._getAttachment=function(e,t,n,r,o){var i=n.digest,a=n.content_type;w.binaryStore.get(i,function(e,t){if(e)return"NotFoundError"!==e.name?o(e):o(null,r.binary?le(a):"");r.binary?o(null,se(t,a)):o(null,t.toString("base64"))})},_._bulkDocs=p(function(e,n,o){function i(e,t){S.get(w.attachmentStore,e,function(n){if(n){var r=g(Ge,"unknown stub attachment with digest "+e);t(r)}else t()})}function a(e){function t(){if(++r===O.length)return e(n)}var n,r=0;O.forEach(function(e){if(e._id&&z(e._id))return t();S.get(w.docStore,e._id,function(r,o){r?"NotFoundError"!==r.name&&(n=r):y.set(e._id,o),t()})})}function s(e,t){var n=Ie.resolve();e.forEach(function(e,t){n=n.then(function(){return new Ie(function(n,r){_._doCompactionNoLock(t,e,{ctx:S},function(e){if(e)return r(e);n()})})})}),n.then(function(){t()},t)}function c(e){var t=new ke.Map;y.forEach(function(e,n){t.set(n,R(e))}),s(t,e)}function l(){s(E,function(e){if(e&&h(e),_.auto_compaction)return c(h);h()})}function u(e,t,n,r,i,a,s,c){function l(e){_++,b||(e?c(b=e):_===k.length&&m())}function u(e,t,n,r){return function(o){d(e,ft+o,t,n,r)}}function h(e,t,n){return function(r){ne(r,u(e,t,r,n))}}function m(){var n=e.metadata.rev_map[e.metadata.rev];if(n)return c();n=++T,e.metadata.rev_map[e.metadata.rev]=e.metadata.seq=n;var r=[{key:f(n),value:e.data,prefix:w.bySeqStore,type:"put"},{key:e.metadata.id,value:e.metadata,prefix:w.docStore,type:"put"}];S.batch(r),v[s]={ok:!0,id:e.metadata.id,rev:t},y.set(e.metadata.id,e.metadata),c()}N+=a;var b=null,_=0;e.metadata.winningRev=t,e.metadata.deleted=n,e.data._id=e.metadata.id,e.data._rev=e.metadata.rev,r&&(e.data._deleted=!0),e.stemmedRevs.length&&E.set(e.metadata.id,e.stemmedRevs);for(var k=e.data._attachments?Object.keys(e.data._attachments):[],x=0;x<k.length;x++){var C=k[x],O=e.data._attachments[C];if(O.stub)p(e.data._id,e.data._rev,O.digest,l);else{var D;if("string"==typeof O.data){try{D=Ze(O.data)}catch(e){return void o(g(We,"Attachment is not a valid base64 string"))}h(e,C,l)(D)}else ce(O.data,h(e,C,l))}}k.length||m()}function p(e,t,n,r){function o(){return new Ie(function(e,t){S.get(w.attachmentStore,n,function(n,r){if(n&&"NotFoundError"!==n.name)return t(n);e(r)})})}function i(r){var o=[e,t].join("@"),i={};return r?r.refs&&(i.refs=r.refs,i.refs[o]=!0):(i.refs={},i.refs[o]=!0),new Ie(function(e){S.batch([{type:"put",prefix:w.attachmentStore,key:n,value:i}]),e(!r)})}var a=P[n]||Ie.resolve();P[n]=a.then(function(){return o().then(i).then(function(e){r(null,e)},r)})}function d(e,t,n,o,i){var a=e.data._attachments[n];delete a.data,a.digest=t,a.length=o.length;var s=e.metadata.id,c=e.metadata.rev;a.revpos=parseInt(c,10),p(s,c,t,function(e,n){return e?i(e):0===o.length?i(e):n?(S.batch([{type:"put",prefix:w.binaryStore,key:t,value:new r(o,"binary")}]),void i()):i(e)})}function h(e){if(e)return t.nextTick(function(){o(e)});S.batch([{prefix:w.metaStore,type:"put",key:ut,value:T},{prefix:w.metaStore,type:"put",key:pt,value:b._docCount+N}]),S.execute(b,function(e){if(e)return o(e);b._docCount+=N,b._updateSeq=T,mt.notify(x),t.nextTick(function(){o(null,v)})})}var m=n.new_edits,v=new Array(e.docs.length),y=new ke.Map,E=new ke.Map,S=new pe,N=0,T=b._updateSeq,O=e.docs,D=O.map(function(e){if(e._id&&z(e._id))return e;var t=C(e,m);return t.metadata&&!t.metadata.rev_map&&(t.metadata.rev_map={}),t}),A=D.filter(function(e){return e.error});if(A.length)return o(A[0]);var P={};if(!D.length)return o(null,[]);!function(e){var t=[];if(O.forEach(function(e){e&&e._attachments&&Object.keys(e._attachments).forEach(function(n){var r=e._attachments[n];r.stub&&t.push(r.digest)})}),!t.length)return e();var n,r=0;t.forEach(function(o){i(o,function(o){o&&!n&&(n=o),++r===t.length&&e(n)})})}(function(e){if(e)return o(e);a(function(e){if(e)return o(e);ie(k,D,_,y,S,v,u,n,l)})})}),_._allDocs=d(function(e,t){e=l(e),i(function(n,r){if(n)return t(n);var o={},i=e.skip||0;if(e.startkey&&(o.gte=e.startkey),e.endkey&&(o.lte=e.endkey),e.key&&(o.gte=o.lte=e.key),e.descending){o.reverse=!0;var a=o.lte;o.lte=o.gte,o.gte=a}var s;if("number"==typeof e.limit&&(s=e.limit),0===s||"start"in o&&"end"in o&&o.start>o.end)return t(null,{total_rows:r,offset:e.skip,rows:[]});var c=[],l=w.docStore.readStream(o),u=Ee.obj(function(t,n,r){function o(t){var n={id:a.id,key:a.id,value:{rev:u}};if(e.include_docs){n.doc=t,n.doc._rev=n.value.rev,e.conflicts&&(n.doc._conflicts=D(a));for(var o in n.doc._attachments)n.doc._attachments.hasOwnProperty(o)&&(n.doc._attachments[o].stub=!0)}if(!1===e.inclusive_end&&a.id===e.endkey)return r();if(p){if("ok"!==e.deleted)return r();n.value.deleted=!0,n.doc=null}c.push(n),r()}var a=t.value,u=de(a),p=fe(a,u);if(p){if("ok"!==e.deleted)return void r()}else{if(i-- >0)return void r();if("number"==typeof s&&s--<=0)return l.unpipe(),l.destroy(),void r()}if(e.include_docs){var d=a.rev_map[u];w.bySeqStore.get(f(d),function(e,t){o(t)})}else o()},function(n){Ie.resolve().then(function(){if(e.include_docs&&e.attachments)return me(c,w,e)}).then(function(){t(null,{total_rows:r,offset:e.skip,rows:c})},t),n()}).on("unpipe",function(){u.end()});l.on("error",t),l.pipe(u)})}),_._changes=function(e){function t(){e.done=!0,u&&e.limit&&e.limit<i.length&&(i.length=e.limit),g.unpipe(v),g.destroy(),e.continuous||e.cancelled||(e.include_docs&&e.attachments?me(i,w,e).then(function(){e.complete(null,{results:i,last_seq:a})}):e.complete(null,{results:i,last_seq:a}))}if((e=l(e)).continuous){var n=x+":"+E();return mt.addListener(x,n,_,e),mt.notify(x),{cancel:function(){mt.removeListener(x,n)}}}var r,o=e.descending,i=[],a=e.since||0,s=0,c={reverse:o};"limit"in e&&e.limit>0&&(r=e.limit),c.reverse||(c.start=f(e.since||0));var u,p=e.doc_ids&&new ke.Set(e.doc_ids),d=y(e),m=new ke.Map;u="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var g=w.bySeqStore.readStream(c),v=Ee.obj(function(n,c,l){function g(t){function n(n){var r=e.processChange(n,t,e);r.seq=t.seq;var o=d(r);if("object"==typeof o)return e.complete(o);o&&(s++,e.attachments&&e.include_docs?me([r],w,e).then(function(){e.onChange(r)}):e.onChange(r),u&&i.push(r)),l()}var r=de(t);if(t.seq!==v)return l();if(a=v,r===y._rev)return n(y);var o=t.rev_map[r];w.bySeqStore.get(f(o),function(e,t){n(t)})}if(r&&s>=r)return t(),l();if(e.cancelled||e.done)return l();var v=h(n.key),y=n.value;if(v===e.since&&!o)return l();if(p&&!p.has(y._id))return l();var _;if(_=m.get(y._id))return g(_);w.docStore.get(y._id,function(t,n){if(e.cancelled||e.done||b.isClosed()||z(n.id))return l();m.set(y._id,n),g(n)})},function(t){if(e.cancelled)return t();u&&e.limit&&e.limit<i.length&&(i.length=e.limit),t()}).on("unpipe",function(){v.end(),t()});return g.pipe(v),{cancel:function(){e.cancelled=!0,t()}}},_._close=function(e){if(b.isClosed())return e(g(He));b.close(function(t){t?e(t):(S.delete(x),e())})},_._getRevisionTree=function(e,t){w.docStore.get(e,function(e,n){e?t(g(Fe)):t(null,n.rev_tree)})},_._doCompaction=p(function(e,t,n,r){_._doCompactionNoLock(e,t,n,r)}),_._doCompactionNoLock=function(e,t,n,r){if("function"==typeof n&&(r=n,n={}),!t.length)return r();var o=n.ctx||new pe;o.get(w.docStore,e,function(i,a){function s(e){if(e&&(d=e),++m===t.length){if(d)return r(d);l()}}function c(e){return e?r(e):(o.batch(p),n.ctx?r():void o.execute(b,r))}function l(){function n(e){e&&(i=e),++a===r.length&&c(i)}var r=Object.keys(h);if(!r.length)return c();var i,a=0,s=new ke.Map;t.forEach(function(t){s.set(e+"@"+t,!0)}),r.forEach(function(e){o.get(w.attachmentStore,e,function(t,r){if(t)return"NotFoundError"===t.name?n():n(t);var o=Object.keys(r.refs||{}).filter(function(e){return!s.has(e)}),i={};o.forEach(function(e){i[e]=!0}),o.length?p.push({key:e,type:"put",value:{refs:i},prefix:w.attachmentStore}):p=p.concat([{key:e,type:"del",prefix:w.attachmentStore},{key:e,type:"del",prefix:w.binaryStore}]),n()})})}if(i)return r(i);var u=t.map(function(e){var t=a.rev_map[e];return delete a.rev_map[e],t});N(a.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")});var p=[];p.push({key:a.id,value:a,type:"put",prefix:w.docStore});var d,h={},m=0;u.forEach(function(e){p.push({key:f(e),type:"del",prefix:w.bySeqStore}),o.get(w.bySeqStore,f(e),function(e,t){if(e)return"NotFoundError"===e.name?s():s(e);Object.keys(t._attachments||{}).forEach(function(e){var n=t._attachments[e].digest;h[n]=!0}),s()})})})},_._getLocal=function(e,t){w.localStore.get(e,function(e,n){e?t(g(Fe)):t(null,n)})},_._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),t.ctx?_._putLocalNoLock(e,t,n):_._putLocalWithLock(e,t,n)},_._putLocalWithLock=p(function(e,t,n){_._putLocalNoLock(e,t,n)}),_._putLocalNoLock=function(e,t,n){delete e._revisions;var r=e._rev,o=e._id,i=t.ctx||new pe;i.get(w.localStore,o,function(a,s){if(a&&r)return n(g(Ue));if(s&&s._rev!==r)return n(g(Ue));e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var c=[{type:"put",prefix:w.localStore,key:o,value:e}];i.batch(c);var l={ok:!0,id:e._id,rev:e._rev};if(t.ctx)return n(null,l);i.execute(b,function(e){if(e)return n(e);n(null,l)})})},_._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),t.ctx?_._removeLocalNoLock(e,t,n):_._removeLocalWithLock(e,t,n)},_._removeLocalWithLock=p(function(e,t,n){_._removeLocalNoLock(e,t,n)}),_._removeLocalNoLock=function(e,t,n){var r=t.ctx||new pe;r.get(w.localStore,e._id,function(o,i){if(o)return n("NotFoundError"!==o.name?o:g(Fe));if(i._rev!==e._rev)return n(g(Ue));r.batch([{prefix:w.localStore,type:"del",key:e._id}]);var a={ok:!0,id:e._id,rev:"0-0"};if(t.ctx)return n(null,a);r.execute(b,function(e){if(e)return n(e);n(null,a)})})},_._destroy=function(e,t){var n,r=$e(T);if(!lt.has(r))return m(x,t);(n=lt.get(r)).has(x)?(mt.removeAllListeners(x),n.get(x).close(function(){n.delete(x),m(x,t)})):m(x,t)}}function ve(e,t){var n=Re.extend({db:Ae},e);ge.call(this,n,t)}var ye,be=o(e("levelup")),_e=o(e("sublevel-pouchdb")),Ee=e("through2"),we=o(e("argsarray")),ke=e("pouchdb-collections"),xe=o(e("double-ended-queue")),Ce=o(e("lie")),Se=o(e("debug")),Ne=e("events"),Te=o(e("inherits")),Oe=o(e("spark-md5")),De=o(e("vuvuzela")),Re=e("js-extend"),Ae=o(e("memdown")),Pe={toSublevel:function(e,n,r){t.nextTick(function(){r()})},localAndMetaStores:function(e,n,r){t.nextTick(function(){r()})}},Ie="function"==typeof Promise?Promise:Ce,je=Function.prototype.toString,Me=je.call(Object);Se("pouchdb:api");if(p())ye=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),ye=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){ye=!1}Te(h,Ne.EventEmitter),h.prototype.addListener=function(e,t,n,r){function o(){if(i._listeners[t])if(a)a="waiting";else{a=!0;var e=u(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(e).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===a&&setTimeout(function(){o()},0),a=!1}).on("error",function(){a=!1})}}if(!this._listeners[t]){var i=this,a=!1;this._listeners[t]=o,this.on(e,o)}},h.prototype.removeListener=function(e,t){t in this._listeners&&Ne.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},h.prototype.notifyLocalWindows=function(e){p()?chrome.storage.local.set({dbName:e}):d()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},h.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},Te(m,Error),m.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};new m({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),new m({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"});var Le,Fe=new m({status:404,error:"not_found",reason:"missing"}),Ue=new m({status:409,error:"conflict",reason:"Document update conflict"}),Be=new m({status:400,error:"bad_request",reason:"_id field must contain a string"}),Ve=new m({status:412,error:"missing_id",reason:"_id is required for puts"}),qe=new m({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),He=new m({status:412,error:"precondition_failed",reason:"Database not open"}),We=(new m({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),new m({status:500,error:"badarg",reason:"Some query argument is invalid"})),ze=(new m({status:400,error:"invalid_request",reason:"Request was invalid"}),new m({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),new m({status:500,error:"doc_validation",reason:"Bad special document member"})),Ke=new m({status:400,error:"bad_request",reason:"Something wrong with the request"}),Ye=(new m({status:400,error:"bad_request",reason:"Document must be a JSON object"}),new m({status:404,error:"not_found",reason:"Database not found"}),new m({status:500,error:"indexed_db_went_bad",reason:"unknown"}),new m({status:500,error:"web_sql_went_bad",reason:"unknown"}),new m({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),new m({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),new m({status:400,error:"bad_request",reason:"Invalid rev format"})),Ge=(new m({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),new m({status:412,error:"missing_stub"})),$e=(new m({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),Le=function(){}.name?function(e){return e.name}:function(e){return e.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}),Je="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),Xe=w(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Qe=w(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),Ze=function(e){return atob(e)},et=function(e){return btoa(e)},tt=n.setImmediate||n.setTimeout,nt=32768;pe.prototype.get=function(e,n,r){var o=ue(this,e),i=o.get(n);return i?t.nextTick(function(){r(null,i)}):null===i?t.nextTick(function(){r({name:"NotFoundError"})}):void e.get(n,function(e,t){if(e)return"NotFoundError"===e.name&&o.set(n,null),r(e);o.set(n,t),r(null,t)})},pe.prototype.batch=function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],o=ue(this,r.prefix);"put"===r.type?o.set(r.key,r.value):o.set(r.key,null)}this._batch=this._batch.concat(e)},pe.prototype.execute=function(e,t){for(var n=new ke.Set,r=[],o=this._batch.length-1;o>=0;o--){var i=this._batch[o],a=i.prefix.prefix()[0]+"ÿ"+i.key;n.has(a)||(n.add(a),r.push(i))}e.batch(r,t)};var rt="document-store",ot="by-sequence",it="attach-store",at="attach-binary-store",st="local-store",ct="meta-store",lt=new ke.Map,ut="_local_last_update_seq",pt="_local_doc_count",dt="_local_uuid",ft="md5-",ht={encode:function(e){try{return JSON.stringify(e)}catch(t){return De.stringify(e)}},decode:function(e){return e.length<5e4?JSON.parse(e):ae(e)},buffer:!1,type:"cheap-json"},mt=new h;ve.valid=function(){return!0},ve.use_prefix=!1;var gt="undefined"!=typeof PouchDB?PouchDB:e("pouchdb");gt?function(e){e.adapter("memory",ve,!0)}(gt):function(e){if("undefined"!==console&&e in console){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}("error",'memory adapter plugin error: Cannot find global "PouchDB" object! Did you remember to include pouchdb.js?')}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},e("buffer").Buffer)},{_process:146,argsarray:49,buffer:56,debug:134,"double-ended-queue":65,events:69,inherits:136,"js-extend":103,levelup:116,lie:137,memdown:122,pouchdb:133,"pouchdb-collections":130,"spark-md5":294,"sublevel-pouchdb":299,through2:144,vuvuzela:312}],133:[function(e,t,n){(function(n,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e.default:e}function i(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function a(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}function s(e){if(e instanceof ArrayBuffer)return a(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}function c(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&Sr.call(n)==Nr}function l(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=l(e[n]);return t}if(e instanceof Date)return e.toISOString();if(i(e))return s(e);if(!c(e))return e;t={};for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=l(e[n]);void 0!==o&&(t[n]=o)}return t}function u(e){var t=!1;return yr(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function p(e){return yr(function(t){var r,o=this,i="function"==typeof(t=l(t))[t.length-1]&&t.pop();i&&(r=function(e,t){n.nextTick(function(){i(e,t)})});var a=new Cr(function(n,r){var i;try{var a=u(function(e,t){e?r(e):n(t)});t.push(a),(i=e.apply(o,t))&&"function"==typeof i.then&&n(i)}catch(e){r(e)}});return r&&a.then(function(e){r(null,e)},r),a})}function d(e,t){function n(e,t,n){if(Tr.enabled){for(var r=[e._db_name,t],o=0;o<n.length-1;o++)r.push(n[o]);Tr.apply(null,r);var i=n[n.length-1];n[n.length-1]=function(n,r){var o=[e._db_name,t];o=o.concat(n?["error",n]:["success",r]),Tr.apply(null,o),i(n,r)}}}return p(yr(function(r){if(this._closed)return Cr.reject(new Error("database is closed"));if(this._destroyed)return Cr.reject(new Error("database is destroyed"));var o=this;return n(o,e,r),this.taskqueue.isReady?t.apply(this,r):new Cr(function(t,n){o.taskqueue.addTask(function(i){i?n(i):t(o[e].apply(o,r))})})}))}function f(e,t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];i in e&&(n[i]=e[i])}return n}function h(e){return e}function m(e){return[{ok:e}]}function g(e,t,n){function r(){var e=[];p.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e})}function o(){++u===l&&r()}function i(e,t,n){p[e]={id:t,docs:n},o()}function a(){if(!(g>=d.length)){var e=Math.min(g+Or,d.length),t=d.slice(g,e);s(t,g),g+=t.length}}function s(n,r){n.forEach(function(n,o){var s=r+o,l=c[n],u=f(l[0],["atts_since","attachments"]);u.open_revs=l.map(function(e){return e.rev}),u.open_revs=u.open_revs.filter(h);var p=h;0===u.open_revs.length&&(delete u.open_revs,p=m),["revs","attachments","binary","ajax"].forEach(function(e){e in t&&(u[e]=t[e])}),e.get(n,u,function(e,t){var r;r=e?[{error:e}]:p(t),i(s,n,r),a()})})}var c={};t.docs.forEach(function(e){e.id in c?c[e.id].push(e):c[e.id]=[e]});var l=Object.keys(c).length,u=0,p=new Array(l),d=Object.keys(c),g=0;a()}function v(){return"undefined"!=typeof chrome&&void 0!==chrome.storage&&void 0!==chrome.storage.local}function y(){return dr}function b(e){v()?chrome.storage.onChanged.addListener(function(t){null!=t.db_name&&e.emit(t.dbName.newValue)}):y()&&("undefined"!=typeof addEventListener?addEventListener("storage",function(t){e.emit(t.key)}):window.attachEvent("storage",function(t){e.emit(t.key)}))}function _(){br.EventEmitter.call(this),this._listeners={},b(this)}function E(e){if("undefined"!==console&&e in console){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function w(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!==t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}function k(e){var t=0;return e||(t=2e3),w(e,t)}function x(e,t){E("info","The above "+e+" is totally normal. "+t)}function C(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}function S(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=C.prototype,new n(t)}function N(e){if("object"!=typeof e){var t=e;(e=Lr).data=t}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function T(e,t,n){try{return!e(t,n)}catch(e){var r="Filter function threw: "+e.toString();return S(Vr,r)}}function O(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var o=n&&T(e.filter,r.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function D(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function R(e){var t;if(e?"string"!=typeof e?t=S(Pr):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=S(jr)):t=S(Ir),t)throw t}function A(e,t){return"listenerCount"in e?e.listenerCount(t):br.EventEmitter.listenerCount(e,t)}function P(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function I(e){var t=P(e);return t?t.join("/"):null}function j(e){for(var t=Jr.exec(e),n={},r=14;r--;){var o=Yr[r],i=t[r]||"",a=-1!==["user","password"].indexOf(o);n[o]=a?decodeURIComponent(i):i}return n[Gr]={},n[Yr[12]].replace($r,function(e,t,r){t&&(n[Gr][t]=r)}),n}function M(e,t,n){return new Cr(function(r,o){e.get(t,function(i,a){if(i){if(404!==i.status)return o(i);a={}}var s=a._rev,c=n(a);if(!c)return r({updated:!1,rev:s});c._id=t,c._rev=s,r(L(e,c,n))})})}function L(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return M(e,t._id,n)})}function F(e){return 0|Math.random()*e}function U(e,t){t=t||Xr.length;var n="",r=-1;if(e){for(;++r<e;)n+=Xr[F(t)];return n}for(;++r<36;)switch(r){case 8:case 13:case 18:case 23:n+="-";break;case 19:n+=Xr[3&F(16)|8];break;default:n+=Xr[F(16)]}return n}function B(e){for(var t,n,r,o,i=e.rev_tree.slice();o=i.pop();){var a=o.ids,s=a[2],c=o.pos;if(s.length)for(var l=0,u=s.length;l<u;l++)i.push({pos:c+1,ids:s[l]});else{var p=!!a[1].deleted,d=a[0];t&&!(r!==p?r:n!==c?n<c:t<d)||(t=d,n=c,r=p)}}return n+"-"+t}function V(e,t){for(var n,r=e.slice();n=r.pop();)for(var o=n.pos,i=n.ids,a=i[2],s=t(0===a.length,o,i[0],n.ctx,i[1]),c=0,l=a.length;c<l;c++)r.push({pos:o+1,ids:a[c],ctx:s})}function q(e,t){return e.pos-t.pos}function H(e){var t=[];V(e,function(e,n,r,o,i){e&&t.push({rev:n+"-"+r,pos:n,opts:i})}),t.sort(q).reverse();for(var n=0,r=t.length;n<r;n++)delete t[n].pos;return t}function W(e){for(var t=B(e),n=H(e.rev_tree),r=[],o=0,i=n.length;o<i;o++){var a=n[o];a.rev===t||a.opts.deleted||r.push(a.rev)}return r}function z(e){var t=[];return V(e.rev_tree,function(e,n,r,o,i){"available"!==i.status||e||(t.push(n+"-"+r),i.status="missing")}),t}function K(e){for(var t,n=[],r=e.slice();t=r.pop();){var o=t.pos,i=t.ids,a=i[0],s=i[1],c=i[2],l=0===c.length,u=t.history?t.history.slice():[];u.push({id:a,opts:s}),l&&n.push({pos:o+1-u.length,ids:u});for(var p=0,d=c.length;p<d;p++)r.push({pos:o+1,ids:c[p],history:u})}return n.reverse()}function Y(e,t){return e.pos-t.pos}function G(e,t,n){for(var r,o=0,i=e.length;o<i;)n(e[r=o+i>>>1],t)<0?o=r+1:i=r;return o}function $(e,t,n){var r=G(e,t,n);e.splice(r,0,t)}function J(e,t){for(var n,r,o=t,i=e.length;o<i;o++){var a=e[o],s=[a.id,a.opts,[]];r?(r[2].push(s),r=s):n=r=s}return n}function X(e,t){return e[0]<t[0]?-1:1}function Q(e,t){for(var n=[{tree1:e,tree2:t}],r=!1;n.length>0;){var o=n.pop(),i=o.tree1,a=o.tree2;(i[1].status||a[1].status)&&(i[1].status="available"===i[1].status||"available"===a[1].status?"available":"missing");for(var s=0;s<a[2].length;s++)if(i[2][0]){for(var c=!1,l=0;l<i[2].length;l++)i[2][l][0]===a[2][s][0]&&(n.push({tree1:i[2][l],tree2:a[2][s]}),c=!0);c||(r="new_branch",$(i[2],a[2][s],X))}else r="new_leaf",i[2][0]=a[2][s]}return{conflicts:r,tree:e}}function Z(e,t,n){var r,o=[],i=!1,a=!1;if(!e.length)return{tree:[t],conflicts:"new_leaf"};for(var s=0,c=e.length;s<c;s++){var l=e[s];if(l.pos===t.pos&&l.ids[0]===t.ids[0])r=Q(l.ids,t.ids),o.push({pos:l.pos,ids:r.tree}),i=i||r.conflicts,a=!0;else if(!0!==n){var u=l.pos<t.pos?l:t,p=l.pos<t.pos?t:l,d=p.pos-u.pos,f=[],h=[];for(h.push({ids:u.ids,diff:d,parent:null,parentIdx:null});h.length>0;){var m=h.pop();if(0!==m.diff)for(var g=m.ids[2],v=0,y=g.length;v<y;v++)h.push({ids:g[v],diff:m.diff-1,parent:m.ids,parentIdx:v});else m.ids[0]===p.ids[0]&&f.push(m)}var b=f[0];b?(r=Q(b.ids,p.ids),b.parent[2][b.parentIdx]=r.tree,o.push({pos:u.pos,ids:u.ids}),i=i||r.conflicts,a=!0):o.push(l)}else o.push(l)}return a||o.push(t),o.sort(Y),{tree:o,conflicts:i||"internal_node"}}function ee(e,t){for(var n,r=K(e),o={},i=0,a=r.length;i<a;i++){for(var s=r[i],c=s.ids,l=Math.max(0,c.length-t),u={pos:s.pos+l,ids:J(c,l)},p=0;p<l;p++){var d=s.pos+p+"-"+c[p].id;o[d]=!0}n=n?Z(n,u,!0).tree:[u]}return V(n,function(e,t,n){delete o[t+"-"+n]}),{tree:n,revs:Object.keys(o)}}function te(e,t,n){var r=Z(e,t),o=ee(r.tree,n);return{tree:o.tree,stemmedRevs:o.revs,conflicts:r.conflicts}}function ne(e,t){for(var n,r=e.slice(),o=t.split("-"),i=parseInt(o[0],10),a=o[1];n=r.pop();){if(n.pos===i&&n.ids[0]===a)return!0;for(var s=n.ids[2],c=0,l=s.length;c<l;c++)r.push({pos:n.pos+1,ids:s[c]})}return!1}function re(e){return e.ids}function oe(e,t){t||(t=B(e));for(var n,r=t.substring(t.indexOf("-")+1),o=e.rev_tree.map(re);n=o.pop();){if(n[0]===r)return!!n[1].deleted;o=o.concat(n[2])}}function ie(e){return/^_local/.test(e)}function ae(e){return _r("return "+e+";",{})}function se(e){return new Function("doc",["var emitted = false;","var emit = function (a, b) {","  emitted = true;","};","var view = "+e+";","view(doc);","if (emitted) {","  return true;","}"].join("\n"))}function ce(e,t){try{e.emit("change",t)}catch(e){E("error",'Error in .on("change", function):',e)}}function le(e,t,n){function r(){o.cancel()}br.EventEmitter.call(this);var o=this;this.db=e;var i=(t=t?l(t):{}).complete=u(function(t,n){t?A(o,"error")>0&&o.emit("error",t):o.emit("complete",n),o.removeAllListeners(),e.removeListener("destroyed",r)});n&&(o.on("complete",function(e){n(null,e)}),o.on("error",n)),e.once("destroyed",r),t.onChange=function(e){t.isCancelled||(ce(o,e),o.startSeq&&o.startSeq<=e.seq&&(o.startSeq=!1))};var a=new Cr(function(e,n){t.complete=function(t,r){t?n(t):e(r)}});o.once("cancel",function(){e.removeListener("destroyed",r),t.complete(null,{status:"cancelled"})}),this.then=a.then.bind(a),this.catch=a.catch.bind(a),this.then(function(e){i(null,e)},i),e.taskqueue.isReady?o.doChanges(t):e.taskqueue.addTask(function(){o.isCancelled?o.emit("cancel"):o.doChanges(t)})}function ue(e,t,n){var r=[{rev:e._rev}];"all_docs"===n.style&&(r=H(t.rev_tree).map(function(e){return{rev:e.rev}}));var o={id:t.id,changes:r,doc:e};return oe(t,e._rev)&&(o.deleted=!0),n.conflicts&&(o.doc._conflicts=W(t),o.doc._conflicts.length||delete o.doc._conflicts),o}function pe(e,t){return e<t?-1:e>t?1:0}function de(e,t){for(var n=0;n<e.length;n++)if(!0===t(e[n],n))return e[n]}function fe(e){return function(t,n){t||n[0]&&n[0].error?e(t||n[0]):e(null,n.length?n[0]:n)}}function he(e){for(var t=0;t<e.length;t++){var n=e[t];if(n._deleted)delete n._attachments;else if(n._attachments)for(var r=Object.keys(n._attachments),o=0;o<r.length;o++){var i=r[o];n._attachments[i]=f(n._attachments[i],["data","digest","content_type","length","revpos","stub"])}}}function me(e,t){var n=pe(e._id,t._id);return 0!==n?n:pe(e._revisions?e._revisions.start:0,t._revisions?t._revisions.start:0)}function ge(e){var t={},n=[];return V(e,function(e,r,o,i){var a=r+"-"+o;return e&&(t[a]=0),void 0!==i&&n.push({from:i,to:a}),a}),n.reverse(),n.forEach(function(e){void 0===t[e.from]?t[e.from]=1+t[e.to]:t[e.from]=Math.min(t[e.from],1+t[e.to])}),t}function ve(e,t,n){var r="limit"in t?t.keys.slice(t.skip,t.limit+t.skip):t.skip>0?t.keys.slice(t.skip):t.keys;if(t.descending&&r.reverse(),!r.length)return e._allDocs({limit:0},n);var o={offset:t.skip};return Cr.all(r.map(function(n){var r=fr.extend({key:n,deleted:"ok"},t);return["limit","skip","keys"].forEach(function(e){delete r[e]}),new Cr(function(t,i){e._allDocs(r,function(e,r){if(e)return i(e);o.total_rows=r.total_rows,t(r.rows[0]||{key:n,error:"not_found"})})})})).then(function(e){return o.rows=e,o})}function ye(e){var t=e._compactionQueue[0],r=t.opts,o=t.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(t){t&&t.last_seq&&(r.last_seq=t.last_seq),e._compact(r,function(t,r){t?o(t):o(null,r),n.nextTick(function(){e._compactionQueue.shift(),e._compactionQueue.length&&ye(e)})})})}function be(e){return"_"===e.charAt(0)&&e+"is not a valid attachment name, attachment names cannot start with '_'"}function _e(){br.EventEmitter.call(this)}function Ee(){this.isReady=!1,this.failed=!1,this.queue=[]}function we(e){e&&r.debug&&E("error",e)}function ke(e,t){function n(){o.emit("destroyed",r)}var r=t.originalName,o=e.constructor,i=o._destructionListeners;e.once("destroyed",n),i.has(r)||i.set(r,[]),i.get(r).push(function(){e.removeListener("destroyed",n),e.emit("destroyed",e)})}function xe(e,t,n){if(!(this instanceof xe))return new xe(e,t,n);var r=this;if("function"!=typeof t&&void 0!==t||(n=t,t={}),e&&"object"==typeof e&&(t=e,e=void 0),void 0===n)n=we;else{var o=n;n=function(){return E("warn","Using a callback for new PouchDB()is deprecated."),o.apply(null,arguments)}}e=e||t.name,delete(t=l(t)).name,this.__opts=t;var i=n;r.auto_compaction=t.auto_compaction,r.prefix=xe.prefix,_e.call(r),r.taskqueue=new Ee;var a=new Cr(function(o,i){n=function(e,t){if(e)return i(e);delete t.then,o(t)},t=l(t);var a,s;if(function(){try{if("string"!=typeof e)throw s=new Error("Missing/invalid DB name"),s.code=400,s;var n=(t.prefix||"")+e;if(a=xe.parseAdapter(n,t),t.originalName=e,t.name=a.name,t.adapter=t.adapter||a.adapter,r._adapter=t.adapter,hr("pouchdb:adapter")("Picked adapter: "+t.adapter),r._db_name=e,!xe.adapters[t.adapter])throw s=new Error("Adapter is missing"),s.code=404,s;if(!xe.adapters[t.adapter].valid())throw s=new Error("Invalid Adapter"),s.code=404,s}catch(e){r.taskqueue.fail(e)}}(),s)return i(s);r.adapter=t.adapter,r.replicate={},r.replicate.from=function(e,t,n){return r.constructor.replicate(e,r,t,n)},r.replicate.to=function(e,t,n){return r.constructor.replicate(r,e,t,n)},r.sync=function(e,t,n){return r.constructor.sync(r,e,t,n)},r.replicate.sync=r.sync,xe.adapters[t.adapter].call(r,t,function(e){if(e)return r.taskqueue.fail(e),void n(e);ke(r,t),r.emit("created",r),xe.emit("created",t.originalName),r.taskqueue.ready(r),n(null,r)})});a.then(function(e){i(null,e)},i),r.then=a.then.bind(a),r.catch=a.catch.bind(a)}function Ce(e){return e.reduce(function(e,t){return e[t]=!0,e},{})}function Se(e){if(!/^\d+\-./.test(e))return S(zr);var t=e.indexOf("-"),n=e.substring(0,t),r=e.substring(t+1);return{prefix:parseInt(n,10),id:r}}function Ne(e,t){for(var n=e.start-e.ids.length+1,r=e.ids,o=[r[0],t,[]],i=1,a=r.length;i<a;i++)o=[r[i],{status:"missing"},[o]];return[{pos:n,ids:o}]}function Te(e,t){var n,r,o,i={status:"available"};if(e._deleted&&(i.deleted=!0),t)if(e._id||(e._id=U()),r=U(32,16).toLowerCase(),e._rev){if((o=Se(e._rev)).error)return o;e._rev_tree=[{pos:o.prefix,ids:[o.id,{status:"missing"},[[r,i,[]]]]}],n=o.prefix+1}else e._rev_tree=[{pos:1,ids:[r,i,[]]}],n=1;else if(e._revisions&&(e._rev_tree=Ne(e._revisions,i),n=e._revisions.start,r=e._revisions.ids[0]),!e._rev_tree){if((o=Se(e._rev)).error)return o;n=o.prefix,r=o.id,e._rev_tree=[{pos:n,ids:[r,i,[]]}]}R(e._id),e._rev=n+"-"+r;var a={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var c="_"===s[0];if(c&&!eo[s]){var l=S(Br,s);throw l.message=Br.message+": "+s,l}c&&!to[s]?a.metadata[s.slice(1)]=e[s]:a.data[s]=e[s]}return a}function Oe(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function De(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function Re(e,t){return Oe([De(e)],{type:t})}function Ae(e,t){return Re(no(e),t)}function Pe(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,o=0;o<r;o++)t+=String.fromCharCode(n[o]);return t}function Ie(e,t){if("undefined"==typeof FileReader)return t(Pe((new FileReaderSync).readAsArrayBuffer(e)));var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t(Pe(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function je(e,t){Ie(e,function(e){t(e)})}function Me(e,t){je(e,function(e){t(ro(e))})}function Le(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}function Fe(e){return ro(e)}function Ue(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.slice(t,n)}function Be(e,t,n,r,o){(n>0||r<t.size)&&(t=Ue(t,n,r)),Le(t,function(t){e.append(t),o()})}function Ve(e,t,n,r,o){(n>0||r<t.length)&&(t=t.substring(n,r)),e.appendBinary(t),o()}function qe(e,t){function n(){oo(o)}function r(){var e=Fe(u.end(!0));t(e),u.destroy()}function o(){var t=l*s,o=t+s;++l<c?p(u,e,t,o,n):p(u,e,t,o,r)}var i="string"==typeof e,a=i?e.length:e.size,s=Math.min(io,a),c=Math.ceil(a/s),l=0,u=i?new Er:new Er.ArrayBuffer,p=i?Ve:Be;o()}function He(e){return Er.hash(e)}function We(e){try{return no(e)}catch(e){return{error:S(Fr,"Attachment is not a valid base64 string")}}}function ze(e,t,n){var r=We(e.data);if(r.error)return n(r.error);e.length=r.length,e.data="blob"===t?Re(r,e.content_type):"base64"===t?ro(r):r,qe(r,function(t){e.digest="md5-"+t,n()})}function Ke(e,t,n){qe(e.data,function(r){e.digest="md5-"+r,e.length=e.data.size||e.data.length||0,"binary"===t?je(e.data,function(t){e.data=t,n()}):"base64"===t?Me(e.data,function(t){e.data=t,n()}):n()})}function Ye(e,t,n){if(e.stub)return n();"string"==typeof e.data?ze(e,t,n):Ke(e,t,n)}function Ge(e,t,n){function r(){i++,e.length===i&&(o?n(o):n())}if(!e.length)return n();var o,i=0;e.forEach(function(e){var n=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],i=0;if(!n.length)return r();for(var a in e.data._attachments)e.data._attachments.hasOwnProperty(a)&&Ye(e.data._attachments[a],t,function(e){o=e,++i===n.length&&r()})})}function $e(e,t,n,r,o,i,a,s){if(ne(t.rev_tree,n.metadata.rev))return r[o]=n,i();var c=t.winningRev||B(t),l="deleted"in t?t.deleted:oe(t,c),u="deleted"in n.metadata?n.metadata.deleted:oe(n.metadata),p=/^1-/.test(n.metadata.rev);if(l&&!u&&s&&p){var d=n.data;d._rev=c,d._id=n.metadata.id,n=Te(d,s)}var f=te(t.rev_tree,n.metadata.rev_tree[0],e);if(s&&(l&&u||!l&&"new_leaf"!==f.conflicts||l&&!u&&"new_branch"===f.conflicts)){var h=S(Ar);return r[o]=h,i()}var m=n.metadata.rev;n.metadata.rev_tree=f.tree,n.stemmedRevs=f.stemmedRevs||[],t.rev_map&&(n.metadata.rev_map=t.rev_map);var g=B(n.metadata),v=oe(n.metadata,g),y=l===v?0:l<v?-1:1;a(n,g,v,m===g?v:oe(n.metadata,m),!0,y,o,i)}function Je(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function Xe(e,t,n,r,o,i,a,s,c){function l(e,t,n){var r=B(e.metadata),o=oe(e.metadata,r);if("was_delete"in s&&o)return i[t]=S(Rr,"deleted"),n();if(p&&Je(e)){var c=S(Ar);return i[t]=c,n()}a(e,r,o,o,!1,o?0:1,t,n)}function u(){++f===h&&c&&c()}e=e||1e3;var p=s.new_edits,d=new vr.Map,f=0,h=t.length;t.forEach(function(e,t){if(e._id&&ie(e._id)){var r=e._deleted?"_removeLocal":"_putLocal";n[r](e,{ctx:o},function(e,n){i[t]=e||n,u()})}else{var a=e.metadata.id;d.has(a)?(h--,d.get(a).push([e,t])):d.set(a,[[e,t]])}}),d.forEach(function(t,n){function o(){++c<t.length?s():u()}function s(){var s=t[c],u=s[0],d=s[1];if(r.has(n))$e(e,r.get(n),u,i,d,o,a,p);else{var f=te([],u.metadata.rev_tree[0],e);u.metadata.rev_tree=f.tree,u.stemmedRevs=f.stemmedRevs||[],l(u,d,o)}}var c=0;s()})}function Qe(e){try{return JSON.parse(e)}catch(t){return wr.parse(e)}}function Ze(e){return e.length<5e4?JSON.parse(e):Qe(e)}function et(e){try{return JSON.stringify(e)}catch(t){return wr.stringify(e)}}function tt(e,t,n,r){try{e.apply(t,n)}catch(e){r.emit("error",e)}}function nt(e){if(!mo.running&&mo.queue.length){mo.running=!0;var t=mo.queue.shift();t.action(function(r,o){tt(t.callback,this,[r,o],e),mo.running=!1,n.nextTick(function(){nt(e)})})}}function rt(e){return function(t){var n="unknown_error";t.target&&t.target.error&&(n=t.target.error.name||t.target.error.message),e(S(Hr,n,t.type))}}function ot(e,t,n){return{data:et(e),winningRev:t,deletedOrLocal:n?"1":"0",seq:e.seq,id:e.id}}function it(e){if(!e)return null;var t=Ze(e.data);return t.winningRev=e.winningRev,t.deleted="1"===e.deletedOrLocal,t.seq=e.seq,t}function at(e){if(!e)return e;var t=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,t-1),e._rev=e._doc_id_rev.substring(t+1),delete e._doc_id_rev,e}function st(e,t,n,r){n?r(e?"string"!=typeof e?e:Ae(e,t):Oe([""],{type:t})):e?"string"!=typeof e?Ie(e,function(e){r(ro(e))}):r(e):r("")}function ct(e,t,n,r){function o(){++s===a.length&&r&&r()}function i(e,t){var r=e._attachments[t],i=r.digest;n.objectStore(lo).get(i).onsuccess=function(e){r.body=e.target.result.body,o()}}var a=Object.keys(e._attachments||{});if(!a.length)return r&&r();var s=0;a.forEach(function(n){t.attachments&&t.include_docs?i(e,n):(e._attachments[n].stub=!0,o())})}function lt(e,t){return Cr.all(e.map(function(e){if(e.doc&&e.doc._attachments){var n=Object.keys(e.doc._attachments);return Cr.all(n.map(function(n){var r=e.doc._attachments[n];if("body"in r){var o=r.body,i=r.content_type;return new Cr(function(a){st(o,i,t,function(t){e.doc._attachments[n]=fr.extend(f(r,["digest","content_type"]),{data:t}),a()})})}}))}}))}function ut(e,t,n){function r(){--l||o()}function o(){i.length&&i.forEach(function(e){c.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::￿",!1,!1)).onsuccess=function(t){t.target.result||s.delete(e)}})}var i=[],a=n.objectStore(co),s=n.objectStore(lo),c=n.objectStore(uo),l=e.length;e.forEach(function(e){var n=a.index("_doc_id_rev"),o=t+"::"+e;n.getKey(o).onsuccess=function(e){var t=e.target.result;if("number"!=typeof t)return r();a.delete(t),c.index("seq").openCursor(IDBKeyRange.only(t)).onsuccess=function(e){var t=e.target.result;if(t){var n=t.value.digestSeq.split("::")[0];i.push(n),c.delete(t.primaryKey),t.continue()}else r()}}})}function pt(e,t,n){try{return{txn:e.transaction(t,n)}}catch(e){return{error:e}}}function dt(e,t,n,r,o,i,a){function s(){var e=pt(o,[so,co,lo,fo,uo],"readwrite");if(e.error)return a(e.error);(y=e.txn).onabort=rt(a),y.ontimeout=rt(a),y.oncomplete=u,b=y.objectStore(so),_=y.objectStore(co),E=y.objectStore(lo),w=y.objectStore(uo),d(function(e){if(e)return A=!0,a(e);l()})}function c(){Xe(e.revs_limit,x,r,R,y,D,f,n)}function l(){function e(){++t===x.length&&c()}if(x.length)for(var t=0,n=0,r=x.length;n<r;n++){var o=x[n];o._id&&ie(o._id)?e():b.get(o.metadata.id).onsuccess=function(t){var n=it(t.target.result);n&&R.set(n.id,n),e()}}}function u(){A||(i.notify(r._meta.name),r._meta.docCount+=C,a(null,D))}function p(e,t){E.get(e).onsuccess=function(n){if(n.target.result)t();else{var r=S(Kr,"unknown stub attachment with digest "+e);r.status=412,t(r)}}}function d(e){function t(){++o===n.length&&e(r)}var n=[];if(x.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,o=0;n.forEach(function(e){p(e,function(e){e&&!r&&(r=e),t()})})}function f(e,t,n,r,o,i,a,s){C+=i,e.metadata.winningRev=t,e.metadata.deleted=n;var c=e.data;if(c._id=e.metadata.id,c._rev=e.metadata.rev,r&&(c._deleted=!0),c._attachments&&Object.keys(c._attachments).length)return m(e,t,n,o,a,s);h(e,t,n,o,a,s)}function h(e,t,n,o,i,a){function s(i){var a=e.stemmedRevs||[];o&&r.auto_compaction&&(a=a.concat(z(e.metadata))),a&&a.length&&ut(a,e.metadata.id,y),u.seq=i.target.result,delete u.rev;var s=ot(u,t,n);b.put(s).onsuccess=c}function c(){D[i]={ok:!0,id:u.id,rev:t},R.set(e.metadata.id,e.metadata),g(e,u.seq,a)}var l=e.data,u=e.metadata;l._doc_id_rev=u.id+"::"+u.rev,delete l._id,delete l._rev;var p=_.put(l);p.onsuccess=s,p.onerror=function(e){e.preventDefault(),e.stopPropagation(),_.index("_doc_id_rev").getKey(l._doc_id_rev).onsuccess=function(e){_.put(l,e.target.result).onsuccess=s}}}function m(e,t,n,r,o,i){function a(){l===u.length&&h(e,t,n,r,o,i)}function s(){l++,a()}var c=e.data,l=0,u=Object.keys(c._attachments);u.forEach(function(n){var r=e.data._attachments[n];if(r.stub)l++,a();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10),v(r.digest,o,s)}})}function g(e,t,n){function r(){++o===i.length&&n()}var o=0,i=Object.keys(e.data._attachments||{});if(!i.length)return n();for(var a=0;a<i.length;a++)!function(n){var o=e.data._attachments[n].digest,i=w.put({seq:t,digestSeq:o+"::"+t});i.onsuccess=r,i.onerror=function(e){e.preventDefault(),e.stopPropagation(),r()}}(i[a])}function v(e,t,n){E.count(e).onsuccess=function(r){if(r.target.result)return n();var o={digest:e,body:t};E.put(o).onsuccess=n}}for(var y,b,_,E,w,k,x=t.docs,C=0,N=0,T=x.length;N<T;N++){var O=x[N];O._id&&ie(O._id)||(O=x[N]=Te(O,n.new_edits)).error&&!k&&(k=O)}if(k)return a(k);var D=new Array(x.length),R=new vr.Map,A=!1,P=r._meta.blobSupport?"blob":"base64";Ge(x,P,function(e){if(e)return a(e);s()})}function ft(e,t,n,r,o){try{if(e&&t)return o?IDBKeyRange.bound(t,e,!n,!1):IDBKeyRange.bound(e,t,!1,!n);if(e)return o?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(t)return o?IDBKeyRange.lowerBound(t,!n):IDBKeyRange.upperBound(t,!n);if(r)return IDBKeyRange.only(r)}catch(e){return{error:e}}return null}function ht(e,t,n,r){if("DataError"===n.name&&0===n.code)return r(null,{total_rows:e._meta.docCount,offset:t.skip,rows:[]});r(S(Hr,n.name,n.message))}function mt(e,t,n,r){function o(e,r){function o(t,n,r){var o=t.id+"::"+r;E.get(o).onsuccess=function(r){n.doc=at(r.target.result),e.conflicts&&(n.doc._conflicts=W(t)),ct(n.doc,e,v)}}function i(t,n,r){var i={id:r.id,key:r.id,value:{rev:n}},a=r.deleted;if("ok"===e.deleted)w.push(i),a?(i.value.deleted=!0,i.doc=null):e.include_docs&&o(r,i,n);else if(!a&&u--<=0&&(w.push(i),e.include_docs&&o(r,i,n),0==--p))return;t.continue()}function a(){r(null,{total_rows:k,offset:e.skip,rows:w})}var s="startkey"in e&&e.startkey,c="endkey"in e&&e.endkey,l="key"in e&&e.key,u=e.skip||0,p="number"==typeof e.limit?e.limit:-1,d=!1!==e.inclusive_end,f="descending"in e&&e.descending?"prev":null,h=ft(s,c,d,l,f);if(h&&h.error)return ht(t,e,h.error,r);var m=[so,co];e.attachments&&m.push(lo);var g=pt(n,m,"readonly");if(g.error)return r(g.error);var v=g.txn,y=v.objectStore(so),b=v.objectStore(co),_=f?y.openCursor(h,f):y.openCursor(h),E=b.index("_doc_id_rev"),w=[],k=0;v.oncomplete=function(){e.attachments?lt(w,e.binary).then(a):a()},_.onsuccess=function(e){k=t._meta.docCount;var n=e.target.result;if(n){var r=it(n.value);i(n,r.winningRev,r)}}}!function(e,n){if(0===e.limit)return n(null,{total_rows:t._meta.docCount,offset:e.skip,rows:[]});o(e,n)}(e,r)}function gt(e){return new Cr(function(t){var n=Oe([""]);e.objectStore(ho).put(n,"key"),e.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},e.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function vt(e,t){var n=this;mo.queue.push({action:function(t){yt(n,e,t)},callback:t}),nt(n.constructor)}function yt(e,t,r){function o(e){var t=e.createObjectStore(so,{keyPath:"id"});e.createObjectStore(co,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(lo,{keyPath:"digest"}),e.createObjectStore(po,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(ho),t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(fo,{keyPath:"_id"});var n=e.createObjectStore(uo,{autoIncrement:!0});n.createIndex("seq","seq"),n.createIndex("digestSeq","digestSeq",{unique:!0})}function i(e,t){var n=e.objectStore(so);n.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),n.openCursor().onsuccess=function(e){var r=e.target.result;if(r){var o=r.value,i=oe(o);o.deletedOrLocal=i?"1":"0",n.put(o),r.continue()}else t()}}function a(e){e.createObjectStore(fo,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function s(e,t){var n=e.objectStore(fo),r=e.objectStore(so),o=e.objectStore(co);r.openCursor().onsuccess=function(e){var i=e.target.result;if(i){var a=i.value,s=a.id,c=ie(s),l=B(a);if(c){var u=s+"::"+l,p=s+"::",d=s+"::~",f=o.index("_doc_id_rev"),h=IDBKeyRange.bound(p,d,!1,!1),m=f.openCursor(h);m.onsuccess=function(e){if(m=e.target.result){var t=m.value;t._doc_id_rev===u&&n.put(t),o.delete(m.primaryKey),m.continue()}else r.delete(i.primaryKey),i.continue()}}else i.continue()}else t&&t()}}function c(e){var t=e.createObjectStore(uo,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}function u(e,t){var n=e.objectStore(co),r=e.objectStore(lo),o=e.objectStore(uo);r.count().onsuccess=function(e){if(!e.target.result)return t();n.openCursor().onsuccess=function(e){var n=e.target.result;if(!n)return t();for(var r=n.value,i=n.primaryKey,a=Object.keys(r._attachments||{}),s={},c=0;c<a.length;c++)s[r._attachments[a[c]].digest]=!0;var l=Object.keys(s);for(c=0;c<l.length;c++){var u=l[c];o.put({seq:i,digestSeq:u+"::"+i})}n.continue()}}}function d(e){function t(e){return e.data?it(e):(e.deleted="1"===e.deletedOrLocal,e)}var n=e.objectStore(co),r=e.objectStore(so);r.openCursor().onsuccess=function(e){function o(){var e=ot(a,a.winningRev,a.deleted);r.put(e).onsuccess=function(){i.continue()}}var i=e.target.result;if(i){var a=t(i.value);if(a.winningRev=a.winningRev||B(a),a.seq)return o();!function(){var e=a.id+"::",t=a.id+"::￿",r=0;n.index("_doc_id_rev").openCursor(IDBKeyRange.bound(e,t)).onsuccess=function(e){var t=e.target.result;if(!t)return a.seq=r,o();var n=t.primaryKey;n>r&&(r=n),t.continue()}}()}}}var f=t.name,h=null;e._meta=null,e.type=function(){return"idb"},e._id=p(function(t){t(null,e._meta.instanceId)}),e._bulkDocs=function(n,r,o){dt(t,n,r,e,h,vo,o)},e._get=function(e,t,n){function r(){n(a,{doc:o,metadata:i,ctx:s})}var o,i,a,s=t.ctx;if(!s){var c=pt(h,[so,co,lo],"readonly");if(c.error)return n(c.error);s=c.txn}s.objectStore(so).get(e).onsuccess=function(e){if(!(i=it(e.target.result)))return a=S(Rr,"missing"),r();if(oe(i)&&!t.rev)return a=S(Rr,"deleted"),r();var n=s.objectStore(co),c=t.rev||i.winningRev,l=i.id+"::"+c;n.index("_doc_id_rev").get(l).onsuccess=function(e){if((o=e.target.result)&&(o=at(o)),!o)return a=S(Rr,"missing"),r();r()}}},e._getAttachment=function(e,t,n,r,o){var i;if(r.ctx)i=r.ctx;else{var a=pt(h,[so,co,lo],"readonly");if(a.error)return o(a.error);i=a.txn}var s=n.digest,c=n.content_type;i.objectStore(lo).get(s).onsuccess=function(e){st(e.target.result.body,c,r.binary,function(e){o(null,e)})}},e._info=function(t){if(null===h||!go.has(f)){var n=new Error("db isn't open");return n.id="idbNull",t(n)}var r,o,i=pt(h,[co],"readonly");if(i.error)return t(i.error);var a=i.txn;a.objectStore(co).openCursor(null,"prev").onsuccess=function(t){var n=t.target.result;r=n?n.key:0,o=e._meta.docCount},a.oncomplete=function(){t(null,{doc_count:o,update_seq:r,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(t,n){mt(t,e,h,n)},e._changes=function(t){function n(e){function n(){return d.seq!==l?e.continue():(s=l,d.winningRev===i._rev?o(i):void r())}function r(){var e=i._id+"::"+d.winningRev;g.get(e).onsuccess=function(e){o(at(e.target.result))}}function o(n){var r=t.processChange(n,d,t);r.seq=d.seq;var o=b(r);if("object"==typeof o)return t.complete(o);o&&(y++,u&&v.push(r),t.attachments&&t.include_docs?ct(n,t,p,function(){lt([r],t.binary).then(function(){t.onChange(r)})}):t.onChange(r)),y!==c&&e.continue()}var i=at(e.value),l=e.key;if(a&&!a.has(i._id))return e.continue();var d;if(d=_.get(i._id))return n();m.get(i._id).onsuccess=function(e){d=it(e.target.result),_.set(i._id,d),n()}}function r(e){var t=e.target.result;t&&n(t)}function o(){function e(){t.complete(null,{results:v,last_seq:s})}!t.continuous&&t.attachments?lt(v).then(e):e()}if((t=l(t)).continuous){var i=f+":"+U();return vo.addListener(f,i,e,t),vo.notify(f),{cancel:function(){vo.removeListener(f,i)}}}var a=t.doc_ids&&new vr.Set(t.doc_ids);t.since=t.since||0;var s=t.since,c="limit"in t?t.limit:-1;0===c&&(c=1);var u;u="return_docs"in t?t.return_docs:!("returnDocs"in t)||t.returnDocs;var p,d,m,g,v=[],y=0,b=O(t),_=new vr.Map;!function(){var e=[so,co];t.attachments&&e.push(lo);var n=pt(h,e,"readonly");if(n.error)return t.complete(n.error);(p=n.txn).onabort=rt(t.complete),p.oncomplete=o,d=p.objectStore(co),m=p.objectStore(so),g=d.index("_doc_id_rev");(t.descending?d.openCursor(null,"prev"):d.openCursor(IDBKeyRange.lowerBound(t.since,!0))).onsuccess=r}()},e._close=function(e){if(null===h)return e(S(Mr));h.close(),go.delete(f),h=null,e()},e._getRevisionTree=function(e,t){var n=pt(h,[so],"readonly");if(n.error)return t(n.error);n.txn.objectStore(so).get(e).onsuccess=function(e){var n=it(e.target.result);n?t(null,n.rev_tree):t(S(Rr))}},e._doCompaction=function(e,t,n){var r=pt(h,[so,co,lo,uo],"readwrite");if(r.error)return n(r.error);var o=r.txn;o.objectStore(so).get(e).onsuccess=function(n){var r=it(n.target.result);V(r.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")}),ut(t,e,o);var i=r.winningRev,a=r.deleted;o.objectStore(so).put(ot(r,i,a))},o.onabort=rt(n),o.oncomplete=function(){n()}},e._getLocal=function(e,t){var n=pt(h,[fo],"readonly");if(n.error)return t(n.error);var r=n.txn.objectStore(fo).get(e);r.onerror=rt(t),r.onsuccess=function(e){var n=e.target.result;n?(delete n._doc_id_rev,t(null,n)):t(S(Rr))}},e._putLocal=function(e,t,n){"function"==typeof t&&(n=t,t={}),delete e._revisions;var r=e._rev,o=e._id;e._rev=r?"0-"+(parseInt(r.split("-")[1],10)+1):"0-1";var i,a=t.ctx;if(!a){var s=pt(h,[fo],"readwrite");if(s.error)return n(s.error);(a=s.txn).onerror=rt(n),a.oncomplete=function(){i&&n(null,i)}}var c,l=a.objectStore(fo);r?(c=l.get(o)).onsuccess=function(o){var a=o.target.result;a&&a._rev===r?l.put(e).onsuccess=function(){i={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,i)}:n(S(Ar))}:((c=l.add(e)).onerror=function(e){n(S(Ar)),e.preventDefault(),e.stopPropagation()},c.onsuccess=function(){i={ok:!0,id:e._id,rev:e._rev},t.ctx&&n(null,i)})},e._removeLocal=function(e,t,n){"function"==typeof t&&(n=t,t={});var r=t.ctx;if(!r){var o=pt(h,[fo],"readwrite");if(o.error)return n(o.error);(r=o.txn).oncomplete=function(){i&&n(null,i)}}var i,a=e._id,s=r.objectStore(fo),c=s.get(a);c.onerror=rt(n),c.onsuccess=function(r){var o=r.target.result;o&&o._rev===e._rev?(s.delete(a),i={ok:!0,id:a,rev:"0-0"},t.ctx&&n(null,i)):n(S(Rr))}},e._destroy=function(e,t){vo.removeAllListeners(f);var n=yo.get(f);n&&n.result&&(n.result.close(),go.delete(f));var r=indexedDB.deleteDatabase(f);r.onsuccess=function(){yo.delete(f),y()&&f in localStorage&&delete localStorage[f],t(null,{ok:!0})},r.onerror=rt(t)};var m=go.get(f);if(m)return h=m.idb,e._meta=m.global,void n.nextTick(function(){r(null,e)});var g;g=t.storage?bt(f,t.storage):indexedDB.open(f,ao),yo.set(f,g),g.onupgradeneeded=function(e){function t(){var e=l[p-1];p++,e&&e(r,t)}var n=e.target.result;if(e.oldVersion<1)return o(n);var r=e.currentTarget.transaction;e.oldVersion<3&&a(n),e.oldVersion<4&&c(n);var l=[i,s,u,d],p=e.oldVersion;t()},g.onsuccess=function(t){(h=t.target.result).onversionchange=function(){h.close(),go.delete(f)},h.onabort=function(e){E("error","Database has a global failure",e.target.error),h.close(),go.delete(f)};var n=h.transaction([po,ho,so],"readwrite"),o=null,i=null,a=null;n.objectStore(po).get(po).onsuccess=function(t){var s=function(){null!==o&&null!==i&&null!==a&&(e._meta={name:f,instanceId:a,blobSupport:o,docCount:i},go.set(f,{idb:h,global:e._meta}),r(null,e))},c=t.target.result||{id:po};f+"_id"in c?(a=c[f+"_id"],s()):(a=U(),c[f+"_id"]=a,n.objectStore(po).put(c).onsuccess=function(){s()}),Zr||(Zr=gt(n)),Zr.then(function(e){o=e,s()}),n.objectStore(so).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){i=e.target.result,s()}}},g.onerror=function(){var e="Failed to open indexedDB, are you in private browsing mode?";E("error",e),r(S(Hr,e))}}function bt(e,t){try{return indexedDB.open(e,{version:ao,storage:t})}catch(t){return indexedDB.open(e,ao)}}function _t(e){return decodeURIComponent(escape(e))}function Et(e){return e<65?e-48:e-55}function wt(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(Et(e.charCodeAt(t++))<<4|Et(e.charCodeAt(t++)));return r}function kt(e,t,n){for(var r="";t<n;)r+=String.fromCharCode(Et(e.charCodeAt(t+2))<<12|Et(e.charCodeAt(t+3))<<8|Et(e.charCodeAt(t))<<4|Et(e.charCodeAt(t+1))),t+=4;return r}function xt(e,t){return"UTF-8"===t?_t(wt(e,0,e.length)):kt(e,0,e.length)}function Ct(e){return"'"+e+"'"}function St(e){return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"")}function Nt(e){return e.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,"")}function Tt(e){return delete e._id,delete e._rev,JSON.stringify(e)}function Ot(e,t,n){return e=JSON.parse(e),e._id=t,e._rev=n,e}function Dt(e){for(var t="(";e--;)t+="?",e&&(t+=",");return t+")"}function Rt(e,t,n,r,o){return"SELECT "+e+" FROM "+("string"==typeof t?t:t.join(" JOIN "))+(n?" ON "+n:"")+(r?" WHERE "+("string"==typeof r?r:r.join(" AND ")):"")+(o?" ORDER BY "+o:"")}function At(e,t,n){function r(){++i===e.length&&o()}function o(){if(a.length){var e="SELECT DISTINCT digest AS digest FROM "+Co+" WHERE seq IN "+Dt(a.length);n.executeSql(e,a,function(e,t){for(var n=[],r=0;r<t.rows.length;r++)n.push(t.rows.item(r).digest);if(n.length){var o="DELETE FROM "+Co+" WHERE seq IN ("+a.map(function(){return"?"}).join(",")+")";e.executeSql(o,a,function(e){var t="SELECT digest FROM "+Co+" WHERE digest IN ("+n.map(function(){return"?"}).join(",")+")";e.executeSql(t,n,function(e,t){for(var r=new vr.Set,o=0;o<t.rows.length;o++)r.add(t.rows.item(o).digest);n.forEach(function(t){r.has(t)||(e.executeSql("DELETE FROM "+Co+" WHERE digest=?",[t]),e.executeSql("DELETE FROM "+wo+" WHERE digest=?",[t]))})})})}})}}if(e.length){var i=0,a=[];e.forEach(function(e){var o="SELECT seq FROM "+Eo+" WHERE doc_id=? AND rev=?";n.executeSql(o,[t,e],function(e,t){if(!t.rows.length)return r();var n=t.rows.item(0).seq;a.push(n),e.executeSql("DELETE FROM "+Eo+" WHERE seq=?",[n],r)})})}}function Pt(e){return function(t){E("error","WebSQL threw an error",t);var n=t&&t.constructor.toString().match(/function ([^\(]+)/),r=n&&n[1]||t.type,o=t.target||t.message;e(S(Wr,o,r))}}function It(e){return"size"in e?1e6*e.size:"undefined"!=typeof navigator&&/Android/.test(navigator.userAgent)?5e6:1}function jt(e,t,n,r,o,i,a){function s(){if(y)return a(y);i.notify(r._name),r._docCount=-1,a(null,b)}function c(e,t){var n="SELECT count(*) as cnt FROM "+wo+" WHERE digest=?";v.executeSql(n,[e],function(n,r){if(0===r.rows.item(0).cnt){var o=S(Kr,"unknown stub attachment with digest "+e);t(o)}else t()})}function l(e){function t(){++o===n.length&&e(r)}var n=[];if(m.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var r=e.data._attachments[t];r.stub&&n.push(r.digest)})}),!n.length)return e();var r,o=0;n.forEach(function(e){c(e,function(e){e&&!r&&(r=e),t()})})}function u(e,t,n,o,i,a,s,c){function l(){function t(e,t){function r(){return++o===i.length&&t(),!1}var o=0,i=Object.keys(n._attachments||{});if(!i.length)return t();for(var a=0;a<i.length;a++)!function(t){var o="INSERT INTO "+Co+" (digest, seq) VALUES (?,?)",i=[n._attachments[t].digest,e];v.executeSql(o,i,r,r)}(i[a])}var n=e.data,r=o?1:0,i=n._id,a=n._rev,s=Tt(n),c="INSERT INTO "+Eo+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",l=[i,a,s,r];v.executeSql(c,l,function(e,n){var r=n.insertId;t(r,function(){d(e,r)})},function(){var e=Rt("seq",Eo,null,"doc_id=? AND rev=?");return v.executeSql(e,[i,a],function(e,n){var o=n.rows.item(0).seq,c="UPDATE "+Eo+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",l=[s,r,i,a];e.executeSql(c,l,function(e){t(o,function(){d(e,o)})})}),!1})}function u(e){h||(e?c(h=e):m===g.length&&l())}function p(e){m++,u(e)}function d(n,o){var a=e.metadata.id,l=e.stemmedRevs||[];i&&r.auto_compaction&&(l=z(e.metadata).concat(l)),l.length&&At(l,a,n),e.metadata.seq=o,delete e.metadata.rev;var u=i?"UPDATE "+_o+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+Eo+" WHERE doc_id="+_o+".id AND rev=?) WHERE id=?":"INSERT INTO "+_o+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",p=et(e.metadata),d=i?[p,o,t,a]:[a,o,o,p];n.executeSql(u,d,function(){b[s]={ok:!0,id:e.metadata.id,rev:t},_.set(a,e.metadata),c()})}var h=null,m=0;e.data._id=e.metadata.id,e.data._rev=e.metadata.rev;var g=Object.keys(e.data._attachments||{});o&&(e.data._deleted=!0),g.forEach(function(n){var r=e.data._attachments[n];if(r.stub)m++,u();else{var o=r.data;delete r.data,r.revpos=parseInt(t,10),f(r.digest,o,p)}}),g.length||l()}function p(){Xe(e.revs_limit,m,r,_,v,b,u,n)}function d(e){function t(){++n===m.length&&e()}if(!m.length)return e();var n=0;m.forEach(function(e){if(e._id&&ie(e._id))return t();var n=e.metadata.id;v.executeSql("SELECT json FROM "+_o+" WHERE id = ?",[n],function(e,r){if(r.rows.length){var o=Ze(r.rows.item(0).json);_.set(n,o)}t()})})}function f(e,t,n){var r="SELECT digest FROM "+wo+" WHERE digest=?";v.executeSql(r,[e],function(o,i){if(i.rows.length)return n();r="INSERT INTO "+wo+" (digest, body, escaped) VALUES (?,?,1)",o.executeSql(r,[e,St(t)],function(){n()},function(){return n(),!1})})}var h=n.new_edits,m=t.docs.map(function(e){return e._id&&ie(e._id)?e:Te(e,h)}),g=m.filter(function(e){return e.error});if(g.length)return a(g[0]);var v,y,b=new Array(m.length),_=new vr.Map;Ge(m,"binary",function(e){if(e)return a(e);o.transaction(function(e){v=e,l(function(e){e?y=e:d(p)})},Pt(a),s)})}function Mt(e){return e.websql(e.name,e.version,e.description,e.size)}function Lt(e){try{return{db:Mt(e)}}catch(e){return{error:e}}}function Ft(e){var t=So.get(e.name);return t||(t=Lt(e),So.set(e.name,t),t.db&&(t.db._sqlitePlugin="undefined"!=typeof sqlitePlugin)),t}function Ut(e,t,n,r,o){function i(){++c===s.length&&o&&o()}function a(e,o){var a=e._attachments[o],s={binary:t.binary,ctx:r};n._getAttachment(e._id,o,a,s,function(t,n){e._attachments[o]=fr.extend(f(a,["digest","content_type"]),{data:n}),i()})}var s=Object.keys(e._attachments||{});if(!s.length)return o&&o();var c=0;s.forEach(function(n){t.attachments&&t.include_docs?a(e,n):(e._attachments[n].stub=!0,i())})}function Bt(e,t){function n(){y()&&(window.localStorage["_pouch__websqldb_"+v._name]=!0),t(null,v)}function r(e,t){e.executeSql(Ro),e.executeSql("ALTER TABLE "+Eo+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){e.executeSql(Oo),e.executeSql("ALTER TABLE "+_o+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){e.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+_o+" (local, id)");var n="SELECT "+_o+".winningseq AS seq, "+_o+".json AS metadata FROM "+Eo+" JOIN "+_o+" ON "+Eo+".seq = "+_o+".winningseq";e.executeSql(n,[],function(e,n){for(var r=[],o=[],i=0;i<n.rows.length;i++){var a=n.rows.item(i),s=a.seq,c=JSON.parse(a.metadata);oe(c)&&r.push(s),ie(c.id)&&o.push(c.id)}e.executeSql("UPDATE "+_o+"SET local = 1 WHERE id IN "+Dt(o.length),o,function(){e.executeSql("UPDATE "+Eo+" SET deleted = 1 WHERE seq IN "+Dt(r.length),r,t)})})})})}function o(e,t){var n="CREATE TABLE IF NOT EXISTS "+ko+" (id UNIQUE, rev, json)";e.executeSql(n,[],function(){var n="SELECT "+_o+".id AS id, "+Eo+".json AS data FROM "+Eo+" JOIN "+_o+" ON "+Eo+".seq = "+_o+".winningseq WHERE local = 1";e.executeSql(n,[],function(e,n){function r(){if(!o.length)return t(e);var n=o.shift(),i=JSON.parse(n.data)._rev;e.executeSql("INSERT INTO "+ko+" (id, rev, json) VALUES (?,?,?)",[n.id,i,n.data],function(e){e.executeSql("DELETE FROM "+_o+" WHERE id=?",[n.id],function(e){e.executeSql("DELETE FROM "+Eo+" WHERE seq=?",[n.seq],function(){r()})})})}for(var o=[],i=0;i<n.rows.length;i++)o.push(n.rows.item(i));r()})})}function i(e,t){function n(n){function r(){if(!n.length)return t(e);var o=xt(n.shift().hex,g),i=o.lastIndexOf("::"),a=o.substring(0,i),s=o.substring(i+2),c="UPDATE "+Eo+" SET doc_id=?, rev=? WHERE doc_id_rev=?";e.executeSql(c,[a,s,o],function(){r()})}r()}var r="ALTER TABLE "+Eo+" ADD COLUMN doc_id";e.executeSql(r,[],function(e){var t="ALTER TABLE "+Eo+" ADD COLUMN rev";e.executeSql(t,[],function(e){e.executeSql(Do,[],function(e){var t="SELECT hex(doc_id_rev) as hex FROM "+Eo;e.executeSql(t,[],function(e,t){for(var r=[],o=0;o<t.rows.length;o++)r.push(t.rows.item(o));n(r)})})})})}function a(e,t){function n(e){var n="SELECT COUNT(*) AS cnt FROM "+wo;e.executeSql(n,[],function(e,n){function r(){var n=Rt(jo+", "+_o+".id AS id",[_o,Eo],Io,null,_o+".id ");n+=" LIMIT "+i+" OFFSET "+o,o+=i,e.executeSql(n,[],function(e,n){if(!n.rows.length)return t(e);for(var o={},i=0;i<n.rows.length;i++)for(var a=n.rows.item(i),s=Ot(a.data,a.id,a.rev),c=Object.keys(s._attachments||{}),l=0;l<c.length;l++)!function(e,t){var n=o[e]=o[e]||[];-1===n.indexOf(t)&&n.push(t)}(s._attachments[c[l]].digest,a.seq);var u=[];if(Object.keys(o).forEach(function(e){o[e].forEach(function(t){u.push([e,t])})}),!u.length)return r();var p=0;u.forEach(function(t){var n="INSERT INTO "+Co+" (digest, seq) VALUES (?,?)";e.executeSql(n,t,function(){++p===u.length&&r()})})})}if(!n.rows.item(0).cnt)return t(e);var o=0,i=10;r()})}var r="CREATE TABLE IF NOT EXISTS "+Co+" (digest, seq INTEGER)";e.executeSql(r,[],function(e){e.executeSql(Po,[],function(e){e.executeSql(Ao,[],n)})})}function s(e,t){var n="ALTER TABLE "+wo+" ADD COLUMN escaped TINYINT(1) DEFAULT 0";e.executeSql(n,[],t)}function c(e,t){var n="ALTER TABLE "+_o+" ADD COLUMN max_seq INTEGER";e.executeSql(n,[],function(e){var n="UPDATE "+_o+" SET max_seq=(SELECT MAX(seq) FROM "+Eo+" WHERE doc_id=id)";e.executeSql(n,[],function(e){var n="CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+_o+" (max_seq)";e.executeSql(n,[],t)})})}function u(e,t){e.executeSql('SELECT HEX("a") AS hex',[],function(e,n){var r=n.rows.item(0).hex;g=2===r.length?"UTF-8":"UTF-16",t()})}function d(){for(;E.length>0;)E.pop()(null,b)}function f(e,t){if(0===t){var n="CREATE TABLE IF NOT EXISTS "+xo+" (dbid, db_version INTEGER)",l="CREATE TABLE IF NOT EXISTS "+wo+" (digest UNIQUE, escaped TINYINT(1), body BLOB)",u="CREATE TABLE IF NOT EXISTS "+Co+" (digest, seq INTEGER)",p="CREATE TABLE IF NOT EXISTS "+_o+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",f="CREATE TABLE IF NOT EXISTS "+Eo+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",h="CREATE TABLE IF NOT EXISTS "+ko+" (id UNIQUE, rev, json)";e.executeSql(l),e.executeSql(h),e.executeSql(u,[],function(){e.executeSql(Ao),e.executeSql(Po)}),e.executeSql(p,[],function(){e.executeSql(Ro),e.executeSql(f,[],function(){e.executeSql(Oo),e.executeSql(Do),e.executeSql(n,[],function(){var t="INSERT INTO "+xo+" (db_version, dbid) VALUES (?,?)";b=U();var n=[bo,b];e.executeSql(t,n,function(){d()})})})})}else{var m=[r,o,i,a,s,c,function(){t<bo&&e.executeSql("UPDATE "+xo+" SET db_version = "+bo);var n="SELECT dbid FROM "+xo;e.executeSql(n,[],function(e,t){b=t.rows.item(0).dbid,d()})}],g=t,v=function(e){m[g-1](e,v),g++};v(e)}}function h(e){var t="SELECT sql FROM sqlite_master WHERE tbl_name = "+xo;e.executeSql(t,[],function(e,t){t.rows.length?/db_version/.test(t.rows.item(0).sql)?e.executeSql("SELECT db_version FROM "+xo,[],function(e,t){f(e,t.rows.item(0).db_version)}):e.executeSql("ALTER TABLE "+xo+" ADD COLUMN db_version INTEGER",[],function(){f(e,1)}):f(e,0)})}function m(e,t){if(-1!==v._docCount)return t(v._docCount);var n=Rt("COUNT("+_o+".id) AS 'num'",[_o,Eo],Io,Eo+".deleted=0");e.executeSql(n,[],function(e,n){v._docCount=n.rows.item(0).num,t(v._docCount)})}var g,v=this,b=null,_=It(e),E=[];v._docCount=-1,v._name=e.name;var w=Ft(fr.extend({},e,{version:To,description:e.name,size:_}));if(w.error)return Pt(t)(w.error);var k=w.db;"function"!=typeof k.readTransaction&&(k.readTransaction=k.transaction),k.transaction(function(e){u(e,function(){h(e)})},Pt(t),n),v.type=function(){return"websql"},v._id=p(function(e){e(null,b)}),v._info=function(e){k.readTransaction(function(t){m(t,function(n){var r="SELECT MAX(seq) AS seq FROM "+Eo;t.executeSql(r,[],function(t,r){var o=r.rows.item(0).seq||0;e(null,{doc_count:n,update_seq:o,sqlite_plugin:k._sqlitePlugin,websql_encoding:g})})})},Pt(e))},v._bulkDocs=function(t,n,r){jt(e,t,n,v,k,No,r)},v._get=function(e,t,n){function r(){n(a,{doc:o,metadata:i,ctx:s})}var o,i,a,s=t.ctx;if(!s)return k.readTransaction(function(r){v._get(e,fr.extend({ctx:r},t),n)});var c,l;t.rev?(c=Rt(jo,[_o,Eo],_o+".id="+Eo+".doc_id",[Eo+".doc_id=?",Eo+".rev=?"]),l=[e,t.rev]):(c=Rt(jo,[_o,Eo],Io,_o+".id=?"),l=[e]),s.executeSql(c,l,function(e,n){if(!n.rows.length)return a=S(Rr,"missing"),r();var s=n.rows.item(0);if(i=Ze(s.metadata),s.deleted&&!t.rev)return a=S(Rr,"deleted"),r();o=Ot(s.data,i.id,s.rev),r()})},v._allDocs=function(e,t){var n,r=[],o="startkey"in e&&e.startkey,i="endkey"in e&&e.endkey,a="key"in e&&e.key,s="descending"in e&&e.descending,c="limit"in e?e.limit:-1,l="skip"in e?e.skip:0,u=!1!==e.inclusive_end,p=[],d=[];if(!1!==a)d.push(_o+".id = ?"),p.push(a);else if(!1!==o||!1!==i){if(!1!==o&&(d.push(_o+".id "+(s?"<=":">=")+" ?"),p.push(o)),!1!==i){var f=s?">":"<";u&&(f+="="),d.push(_o+".id "+f+" ?"),p.push(i)}!1!==a&&(d.push(_o+".id = ?"),p.push(a))}"ok"!==e.deleted&&d.push(Eo+".deleted = 0"),k.readTransaction(function(t){m(t,function(o){if(n=o,0!==c){var i=Rt(jo,[_o,Eo],Io,d,_o+".id "+(s?"DESC":"ASC"));i+=" LIMIT "+c+" OFFSET "+l,t.executeSql(i,p,function(t,n){for(var o=0,i=n.rows.length;o<i;o++){var a=n.rows.item(o),s=Ze(a.metadata),c=s.id,l=Ot(a.data,c,a.rev),u=l._rev,p={id:c,key:c,value:{rev:u}};if(e.include_docs&&(p.doc=l,p.doc._rev=u,e.conflicts&&(p.doc._conflicts=W(s)),Ut(p.doc,e,v,t)),a.deleted){if("ok"!==e.deleted)continue;p.value.deleted=!0,p.doc=null}r.push(p)}})}})},Pt(t),function(){t(null,{total_rows:n,offset:e.skip,rows:r})})},v._changes=function(e){if((e=l(e)).continuous){var t=v._name+":"+U();return No.addListener(v._name,t,v,e),No.notify(v._name),{cancel:function(){No.removeListener(v._name,t)}}}var n=e.descending;e.since=e.since&&!n?e.since:0;var r="limit"in e?e.limit:-1;0===r&&(r=1);var o;o="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var i=[],a=0;!function(){var t=_o+".json AS metadata, "+_o+".max_seq AS maxSeq, "+Eo+".json AS winningDoc, "+Eo+".rev AS winningRev ",s=_o+" JOIN "+Eo,c=_o+".id="+Eo+".doc_id AND "+_o+".winningseq="+Eo+".seq",l=["maxSeq > ?"],u=[e.since];e.doc_ids&&(l.push(_o+".id IN "+Dt(e.doc_ids.length)),u=u.concat(e.doc_ids));var p=Rt(t,s,c,l,"maxSeq "+(n?"DESC":"ASC")),d=O(e);e.view||e.filter||(p+=" LIMIT "+r);var f=e.since||0;k.readTransaction(function(t){t.executeSql(p,u,function(t,n){function s(t){return function(){e.onChange(t)}}for(var c=0,l=n.rows.length;c<l;c++){var u=n.rows.item(c),p=Ze(u.metadata);f=u.maxSeq;var h=Ot(u.winningDoc,p.id,u.winningRev),m=e.processChange(h,p,e);m.seq=u.maxSeq;var g=d(m);if("object"==typeof g)return e.complete(g);if(g&&(a++,o&&i.push(m),e.attachments&&e.include_docs?Ut(h,e,v,t,s(m)):s(m)()),a===r)break}})},Pt(e.complete),function(){e.continuous||e.complete(null,{results:i,last_seq:f})})}()},v._close=function(e){e()},v._getAttachment=function(e,t,n,r,o){var i,a=r.ctx,s=n.digest,c=n.content_type,l="SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+wo+" WHERE digest=?";a.executeSql(l,[s],function(e,t){var n=t.rows.item(0),a=n.escaped?Nt(n.body):xt(n.body,g);i=r.binary?Re(a,c):ro(a),o(null,i)})},v._getRevisionTree=function(e,t){k.readTransaction(function(n){var r="SELECT json AS metadata FROM "+_o+" WHERE id = ?";n.executeSql(r,[e],function(e,n){if(n.rows.length){var r=Ze(n.rows.item(0).metadata);t(null,r.rev_tree)}else t(S(Rr))})})},v._doCompaction=function(e,t,n){if(!t.length)return n();k.transaction(function(n){var r="SELECT json AS metadata FROM "+_o+" WHERE id = ?";n.executeSql(r,[e],function(n,r){var o=Ze(r.rows.item(0).metadata);V(o.rev_tree,function(e,n,r,o,i){var a=n+"-"+r;-1!==t.indexOf(a)&&(i.status="missing")});var i="UPDATE "+_o+" SET json = ? WHERE id = ?";n.executeSql(i,[et(o),e])}),At(t,e,n)},Pt(n),function(){n()})},v._getLocal=function(e,t){k.readTransaction(function(n){var r="SELECT json, rev FROM "+ko+" WHERE id=?";n.executeSql(r,[e],function(n,r){if(r.rows.length){var o=r.rows.item(0),i=Ot(o.json,e,o.rev);t(null,i)}else t(S(Rr))})})},v._putLocal=function(e,t,n){function r(e){var r,l;i?(r="UPDATE "+ko+" SET rev=?, json=? WHERE id=? AND rev=?",l=[o,c,a,i]):(r="INSERT INTO "+ko+" (id, rev, json) VALUES (?,?,?)",l=[a,o,c]),e.executeSql(r,l,function(e,r){r.rowsAffected?(s={ok:!0,id:a,rev:o},t.ctx&&n(null,s)):n(S(Ar))},function(){return n(S(Ar)),!1})}"function"==typeof t&&(n=t,t={}),delete e._revisions;var o,i=e._rev,a=e._id;o=e._rev=i?"0-"+(parseInt(i.split("-")[1],10)+1):"0-1";var s,c=Tt(e);t.ctx?r(t.ctx):k.transaction(r,Pt(n),function(){s&&n(null,s)})},v._removeLocal=function(e,t,n){function r(r){var i="DELETE FROM "+ko+" WHERE id=? AND rev=?",a=[e._id,e._rev];r.executeSql(i,a,function(r,i){if(!i.rowsAffected)return n(S(Rr));o={ok:!0,id:e._id,rev:"0-0"},t.ctx&&n(null,o)})}"function"==typeof t&&(n=t,t={});var o;t.ctx?r(t.ctx):k.transaction(r,Pt(n),function(){o&&n(null,o)})},v._destroy=function(e,t){No.removeAllListeners(v._name),k.transaction(function(e){[_o,Eo,wo,xo,ko,Co].forEach(function(t){e.executeSql("DROP TABLE IF EXISTS "+t,[])})},Pt(t),function(){y()&&(delete window.localStorage["_pouch__websqldb_"+v._name],delete window.localStorage[v._name]),t(null,{ok:!0})})}}function Vt(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(e){return!1}}function qt(){if("undefined"==typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var e=y(),t="_pouch__websqldb_valid_"+navigator.userAgent;if(e&&localStorage[t])return"1"===localStorage[t];var n=Vt();return e&&(localStorage[t]=n?"1":"0"),n}function Ht(){return"undefined"!=typeof openDatabase&&("undefined"!=typeof sqlitePlugin||qt())}function Wt(e){return function(t,n,r,o){if("undefined"!=typeof sqlitePlugin){var i=fr.extend({},e,{name:t,version:n,description:r,size:o});return sqlitePlugin.openDatabase(i)}return openDatabase(t,n,r,o)}}function zt(e,t){var n=Wt(e),r=fr.extend({websql:n},e);"undefined"==typeof cordova||Ht()||E("error","PouchDB error: you must install a SQLite plugin in order for PouchDB to work on this platform. Options:\n - https://github.com/nolanlawson/cordova-plugin-sqlite-2\n - https://github.com/litehelpers/Cordova-sqlite-storage\n - https://github.com/Microsoft/cordova-plugin-websql"),Bt.call(this,r,t)}function Kt(){for(var e={},t=new Cr(function(t,n){e.resolve=t,e.reject=n}),n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.promise=t,Cr.resolve().then(function(){return fetch.apply(null,n)}).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e}function Yt(e,t){var n,r,o,i=new Headers,a={method:e.method,credentials:"include",headers:i};return e.json&&(i.set("Accept","application/json"),i.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?Le(e.body,function(e){a.body=e}):e.body&&e.processData&&"string"!=typeof e.body?a.body=JSON.stringify(e.body):a.body="body"in e?e.body:null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&i.set(t,e.headers[t])}),n=Kt(e.url,a),e.timeout>0&&(r=setTimeout(function(){n.reject(new Error("Load timeout for resource: "+e.url))},e.timeout)),n.promise.then(function(t){return o={statusCode:t.status},e.timeout>0&&clearTimeout(r),o.statusCode>=200&&o.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){o.statusCode>=200&&o.statusCode<300?t(null,o,e):t(e,o)}).catch(function(e){t(e,o)}),{abort:n.reject}}function Gt(e,t){var n,r,o=!1,i=function(){o=!0,n.abort()};n=e.xhr?new e.xhr:new XMLHttpRequest;try{n.open(e.method,e.url)}catch(e){return t(new Error(e.name||"Url is invalid"))}n.withCredentials=!("withCredentials"in e)||e.withCredentials,"GET"===e.method?delete e.headers["Content-Type"]:e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(n.responseType="arraybuffer"),"body"in e||(e.body=null);for(var a in e.headers)e.headers.hasOwnProperty(a)&&n.setRequestHeader(a,e.headers[a]);return e.timeout>0&&(r=setTimeout(i,e.timeout),n.onprogress=function(){clearTimeout(r),4!==n.readyState&&(r=setTimeout(i,e.timeout))},void 0!==n.upload&&(n.upload.onprogress=n.onprogress)),n.onreadystatechange=function(){if(4===n.readyState){var r={statusCode:n.status};if(n.status>=200&&n.status<300){var i;i=e.binary?Oe([n.response||""],{type:n.getResponseHeader("Content-Type")}):n.responseText,t(null,r,i)}else{var a={};if(o)(a=new Error("ETIMEDOUT")).code="ETIMEDOUT";else try{a=JSON.parse(n.response)}catch(e){}a.status=n.status,t(a)}}},e.body&&e.body instanceof Blob?Le(e.body,function(e){n.send(e)}):n.send(e.body),{abort:function(){n.abort()}}}function $t(e,t){return Mo||e.xhr?Gt(e,t):Yt(e,t)}function Jt(){return""}function Xt(e,t){function n(t,n,r){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(e){return r(e)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?N(e):e})),e.binary&&Lo(t,n),r(null,t,n)}e=l(e);var r={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return(e=fr.extend(r,e)).json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),$t(e,function(r,o,i){if(r)return t(N(r));var a,s=o.headers&&o.headers["content-type"],c=i||Jt();if(!e.binary&&(e.json||!e.processData)&&"object"!=typeof c&&(/json/.test(s)||/^[\s]*\{/.test(c)&&/\}[\s]*$/.test(c)))try{c=JSON.parse(c.toString())}catch(e){}o.statusCode>=200&&o.statusCode<300?n(c,o,t):((a=N(c)).status=o.statusCode,t(a))})}function Qt(e,t){var n=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",r=-1!==n.indexOf("safari")&&-1===n.indexOf("chrome"),o=-1!==n.indexOf("msie"),i=-1!==n.indexOf("edge"),a=r||(o||i)&&"GET"===e.method,s=!("cache"in e)||e.cache;if(!/^blob:/.test(e.url)&&(a||!s)){var c=-1!==e.url.indexOf("?");e.url+=(c?"&":"?")+"_nonce="+Date.now()}return Xt(e,t)}function Zt(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];n.data=Ae(n.data,n.content_type)})}function en(e){return/^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function tn(e){return e._attachments&&Object.keys(e._attachments)?Cr.all(Object.keys(e._attachments).map(function(t){var n=e._attachments[t];if(n.data&&"string"!=typeof n.data)return new Cr(function(e){Me(n.data,e)}).then(function(e){n.data=e})})):Cr.resolve()}function nn(e){var t=j(e);(t.user||t.password)&&(t.auth={username:t.user,password:t.password});var n=t.path.replace(/(^\/|\/$)/g,"").split("/");return t.db=n.pop(),-1===t.db.indexOf("%")&&(t.db=encodeURIComponent(t.db)),t.path=n.join("/"),t}function rn(e,t){return on(e,e.db+"/"+t)}function on(e,t){var n=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+n+t}function an(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")}function sn(e,t){function n(e,t,n){var r=e.ajax||{},o=fr.extend(l(h),r,t);return qo(o.method+" "+o.url),s._ajax(o,n)}function r(e,t){return new Cr(function(r,o){n(e,t,function(e,t){if(e)return o(e);r(t)})})}function o(e,t){return d(e,yr(function(e){i().then(function(){return t.apply(this,e)}).catch(function(t){e.pop()(t)})}))}function i(){return e.skipSetup||e.skip_setup?Cr.resolve():b||((b=r({},{method:"GET",url:p}).catch(function(e){return e&&e.status&&404===e.status?(x(404,"PouchDB is just detecting if the remote exists."),r({},{method:"PUT",url:p})):Cr.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||Cr.reject(e)})).catch(function(){b=null}),b)}function a(e){return e.split("/").map(encodeURIComponent).join("/")}var s=this,c=nn;e.getHost&&(c=e.getHost);var u=c(e.name,e),p=rn(u,""),h=(e=l(e)).ajax||{};if(s.getUrl=function(){return p},s.getHeaders=function(){return h.headers||{}},e.auth||u.auth){var m=e.auth||u.auth,v=m.username+":"+m.password,y=ro(unescape(encodeURIComponent(v)));h.headers=h.headers||{},h.headers.Authorization="Basic "+y}s._ajax=Qt;var b;setTimeout(function(){t(null,s)}),s.type=function(){return"http"},s.id=o("id",function(e){n({},{method:"GET",url:on(u,"")},function(t,n){var r=n&&n.uuid?n.uuid+u.db:rn(u,"");e(null,r)})}),s.request=o("request",function(e,t){e.url=rn(u,e.url),n({},e,t)}),s.compact=o("compact",function(e,t){"function"==typeof e&&(t=e,e={}),n(e=l(e),{url:rn(u,"_compact"),method:"POST"},function(){function n(){s.info(function(r,o){o&&!o.compact_running?t(null,{ok:!0}):setTimeout(n,e.interval||200)})}n()})}),s.bulkGet=d("bulkGet",function(e,t){function r(t){var r={};e.revs&&(r.revs=!0),e.attachments&&(r.attachments=!0),n({},{url:rn(u,"_bulk_get"+an(r)),method:"POST",body:{docs:e.docs}},t)}function o(){for(var n=Uo,r=Math.ceil(e.docs.length/n),o=0,a=new Array(r),s=0;s<r;s++){var c=f(e,["revs","attachments"]);c.ajax=h,c.docs=e.docs.slice(s*n,Math.min(e.docs.length,(s+1)*n)),g(i,c,function(e){return function(n,i){a[e]=i.results,++o===r&&t(null,{results:D(a)})}}(s))}}var i=this,a=on(u,""),s=Bo[a];"boolean"!=typeof s?r(function(e,n){if(e){var r=Math.floor(e.status/100);4===r||5===r?(Bo[a]=!1,x(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),o()):t(e)}else Bo[a]=!0,t(null,n)}):s?r(t):o()}),s._info=function(e){i().then(function(){n({},{method:"GET",url:rn(u,"")},function(t,n){if(t)return e(t);n.host=rn(u,""),e(null,n)})}).catch(e)},s.get=o("get",function(e,t,n){function o(e){var n=e._attachments,o=n&&Object.keys(n);if(n&&o.length)return new kr(function(){if(!o.length)return null;var i=o.pop(),s=n[i],c=en(e._id)+"/"+a(i)+"?rev="+e._rev;return r(t,{method:"GET",url:rn(u,c),binary:!0}).then(function(e){return t.binary?e:new Cr(function(t){Me(e,t)})}).then(function(e){delete s.stub,delete s.length,s.data=e})},5,{promise:Cr}).start()}function i(e){return Array.isArray(e)?Cr.all(e.map(function(e){if(e.ok)return o(e.ok)})):o(e)}"function"==typeof t&&(n=t,t={});var s={};(t=l(t)).revs&&(s.revs=!0),t.revs_info&&(s.revs_info=!0),t.open_revs&&("all"!==t.open_revs&&(t.open_revs=JSON.stringify(t.open_revs)),s.open_revs=t.open_revs),t.rev&&(s.rev=t.rev),t.conflicts&&(s.conflicts=t.conflicts),e=en(e);var c={method:"GET",url:rn(u,e+an(s))};r(t,c).then(function(e){return Cr.resolve().then(function(){if(t.attachments)return i(e)}).then(function(){n(null,e)})}).catch(n)}),s.remove=o("remove",function(e,t,r,o){var i;"string"==typeof t?(i={_id:e,_rev:t},"function"==typeof r&&(o=r,r={})):(i=e,"function"==typeof t?(o=t,r={}):(o=r,r=t));var a=i._rev||r.rev;n(r,{method:"DELETE",url:rn(u,en(i._id))+"?rev="+a},o)}),s.getAttachment=o("getAttachment",function(e,t,r,o){"function"==typeof r&&(o=r,r={});var i=r.rev?"?rev="+r.rev:"";n(r,{method:"GET",url:rn(u,en(e))+"/"+a(t)+i,binary:!0},o)}),s.removeAttachment=o("removeAttachment",function(e,t,r,o){n({},{method:"DELETE",url:rn(u,en(e)+"/"+a(t))+"?rev="+r},o)}),s.putAttachment=o("putAttachment",function(e,t,r,o,i,s){"function"==typeof i&&(s=i,i=o,o=r,r=null);var c=en(e)+"/"+a(t),l=rn(u,c);if(r&&(l+="?rev="+r),"string"==typeof o){var p;try{p=no(o)}catch(e){return s(S(Fr,"Attachment is not a valid base64 string"))}o=p?Re(p,i):""}n({},{headers:{"Content-Type":i},method:"PUT",url:l,processData:!1,body:o,timeout:h.timeout||6e4},s)}),s._bulkDocs=function(e,t,r){e.new_edits=t.new_edits,i().then(function(){return Cr.all(e.docs.map(tn))}).then(function(){n(t,{method:"POST",url:rn(u,"_bulk_docs"),body:e},function(e,t){if(e)return r(e);t.forEach(function(e){e.ok=!0}),r(null,t)})}).catch(r)},s.allDocs=o("allDocs",function(e,t){"function"==typeof e&&(t=e,e={});var n,o={},i="GET";(e=l(e)).conflicts&&(o.conflicts=!0),e.descending&&(o.descending=!0),e.include_docs&&(o.include_docs=!0),e.attachments&&(o.attachments=!0),e.key&&(o.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(o.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(o.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(o.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(o.limit=e.limit),void 0!==e.skip&&(o.skip=e.skip);var a=an(o);if(void 0!==e.keys){var s="keys="+encodeURIComponent(JSON.stringify(e.keys));s.length+a.length+1<=Vo?a+="&"+s:(i="POST",n={keys:e.keys})}r(e,{method:i,url:rn(u,"_all_docs"+a),body:n}).then(function(n){e.include_docs&&e.attachments&&e.binary&&n.rows.forEach(Zt),t(null,n)}).catch(t)}),s._changes=function(e){var t="batch_size"in e?e.batch_size:Fo;(e=l(e)).timeout="timeout"in e?e.timeout:"timeout"in h?h.timeout:3e4;var r,o=e.timeout?{timeout:e.timeout-5e3}:{},a=void 0!==e.limit&&e.limit;r="return_docs"in e?e.return_docs:!("returnDocs"in e)||e.returnDocs;var s=a;if(e.style&&(o.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(o.include_docs=!0),e.attachments&&(o.attachments=!0),e.continuous&&(o.feed="longpoll"),e.conflicts&&(o.conflicts=!0),e.descending&&(o.descending=!0),"heartbeat"in e?e.heartbeat&&(o.heartbeat=e.heartbeat):o.heartbeat=1e4,e.filter&&"string"==typeof e.filter&&(o.filter=e.filter),e.view&&"string"==typeof e.view&&(o.filter="_view",o.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var c in e.query_params)e.query_params.hasOwnProperty(c)&&(o[c]=e.query_params[c]);var p,d="GET";if(e.doc_ids){o.filter="_doc_ids";var f=JSON.stringify(e.doc_ids);f.length<Vo?o.doc_ids=f:(d="POST",p={doc_ids:e.doc_ids})}var m,g,v=function(r,c){if(!e.aborted){o.since=r,"object"==typeof o.since&&(o.since=JSON.stringify(o.since)),e.descending?a&&(o.limit=s):o.limit=!a||s>t?t:s;var l={method:d,url:rn(u,"_changes"+an(o)),timeout:e.timeout,body:p};g=r,e.aborted||i().then(function(){m=n(e,l,c)}).catch(c)}},y={results:[]},b=function(n,o){if(!e.aborted){var i=0;if(o&&o.results)i=o.results.length,y.last_seq=o.last_seq,{}.query=e.query_params,o.results=o.results.filter(function(t){s--;var n=O(e)(t);return n&&(e.include_docs&&e.attachments&&e.binary&&Zt(t),r&&y.results.push(t),e.onChange(t)),n});else if(n)return e.aborted=!0,void e.complete(n);o&&o.last_seq&&(g=o.last_seq);var c=a&&s<=0||o&&i<t||e.descending;(!e.continuous||a&&s<=0)&&c?e.complete(null,y):setTimeout(function(){v(g,b)},0)}};return v(e.since||0,b),{cancel:function(){e.aborted=!0,m&&m.abort()}}},s.revsDiff=o("revsDiff",function(e,t,r){"function"==typeof t&&(r=t,t={}),n(t,{method:"POST",url:rn(u,"_revs_diff"),body:e},r)}),s._close=function(e){e()},s._destroy=function(e,t){n(e,{url:rn(u,""),method:"DELETE"},function(e,n){if(e&&e.status&&404!==e.status)return t(e);t(null,n)})}}function cn(){this.promise=new Cr(function(e){e()})}function ln(e){var t,n=e.db,r=e.viewName,o=e.map,i=e.reduce,a=e.temporary,s=o.toString()+(i&&i.toString())+"undefined";if(!a&&(t=n._cachedViews=n._cachedViews||{})[s])return t[s];var c=n.info().then(function(e){var c=e.db_name+"-mrview-"+(a?"temp":He(s));return M(n,"_local/mrviews",function(e){e.views=e.views||{};var t=r;-1===t.indexOf("/")&&(t=r+"/"+r);var n=e.views[t]=e.views[t]||{};if(!n[c])return n[c]=!0,e}).then(function(){return n.registerDependentDatabase(c).then(function(e){var r=e.db;r.auto_compaction=!0;var a={name:c,db:r,sourceDB:n,adapter:n.adapter,mapFun:o,reduceFun:i};return a.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return a.seq=e?e.seq:0,t&&a.db.once("destroyed",function(){delete t[s]}),a})})})});return t&&(t[s]=c),c}function un(e,t,n,r,o,i){return _r("return ("+e.replace(/;\s*$/,"")+");",{emit:t,sum:n,log:r,isArray:o,toJSON:i})}function pn(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function dn(e){return 1===e.length&&/^1-/.test(e[0].rev)}function fn(e,t){try{e.emit("error",t)}catch(e){E("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),E("error",t)}}function hn(e,t,n){try{return{output:t.apply(null,n)}}catch(t){return fn(e,t),{error:t}}}function mn(e,t){var n=xr.collate(e.key,t.key);return 0!==n?n:xr.collate(e.value,t.value)}function gn(e,t,n){return n=n||0,"number"==typeof t?e.slice(n,t+n):n>0?e.slice(n):e}function vn(e){var t=e.value;return t&&"object"==typeof t&&t._id||e.id}function yn(e){e.rows.forEach(function(e){var t=e.doc&&e.doc._attachments;t&&Object.keys(t).forEach(function(e){var n=t[e];t[e].data=Ae(n.data,n.content_type)})})}function bn(e){return function(t){return e.include_docs&&e.attachments&&e.binary&&yn(t),t}}function _n(e){return new Wn("builtin "+e+" function requires map values to be numbers or number arrays")}function En(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e[n];if("number"!=typeof o){if(!Array.isArray(o))throw _n("_sum");t="number"==typeof t?[t]:t;for(var i=0,a=o.length;i<a;i++){var s=o[i];if("number"!=typeof s)throw _n("_sum");void 0===t[i]?t.push(s):t[i]+=s}}else"number"==typeof t?t+=o:t[0]+=o}return t}function wn(e,t,n,r){var o=t[e];void 0!==o&&(r&&(o=encodeURIComponent(JSON.stringify(o))),n.push(e+"="+o))}function kn(e){if(void 0!==e){var t=Number(e);return isNaN(t)||t!==parseInt(e,10)?e:t}}function xn(e){return e.group_level=kn(e.group_level),e.limit=kn(e.limit),e.skip=kn(e.skip),e}function Cn(e){if(e){if("number"!=typeof e)return new qn('Invalid value for integer: "'+e+'"');if(e<0)return new qn('Invalid value for positive integer: "'+e+'"')}}function Sn(e,t){var n=e.descending?"endkey":"startkey",r=e.descending?"startkey":"endkey";if(void 0!==e[n]&&void 0!==e[r]&&xr.collate(e[n],e[r])>0)throw new qn("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(t.reduce&&!1!==e.reduce){if(e.include_docs)throw new qn("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new qn("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(t){var n=Cn(e[t]);if(n)throw n})}function Nn(e,t,n){var r,o=[],i="GET";if(wn("reduce",n,o),wn("include_docs",n,o),wn("attachments",n,o),wn("limit",n,o),wn("descending",n,o),wn("group",n,o),wn("group_level",n,o),wn("skip",n,o),wn("stale",n,o),wn("conflicts",n,o),wn("startkey",n,o,!0),wn("start_key",n,o,!0),wn("endkey",n,o,!0),wn("end_key",n,o,!0),wn("inclusive_end",n,o),wn("key",n,o,!0),o=o.join("&"),o=""===o?"":"?"+o,void 0!==n.keys){var a="keys="+encodeURIComponent(JSON.stringify(n.keys));a.length+o.length+1<=2e3?o+=("?"===o[0]?"&":"?")+a:(i="POST","string"==typeof t?r={keys:n.keys}:t.keys=n.keys)}if("string"==typeof t){var s=pn(t);return e.request({method:i,url:"_design/"+s[0]+"/_view/"+s[1]+o,body:r}).then(bn(n))}return r=r||{},Object.keys(t).forEach(function(e){Array.isArray(t[e])?r[e]=t[e]:r[e]=t[e].toString()}),e.request({method:"POST",url:"_temp_view"+o,body:r}).then(bn(n))}function Tn(e,t,n){return new Cr(function(r,o){e._query(t,n,function(e,t){if(e)return o(e);r(t)})})}function On(e){return new Cr(function(t,n){e._viewCleanup(function(e,r){if(e)return n(e);t(r)})})}function Dn(e){return function(t){if(404===t.status)return e;throw t}}function Rn(e,t,n){function r(e){return e.keys.length?t.db.allDocs({keys:e.keys,include_docs:!0}):Cr.resolve({rows:[]})}function o(e,t){for(var n=[],r={},o=0,i=t.rows.length;o<i;o++){var a=t.rows[o].doc;if(a&&(n.push(a),r[a._id]=!0,a._deleted=!c[a._id],!a._deleted)){var s=c[a._id];"value"in s&&(a.value=s.value)}}var l=Object.keys(c);return l.forEach(function(e){if(!r[e]){var t={_id:e},o=c[e];"value"in o&&(t.value=o.value),n.push(t)}}),e.keys=Ko(l.concat(e.keys)),n.push(e),n}var i="_local/doc_"+e,a={_id:i,keys:[]},s=n[e],c=s.indexableKeysToKeyValues;return(dn(s.changes)?Cr.resolve(a):t.db.get(i).catch(Dn(a))).then(function(e){return r(e).then(function(t){return o(e,t)})})}function An(e,t,n){return e.db.get("_local/lastSeq").catch(Dn({_id:"_local/lastSeq",seq:0})).then(function(r){var o=Object.keys(t);return Cr.all(o.map(function(n){return Rn(n,e,t)})).then(function(t){var o=D(t);return r.seq=n,o.push(r),e.db.bulkDocs({docs:o})})})}function Pn(e){var t="string"==typeof e?e:e.name,n=Yo[t];return n||(n=Yo[t]=new cn),n}function In(e){return zo(Pn(e),function(){return jn(e)})()}function jn(e){function t(e,t){var n={id:o._id,key:xr.normalizeKey(e)};void 0!==t&&null!==t&&(n.value=xr.normalizeKey(t)),r.push(n)}function n(t,n){return function(){return An(e,t,n)}}var r,o,i;if("function"==typeof e.mapFun&&2===e.mapFun.length){var a=e.mapFun;i=function(e){return a(e,t)}}else i=un(e.mapFun.toString(),t,En,Jo,Array.isArray,JSON.parse);var s=e.seq||0,c=new cn;return new Cr(function(t,a){function l(){c.finish().then(function(){e.seq=s,t()})}function u(){e.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:s,limit:$o}).on("complete",function(t){var a=t.results;if(!a.length)return l();for(var p={},d=0,f=a.length;d<f;d++){var h=a[d];if("_"!==h.doc._id[0]){r=[],(o=h.doc)._deleted||hn(e.sourceDB,i,[o]),r.sort(mn);for(var m,g={},v=0,y=r.length;v<y;v++){var b=r[v],_=[b.key,b.id];0===xr.collate(b.key,m)&&_.push(v),g[xr.toIndexableString(_)]=b,m=b.key}p[h.doc._id]={indexableKeysToKeyValues:g,changes:h.changes}}s=h.seq}return c.add(n(p,s)),a.length<$o?l():u()}).on("error",function(e){a(e)})}u()})}function Mn(e,t,n){0===n.group_level&&delete n.group_level;var r,o=n.group||n.group_level;r=Xo[e.reduceFun]?Xo[e.reduceFun]:un(e.reduceFun.toString(),null,En,Jo,Array.isArray,JSON.parse);var i=[],a=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;t.forEach(function(e){var t=i[i.length-1],n=o?e.key:null;if(o&&Array.isArray(n)&&(n=n.slice(0,a)),t&&0===xr.collate(t.groupKey,n))return t.keys.push([e.key,e.id]),void t.values.push(e.value);i.push({keys:[[e.key,e.id]],values:[e.value],groupKey:n})}),t=[];for(var s=0,c=i.length;s<c;s++){var l=i[s],u=hn(e.sourceDB,r,[l.keys,l.values,!1]);if(u.error&&u.error instanceof Wn)throw u.error;t.push({value:u.error?null:u.output,key:l.groupKey})}return{rows:gn(t,n.limit,n.skip)}}function Ln(e,t){return zo(Pn(e),function(){return Fn(e,t)})()}function Fn(e,t){function n(t){return t.include_docs=!0,e.db.allDocs(t).then(function(e){return o=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var t=Object.keys(e.doc.value).sort(),n=["id","key","value"];if(!(t<n||t>n))return e.doc.value}var r=xr.parseIndexableString(e.doc._id);return{key:r[0],id:r[1],value:"value"in e.doc?e.doc.value:null}})})}function r(n){var r;if(r=i?Mn(e,n,t):{total_rows:o,offset:a,rows:n},t.include_docs){var s=Ko(n.map(vn));return e.sourceDB.allDocs({keys:s,include_docs:!0,conflicts:t.conflicts,attachments:t.attachments,binary:t.binary}).then(function(e){var t={};return e.rows.forEach(function(e){e.doc&&(t["$"+e.id]=e.doc)}),n.forEach(function(e){var n=vn(e),r=t["$"+n];r&&(e.doc=r)}),r})}return r}var o,i=e.reduceFun&&!1!==t.reduce,a=t.skip||0;if(void 0===t.keys||t.keys.length||(t.limit=0,delete t.keys),void 0!==t.keys){var s=t.keys.map(function(e){return n({startkey:xr.toIndexableString([e]),endkey:xr.toIndexableString([e,{}])})});return Cr.all(s).then(D).then(r)}var c={descending:t.descending};if(t.start_key&&(t.startkey=t.start_key),t.end_key&&(t.endkey=t.end_key),void 0!==t.startkey&&(c.startkey=t.descending?xr.toIndexableString([t.startkey,{}]):xr.toIndexableString([t.startkey])),void 0!==t.endkey){var l=!1!==t.inclusive_end;t.descending&&(l=!l),c.endkey=xr.toIndexableString(l?[t.endkey,{}]:[t.endkey])}if(void 0!==t.key){var u=xr.toIndexableString([t.key]),p=xr.toIndexableString([t.key,{}]);c.descending?(c.endkey=u,c.startkey=p):(c.startkey=u,c.endkey=p)}return i||("number"==typeof t.limit&&(c.limit=t.limit),c.skip=a),n(c).then(r)}function Un(e){return e.request({method:"POST",url:"_view_cleanup"})}function Bn(e){return e.get("_local/mrviews").then(function(t){var n={};Object.keys(t.views).forEach(function(e){var t=pn(e),r="_design/"+t[0],o=t[1];n[r]=n[r]||{},n[r][o]=!0});var r={keys:Object.keys(n),include_docs:!0};return e.allDocs(r).then(function(r){var o={};r.rows.forEach(function(e){var r=e.key.substring(8);Object.keys(n[e.key]).forEach(function(n){var i=r+"/"+n;t.views[i]||(i=n);var a=Object.keys(t.views[i]),s=e.doc&&e.doc.views&&e.doc.views[n];a.forEach(function(e){o[e]=o[e]||s})})});var i=Object.keys(o).filter(function(e){return!o[e]}).map(function(t){return zo(Pn(t),function(){return new e.constructor(t,e.__opts).destroy()})()});return Cr.all(i).then(function(){return{ok:!0}})})},Dn({ok:!0}))}function Vn(e,t,r){if("http"===e.type())return Nn(e,t,r);if("function"==typeof e._query)return Tn(e,t,r);if("string"!=typeof t){Sn(r,t);var o={db:e,viewName:"temp_view/temp_view",map:t.map,reduce:t.reduce,temporary:!0};return Go.add(function(){return ln(o).then(function(e){return Wo(In(e).then(function(){return Ln(e,r)}),function(){return e.db.destroy()})})}),Go.finish()}var i=t,a=pn(i),s=a[0],c=a[1];return e.get("_design/"+s).then(function(t){var o=t.views&&t.views[c];if(!o||"string"!=typeof o.map)throw new Hn("ddoc "+s+" has no view named "+c);return Sn(r,o),ln({db:e,viewName:i,map:o.map,reduce:o.reduce}).then(function(e){return"ok"===r.stale||"update_after"===r.stale?("update_after"===r.stale&&n.nextTick(function(){In(e)}),Ln(e,r)):In(e).then(function(){return Ln(e,r)})})})}function qn(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,qn)}catch(e){}}function Hn(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,Hn)}catch(e){}}function Wn(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,Wn)}catch(e){}}function zn(e){return/^1-/.test(e)}function Kn(e,t,n){return!e._attachments||!e._attachments[n]||e._attachments[n].digest!==t._attachments[n].digest}function Yn(e,t){var n=Object.keys(t._attachments);return Cr.all(n.map(function(n){return e.getAttachment(t._id,n,{rev:t._rev})}))}function Gn(e,t,n){var r="http"===t.type()&&"http"!==e.type(),o=Object.keys(n._attachments);return r?e.get(n._id).then(function(r){return Cr.all(o.map(function(o){return Kn(r,n,o)?t.getAttachment(n._id,o):e.getAttachment(r._id,o)}))}).catch(function(e){if(404!==e.status)throw e;return Yn(t,n)}):Yn(t,n)}function $n(e){var t=[];return Object.keys(e).forEach(function(n){e[n].missing.forEach(function(e){t.push({id:n,rev:e})})}),{docs:t,revs:!0}}function Jn(e,t,n,r){function o(e){return e._attachments&&Object.keys(e._attachments).length>0}function i(t){return e.allDocs({keys:t,include_docs:!0}).then(function(e){if(r.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){!e.deleted&&e.doc&&zn(e.value.rev)&&!o(e.doc)&&(a.push(e.doc),delete n[e.id])})})}n=l(n);var a=[],s=!0;return Cr.resolve().then(function(){var e=Object.keys(n).filter(function(e){var t=n[e].missing;return 1===t.length&&zn(t[0])});if(e.length>0)return i(e)}).then(function(){var o=$n(n);if(o.docs.length)return e.bulkGet(o).then(function(n){if(r.cancelled)throw new Error("cancelled");return Cr.all(n.results.map(function(n){return Cr.all(n.docs.map(function(n){var r=n.ok;return n.error&&(s=!1),r&&r._attachments?Gn(t,e,r).then(function(e){var t=Object.keys(r._attachments);return e.forEach(function(e,n){var o=r._attachments[t[n]];delete o.stub,delete o.length,o.data=e}),r}):r}))})).then(function(e){a=a.concat(D(e).filter(Boolean))})})}).then(function(){return{ok:s,docs:a}})}function Xn(e,t,n,r,o){return e.get(t).catch(function(n){if(404===n.status)return"http"===e.type()&&x(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:r,_id:t,history:[],replicator:ti,version:ei};throw n}).then(function(i){if(!o.cancelled)return i.history=(i.history||[]).filter(function(e){return e.session_id!==r}),i.history.unshift({last_seq:n,session_id:r}),i.history=i.history.slice(0,ni),i.version=ei,i.replicator=ti,i.session_id=r,i.last_seq=n,e.put(i).catch(function(i){if(409===i.status)return Xn(e,t,n,r,o);throw i})})}function Qn(e,t,n,r){this.src=e,this.target=t,this.id=n,this.returnValue=r}function Zn(e,t){return e.session_id===t.session_id?{last_seq:e.last_seq,history:e.history}:er(e.history,t.history)}function er(e,t){var n=e[0],r=e.slice(1),o=t[0],i=t.slice(1);return n&&0!==t.length?tr(n.session_id,t)?{last_seq:n.last_seq,history:e}:tr(o.session_id,r)?{last_seq:o.last_seq,history:i}:er(r,i):{last_seq:ri,history:[]}}function tr(e,t){var n=t[0],r=t.slice(1);return!(!e||0===t.length)&&(e===n.session_id||tr(e,r))}function nr(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}function rr(e,t,n,r){if(!1===e.retry)return t.emit("error",n),void t.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=k),t.emit("requestError",n),"active"===t.state||"pending"===t.state){t.emit("paused",n),t.state="stopped";var o=function(){e.current_back_off=ii};t.once("paused",function(){t.removeListener("active",o)}),t.once("active",o)}e.current_back_off=e.current_back_off||ii,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(r,e.current_back_off)}function or(e){return Object.keys(e).sort(xr.collate).reduce(function(t,n){return t[n]=e[n],t},{})}function ir(e,t,n){var r=n.doc_ids?n.doc_ids.sort(xr.collate):"",o=n.filter?n.filter.toString():"",i="",a="";return n.filter&&n.query_params&&(i=JSON.stringify(or(n.query_params))),n.filter&&"_view"===n.filter&&(a=n.view.toString()),Cr.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+o+a+i+r;return new Cr(function(e){qe(t,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function ar(e,t,n,r,o){function i(){return k?Cr.resolve():ir(e,t,n).then(function(n){k=new Qn(e,t,w=n,r)})}function a(){if(L=[],0!==E.docs.length){var e=E.docs;return t.bulkDocs({docs:e,new_edits:!1}).then(function(t){if(r.cancelled)throw h(),new Error("cancelled");var n=[],i={};t.forEach(function(e){e.error&&(o.doc_write_failures++,n.push(e),i[e.id]=e)}),M=M.concat(n),o.docs_written+=E.docs.length-n.length;var a=n.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name});if(e.forEach(function(e){var t=i[e._id];t?r.emit("denied",l(t)):L.push(e)}),a.length>0){var s=new Error("bulkDocs error");throw s.other_errors=n,f("target.bulkDocs failed to write docs",s),new Error("bulkWrite partial failure")}},function(t){throw o.doc_write_failures+=e.length,t})}}function s(){if(E.error)throw new Error("There was a problem getting docs.");o.last_seq=D=E.seq;var e=l(o);return L.length&&(e.docs=L,r.emit("change",e)),S=!0,k.writeCheckpoint(E.seq,F).then(function(){if(S=!1,r.cancelled)throw h(),new Error("cancelled");E=void 0,y()}).catch(_)}function c(){var e={};return E.changes.forEach(function(t){"_user/"!==t.id&&(e[t.id]=t.changes.map(function(e){return e.rev}))}),t.revsDiff(e).then(function(e){if(r.cancelled)throw h(),new Error("cancelled");E.diffs=e})}function u(){return Jn(e,t,E.diffs,r).then(function(e){E.error=!e.ok,e.docs.forEach(function(e){delete E.diffs[e._id],o.docs_read++,E.docs.push(e)})})}function p(){r.cancelled||E||(0!==x.length?(E=x.shift(),c().then(u).then(a).then(s).then(p).catch(function(e){f("batch processing terminated with error",e)})):d(!0))}function d(e){0!==C.changes.length?(e||N||C.changes.length>=A)&&(x.push(C),C={seq:0,changes:[],docs:[]},"pending"!==r.state&&"stopped"!==r.state||(r.state="active",r.emit("active")),p()):0!==x.length||E||((R&&B.live||N)&&(r.state="pending",r.emit("paused")),N&&h())}function f(e,t){T||(t.message||(t.message=e),o.ok=!1,o.status="aborting",o.errors.push(t),M=M.concat(t),x=[],C={seq:0,changes:[],docs:[]},h())}function h(){if(!(T||r.cancelled&&(o.status="cancelled",S)))if(o.status=o.status||"complete",o.end_time=new Date,o.last_seq=D,T=!0,M.filter(function(e){return"unauthorized"!==e.name&&"forbidden"!==e.name}).length>0){var i=M.pop();M.length>0&&(i.other_errors=M),i.result=o,rr(n,r,i,function(){ar(e,t,n,r)})}else o.errors=M,r.emit("complete",o),r.removeAllListeners()}function m(e){if(r.cancelled)return h();O(n)(e)&&(C.seq=e.seq,C.changes.push(e),d(0===x.length&&B.live))}function g(e){if(I=!1,r.cancelled)return h();if(e.results.length>0)B.since=e.last_seq,y(),d(!0);else{var t=function(){R?(B.live=!0,y()):N=!0,d(!0)};E||0!==e.results.length?t():(S=!0,k.writeCheckpoint(e.last_seq,F).then(function(){S=!1,o.last_seq=D=e.last_seq,t()}).catch(_))}}function v(e){if(I=!1,r.cancelled)return h();f("changes rejected",e)}function y(){function t(){i.cancel()}function o(){r.removeListener("cancel",t)}if(!I&&!N&&x.length<P){I=!0,r._changes&&(r.removeListener("cancel",r._abortChanges),r._changes.cancel()),r.once("cancel",t);var i=e.changes(B).on("change",m);i.then(o,o),i.then(g).catch(v),n.retry&&(r._changes=i,r._abortChanges=t)}}function b(){i().then(function(){if(!r.cancelled)return k.getCheckpoint().then(function(e){B={since:D=e,limit:A,batch_size:A,style:"all_docs",doc_ids:j,return_docs:!0},n.filter&&("string"!=typeof n.filter?B.include_docs=!0:B.filter=n.filter),"heartbeat"in n&&(B.heartbeat=n.heartbeat),"timeout"in n&&(B.timeout=n.timeout),n.query_params&&(B.query_params=n.query_params),n.view&&(B.view=n.view),y()});h()}).catch(function(e){f("getCheckpoint rejected with ",e)})}function _(e){throw S=!1,f("writeCheckpoint completed with error",e),e}var E,w,k,x=[],C={seq:0,changes:[],docs:[]},S=!1,N=!1,T=!1,D=0,R=n.continuous||n.live||!1,A=n.batch_size||100,P=n.batches_limit||10,I=!1,j=n.doc_ids,M=[],L=[],F=U();o=o||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var B={};r.ready(e,t),r.cancelled?h():(r._addedListeners||(r.once("cancel",h),"function"==typeof n.complete&&(r.once("error",n.complete),r.once("complete",function(e){n.complete(null,e)})),r._addedListeners=!0),void 0===n.since?b():i().then(function(){return S=!0,k.writeCheckpoint(n.since,F)}).then(function(){S=!1,r.cancelled?h():(D=n.since,b())}).catch(_))}function sr(){br.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,t=new Cr(function(t,n){e.once("complete",t),e.once("error",n)});e.then=function(e,n){return t.then(e,n)},e.catch=function(e){return t.catch(e)},e.catch(function(){})}function cr(e,t){var n=t.PouchConstructor;return"string"==typeof e?new n(e,t):e}function lr(e,t,n,r){if("function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n.doc_ids&&!Array.isArray(n.doc_ids))throw S(Vr,"`doc_ids` filter parameter is not a list.");n.complete=r,(n=l(n)).continuous=n.continuous||n.live,n.retry="retry"in n&&n.retry,n.PouchConstructor=n.PouchConstructor||this;var o=new sr(n);return ar(cr(e,n),cr(t,n),n,o),o}function ur(e,t,n,r){return"function"==typeof n&&(r=n,n={}),void 0===n&&(n={}),n=l(n),n.PouchConstructor=n.PouchConstructor||this,e=cr(e,n),t=cr(t,n),new pr(e,t,n,r)}function pr(e,t,n,r){function o(e){f.emit("change",{direction:"pull",change:e})}function i(e){f.emit("change",{direction:"push",change:e})}function a(e){f.emit("denied",{direction:"push",doc:e})}function s(e){f.emit("denied",{direction:"pull",doc:e})}function c(){f.pushPaused=!0,f.pullPaused&&f.emit("paused")}function l(){f.pullPaused=!0,f.pushPaused&&f.emit("paused")}function u(){f.pushPaused=!1,f.pullPaused&&f.emit("active",{direction:"push"})}function p(){f.pullPaused=!1,f.pushPaused&&f.emit("active",{direction:"pull"})}function d(e){return function(t,n){var r="change"===t&&(n===o||n===i),d="denied"===t&&(n===s||n===a),h="paused"===t&&(n===l||n===c),m="active"===t&&(n===p||n===u);(r||d||h||m)&&(t in g||(g[t]={}),g[t][e]=!0,2===Object.keys(g[t]).length&&f.removeAllListeners(t))}}var f=this;this.canceled=!1;var h=n.push?fr.extend({},n,n.push):n,m=n.pull?fr.extend({},n,n.pull):n;this.push=lr(e,t,h),this.pull=lr(t,e,m),this.pushPaused=!0,this.pullPaused=!0;var g={};n.live&&(this.push.on("complete",f.pull.cancel.bind(f.pull)),this.pull.on("complete",f.push.cancel.bind(f.push))),this.on("newListener",function(e){"change"===e?(f.pull.on("change",o),f.push.on("change",i)):"denied"===e?(f.pull.on("denied",s),f.push.on("denied",a)):"active"===e?(f.pull.on("active",p),f.push.on("active",u)):"paused"===e&&(f.pull.on("paused",l),f.push.on("paused",c))}),this.on("removeListener",function(e){"change"===e?(f.pull.removeListener("change",o),f.push.removeListener("change",i)):"denied"===e?(f.pull.removeListener("denied",s),f.push.removeListener("denied",a)):"active"===e?(f.pull.removeListener("active",p),f.push.removeListener("active",u)):"paused"===e&&(f.pull.removeListener("paused",l),f.push.removeListener("paused",c))}),this.pull.on("removeListener",d("pull")),this.push.on("removeListener",d("push"));var v=Cr.all([this.push,this.pull]).then(function(e){var t={push:e[0],pull:e[1]};return f.emit("complete",t),r&&r(null,t),f.removeAllListeners(),t},function(e){if(f.cancel(),r?r(e):f.emit("error",e),f.removeAllListeners(),r)throw e});this.then=function(e,t){return v.then(e,t)},this.catch=function(e){return v.catch(e)}}var dr,fr=e("js-extend"),hr=o(e("debug")),mr=o(e("inherits")),gr=o(e("lie")),vr=e("pouchdb-collections"),yr=o(e("argsarray")),br=e("events"),_r=o(e("scope-eval")),Er=o(e("spark-md5")),wr=o(e("vuvuzela")),kr=o(e("es6-promise-pool")),xr=e("pouchdb-collate"),Cr="function"==typeof Promise?Promise:gr,Sr=Function.prototype.toString,Nr=Sr.call(Object),Tr=hr("pouchdb:api"),Or=6;if(v())dr=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),dr=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){dr=!1}mr(_,br.EventEmitter),_.prototype.addListener=function(e,t,n,r){function o(){if(i._listeners[t])if(a)a="waiting";else{a=!0;var e=f(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);n.changes(e).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===a&&setTimeout(function(){o()},0),a=!1}).on("error",function(){a=!1})}}if(!this._listeners[t]){var i=this,a=!1;this._listeners[t]=o,this.on(e,o)}},_.prototype.removeListener=function(e,t){t in this._listeners&&br.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t])},_.prototype.notifyLocalWindows=function(e){v()?chrome.storage.local.set({dbName:e}):y()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},_.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)},mr(C,Error),C.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};new C({status:401,error:"unauthorized",reason:"Name or password is incorrect."});var Dr=new C({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),Rr=new C({status:404,error:"not_found",reason:"missing"}),Ar=new C({status:409,error:"conflict",reason:"Document update conflict"}),Pr=new C({status:400,error:"bad_request",reason:"_id field must contain a string"}),Ir=new C({status:412,error:"missing_id",reason:"_id is required for puts"}),jr=new C({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),Mr=new C({status:412,error:"precondition_failed",reason:"Database not open"}),Lr=new C({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),Fr=new C({status:500,error:"badarg",reason:"Some query argument is invalid"}),Ur=(new C({status:400,error:"invalid_request",reason:"Request was invalid"}),new C({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"})),Br=new C({status:500,error:"doc_validation",reason:"Bad special document member"}),Vr=new C({status:400,error:"bad_request",reason:"Something wrong with the request"}),qr=new C({status:400,error:"bad_request",reason:"Document must be a JSON object"}),Hr=(new C({status:404,error:"not_found",reason:"Database not found"}),new C({status:500,error:"indexed_db_went_bad",reason:"unknown"})),Wr=new C({status:500,error:"web_sql_went_bad",reason:"unknown"}),zr=(new C({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),new C({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),new C({status:400,error:"bad_request",reason:"Invalid rev format"})),Kr=(new C({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),new C({status:412,error:"missing_stub"})),Yr=(new C({status:413,error:"invalid_url",reason:"Provided URL is invalid"}),["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"]),Gr="queryKey",$r=/(?:^|&)([^&=]*)=?([^&]*)/g,Jr=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Xr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");mr(le,br.EventEmitter),le.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},le.prototype.doChanges=function(e){var t=this,n=e.complete;if("live"in(e=l(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=ue,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(e.continuous&&"now"!==e.since&&this.db.info().then(function(e){t.startSeq=e.update_seq},function(e){if("idbNull"!==e.id)throw e}),e.view&&!e.filter&&(e.filter="_view"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=I(e.view):e.filter=I(e.filter),"http"!==this.db.type()&&!e.doc_ids))return this.filterChanges(e);"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=n;var r=this.db._changes(e);if(r&&"function"==typeof r.cancel){var o=t.cancel;t.cancel=yr(function(e){r.cancel(),o.apply(this,e)})}}else this.db.info().then(function(r){t.isCancelled?n(null,{status:"cancelled"}):(e.since=r.update_seq,t.doChanges(e))},n)},le.prototype.filterChanges=function(e){var t=this,n=e.complete;if("_view"===e.filter){if(!e.view||"string"!=typeof e.view){var r=S(Vr,"`view` filter parameter not found or invalid.");return n(r)}var o=P(e.view);this.db.get("_design/"+o[0],function(r,i){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(N(r));var a=i&&i.views&&i.views[o[1]]&&i.views[o[1]].map;if(!a)return n(S(Rr,i.views?"missing json key: "+o[1]:"missing json key: views"));e.filter=se(a),t.doChanges(e)})}else{var i=P(e.filter);if(!i)return t.doChanges(e);this.db.get("_design/"+i[0],function(r,o){if(t.isCancelled)return n(null,{status:"cancelled"});if(r)return n(N(r));var a=o&&o.filters&&o.filters[i[1]];if(!a)return n(S(Rr,o&&o.filters?"missing json key: "+i[1]:"missing json key: filters"));e.filter=ae(a),t.doChanges(e)})}},mr(_e,br.EventEmitter),_e.prototype.post=d("post",function(e,t,n){if("function"==typeof t&&(n=t,t={}),"object"!=typeof e||Array.isArray(e))return n(S(qr));this.bulkDocs({docs:[e]},t,fe(n))}),_e.prototype.put=d("put",yr(function(e){function t(){a||(E("warn","db.put(doc, id, rev) has been deprecated and will be removed in a future release, please use db.put({_id: id, _rev: rev}) instead"),a=!0)}var n,r,o,i,a=!1,s=e.shift(),c="_id"in s;if("object"!=typeof s||Array.isArray(s))return(i=e.pop())(S(qr));for(;;)if(n=e.shift(),"string"!==(r=typeof n)||c?"string"!==r||!c||"_rev"in s?"object"===r?o=n:"function"===r&&(i=n):(t(),s._rev=n):(t(),s._id=n,c=!0),!e.length)break;if(o=o||{},R(s._id),ie(s._id)&&"function"==typeof this._putLocal)return s._deleted?this._removeLocal(s,i):this._putLocal(s,i);this.bulkDocs({docs:[s]},o,fe(i))})),_e.prototype.putAttachment=d("putAttachment",function(e,t,n,r,o){function i(e){var n="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[t]={content_type:o,data:r,revpos:++n},a.put(e)}var a=this;return"function"==typeof o&&(o=r,r=n,n=null),void 0===o&&(o=r,r=n,n=null),a.get(e).then(function(e){if(e._rev!==n)throw S(Ar);return i(e)},function(t){if(t.reason===Rr.message)return i({_id:e});throw t})}),_e.prototype.removeAttachment=d("removeAttachment",function(e,t,n,r){var o=this;o.get(e,function(e,i){if(e)r(e);else if(i._rev===n){if(!i._attachments)return r();delete i._attachments[t],0===Object.keys(i._attachments).length&&delete i._attachments,o.put(i,r)}else r(S(Ar))})}),_e.prototype.remove=d("remove",function(e,t,n,r){var o;"string"==typeof t?(o={_id:e,_rev:t},"function"==typeof n&&(r=n,n={})):(o=e,"function"==typeof t?(r=t,n={}):(r=n,n=t)),(n=n||{}).was_delete=!0;var i={_id:o._id,_rev:o._rev||n.rev};if(i._deleted=!0,ie(i._id)&&"function"==typeof this._removeLocal)return this._removeLocal(o,r);this.bulkDocs({docs:[i]},n,fe(r))}),_e.prototype.revsDiff=d("revsDiff",function(e,t,n){function r(e,t){s.has(e)||s.set(e,{missing:[]}),s.get(e).missing.push(t)}function o(t,n){var o=e[t].slice(0);V(n,function(e,n,i,a,s){var c=n+"-"+i,l=o.indexOf(c);-1!==l&&(o.splice(l,1),"available"!==s.status&&r(t,c))}),o.forEach(function(e){r(t,e)})}"function"==typeof t&&(n=t,t={});var i=Object.keys(e);if(!i.length)return n(null,{});var a=0,s=new vr.Map;i.map(function(t){this._getRevisionTree(t,function(r,c){if(r&&404===r.status&&"missing"===r.message)s.set(t,{missing:e[t]});else{if(r)return n(r);o(t,c)}if(++a===i.length){var l={};return s.forEach(function(e,t){l[t]=e}),n(null,l)}})},this)}),_e.prototype.bulkGet=d("bulkGet",function(e,t){g(this,e,t)}),_e.prototype.compactDocument=d("compactDocument",function(e,t,n){var r=this;this._getRevisionTree(e,function(o,i){if(o)return n(o);var a=ge(i),s=[],c=[];Object.keys(a).forEach(function(e){a[e]>t&&s.push(e)}),V(i,function(e,t,n,r,o){var i=t+"-"+n;"available"===o.status&&-1!==s.indexOf(i)&&c.push(i)}),r._doCompaction(e,c,n)})}),_e.prototype.compact=d("compact",function(e,t){"function"==typeof e&&(t=e,e={});var n=this;e=e||{},n._compactionQueue=n._compactionQueue||[],n._compactionQueue.push({opts:e,callback:t}),1===n._compactionQueue.length&&ye(n)}),_e.prototype._compact=function(e,t){var n=this,r={return_docs:!1,last_seq:e.last_seq||0},o=[];n.changes(r).on("change",function(e){o.push(n.compactDocument(e.id,0))}).on("complete",function(e){var r=e.last_seq;Cr.all(o).then(function(){return M(n,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<r)&&(e.last_seq=r,e)})}).then(function(){t(null,{ok:!0})}).catch(t)}).on("error",t)},_e.prototype.get=d("get",function(e,t,n){function r(){var r=[],a=o.length;if(!a)return n(null,r);o.forEach(function(o){i.get(e,{rev:o,revs:t.revs,attachments:t.attachments},function(e,t){e?r.push({missing:o}):r.push({ok:t}),--a||n(null,r)})})}if("function"==typeof t&&(n=t,t={}),"string"!=typeof e)return n(S(Pr));if(ie(e)&&"function"==typeof this._getLocal)return this._getLocal(e,n);var o=[],i=this;if(!t.open_revs)return this._get(e,t,function(e,r){if(e)return n(e);var o=r.doc,a=r.metadata,s=r.ctx;if(t.conflicts){var c=W(a);c.length&&(o._conflicts=c)}if(oe(a,o._rev)&&(o._deleted=!0),t.revs||t.revs_info){var l=de(K(a.rev_tree),function(e){return-1!==e.ids.map(function(e){return e.id}).indexOf(o._rev.split("-")[1])}),u=l.ids.map(function(e){return e.id}).indexOf(o._rev.split("-")[1])+1,p=l.ids.length-u;if(l.ids.splice(u,p),l.ids.reverse(),t.revs&&(o._revisions={start:l.pos+l.ids.length-1,ids:l.ids.map(function(e){return e.id})}),t.revs_info){var d=l.pos+l.ids.length;o._revs_info=l.ids.map(function(e){return d--,{rev:d+"-"+e.id,status:e.opts.status}})}}if(t.attachments&&o._attachments){var f=o._attachments,h=Object.keys(f).length;if(0===h)return n(null,o);Object.keys(f).forEach(function(e){this._getAttachment(o._id,e,f[e],{rev:o._rev,binary:t.binary,ctx:s},function(t,r){var i=o._attachments[e];i.data=r,delete i.stub,delete i.length,--h||n(null,o)})},i)}else{if(o._attachments)for(var m in o._attachments)o._attachments.hasOwnProperty(m)&&(o._attachments[m].stub=!0);n(null,o)}});if("all"===t.open_revs)this._getRevisionTree(e,function(e,t){if(e)return n(e);o=H(t).map(function(e){return e.rev}),r()});else{if(!Array.isArray(t.open_revs))return n(S(Lr,"function_clause"));o=t.open_revs;for(var a=0;a<o.length;a++){var s=o[a];if("string"!=typeof s||!/^\d+-/.test(s))return n(S(zr))}r()}}),_e.prototype.getAttachment=d("getAttachment",function(e,t,n,r){var o=this;n instanceof Function&&(r=n,n={}),this._get(e,n,function(i,a){return i?r(i):a.doc._attachments&&a.doc._attachments[t]?(n.ctx=a.ctx,n.binary=!0,void o._getAttachment(e,t,a.doc._attachments[t],n,r)):r(S(Rr))})}),_e.prototype.allDocs=d("allDocs",function(e,t){if("function"==typeof e&&(t=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return t(new TypeError("options.keys must be an array"));var n=["startkey","endkey","key"].filter(function(t){return t in e})[0];if(n)return void t(S(Ur,"Query parameter `"+n+"` is not compatible with multi-get"));if("http"!==this.type())return ve(this,e,t)}return this._allDocs(e,t)}),_e.prototype.changes=function(e,t){return"function"==typeof e&&(t=e,e={}),new le(this,e,t)},_e.prototype.close=d("close",function(e){return this._closed=!0,this._close(e)}),_e.prototype.info=d("info",function(e){var t=this;this._info(function(n,r){if(n)return e(n);r.db_name=r.db_name||t._db_name,r.auto_compaction=!(!t.auto_compaction||"http"===t.type()),r.adapter=t.type(),e(null,r)})}),_e.prototype.id=d("id",function(e){return this._id(e)}),_e.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},_e.prototype.bulkDocs=d("bulkDocs",function(e,t,n){if("function"==typeof t&&(n=t,t={}),t=t||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return n(S(Dr));for(var r=0;r<e.docs.length;++r)if("object"!=typeof e.docs[r]||Array.isArray(e.docs[r]))return n(S(qr));var o;return e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(e){o=o||be(e)})}),o?n(S(Vr,o)):("new_edits"in t||(t.new_edits=!("new_edits"in e)||e.new_edits),t.new_edits||"http"===this.type()||e.docs.sort(me),he(e.docs),this._bulkDocs(e,t,function(e,r){if(e)return n(e);t.new_edits||(r=r.filter(function(e){return e.error})),n(null,r)}))}),_e.prototype.registerDependentDatabase=d("registerDependentDatabase",function(e,t){var n=new this.constructor(e,this.__opts);M(this,"_local/_pouch_dependentDbs",function(t){return t.dependentDbs=t.dependentDbs||{},!t.dependentDbs[e]&&(t.dependentDbs[e]=!0,t)}).then(function(){t(null,{db:n})}).catch(t)}),_e.prototype.destroy=d("destroy",function(e,t){function n(){r._destroy(e,function(e,n){if(e)return t(e);r._destroyed=!0,r.emit("destroyed"),t(null,n||{ok:!0})})}"function"==typeof e&&(t=e,e={});var r=this,o=!("use_prefix"in r)||r.use_prefix;if("http"===r.type())return n();r.get("_local/_pouch_dependentDbs",function(e,i){if(e)return 404!==e.status?t(e):n();var a=i.dependentDbs,s=r.constructor,c=Object.keys(a).map(function(e){var t=o?e.replace(new RegExp("^"+s.prefix),""):e;return new s(t,r.__opts).destroy()});Cr.all(c).then(n,t)})}),Ee.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},Ee.prototype.fail=function(e){this.failed=e,this.execute()},Ee.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},Ee.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},mr(xe,_e),xe.debug=hr,xe.adapters={},xe.preferredAdapters=[],xe.prefix="_pouch_";var Qr=new br.EventEmitter;!function(e){Object.keys(br.EventEmitter.prototype).forEach(function(t){"function"==typeof br.EventEmitter.prototype[t]&&(e[t]=Qr[t].bind(Qr))});var t=e._destructionListeners=new vr.Map;e.on("destroyed",function(e){t.get(e).forEach(function(e){e()}),t.delete(e)})}(xe),xe.parseAdapter=function(e,t){var n,r,o=e.match(/([a-z\-]*):\/\/(.*)/);if(o){if(e=/http(s?)/.test(o[1])?o[1]+"://"+o[2]:o[2],n=o[1],!xe.adapters[n].valid())throw"Invalid adapter";return{name:e,adapter:o[1]}}var i="idb"in xe.adapters&&"websql"in xe.adapters&&y()&&localStorage["_pouch__websqldb_"+xe.prefix+e];if(t.adapter)r=t.adapter;else if(void 0!==t&&t.db)r="leveldb";else for(var a=0;a<xe.preferredAdapters.length;++a)if((r=xe.preferredAdapters[a])in xe.adapters){if(i&&"idb"===r){E("log",'PouchDB is downgrading "'+e+'" to WebSQL to avoid data loss, because it was already opened with WebSQL.');continue}break}return{name:!((n=xe.adapters[r])&&"use_prefix"in n)||n.use_prefix?xe.prefix+e:e,adapter:r}},xe.adapter=function(e,t,n){t.valid()&&(xe.adapters[e]=t,n&&xe.preferredAdapters.push(e))},xe.plugin=function(e){return"function"==typeof e?e(xe):Object.keys(e).forEach(function(t){xe.prototype[t]=e[t]}),xe},xe.defaults=function(e){function t(n,r,o){if(!(this instanceof t))return new t(n,r,o);"function"!=typeof r&&void 0!==r||(o=r,r={}),n&&"object"==typeof n&&(r=n,n=void 0),r=fr.extend({},e,r),xe.call(this,n,r,o)}return mr(t,xe),t.preferredAdapters=xe.preferredAdapters.slice(),Object.keys(xe).forEach(function(e){e in t||(t[e]=xe[e])}),t};xe.version="5.4.5";var Zr,eo=Ce(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),to=Ce(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),no=function(e){return atob(e)},ro=function(e){return btoa(e)},oo=r.setImmediate||r.setTimeout,io=32768,ao=5,so="document-store",co="by-sequence",lo="attach-store",uo="attach-seq-store",po="meta-store",fo="local-store",ho="detect-blob-support",mo={running:!1,queue:[]},go=new vr.Map,vo=new _,yo=new vr.Map;vt.valid=function(){return!("undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform))&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange};var bo=7,_o=Ct("document-store"),Eo=Ct("by-sequence"),wo=Ct("attach-store"),ko=Ct("local-store"),xo=Ct("metadata-store"),Co=Ct("attach-seq-store"),So=new vr.Map,No=new _,To=1,Oo="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+Eo+" (seq, deleted)",Do="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+Eo+" (doc_id, rev)",Ro="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+_o+" (winningseq)",Ao="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+Co+" (seq)",Po="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+Co+" (digest, seq)",Io=Eo+".seq = "+_o+".winningseq",jo=Eo+".seq AS seq, "+Eo+".deleted AS deleted, "+Eo+".json AS data, "+Eo+".rev AS rev, "+_o+".json AS metadata";zt.valid=function(){return"undefined"!=typeof cordova||Ht()},zt.use_prefix=!0;var Mo=function(){try{return new XMLHttpRequest,!0}catch(e){return!1}}(),Lo=function(){},Fo=25,Uo=50,Bo={},Vo=1800,qo=hr("pouchdb:http");sn.valid=function(){return!0},cn.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},cn.prototype.finish=function(){return this.promise};var Ho=function(e,t){return t&&e.then(function(e){n.nextTick(function(){t(null,e)})},function(e){n.nextTick(function(){t(e)})}),e},Wo=function(e,t){return e.then(function(e){return t().then(function(){return e})},function(e){return t().then(function(){throw e})})},zo=function(e,t){return function(){var n=arguments,r=this;return e.add(function(){return t.apply(r,n)})}},Ko=function(e){for(var t={},n=0,r=e.length;n<r;n++)t["$"+e[n]]=!0;var o=Object.keys(t),i=new Array(o.length);for(n=0,r=o.length;n<r;n++)i[n]=o[n].substring(1);return i},Yo={},Go=new cn,$o=50,Jo=E.bind(null,"log"),Xo={_sum:function(e,t){return En(t)},_count:function(e,t){return t.length},_stats:function(e,t){return{sum:En(t),min:Math.min.apply(null,t),max:Math.max.apply(null,t),count:t.length,sumsqr:function(e){for(var t=0,n=0,r=e.length;n<r;n++){var o=e[n];t+=o*o}return t}(t)}}},Qo=function(e){return yr(function(t){var n=t.pop(),r=e.apply(this,t);return"function"==typeof n&&Ho(r,n),r})}(function(){var e=this;return"http"===e.type()?Un(e):"function"==typeof e._viewCleanup?On(e):Bn(e)});mr(qn,Error),mr(Hn,Error),mr(Wn,Error);var Zo={query:function(e,t,n){"function"==typeof t&&(n=t,t={}),t=t?xn(t):{},"function"==typeof e&&(e={map:e});var r=this,o=Cr.resolve().then(function(){return Vn(r,e,t)});return Ho(o,n),o},viewCleanup:Qo},ei=1,ti="pouchdb",ni=5,ri=0;Qn.prototype.writeCheckpoint=function(e,t){var n=this;return this.updateTarget(e,t).then(function(){return n.updateSource(e,t)})},Qn.prototype.updateTarget=function(e,t){return Xn(this.target,this.id,e,t,this.returnValue)},Qn.prototype.updateSource=function(e,t){var n=this;return this.readOnlySource?Cr.resolve(!0):Xn(this.src,this.id,e,t,this.returnValue).catch(function(e){if(nr(e))return n.readOnlySource=!0,!0;throw e})};var oi={undefined:function(e,t){return 0===xr.collate(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return Zn(t,e).last_seq}};Qn.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.readOnlySource?Cr.resolve(t.last_seq):e.src.get(e.id).then(function(e){if(t.version!==e.version)return ri;var n;return(n=t.version?t.version.toString():"undefined")in oi?oi[n](t,e):ri},function(n){if(404===n.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:ri}).then(function(){return ri},function(n){return nr(n)?(e.readOnlySource=!0,t.last_seq):ri});throw n})}).catch(function(e){if(404!==e.status)throw e;return ri})};var ii=0;mr(sr,br.EventEmitter),sr.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},sr.prototype.ready=function(e,t){function n(){r.cancel()}var r=this;r._readyCalled||(r._readyCalled=!0,e.once("destroyed",n),t.once("destroyed",n),r.once("complete",function(){e.removeListener("destroyed",n),t.removeListener("destroyed",n)}))},mr(pr,br.EventEmitter),pr.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},xe.plugin(function(e){e.adapter("idb",vt,!0)}).plugin(function(e){e.adapter("websql",zt,!0)}).plugin(function(e){e.adapter("http",sn,!1),e.adapter("https",sn,!1)}).plugin(Zo).plugin(function(e){e.replicate=lr,e.sync=ur}),t.exports=xe}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:146,argsarray:49,debug:134,"es6-promise-pool":68,events:69,inherits:136,"js-extend":103,lie:137,"pouchdb-collate":128,"pouchdb-collections":130,"scope-eval":293,"spark-md5":294,vuvuzela:312}],134:[function(e,t,n){function r(){var e;try{e=n.storage.debug}catch(e){}return e}(n=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var r="color: "+this.color,o=0,i=0;return(e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1)))[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r),e},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=r,n.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(r())},{"./debug":135}],135:[function(e,t,n){function r(){return n.colors[i++%n.colors.length]}(n=t.exports=function(e){function t(){}function i(){var e=i,t=+new Date,a=t-(o||t);e.diff=a,e.prev=o,e.curr=t,o=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=r());var s=Array.prototype.slice.call(arguments);s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var c=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,r){if("%%"===t)return t;c++;var o=n.formatters[r];if("function"==typeof o){var i=s[c];t=o.call(e,i),s.splice(c,1),c--}return t}),"function"==typeof n.formatArgs&&(s=n.formatArgs.apply(e,s)),(i.log||n.log||console.log.bind(console)).apply(e,s)}t.enabled=!1,i.enabled=!0;var a=n.enabled(e)?i:t;return a.namespace=e,a}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),r=t.length,o=0;o<r;o++)t[o]&&("-"===(e=t[o].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var o,i=0},{ms:138}],136:[function(e,t,n){arguments[4][53][0].apply(n,arguments)},{dup:53}],137:[function(e,t,n){"use strict";function r(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=h,this.queue=[],this.outcome=void 0,e!==r&&c(this,e)}function i(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){u(function(){var r;try{r=t(n)}catch(t){return p.reject(e,t)}r===e?p.reject(e,new TypeError("Cannot resolve promise with itself")):p.resolve(e,r)})}function s(e){var t=e&&e.then;if(e&&"object"==typeof e&&"function"==typeof t)return function(){t.apply(e,arguments)}}function c(e,t){function n(t){o||(o=!0,p.reject(e,t))}function r(t){o||(o=!0,p.resolve(e,t))}var o=!1,i=l(function(){t(r,n)});"error"===i.status&&n(i.value)}function l(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}var u=e("immediate"),p={},d=["REJECTED"],f=["FULFILLED"],h=["PENDING"];t.exports=o,o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===f||"function"!=typeof t&&this.state===d)return this;var n=new this.constructor(r);return this.state!==h?a(n,this.state===f?e:t,this.outcome):this.queue.push(new i(n,e,t)),n},i.prototype.callFulfilled=function(e){p.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){p.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},p.resolve=function(e,t){var n=l(s,t);if("error"===n.status)return p.reject(e,n.value);var r=n.value;if(r)c(e,r);else{e.state=f,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},p.reject=function(e,t){e.state=d,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},o.resolve=function(e){return e instanceof this?e:p.resolve(new this(r),e)},o.reject=function(e){var t=new this(r);return p.reject(t,e)},o.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var i=new Array(n),a=0,s=-1,c=new this(r);++s<n;)!function(e,r){t.resolve(e).then(function(e){i[r]=e,++a!==n||o||(o=!0,p.resolve(c,i))},function(e){o||(o=!0,p.reject(c,e))})}(e[s],s);return c},o.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,o=!1;if(!n)return this.resolve([]);for(var i=-1,a=new this(r);++i<n;)!function(e){t.resolve(e).then(function(e){o||(o=!0,p.resolve(a,e))},function(e){o||(o=!0,p.reject(a,e))})}(e[i]);return a}},{immediate:99}],138:[function(e,t,n){function r(e){if(!((e=""+e).length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*p;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*l;case"minutes":case"minute":case"mins":case"min":case"m":return n*c;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function o(e){return e>=u?Math.round(e/u)+"d":e>=l?Math.round(e/l)+"h":e>=c?Math.round(e/c)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function i(e){return a(e,u,"day")||a(e,l,"hour")||a(e,c,"minute")||a(e,s,"second")||e+" ms"}function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,c=60*s,l=60*c,u=24*l,p=365.25*u;t.exports=function(e,t){return t=t||{},"string"==typeof e?r(e):t.long?i(e):o(e)}},{}],139:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);l.call(this,e),u.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",o)}function o(){this.allowHalfOpen||this._writableState.ended||s(i,this)}function i(e){e.end()}var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=r;var s=e("process-nextick-args"),c=e("core-util-is");c.inherits=e("inherits");var l=e("./_stream_readable"),u=e("./_stream_writable");c.inherits(r,l);for(var p=a(u.prototype),d=0;d<p.length;d++){var f=p[d];r.prototype[f]||(r.prototype[f]=u.prototype[f])}},{"./_stream_readable":140,"./_stream_writable":142,"core-util-is":57,inherits:136,"process-nextick-args":145}],140:[function(e,t,n){(function(n){"use strict";function r(t,n){I=I||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof I&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(P||(P=e("string_decoder/").StringDecoder),this.decoder=new P(t.encoding),this.encoding=t.encoding)}function o(t){if(I=I||e("./_stream_duplex"),!(this instanceof o))return new o(t);this._readableState=new r(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),T.call(this)}function i(e,t,n,r,o){var i=l(t,n);if(i)e.emit("error",i);else if(null===n)t.reading=!1,u(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!o){s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&o){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var c;!t.decoder||o||r||(n=t.decoder.write(n),c=!t.objectMode&&0===n.length),o||(t.reading=!1),c||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&p(e))),f(e,t)}else o||(t.reading=!1);return a(t)}function a(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function s(e){return e>=j?e=j:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=s(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function l(e,t){var n=null;return N.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function u(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,p(e)}}function p(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(A("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?C(d,e):d(e))}function d(e){A("emit readable"),e.emit("readable"),b(e)}function f(e,t){t.readingMore||(t.readingMore=!0,C(h,e,t))}function h(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(A("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function m(e){return function(){var t=e._readableState;A("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&O(e,"data")&&(t.flowing=!0,b(e))}}function g(e){A("readable nexttick read 0"),e.read(0)}function v(e,t){t.resumeScheduled||(t.resumeScheduled=!0,C(y,e,t))}function y(e,t){t.reading||(A("resume read 0"),e.read(0)),t.resumeScheduled=!1,e.emit("resume"),b(e),t.flowing&&!t.reading&&e.read(0)}function b(e){var t=e._readableState;if(A("flow",t.flowing),t.flowing)do{var n=e.read()}while(null!==n&&t.flowing)}function _(e,t){var n,r=t.buffer,o=t.length,i=!!t.decoder,a=!!t.objectMode;if(0===r.length)return null;if(0===o)n=null;else if(a)n=r.shift();else if(!e||e>=o)n=i?r.join(""):1===r.length?r[0]:N.concat(r,o),r.length=0;else if(e<r[0].length)n=(u=r[0]).slice(0,e),r[0]=u.slice(e);else if(e===r[0].length)n=r.shift();else{n=i?"":new N(e);for(var s=0,c=0,l=r.length;c<l&&s<e;c++){var u=r[0],p=Math.min(e-s,u.length);i?n+=u.slice(0,p):u.copy(n,s,0,p),p<u.length?r[0]=u.slice(p):r.shift(),s+=p}}return n}function E(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");t.endEmitted||(t.ended=!0,C(w,t,e))}function w(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function k(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function x(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}t.exports=o;var C=e("process-nextick-args"),S=e("isarray"),N=e("buffer").Buffer;o.ReadableState=r;e("events");var T,O=function(e,t){return e.listeners(t).length};!function(){try{T=e("stream")}catch(e){}finally{T||(T=e("events").EventEmitter)}}();var N=e("buffer").Buffer,D=e("core-util-is");D.inherits=e("inherits");var R=e("util"),A=void 0;A=R&&R.debuglog?R.debuglog("stream"):function(){};var P;D.inherits(o,T);var I;o.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=new N(e,t),t=""),i(this,n,e,t,!1)},o.prototype.unshift=function(e){return i(this,this._readableState,e,"",!0)},o.prototype.isPaused=function(){return!1===this._readableState.flowing},o.prototype.setEncoding=function(t){return P||(P=e("string_decoder/").StringDecoder),this._readableState.decoder=new P(t),this._readableState.encoding=t,this};var j=8388608;o.prototype.read=function(e){A("read",e);var t=this._readableState,n=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return A("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?E(this):p(this),null;if(0===(e=c(e,t))&&t.ended)return 0===t.length&&E(this),null;var r=t.needReadable;A("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&A("length less than watermark",r=!0),(t.ended||t.reading)&&A("reading or ended",r=!1),r&&(A("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=c(n,t));var o;return null===(o=e>0?_(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),n!==e&&t.ended&&0===t.length&&E(this),null!==o&&this.emit("data",o),o},o.prototype._read=function(e){this.emit("error",new Error("not implemented"))},o.prototype.pipe=function(e,t){function r(e){A("onunpipe"),e===p&&i()}function o(){A("onend"),e.end()}function i(){A("cleanup"),e.removeListener("close",c),e.removeListener("finish",l),e.removeListener("drain",h),e.removeListener("error",s),e.removeListener("unpipe",r),p.removeListener("end",o),p.removeListener("end",i),p.removeListener("data",a),g=!0,!d.awaitDrain||e._writableState&&!e._writableState.needDrain||h()}function a(t){A("ondata"),!1===e.write(t)&&(1!==d.pipesCount||d.pipes[0]!==e||1!==p.listenerCount("data")||g||(A("false write response, pause",p._readableState.awaitDrain),p._readableState.awaitDrain++),p.pause())}function s(t){A("onerror",t),u(),e.removeListener("error",s),0===O(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",l),u()}function l(){A("onfinish"),e.removeListener("close",c),u()}function u(){A("unpipe"),p.unpipe(e)}var p=this,d=this._readableState;switch(d.pipesCount){case 0:d.pipes=e;break;case 1:d.pipes=[d.pipes,e];break;default:d.pipes.push(e)}d.pipesCount+=1,A("pipe count=%d opts=%j",d.pipesCount,t);var f=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?o:i;d.endEmitted?C(f):p.once("end",f),e.on("unpipe",r);var h=m(p);e.on("drain",h);var g=!1;return p.on("data",a),e._events&&e._events.error?S(e._events.error)?e._events.error.unshift(s):e._events.error=[s,e._events.error]:e.on("error",s),e.once("close",c),e.once("finish",l),e.emit("pipe",p),d.flowing||(A("pipe resume"),p.resume()),e},o.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this);return this}var i=x(t.pipes,e);return-1===i?this:(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},o.prototype.on=function(e,t){var n=T.prototype.on.call(this,e,t);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&!this._readableState.endEmitted){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&p(this):C(g,this))}return n},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){var e=this._readableState;return e.flowing||(A("resume"),e.flowing=!0,v(this,e)),this},o.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this},o.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(A("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(o){A("wrapped data"),t.decoder&&(o=t.decoder.write(o)),(!t.objectMode||null!==o&&void 0!==o)&&(t.objectMode||o&&o.length)&&(r.push(o)||(n=!0,e.pause()))});for(var o in e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));return k(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){A("wrapped _read",t),n&&(n=!1,e.resume())},r},o._fromList=_}).call(this,e("_process"))},{"./_stream_duplex":139,_process:146,buffer:56,"core-util-is":57,events:69,inherits:136,isarray:102,"process-nextick-args":145,"string_decoder/":296,util:52}],141:[function(e,t,n){"use strict";function r(e){this.afterTransform=function(t,n){return o(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function o(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),o(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}function i(e){if(!(this instanceof i))return new i(e);s.call(this,e),this._transformState=new r(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e){a(t,e)}):a(t)})}function a(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}t.exports=i;var s=e("./_stream_duplex"),c=e("core-util-is");c.inherits=e("inherits"),c.inherits(i,s),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,n){throw new Error("not implemented")},i.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},i.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},{"./_stream_duplex":139,"core-util-is":57,inherits:136}],142:[function(e,t,n){(function(n){"use strict";function r(){}function o(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function i(t,n){O=O||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof O&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:o,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var i=!1===t.decodeStrings;this.decodeStrings=!i,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){h(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this),this.corkedRequestsFree.next=new w(this)}function a(t){if(O=O||e("./_stream_duplex"),!(this instanceof a||this instanceof O))return new a(t);this._writableState=new i(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),N.call(this)}function s(e,t){var n=new Error("write after end");e.emit("error",n),k(t,n)}function c(e,t,n,r){var o=!0;if(!C.isBuffer(n)&&"string"!=typeof n&&null!==n&&void 0!==n&&!t.objectMode){var i=new TypeError("Invalid non-string/buffer chunk");e.emit("error",i),k(r,i),o=!1}return o}function l(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new C(t,n)),t}function u(e,t,n,r,i){n=l(t,n,r),C.isBuffer(n)&&(r="buffer");var a=t.objectMode?1:n.length;t.length+=a;var s=t.length<t.highWaterMark;if(s||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest=new o(n,r,i),c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else p(e,t,!1,a,n,r,i);return s}function p(e,t,n,r,o,i,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function d(e,t,n,r,o){--t.pendingcb,n?k(o,r):o(r),e._writableState.errorEmitted=!0,e.emit("error",r)}function f(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function h(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(f(n),t)d(e,n,r,t,o);else{var i=y(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||v(e,n),r?x(m,e,n,i,o):m(e,n,i,o)}}function m(e,t,n,r){n||g(e,t),t.pendingcb--,r(),_(e,t)}function g(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function v(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),i=t.corkedRequestsFree;i.entry=n;for(var a=0;n;)o[a]=n,n=n.next,a+=1;p(e,t,!0,t.length,o,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,t.corkedRequestsFree=i.next,i.next=null}else{for(;n;){var s=n.chunk,c=n.encoding,l=n.callback;if(p(e,t,!1,t.objectMode?1:s.length,s,c,l),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function y(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function b(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function _(e,t){var n=y(t);return n&&(0===t.pendingcb?(b(e,t),t.finished=!0,e.emit("finish")):b(e,t)),n}function E(e,t,n){t.ending=!0,_(e,t),n&&(t.finished?k(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function w(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var o=r.callback;e.pendingcb--,o(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}t.exports=a;var k=e("process-nextick-args"),x=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?setImmediate:k,C=e("buffer").Buffer;a.WritableState=i;var S=e("core-util-is");S.inherits=e("inherits");var N,T={deprecate:e("util-deprecate")};!function(){try{N=e("stream")}catch(e){}finally{N||(N=e("events").EventEmitter)}}();C=e("buffer").Buffer;S.inherits(a,N);i.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(i.prototype,"buffer",{get:T.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(e){}}();var O;a.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},a.prototype.write=function(e,t,n){var o=this._writableState,i=!1;return"function"==typeof t&&(n=t,t=null),C.isBuffer(e)?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=r),o.ended?s(this,n):c(this,o,e,n)&&(o.pendingcb++,i=u(this,o,e,t,n)),i},a.prototype.cork=function(){this._writableState.corked++},a.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||v(this,e))},a.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);this._writableState.defaultEncoding=e},a.prototype._write=function(e,t,n){n(new Error("not implemented"))},a.prototype._writev=null,a.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||E(this,r,n)}}).call(this,e("_process"))},{"./_stream_duplex":139,_process:146,buffer:56,"core-util-is":57,events:69,inherits:136,"process-nextick-args":145,"util-deprecate":311}],143:[function(e,t,n){t.exports=e("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":141}],144:[function(e,t,n){(function(n){function r(e){a.call(this,e),this._destroyed=!1}function o(e,t,n){n(null,e)}function i(e){return function(t,n,r){return"function"==typeof t&&(r=n,n=t,t={}),"function"!=typeof n&&(n=o),"function"!=typeof r&&(r=null),e(t,n,r)}}var a=e("readable-stream/transform"),s=e("util").inherits,c=e("xtend");s(r,a),r.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;n.nextTick(function(){e&&t.emit("error",e),t.emit("close")})}},t.exports=i(function(e,t,n){var o=new r(e);return o._transform=t,n&&(o._flush=n),o}),t.exports.ctor=i(function(e,t,n){function o(t){if(!(this instanceof o))return new o(t);this.options=c(e,t),r.call(this,this.options)}return s(o,r),o.prototype._transform=t,n&&(o.prototype._flush=n),o}),t.exports.obj=i(function(e,t,n){var o=new r(c({objectMode:!0,highWaterMark:16},e));return o._transform=t,n&&(o._flush=n),o})}).call(this,e("_process"))},{_process:146,"readable-stream/transform":143,util:55,xtend:313}],145:[function(e,t,n){(function(e){"use strict";!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports=function(t,n,r,o){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var i,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,o)});default:for(i=new Array(s-1),a=0;a<i.length;)i[a++]=arguments[a];return e.nextTick(function(){t.apply(null,i)})}}:t.exports=e.nextTick}).call(this,e("_process"))},{_process:146}],146:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function a(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){g&&h&&(g=!1,h.length?m=h.concat(m):v=-1,m.length&&c())}function c(){if(!g){var e=i(s);g=!0;for(var t=m.length;t;){for(h=m,m=[];++v<t;)h&&h[v].run();v=-1,t=m.length}h=null,g=!1,a(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var p,d,f=t.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(e){p=r}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(e){d=o}}();var h,m=[],g=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new l(e,t)),1!==m.length||g||i(c)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],147:[function(e,t,n){arguments[4][118][0].apply(n,arguments)},{dup:118}],148:[function(e,t,n){"use strict";t.exports=e("react/lib/ReactDOM")},{"react/lib/ReactDOM":183}],149:[function(e,t,n){"use strict";var r=e("./ReactMount"),o=e("./findDOMNode"),i=e("fbjs/lib/focusNode"),a={Mixin:{componentDidMount:function(){this.props.autoFocus&&i(o(this))}},focusDOMComponent:function(){i(r.getNode(this._rootNodeID))}};t.exports=a},{"./ReactMount":213,"./findDOMNode":256,"fbjs/lib/focusNode":79}],150:[function(e,t,n){"use strict";function r(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}function o(e){switch(e){case N.topCompositionStart:return T.compositionStart;case N.topCompositionEnd:return T.compositionEnd;case N.topCompositionUpdate:return T.compositionUpdate}}function i(e,t){return e===N.topKeyDown&&t.keyCode===_}function a(e,t){switch(e){case N.topKeyUp:return-1!==b.indexOf(t.keyCode);case N.topKeyDown:return t.keyCode!==_;case N.topKeyPress:case N.topMouseDown:case N.topBlur:return!0;default:return!1}}function s(e){var t=e.detail;return"object"==typeof t&&"data"in t?t.data:null}function c(e,t,n,r,c){var l,u;if(E?l=o(e):D?a(e,r)&&(l=T.compositionEnd):i(e,r)&&(l=T.compositionStart),!l)return null;x&&(D||l!==T.compositionStart?l===T.compositionEnd&&D&&(u=D.getData()):D=m.getPooled(t));var p=g.getPooled(l,n,r,c);if(u)p.data=u;else{var d=s(r);null!==d&&(p.data=d)}return f.accumulateTwoPhaseDispatches(p),p}function l(e,t){switch(e){case N.topCompositionEnd:return s(t);case N.topKeyPress:return t.which!==C?null:(O=!0,S);case N.topTextInput:var n=t.data;return n===S&&O?null:n;default:return null}}function u(e,t){if(D){if(e===N.topCompositionEnd||a(e,t)){var n=D.getData();return m.release(D),D=null,n}return null}switch(e){case N.topPaste:return null;case N.topKeyPress:return t.which&&!r(t)?String.fromCharCode(t.which):null;case N.topCompositionEnd:return x?null:t.data;default:return null}}function p(e,t,n,r,o){var i;if(!(i=k?l(e,r):u(e,r)))return null;var a=v.getPooled(T.beforeInput,n,r,o);return a.data=i,f.accumulateTwoPhaseDispatches(a),a}var d=e("./EventConstants"),f=e("./EventPropagators"),h=e("fbjs/lib/ExecutionEnvironment"),m=e("./FallbackCompositionState"),g=e("./SyntheticCompositionEvent"),v=e("./SyntheticInputEvent"),y=e("fbjs/lib/keyOf"),b=[9,13,27,32],_=229,E=h.canUseDOM&&"CompositionEvent"in window,w=null;h.canUseDOM&&"documentMode"in document&&(w=document.documentMode);var k=h.canUseDOM&&"TextEvent"in window&&!w&&!function(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}(),x=h.canUseDOM&&(!E||w&&w>8&&w<=11),C=32,S=String.fromCharCode(C),N=d.topLevelTypes,T={beforeInput:{phasedRegistrationNames:{bubbled:y({onBeforeInput:null}),captured:y({onBeforeInputCapture:null})},dependencies:[N.topCompositionEnd,N.topKeyPress,N.topTextInput,N.topPaste]},compositionEnd:{phasedRegistrationNames:{bubbled:y({onCompositionEnd:null}),captured:y({onCompositionEndCapture:null})},dependencies:[N.topBlur,N.topCompositionEnd,N.topKeyDown,N.topKeyPress,N.topKeyUp,N.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:y({onCompositionStart:null}),captured:y({onCompositionStartCapture:null})},dependencies:[N.topBlur,N.topCompositionStart,N.topKeyDown,N.topKeyPress,N.topKeyUp,N.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:y({onCompositionUpdate:null}),captured:y({onCompositionUpdateCapture:null})},dependencies:[N.topBlur,N.topCompositionUpdate,N.topKeyDown,N.topKeyPress,N.topKeyUp,N.topMouseDown]}},O=!1,D=null,R={eventTypes:T,extractEvents:function(e,t,n,r,o){return[c(e,t,n,r,o),p(e,0,n,r,o)]}};t.exports=R},{"./EventConstants":162,"./EventPropagators":166,"./FallbackCompositionState":167,"./SyntheticCompositionEvent":238,"./SyntheticInputEvent":242,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/keyOf":89}],151:[function(e,t,n){"use strict";function r(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var o={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0},i=["Webkit","ms","Moz","O"];Object.keys(o).forEach(function(e){i.forEach(function(t){o[r(t,e)]=o[e]})});var a={isUnitlessNumber:o,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.exports=a},{}],152:[function(e,t,n){(function(n){"use strict";var r=e("./CSSProperty"),o=e("fbjs/lib/ExecutionEnvironment"),i=e("./ReactPerf"),a=e("fbjs/lib/camelizeStyleName"),s=e("./dangerousStyleValue"),c=e("fbjs/lib/hyphenateStyleName"),l=e("fbjs/lib/memoizeStringOnly"),u=e("fbjs/lib/warning"),p=l(function(e){return c(e)}),d=!1,f="cssFloat";if(o.canUseDOM){var h=document.createElement("div").style;try{h.font=""}catch(e){d=!0}void 0===document.documentElement.style.cssFloat&&(f="styleFloat")}if("production"!==n.env.NODE_ENV)var m=/^(?:webkit|moz|o)[A-Z]/,g=/;\s*$/,v={},y={},b=function(e){v.hasOwnProperty(e)&&v[e]||(v[e]=!0,"production"!==n.env.NODE_ENV&&u(!1,"Unsupported style property %s. Did you mean %s?",e,a(e)))},_=function(e){v.hasOwnProperty(e)&&v[e]||(v[e]=!0,"production"!==n.env.NODE_ENV&&u(!1,"Unsupported vendor-prefixed style property %s. Did you mean %s?",e,e.charAt(0).toUpperCase()+e.slice(1)))},E=function(e,t){y.hasOwnProperty(t)&&y[t]||(y[t]=!0,"production"!==n.env.NODE_ENV&&u(!1,'Style property values shouldn\'t contain a semicolon. Try "%s: %s" instead.',e,t.replace(g,"")))},w=function(e,t){e.indexOf("-")>-1?b(e):m.test(e)?_(e):g.test(t)&&E(e,t)};var k={createMarkupForStyles:function(e){var t="";for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];"production"!==n.env.NODE_ENV&&w(r,o),null!=o&&(t+=p(r)+":",t+=s(r,o)+";")}return t||null},setValueForStyles:function(e,t){var o=e.style;for(var i in t)if(t.hasOwnProperty(i)){"production"!==n.env.NODE_ENV&&w(i,t[i]);var a=s(i,t[i]);if("float"===i&&(i=f),a)o[i]=a;else{var c=d&&r.shorthandPropertyExpansions[i];if(c)for(var l in c)o[l]="";else o[i]=""}}}};i.measureMethods(k,"CSSPropertyOperations",{setValueForStyles:"setValueForStyles"}),t.exports=k}).call(this,e("_process"))},{"./CSSProperty":151,"./ReactPerf":219,"./dangerousStyleValue":253,_process:146,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/camelizeStyleName":73,"fbjs/lib/hyphenateStyleName":84,"fbjs/lib/memoizeStringOnly":91,"fbjs/lib/warning":96}],153:[function(e,t,n){(function(n){"use strict";function r(){this._callbacks=null,this._contexts=null}var o=e("./PooledClass"),i=e("./Object.assign"),a=e("fbjs/lib/invariant");i(r.prototype,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){e.length!==t.length&&("production"!==n.env.NODE_ENV?a(!1,"Mismatched list of contexts in callback queue"):a(!1)),this._callbacks=null,this._contexts=null;for(var r=0;r<e.length;r++)e[r].call(t[r]);e.length=0,t.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),o.addPoolingTo(r),t.exports=r}).call(this,e("_process"))},{"./Object.assign":170,"./PooledClass":171,_process:146,"fbjs/lib/invariant":85}],154:[function(e,t,n){"use strict";function r(e){var t=e.nodeName&&e.nodeName.toLowerCase();return"select"===t||"input"===t&&"file"===e.type}function o(e){var t=k.getPooled(O.change,R,e,x(e));_.accumulateTwoPhaseDispatches(t),w.batchedUpdates(i,t)}function i(e){b.enqueueEvents(e),b.processEventQueue(!1)}function a(e,t){R=t,(D=e).attachEvent("onchange",o)}function s(){D&&(D.detachEvent("onchange",o),D=null,R=null)}function c(e,t,n){if(e===T.topChange)return n}function l(e,t,n){e===T.topFocus?(s(),a(t,n)):e===T.topBlur&&s()}function u(e,t){D=e,R=t,A=e.value,P=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(D,"value",M),D.attachEvent("onpropertychange",d)}function p(){D&&(delete D.value,D.detachEvent("onpropertychange",d),D=null,R=null,A=null,P=null)}function d(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==A&&(A=t,o(e))}}function f(e,t,n){if(e===T.topInput)return n}function h(e,t,n){e===T.topFocus?(p(),u(t,n)):e===T.topBlur&&p()}function m(e,t,n){if((e===T.topSelectionChange||e===T.topKeyUp||e===T.topKeyDown)&&D&&D.value!==A)return A=D.value,R}function g(e){return e.nodeName&&"input"===e.nodeName.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)}function v(e,t,n){if(e===T.topClick)return n}var y=e("./EventConstants"),b=e("./EventPluginHub"),_=e("./EventPropagators"),E=e("fbjs/lib/ExecutionEnvironment"),w=e("./ReactUpdates"),k=e("./SyntheticEvent"),x=e("./getEventTarget"),C=e("./isEventSupported"),S=e("./isTextInputElement"),N=e("fbjs/lib/keyOf"),T=y.topLevelTypes,O={change:{phasedRegistrationNames:{bubbled:N({onChange:null}),captured:N({onChangeCapture:null})},dependencies:[T.topBlur,T.topChange,T.topClick,T.topFocus,T.topInput,T.topKeyDown,T.topKeyUp,T.topSelectionChange]}},D=null,R=null,A=null,P=null,I=!1;E.canUseDOM&&(I=C("change")&&(!("documentMode"in document)||document.documentMode>8));var j=!1;E.canUseDOM&&(j=C("input")&&(!("documentMode"in document)||document.documentMode>9));var M={get:function(){return P.get.call(this)},set:function(e){A=""+e,P.set.call(this,e)}},L={eventTypes:O,extractEvents:function(e,t,n,o,i){var a,s;if(r(t)?I?a=c:s=l:S(t)?j?a=f:(a=m,s=h):g(t)&&(a=v),a){var u=a(e,t,n);if(u){var p=k.getPooled(O.change,u,o,i);return p.type="change",_.accumulateTwoPhaseDispatches(p),p}}s&&s(e,t,n)}};t.exports=L},{"./EventConstants":162,"./EventPluginHub":163,"./EventPropagators":166,"./ReactUpdates":231,"./SyntheticEvent":240,"./getEventTarget":262,"./isEventSupported":267,"./isTextInputElement":268,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/keyOf":89}],155:[function(e,t,n){"use strict";var r=0,o={createReactRootIndex:function(){return r++}};t.exports=o},{}],156:[function(e,t,n){(function(n){"use strict";function r(e,t,n){var r=n>=e.childNodes.length?null:e.childNodes.item(n);e.insertBefore(t,r)}var o=e("./Danger"),i=e("./ReactMultiChildUpdateTypes"),a=e("./ReactPerf"),s=e("./setInnerHTML"),c=e("./setTextContent"),l=e("fbjs/lib/invariant"),u={dangerouslyReplaceNodeWithMarkup:o.dangerouslyReplaceNodeWithMarkup,updateTextContent:c,processUpdates:function(e,t){for(var a,u=null,p=null,d=0;d<e.length;d++)if((a=e[d]).type===i.MOVE_EXISTING||a.type===i.REMOVE_NODE){var f=a.fromIndex,h=a.parentNode.childNodes[f],m=a.parentID;h||("production"!==n.env.NODE_ENV?l(!1,"processUpdates(): Unable to find child %s of element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables, nesting tags like <form>, <p>, or <a>, or using non-SVG elements in an <svg> parent. Try inspecting the child nodes of the element with React ID `%s`.",f,m):l(!1)),(u=u||{})[m]=u[m]||[],u[m][f]=h,(p=p||[]).push(h)}var g;if(g=t.length&&"string"==typeof t[0]?o.dangerouslyRenderMarkup(t):t,p)for(var v=0;v<p.length;v++)p[v].parentNode.removeChild(p[v]);for(var y=0;y<e.length;y++)switch((a=e[y]).type){case i.INSERT_MARKUP:r(a.parentNode,g[a.markupIndex],a.toIndex);break;case i.MOVE_EXISTING:r(a.parentNode,u[a.parentID][a.fromIndex],a.toIndex);break;case i.SET_MARKUP:s(a.parentNode,a.content);break;case i.TEXT_CONTENT:c(a.parentNode,a.content);break;case i.REMOVE_NODE:}}};a.measureMethods(u,"DOMChildrenOperations",{updateTextContent:"updateTextContent"}),t.exports=u}).call(this,e("_process"))},{"./Danger":159,"./ReactMultiChildUpdateTypes":215,"./ReactPerf":219,"./setInnerHTML":272,"./setTextContent":273,_process:146,"fbjs/lib/invariant":85}],157:[function(e,t,n){(function(n){"use strict";function r(e,t){return(e&t)===t}var o=e("fbjs/lib/invariant"),i={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=i,a=e.Properties||{},c=e.DOMAttributeNamespaces||{},l=e.DOMAttributeNames||{},u=e.DOMPropertyNames||{},p=e.DOMMutationMethods||{};e.isCustomAttribute&&s._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var d in a){s.properties.hasOwnProperty(d)&&("production"!==n.env.NODE_ENV?o(!1,"injectDOMPropertyConfig(...): You're trying to inject DOM property '%s' which has already been injected. You may be accidentally injecting the same DOM property config twice, or you may be injecting two configs that have conflicting property names.",d):o(!1));var f=d.toLowerCase(),h=a[d],m={attributeName:f,attributeNamespace:null,propertyName:d,mutationMethod:null,mustUseAttribute:r(h,t.MUST_USE_ATTRIBUTE),mustUseProperty:r(h,t.MUST_USE_PROPERTY),hasSideEffects:r(h,t.HAS_SIDE_EFFECTS),hasBooleanValue:r(h,t.HAS_BOOLEAN_VALUE),hasNumericValue:r(h,t.HAS_NUMERIC_VALUE),hasPositiveNumericValue:r(h,t.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:r(h,t.HAS_OVERLOADED_BOOLEAN_VALUE)};if(m.mustUseAttribute&&m.mustUseProperty&&("production"!==n.env.NODE_ENV?o(!1,"DOMProperty: Cannot require using both attribute and property: %s",d):o(!1)),!m.mustUseProperty&&m.hasSideEffects&&("production"!==n.env.NODE_ENV?o(!1,"DOMProperty: Properties that have side effects must use property: %s",d):o(!1)),m.hasBooleanValue+m.hasNumericValue+m.hasOverloadedBooleanValue<=1||("production"!==n.env.NODE_ENV?o(!1,"DOMProperty: Value can be one of boolean, overloaded boolean, or numeric value, but not a combination: %s",d):o(!1)),"production"!==n.env.NODE_ENV&&(s.getPossibleStandardName[f]=d),l.hasOwnProperty(d)){var g=l[d];m.attributeName=g,"production"!==n.env.NODE_ENV&&(s.getPossibleStandardName[g]=d)}c.hasOwnProperty(d)&&(m.attributeNamespace=c[d]),u.hasOwnProperty(d)&&(m.propertyName=u[d]),p.hasOwnProperty(d)&&(m.mutationMethod=p[d]),s.properties[d]=m}}},a={},s={ID_ATTRIBUTE_NAME:"data-reactid",properties:{},getPossibleStandardName:"production"!==n.env.NODE_ENV?{}:null,_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<s._isCustomAttributeFunctions.length;t++)if((0,s._isCustomAttributeFunctions[t])(e))return!0;return!1},getDefaultValueForProperty:function(e,t){var n,r=a[e];return r||(a[e]=r={}),t in r||(n=document.createElement(e),r[t]=n[t]),r[t]},injection:i};t.exports=s}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],158:[function(e,t,n){(function(n){"use strict";function r(e){return!!p.hasOwnProperty(e)||!u.hasOwnProperty(e)&&(l.test(e)?(p[e]=!0,!0):(u[e]=!0,"production"!==n.env.NODE_ENV&&c(!1,"Invalid attribute name: `%s`",e),!1))}function o(e,t){return null==t||e.hasBooleanValue&&!t||e.hasNumericValue&&isNaN(t)||e.hasPositiveNumericValue&&t<1||e.hasOverloadedBooleanValue&&!1===t}var i=e("./DOMProperty"),a=e("./ReactPerf"),s=e("./quoteAttributeValueForBrowser"),c=e("fbjs/lib/warning"),l=/^[a-zA-Z_][\w\.\-]*$/,u={},p={};if("production"!==n.env.NODE_ENV)var d={children:!0,dangerouslySetInnerHTML:!0,key:!0,ref:!0},f={},h=function(e){if(!(d.hasOwnProperty(e)&&d[e]||f.hasOwnProperty(e)&&f[e])){f[e]=!0;var t=e.toLowerCase(),r=i.isCustomAttribute(t)?t:i.getPossibleStandardName.hasOwnProperty(t)?i.getPossibleStandardName[t]:null;"production"!==n.env.NODE_ENV&&c(null==r,"Unknown DOM property %s. Did you mean %s?",e,r)}};var m={createMarkupForID:function(e){return i.ID_ATTRIBUTE_NAME+"="+s(e)},setAttributeForID:function(e,t){e.setAttribute(i.ID_ATTRIBUTE_NAME,t)},createMarkupForProperty:function(e,t){var r=i.properties.hasOwnProperty(e)?i.properties[e]:null;if(r){if(o(r,t))return"";var a=r.attributeName;return r.hasBooleanValue||r.hasOverloadedBooleanValue&&!0===t?a+'=""':a+"="+s(t)}return i.isCustomAttribute(e)?null==t?"":e+"="+s(t):("production"!==n.env.NODE_ENV&&h(e),null)},createMarkupForCustomAttribute:function(e,t){return r(e)&&null!=t?e+"="+s(t):""},setValueForProperty:function(e,t,r){var a=i.properties.hasOwnProperty(t)?i.properties[t]:null;if(a){var s=a.mutationMethod;if(s)s(e,r);else if(o(a,r))this.deleteValueForProperty(e,t);else if(a.mustUseAttribute){var c=a.attributeName,l=a.attributeNamespace;l?e.setAttributeNS(l,c,""+r):a.hasBooleanValue||a.hasOverloadedBooleanValue&&!0===r?e.setAttribute(c,""):e.setAttribute(c,""+r)}else{var u=a.propertyName;a.hasSideEffects&&""+e[u]==""+r||(e[u]=r)}}else i.isCustomAttribute(t)?m.setValueForAttribute(e,t,r):"production"!==n.env.NODE_ENV&&h(t)},setValueForAttribute:function(e,t,n){r(t)&&(null==n?e.removeAttribute(t):e.setAttribute(t,""+n))},deleteValueForProperty:function(e,t){var r=i.properties.hasOwnProperty(t)?i.properties[t]:null;if(r){var o=r.mutationMethod;if(o)o(e,void 0);else if(r.mustUseAttribute)e.removeAttribute(r.attributeName);else{var a=r.propertyName,s=i.getDefaultValueForProperty(e.nodeName,a);r.hasSideEffects&&""+e[a]===s||(e[a]=s)}}else i.isCustomAttribute(t)?e.removeAttribute(t):"production"!==n.env.NODE_ENV&&h(t)}};a.measureMethods(m,"DOMPropertyOperations",{setValueForProperty:"setValueForProperty",setValueForAttribute:"setValueForAttribute",deleteValueForProperty:"deleteValueForProperty"}),t.exports=m}).call(this,e("_process"))},{"./DOMProperty":157,"./ReactPerf":219,"./quoteAttributeValueForBrowser":270,_process:146,"fbjs/lib/warning":96}],159:[function(e,t,n){(function(n){"use strict";function r(e){return e.substring(1,e.indexOf(" "))}var o=e("fbjs/lib/ExecutionEnvironment"),i=e("fbjs/lib/createNodesFromMarkup"),a=e("fbjs/lib/emptyFunction"),s=e("fbjs/lib/getMarkupWrap"),c=e("fbjs/lib/invariant"),l=/^(<[^ \/>]+)/,u={dangerouslyRenderMarkup:function(e){o.canUseDOM||("production"!==n.env.NODE_ENV?c(!1,"dangerouslyRenderMarkup(...): Cannot render markup in a worker thread. Make sure `window` and `document` are available globally before requiring React when unit testing or use ReactDOMServer.renderToString for server rendering."):c(!1));for(var t,u={},p=0;p<e.length;p++)e[p]||("production"!==n.env.NODE_ENV?c(!1,"dangerouslyRenderMarkup(...): Missing markup."):c(!1)),t=r(e[p]),u[t=s(t)?t:"*"]=u[t]||[],u[t][p]=e[p];var d=[],f=0;for(t in u)if(u.hasOwnProperty(t)){var h,m=u[t];for(h in m)if(m.hasOwnProperty(h)){var g=m[h];m[h]=g.replace(l,'$1 data-danger-index="'+h+'" ')}for(var v=i(m.join(""),a),y=0;y<v.length;++y){var b=v[y];b.hasAttribute&&b.hasAttribute("data-danger-index")?(h=+b.getAttribute("data-danger-index"),b.removeAttribute("data-danger-index"),d.hasOwnProperty(h)&&("production"!==n.env.NODE_ENV?c(!1,"Danger: Assigning to an already-occupied result index."):c(!1)),d[h]=b,f+=1):"production"!==n.env.NODE_ENV&&console.error("Danger: Discarding unexpected node:",b)}}return f!==d.length&&("production"!==n.env.NODE_ENV?c(!1,"Danger: Did not assign to every index of resultList."):c(!1)),d.length!==e.length&&("production"!==n.env.NODE_ENV?c(!1,"Danger: Expected markup to render %s nodes, but rendered %s.",e.length,d.length):c(!1)),d},dangerouslyReplaceNodeWithMarkup:function(e,t){o.canUseDOM||("production"!==n.env.NODE_ENV?c(!1,"dangerouslyReplaceNodeWithMarkup(...): Cannot render markup in a worker thread. Make sure `window` and `document` are available globally before requiring React when unit testing or use ReactDOMServer.renderToString() for server rendering."):c(!1)),t||("production"!==n.env.NODE_ENV?c(!1,"dangerouslyReplaceNodeWithMarkup(...): Missing markup."):c(!1)),"html"===e.tagName.toLowerCase()&&("production"!==n.env.NODE_ENV?c(!1,"dangerouslyReplaceNodeWithMarkup(...): Cannot replace markup of the <html> node. This is because browser quirks make this unreliable and/or slow. If you want to render to the root you must use server rendering. See ReactDOMServer.renderToString()."):c(!1));var r;r="string"==typeof t?i(t,a)[0]:t,e.parentNode.replaceChild(r,e)}};t.exports=u}).call(this,e("_process"))},{_process:146,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/createNodesFromMarkup":76,"fbjs/lib/emptyFunction":77,"fbjs/lib/getMarkupWrap":81,"fbjs/lib/invariant":85}],160:[function(e,t,n){"use strict";var r=e("fbjs/lib/keyOf"),o=[r({ResponderEventPlugin:null}),r({SimpleEventPlugin:null}),r({TapEventPlugin:null}),r({EnterLeaveEventPlugin:null}),r({ChangeEventPlugin:null}),r({SelectEventPlugin:null}),r({BeforeInputEventPlugin:null})];t.exports=o},{"fbjs/lib/keyOf":89}],161:[function(e,t,n){"use strict";var r=e("./EventConstants"),o=e("./EventPropagators"),i=e("./SyntheticMouseEvent"),a=e("./ReactMount"),s=e("fbjs/lib/keyOf"),c=r.topLevelTypes,l=a.getFirstReactDOM,u={mouseEnter:{registrationName:s({onMouseEnter:null}),dependencies:[c.topMouseOut,c.topMouseOver]},mouseLeave:{registrationName:s({onMouseLeave:null}),dependencies:[c.topMouseOut,c.topMouseOver]}},p=[null,null],d={eventTypes:u,extractEvents:function(e,t,n,r,s){if(e===c.topMouseOver&&(r.relatedTarget||r.fromElement))return null;if(e!==c.topMouseOut&&e!==c.topMouseOver)return null;var d;if(t.window===t)d=t;else{var f=t.ownerDocument;d=f?f.defaultView||f.parentWindow:window}var h,m,g="",v="";if(e===c.topMouseOut?(h=t,g=n,(m=l(r.relatedTarget||r.toElement))?v=a.getID(m):m=d,m=m||d):(h=d,m=t,v=n),h===m)return null;var y=i.getPooled(u.mouseLeave,g,r,s);y.type="mouseleave",y.target=h,y.relatedTarget=m;var b=i.getPooled(u.mouseEnter,v,r,s);return b.type="mouseenter",b.target=m,b.relatedTarget=h,o.accumulateEnterLeaveDispatches(y,b,g,v),p[0]=y,p[1]=b,p}};t.exports=d},{"./EventConstants":162,"./EventPropagators":166,"./ReactMount":213,"./SyntheticMouseEvent":244,"fbjs/lib/keyOf":89}],162:[function(e,t,n){"use strict";var r=e("fbjs/lib/keyMirror"),o=r({bubbled:null,captured:null}),i={topLevelTypes:r({topAbort:null,topBlur:null,topCanPlay:null,topCanPlayThrough:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topDurationChange:null,topEmptied:null,topEncrypted:null,topEnded:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topLoadedData:null,topLoadedMetadata:null,topLoadStart:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topPause:null,topPlay:null,topPlaying:null,topProgress:null,topRateChange:null,topReset:null,topScroll:null,topSeeked:null,topSeeking:null,topSelectionChange:null,topStalled:null,topSubmit:null,topSuspend:null,topTextInput:null,topTimeUpdate:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topVolumeChange:null,topWaiting:null,topWheel:null}),PropagationPhases:o};t.exports=i},{"fbjs/lib/keyMirror":88}],163:[function(e,t,n){(function(n){"use strict";function r(){var e=g&&g.traverseTwoPhase&&g.traverseEnterLeave;"production"!==n.env.NODE_ENV&&u(e,"InstanceHandle not injected before use!")}var o=e("./EventPluginRegistry"),i=e("./EventPluginUtils"),a=e("./ReactErrorUtils"),s=e("./accumulateInto"),c=e("./forEachAccumulated"),l=e("fbjs/lib/invariant"),u=e("fbjs/lib/warning"),p={},d=null,f=function(e,t){e&&(i.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e))},h=function(e){return f(e,!0)},m=function(e){return f(e,!1)},g=null,v={injection:{injectMount:i.injection.injectMount,injectInstanceHandle:function(e){g=e,"production"!==n.env.NODE_ENV&&r()},getInstanceHandle:function(){return"production"!==n.env.NODE_ENV&&r(),g},injectEventPluginOrder:o.injectEventPluginOrder,injectEventPluginsByName:o.injectEventPluginsByName},eventNameDispatchConfigs:o.eventNameDispatchConfigs,registrationNameModules:o.registrationNameModules,putListener:function(e,t,r){"function"!=typeof r&&("production"!==n.env.NODE_ENV?l(!1,"Expected %s listener to be a function, instead got type %s",t,typeof r):l(!1)),(p[t]||(p[t]={}))[e]=r;var i=o.registrationNameModules[t];i&&i.didPutListener&&i.didPutListener(e,t,r)},getListener:function(e,t){var n=p[t];return n&&n[e]},deleteListener:function(e,t){var n=o.registrationNameModules[t];n&&n.willDeleteListener&&n.willDeleteListener(e,t);var r=p[t];r&&delete r[e]},deleteAllListeners:function(e){for(var t in p)if(p[t][e]){var n=o.registrationNameModules[t];n&&n.willDeleteListener&&n.willDeleteListener(e,t),delete p[t][e]}},extractEvents:function(e,t,n,r,i){for(var a,c=o.plugins,l=0;l<c.length;l++){var u=c[l];if(u){var p=u.extractEvents(e,t,n,r,i);p&&(a=s(a,p))}}return a},enqueueEvents:function(e){e&&(d=s(d,e))},processEventQueue:function(e){var t=d;d=null,e?c(t,h):c(t,m),d&&("production"!==n.env.NODE_ENV?l(!1,"processEventQueue(): Additional events were enqueued while processing an event queue. Support for this has not yet been implemented."):l(!1)),a.rethrowCaughtError()},__purge:function(){p={}},__getListenerBank:function(){return p}};t.exports=v}).call(this,e("_process"))},{"./EventPluginRegistry":164,"./EventPluginUtils":165,"./ReactErrorUtils":204,"./accumulateInto":250,"./forEachAccumulated":258,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],164:[function(e,t,n){(function(n){"use strict";function r(){if(s)for(var e in c){var t=c[e],r=s.indexOf(e);if(r>-1||("production"!==n.env.NODE_ENV?a(!1,"EventPluginRegistry: Cannot inject event plugins that do not exist in the plugin ordering, `%s`.",e):a(!1)),!l.plugins[r]){t.extractEvents||("production"!==n.env.NODE_ENV?a(!1,"EventPluginRegistry: Event plugins must implement an `extractEvents` method, but `%s` does not.",e):a(!1)),l.plugins[r]=t;var i=t.eventTypes;for(var u in i)o(i[u],t,u)||("production"!==n.env.NODE_ENV?a(!1,"EventPluginRegistry: Failed to publish event `%s` for plugin `%s`.",u,e):a(!1))}}}function o(e,t,r){l.eventNameDispatchConfigs.hasOwnProperty(r)&&("production"!==n.env.NODE_ENV?a(!1,"EventPluginHub: More than one plugin attempted to publish the same event name, `%s`.",r):a(!1)),l.eventNameDispatchConfigs[r]=e;var o=e.phasedRegistrationNames;if(o){for(var s in o)o.hasOwnProperty(s)&&i(o[s],t,r);return!0}return!!e.registrationName&&(i(e.registrationName,t,r),!0)}function i(e,t,r){l.registrationNameModules[e]&&("production"!==n.env.NODE_ENV?a(!1,"EventPluginHub: More than one plugin attempted to publish the same registration name, `%s`.",e):a(!1)),l.registrationNameModules[e]=t,l.registrationNameDependencies[e]=t.eventTypes[r].dependencies}var a=e("fbjs/lib/invariant"),s=null,c={},l={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){s&&("production"!==n.env.NODE_ENV?a(!1,"EventPluginRegistry: Cannot inject event plugin ordering more than once. You are likely trying to load more than one copy of React."):a(!1)),s=Array.prototype.slice.call(e),r()},injectEventPluginsByName:function(e){var t=!1;for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];c.hasOwnProperty(o)&&c[o]===i||(c[o]&&("production"!==n.env.NODE_ENV?a(!1,"EventPluginRegistry: Cannot inject two different event plugins using the same name, `%s`.",o):a(!1)),c[o]=i,t=!0)}t&&r()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return l.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(n)){var r=l.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r}return null},_resetEventPlugins:function(){s=null;for(var e in c)c.hasOwnProperty(e)&&delete c[e];l.plugins.length=0;var t=l.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var r=l.registrationNameModules;for(var o in r)r.hasOwnProperty(o)&&delete r[o]}};t.exports=l}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],165:[function(e,t,n){(function(n){"use strict";function r(e,t,n,r){var o=e.type||"unknown-event";e.currentTarget=u.Mount.getNode(r),t?s.invokeGuardedCallbackWithCatch(o,n,e,r):s.invokeGuardedCallback(o,n,e,r),e.currentTarget=null}function o(e){var t=e._dispatchListeners,r=e._dispatchIDs;if("production"!==n.env.NODE_ENV&&i(e),Array.isArray(t)){for(var o=0;o<t.length&&!e.isPropagationStopped();o++)if(t[o](e,r[o]))return r[o]}else if(t&&t(e,r))return r;return null}var i,a=e("./EventConstants"),s=e("./ReactErrorUtils"),c=e("fbjs/lib/invariant"),l=e("fbjs/lib/warning"),u={Mount:null,injectMount:function(e){u.Mount=e,"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&l(e&&e.getNode&&e.getID,"EventPluginUtils.injection.injectMount(...): Injected Mount module is missing getNode or getID.")}},p=a.topLevelTypes;"production"!==n.env.NODE_ENV&&(i=function(e){var t=e._dispatchListeners,r=e._dispatchIDs,o=Array.isArray(t),i=Array.isArray(r),a=i?r.length:r?1:0,s=o?t.length:t?1:0;"production"!==n.env.NODE_ENV&&l(i===o&&a===s,"EventPluginUtils: Invalid `event`.")});var d={isEndish:function(e){return e===p.topMouseUp||e===p.topTouchEnd||e===p.topTouchCancel},isMoveish:function(e){return e===p.topMouseMove||e===p.topTouchMove},isStartish:function(e){return e===p.topMouseDown||e===p.topTouchStart},executeDirectDispatch:function(e){"production"!==n.env.NODE_ENV&&i(e);var t=e._dispatchListeners,r=e._dispatchIDs;Array.isArray(t)&&("production"!==n.env.NODE_ENV?c(!1,"executeDirectDispatch(...): Invalid `event`."):c(!1));var o=t?t(e,r):null;return e._dispatchListeners=null,e._dispatchIDs=null,o},executeDispatchesInOrder:function(e,t){var o=e._dispatchListeners,a=e._dispatchIDs;if("production"!==n.env.NODE_ENV&&i(e),Array.isArray(o))for(var s=0;s<o.length&&!e.isPropagationStopped();s++)r(e,t,o[s],a[s]);else o&&r(e,t,o,a);e._dispatchListeners=null,e._dispatchIDs=null},executeDispatchesInOrderStopAtTrue:function(e){var t=o(e);return e._dispatchIDs=null,e._dispatchListeners=null,t},hasDispatches:function(e){return!!e._dispatchListeners},getNode:function(e){return u.Mount.getNode(e)},getID:function(e){return u.Mount.getID(e)},injection:u};t.exports=d}).call(this,e("_process"))},{"./EventConstants":162,"./ReactErrorUtils":204,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],166:[function(e,t,n){(function(n){"use strict";function r(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return m(e,r)}function o(e,t,o){"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&p(e,"Dispatching id must not be null");var i=r(e,o,t?h.bubbled:h.captured);i&&(o._dispatchListeners=d(o._dispatchListeners,i),o._dispatchIDs=d(o._dispatchIDs,e))}function i(e){e&&e.dispatchConfig.phasedRegistrationNames&&u.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,o,e)}function a(e){e&&e.dispatchConfig.phasedRegistrationNames&&u.injection.getInstanceHandle().traverseTwoPhaseSkipTarget(e.dispatchMarker,o,e)}function s(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,o=m(e,r);o&&(n._dispatchListeners=d(n._dispatchListeners,o),n._dispatchIDs=d(n._dispatchIDs,e))}}function c(e){e&&e.dispatchConfig.registrationName&&s(e.dispatchMarker,null,e)}var l=e("./EventConstants"),u=e("./EventPluginHub"),p=e("fbjs/lib/warning"),d=e("./accumulateInto"),f=e("./forEachAccumulated"),h=l.PropagationPhases,m=u.getListener,g={accumulateTwoPhaseDispatches:function(e){f(e,i)},accumulateTwoPhaseDispatchesSkipTarget:function(e){f(e,a)},accumulateDirectDispatches:function(e){f(e,c)},accumulateEnterLeaveDispatches:function(e,t,n,r){u.injection.getInstanceHandle().traverseEnterLeave(n,r,s,e,t)}};t.exports=g}).call(this,e("_process"))},{"./EventConstants":162,"./EventPluginHub":163,"./accumulateInto":250,"./forEachAccumulated":258,_process:146,"fbjs/lib/warning":96}],167:[function(e,t,n){"use strict";function r(e){this._root=e,this._startText=this.getText(),this._fallbackText=null}var o=e("./PooledClass"),i=e("./Object.assign"),a=e("./getTextContentAccessor");i(r.prototype,{destructor:function(){this._root=null,this._startText=null,this._fallbackText=null},getText:function(){return"value"in this._root?this._root.value:this._root[a()]},getData:function(){if(this._fallbackText)return this._fallbackText;var e,t,n=this._startText,r=n.length,o=this.getText(),i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);var s=t>1?1-t:void 0;return this._fallbackText=o.slice(e,s),this._fallbackText}}),o.addPoolingTo(r),t.exports=r},{"./Object.assign":170,"./PooledClass":171,"./getTextContentAccessor":265}],168:[function(e,t,n){"use strict";var r,o=e("./DOMProperty"),i=e("fbjs/lib/ExecutionEnvironment"),a=o.injection.MUST_USE_ATTRIBUTE,s=o.injection.MUST_USE_PROPERTY,c=o.injection.HAS_BOOLEAN_VALUE,l=o.injection.HAS_SIDE_EFFECTS,u=o.injection.HAS_NUMERIC_VALUE,p=o.injection.HAS_POSITIVE_NUMERIC_VALUE,d=o.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(i.canUseDOM){var f=document.implementation;r=f&&f.hasFeature&&f.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var h={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:a|c,allowTransparency:a,alt:null,async:c,autoComplete:null,autoPlay:c,capture:a|c,cellPadding:null,cellSpacing:null,charSet:a,challenge:a,checked:s|c,classID:a,className:r?a:s,cols:a|p,colSpan:null,content:null,contentEditable:null,contextMenu:a,controls:s|c,coords:null,crossOrigin:null,data:null,dateTime:a,default:c,defer:c,dir:null,disabled:a|c,download:d,draggable:null,encType:null,form:a,formAction:a,formEncType:a,formMethod:a,formNoValidate:c,formTarget:a,frameBorder:a,headers:null,height:a,hidden:a|c,high:null,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:s,inputMode:a,integrity:null,is:a,keyParams:a,keyType:a,kind:null,label:null,lang:null,list:a,loop:s|c,low:null,manifest:a,marginHeight:null,marginWidth:null,max:null,maxLength:a,media:a,mediaGroup:null,method:null,min:null,minLength:a,multiple:s|c,muted:s|c,name:null,nonce:a,noValidate:c,open:c,optimum:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:s|c,rel:null,required:c,reversed:c,role:a,rows:a|p,rowSpan:null,sandbox:null,scope:null,scoped:c,scrolling:null,seamless:a|c,selected:s|c,shape:null,size:a|p,sizes:a,span:p,spellCheck:null,src:null,srcDoc:s,srcLang:null,srcSet:a,start:u,step:null,style:null,summary:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:s|l,width:a,wmode:a,wrap:null,about:a,datatype:a,inlist:a,prefix:a,property:a,resource:a,typeof:a,vocab:a,autoCapitalize:a,autoCorrect:a,autoSave:null,color:null,itemProp:a,itemScope:a|c,itemType:a,itemID:a,itemRef:a,results:null,security:a,unselectable:a},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoComplete:"autocomplete",autoFocus:"autofocus",autoPlay:"autoplay",autoSave:"autosave",encType:"encoding",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=h},{"./DOMProperty":157,"fbjs/lib/ExecutionEnvironment":71}],169:[function(e,t,n){(function(n){"use strict";function r(e){null!=e.checkedLink&&null!=e.valueLink&&("production"!==n.env.NODE_ENV?l(!1,"Cannot provide a checkedLink and a valueLink. If you want to use checkedLink, you probably don't want to use valueLink and vice versa."):l(!1))}function o(e){r(e),(null!=e.value||null!=e.onChange)&&("production"!==n.env.NODE_ENV?l(!1,"Cannot provide a valueLink and a value or onChange event. If you want to use value or onChange, you probably don't want to use valueLink."):l(!1))}function i(e){r(e),(null!=e.checked||null!=e.onChange)&&("production"!==n.env.NODE_ENV?l(!1,"Cannot provide a checkedLink and a checked property or onChange event. If you want to use checked or onChange, you probably don't want to use checkedLink"):l(!1))}function a(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}var s=e("./ReactPropTypes"),c=e("./ReactPropTypeLocations"),l=e("fbjs/lib/invariant"),u=e("fbjs/lib/warning"),p={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},d={value:function(e,t,n){return!e[t]||p[e.type]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t,n){return!e[t]||e.onChange||e.readOnly||e.disabled?null:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:s.func},f={},h={checkPropTypes:function(e,t,r){for(var o in d){if(d.hasOwnProperty(o))var i=d[o](t,o,e,c.prop,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(i instanceof Error&&!(i.message in f)){f[i.message]=!0;var s=a(r);"production"!==n.env.NODE_ENV&&u(!1,"Failed form propType: %s%s",i.message,s)}}},getValue:function(e){return e.valueLink?(o(e),e.valueLink.value):e.value},getChecked:function(e){return e.checkedLink?(i(e),e.checkedLink.value):e.checked},executeOnChange:function(e,t){return e.valueLink?(o(e),e.valueLink.requestChange(t.target.value)):e.checkedLink?(i(e),e.checkedLink.requestChange(t.target.checked)):e.onChange?e.onChange.call(void 0,t):void 0}};t.exports=h}).call(this,e("_process"))},{"./ReactPropTypeLocations":221,"./ReactPropTypes":222,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],170:[function(e,t,n){"use strict";t.exports=function(e,t){if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");for(var n=Object(e),r=Object.prototype.hasOwnProperty,o=1;o<arguments.length;o++){var i=arguments[o];if(null!=i){var a=Object(i);for(var s in a)r.call(a,s)&&(n[s]=a[s])}}return n}},{}],171:[function(e,t,n){(function(n){"use strict";var r=e("fbjs/lib/invariant"),o=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},i=function(e){var t=this;e instanceof t||("production"!==n.env.NODE_ENV?r(!1,"Trying to release an instance into a pool of a different type."):r(!1)),e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},a=o,s={addPoolingTo:function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||a,n.poolSize||(n.poolSize=10),n.release=i,n},oneArgumentPooler:o,twoArgumentPooler:function(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r}return new n(e,t)},threeArgumentPooler:function(e,t,n){var r=this;if(r.instancePool.length){var o=r.instancePool.pop();return r.call(o,e,t,n),o}return new r(e,t,n)},fourArgumentPooler:function(e,t,n,r){var o=this;if(o.instancePool.length){var i=o.instancePool.pop();return o.call(i,e,t,n,r),i}return new o(e,t,n,r)},fiveArgumentPooler:function(e,t,n,r,o){var i=this;if(i.instancePool.length){var a=i.instancePool.pop();return i.call(a,e,t,n,r,o),a}return new i(e,t,n,r,o)}};t.exports=s}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],172:[function(e,t,n){"use strict";var r=e("./ReactDOM"),o=e("./ReactDOMServer"),i=e("./ReactIsomorphic"),a=e("./Object.assign"),s=e("./deprecated"),c={};a(c,i),a(c,{findDOMNode:s("findDOMNode","ReactDOM","react-dom",r,r.findDOMNode),render:s("render","ReactDOM","react-dom",r,r.render),unmountComponentAtNode:s("unmountComponentAtNode","ReactDOM","react-dom",r,r.unmountComponentAtNode),renderToString:s("renderToString","ReactDOMServer","react-dom/server",o,o.renderToString),renderToStaticMarkup:s("renderToStaticMarkup","ReactDOMServer","react-dom/server",o,o.renderToStaticMarkup)}),c.__SECRET_DOM_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=r,c.__SECRET_DOM_SERVER_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o,t.exports=c},{"./Object.assign":170,"./ReactDOM":183,"./ReactDOMServer":193,"./ReactIsomorphic":211,"./deprecated":254}],173:[function(e,t,n){(function(n){"use strict";var r=e("./ReactInstanceMap"),o=e("./findDOMNode"),i=e("fbjs/lib/warning"),a={getDOMNode:function(){return"production"!==n.env.NODE_ENV&&i(this.constructor._getDOMNodeDidWarn,"%s.getDOMNode(...) is deprecated. Please use ReactDOM.findDOMNode(instance) instead.",r.get(this).getName()||this.tagName||"Unknown"),this.constructor._getDOMNodeDidWarn=!0,o(this)}};t.exports=a}).call(this,e("_process"))},{"./ReactInstanceMap":210,"./findDOMNode":256,_process:146,"fbjs/lib/warning":96}],174:[function(e,t,n){"use strict";function r(e){return Object.prototype.hasOwnProperty.call(e,g)||(e[g]=h++,d[e[g]]={}),d[e[g]]}var o=e("./EventConstants"),i=e("./EventPluginHub"),a=e("./EventPluginRegistry"),s=e("./ReactEventEmitterMixin"),c=e("./ReactPerf"),l=e("./ViewportMetrics"),u=e("./Object.assign"),p=e("./isEventSupported"),d={},f=!1,h=0,m={topAbort:"abort",topBlur:"blur",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},g="_reactListenersID"+String(Math.random()).slice(2),v=u({},s,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(v.handleTopLevel),v.ReactEventListener=e}},setEnabled:function(e){v.ReactEventListener&&v.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!v.ReactEventListener||!v.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var n=t,i=r(n),s=a.registrationNameDependencies[e],c=o.topLevelTypes,l=0;l<s.length;l++){var u=s[l];i.hasOwnProperty(u)&&i[u]||(u===c.topWheel?p("wheel")?v.ReactEventListener.trapBubbledEvent(c.topWheel,"wheel",n):p("mousewheel")?v.ReactEventListener.trapBubbledEvent(c.topWheel,"mousewheel",n):v.ReactEventListener.trapBubbledEvent(c.topWheel,"DOMMouseScroll",n):u===c.topScroll?p("scroll",!0)?v.ReactEventListener.trapCapturedEvent(c.topScroll,"scroll",n):v.ReactEventListener.trapBubbledEvent(c.topScroll,"scroll",v.ReactEventListener.WINDOW_HANDLE):u===c.topFocus||u===c.topBlur?(p("focus",!0)?(v.ReactEventListener.trapCapturedEvent(c.topFocus,"focus",n),v.ReactEventListener.trapCapturedEvent(c.topBlur,"blur",n)):p("focusin")&&(v.ReactEventListener.trapBubbledEvent(c.topFocus,"focusin",n),v.ReactEventListener.trapBubbledEvent(c.topBlur,"focusout",n)),i[c.topBlur]=!0,i[c.topFocus]=!0):m.hasOwnProperty(u)&&v.ReactEventListener.trapBubbledEvent(u,m[u],n),i[u]=!0)}},trapBubbledEvent:function(e,t,n){return v.ReactEventListener.trapBubbledEvent(e,t,n)},trapCapturedEvent:function(e,t,n){return v.ReactEventListener.trapCapturedEvent(e,t,n)},ensureScrollValueMonitoring:function(){if(!f){var e=l.refreshScrollValues;v.ReactEventListener.monitorScrollValue(e),f=!0}},eventNameDispatchConfigs:i.eventNameDispatchConfigs,registrationNameModules:i.registrationNameModules,putListener:i.putListener,getListener:i.getListener,deleteListener:i.deleteListener,deleteAllListeners:i.deleteAllListeners});c.measureMethods(v,"ReactBrowserEventEmitter",{putListener:"putListener",deleteListener:"deleteListener"}),t.exports=v},{"./EventConstants":162,"./EventPluginHub":163,"./EventPluginRegistry":164,"./Object.assign":170,"./ReactEventEmitterMixin":205,"./ReactPerf":219,"./ViewportMetrics":249,"./isEventSupported":267}],175:[function(e,t,n){(function(n){"use strict";function r(e,t,r){var o=void 0===e[r];"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&c(o,"flattenChildren(...): Encountered two children with the same key, `%s`. Child keys must be unique; when two children share a key, only the first child will be used.",r),null!=t&&o&&(e[r]=i(t,null))}var o=e("./ReactReconciler"),i=e("./instantiateReactComponent"),a=e("./shouldUpdateReactComponent"),s=e("./traverseAllChildren"),c=e("fbjs/lib/warning"),l={instantiateChildren:function(e,t,n){if(null==e)return null;var o={};return s(e,r,o),o},updateChildren:function(e,t,n,r){if(!t&&!e)return null;var s;for(s in t)if(t.hasOwnProperty(s)){var c=e&&e[s],l=c&&c._currentElement,u=t[s];if(null!=c&&a(l,u))o.receiveComponent(c,u,n,r),t[s]=c;else{c&&o.unmountComponent(c,s);var p=i(u,null);t[s]=p}}for(s in e)!e.hasOwnProperty(s)||t&&t.hasOwnProperty(s)||o.unmountComponent(e[s]);return t},unmountChildren:function(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];o.unmountComponent(n)}}};t.exports=l}).call(this,e("_process"))},{"./ReactReconciler":224,"./instantiateReactComponent":266,"./shouldUpdateReactComponent":274,"./traverseAllChildren":275,_process:146,"fbjs/lib/warning":96}],176:[function(e,t,n){"use strict";function r(e){return(""+e).replace(g,"//")}function o(e,t){this.func=e,this.context=t,this.count=0}function i(e,t,n){var r=e.func,o=e.context;r.call(o,t,e.count++)}function a(e,t,n,r){this.result=e,this.keyPrefix=t,this.func=n,this.context=r,this.count=0}function s(e,t,n){var o=e.result,i=e.keyPrefix,a=e.func,s=e.context,l=a.call(s,t,e.count++);Array.isArray(l)?c(l,o,n,d.thatReturnsArgument):null!=l&&(p.isValidElement(l)&&(l=p.cloneAndReplaceKey(l,i+(l!==t?r(l.key||"")+"/":"")+n)),o.push(l))}function c(e,t,n,o,i){var c="";null!=n&&(c=r(n)+"/");var l=a.getPooled(t,c,o,i);f(e,s,l),a.release(l)}function l(e,t,n){return null}var u=e("./PooledClass"),p=e("./ReactElement"),d=e("fbjs/lib/emptyFunction"),f=e("./traverseAllChildren"),h=u.twoArgumentPooler,m=u.fourArgumentPooler,g=/\/(?!\/)/g;o.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},u.addPoolingTo(o,h),a.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},u.addPoolingTo(a,m);var v={forEach:function(e,t,n){if(null==e)return e;var r=o.getPooled(t,n);f(e,i,r),o.release(r)},map:function(e,t,n){if(null==e)return e;var r=[];return c(e,r,null,t,n),r},mapIntoWithKeyPrefixInternal:c,count:function(e,t){return f(e,l,null)},toArray:function(e){var t=[];return c(e,t,null,d.thatReturnsArgument),t}};t.exports=v},{"./PooledClass":171,"./ReactElement":200,"./traverseAllChildren":275,"fbjs/lib/emptyFunction":77}],177:[function(e,t,n){(function(n){"use strict";function r(){N||(N=!0,"production"!==n.env.NODE_ENV&&k(!1,"setProps(...) and replaceProps(...) are deprecated. Instead, call render again at the top level."))}function o(e,t,r){for(var o in t)t.hasOwnProperty(o)&&"production"!==n.env.NODE_ENV&&k("function"==typeof t[o],"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",e.displayName||"ReactClass",g[r],o)}function i(e,t){var r=T.hasOwnProperty(t)?T[t]:null;D.hasOwnProperty(t)&&r!==C.OVERRIDE_BASE&&("production"!==n.env.NODE_ENV?_(!1,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",t):_(!1)),e.hasOwnProperty(t)&&r!==C.DEFINE_MANY&&r!==C.DEFINE_MANY_MERGED&&("production"!==n.env.NODE_ENV?_(!1,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",t):_(!1))}function a(e,t){if(t){"function"==typeof t&&("production"!==n.env.NODE_ENV?_(!1,"ReactClass: You're attempting to use a component class as a mixin. Instead, just use a regular object."):_(!1)),h.isValidElement(t)&&("production"!==n.env.NODE_ENV?_(!1,"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object."):_(!1));var r=e.prototype;t.hasOwnProperty(x)&&O.mixins(e,t.mixins);for(var o in t)if(t.hasOwnProperty(o)&&o!==x){var a=t[o];if(i(r,o),O.hasOwnProperty(o))O[o](e,a);else{var s=T.hasOwnProperty(o),c=r.hasOwnProperty(o);if("function"==typeof a&&!s&&!c&&!1!==t.autobind)r.__reactAutoBindMap||(r.__reactAutoBindMap={}),r.__reactAutoBindMap[o]=a,r[o]=a;else if(c){var p=T[o];(!s||p!==C.DEFINE_MANY_MERGED&&p!==C.DEFINE_MANY)&&("production"!==n.env.NODE_ENV?_(!1,"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",p,o):_(!1)),p===C.DEFINE_MANY_MERGED?r[o]=l(r[o],a):p===C.DEFINE_MANY&&(r[o]=u(r[o],a))}else r[o]=a,"production"!==n.env.NODE_ENV&&"function"==typeof a&&t.displayName&&(r[o].displayName=t.displayName+"_"+o)}}}}function s(e,t){if(t)for(var r in t){var o=t[r];t.hasOwnProperty(r)&&(r in O&&("production"!==n.env.NODE_ENV?_(!1,'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',r):_(!1)),r in e&&("production"!==n.env.NODE_ENV?_(!1,"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",r):_(!1)),e[r]=o)}}function c(e,t){e&&t&&"object"==typeof e&&"object"==typeof t||("production"!==n.env.NODE_ENV?_(!1,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects."):_(!1));for(var r in t)t.hasOwnProperty(r)&&(void 0!==e[r]&&("production"!==n.env.NODE_ENV?_(!1,"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",r):_(!1)),e[r]=t[r]);return e}function l(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);if(null==n)return r;if(null==r)return n;var o={};return c(o,n),c(o,r),o}}function u(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function p(e,t){var r=t.bind(e);if("production"!==n.env.NODE_ENV){r.__reactBoundContext=e,r.__reactBoundMethod=t,r.__reactBoundArguments=null;var o=e.constructor.displayName,i=r.bind;r.bind=function(a){for(var s=arguments.length,c=Array(s>1?s-1:0),l=1;l<s;l++)c[l-1]=arguments[l];if(a!==e&&null!==a)"production"!==n.env.NODE_ENV&&k(!1,"bind(): React component methods may only be bound to the component instance. See %s",o);else if(!c.length)return"production"!==n.env.NODE_ENV&&k(!1,"bind(): You are binding a component method to the component. React does this for you automatically in a high-performance way, so you can safely remove this call. See %s",o),r;var u=i.apply(r,arguments);return u.__reactBoundContext=e,u.__reactBoundMethod=t,u.__reactBoundArguments=c,u}}return r}function d(e){for(var t in e.__reactAutoBindMap)if(e.__reactAutoBindMap.hasOwnProperty(t)){var n=e.__reactAutoBindMap[t];e[t]=p(e,n)}}var f=e("./ReactComponent"),h=e("./ReactElement"),m=e("./ReactPropTypeLocations"),g=e("./ReactPropTypeLocationNames"),v=e("./ReactNoopUpdateQueue"),y=e("./Object.assign"),b=e("fbjs/lib/emptyObject"),_=e("fbjs/lib/invariant"),E=e("fbjs/lib/keyMirror"),w=e("fbjs/lib/keyOf"),k=e("fbjs/lib/warning"),x=w({mixins:null}),C=E({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),S=[],N=!1,T={mixins:C.DEFINE_MANY,statics:C.DEFINE_MANY,propTypes:C.DEFINE_MANY,contextTypes:C.DEFINE_MANY,childContextTypes:C.DEFINE_MANY,getDefaultProps:C.DEFINE_MANY_MERGED,getInitialState:C.DEFINE_MANY_MERGED,getChildContext:C.DEFINE_MANY_MERGED,render:C.DEFINE_ONCE,componentWillMount:C.DEFINE_MANY,componentDidMount:C.DEFINE_MANY,componentWillReceiveProps:C.DEFINE_MANY,shouldComponentUpdate:C.DEFINE_ONCE,componentWillUpdate:C.DEFINE_MANY,componentDidUpdate:C.DEFINE_MANY,componentWillUnmount:C.DEFINE_MANY,updateComponent:C.OVERRIDE_BASE},O={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)a(e,t[n])},childContextTypes:function(e,t){"production"!==n.env.NODE_ENV&&o(e,t,m.childContext),e.childContextTypes=y({},e.childContextTypes,t)},contextTypes:function(e,t){"production"!==n.env.NODE_ENV&&o(e,t,m.context),e.contextTypes=y({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps?e.getDefaultProps=l(e.getDefaultProps,t):e.getDefaultProps=t},propTypes:function(e,t){"production"!==n.env.NODE_ENV&&o(e,t,m.prop),e.propTypes=y({},e.propTypes,t)},statics:function(e,t){s(e,t)},autobind:function(){}},D={replaceState:function(e,t){this.updater.enqueueReplaceState(this,e),t&&this.updater.enqueueCallback(this,t)},isMounted:function(){return this.updater.isMounted(this)},setProps:function(e,t){"production"!==n.env.NODE_ENV&&r(),this.updater.enqueueSetProps(this,e),t&&this.updater.enqueueCallback(this,t)},replaceProps:function(e,t){"production"!==n.env.NODE_ENV&&r(),this.updater.enqueueReplaceProps(this,e),t&&this.updater.enqueueCallback(this,t)}},R=function(){};y(R.prototype,f.prototype,D);var A={createClass:function(e){var t=function(e,r,o){"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&k(this instanceof t,"Something is calling a React component directly. Use a factory or JSX instead. See: https://fb.me/react-legacyfactory"),this.__reactAutoBindMap&&d(this),this.props=e,this.context=r,this.refs=b,this.updater=o||v,this.state=null;var i=this.getInitialState?this.getInitialState():null;"production"!==n.env.NODE_ENV&&void 0===i&&this.getInitialState._isMockFunction&&(i=null),("object"!=typeof i||Array.isArray(i))&&("production"!==n.env.NODE_ENV?_(!1,"%s.getInitialState(): must return an object or null",t.displayName||"ReactCompositeComponent"):_(!1)),this.state=i};t.prototype=new R,t.prototype.constructor=t,S.forEach(a.bind(null,t)),a(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),"production"!==n.env.NODE_ENV&&(t.getDefaultProps&&(t.getDefaultProps.isReactClassApproved={}),t.prototype.getInitialState&&(t.prototype.getInitialState.isReactClassApproved={})),t.prototype.render||("production"!==n.env.NODE_ENV?_(!1,"createClass(...): Class specification must implement a `render` method."):_(!1)),"production"!==n.env.NODE_ENV&&("production"!==n.env.NODE_ENV&&k(!t.prototype.componentShouldUpdate,"%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",e.displayName||"A component"),"production"!==n.env.NODE_ENV&&k(!t.prototype.componentWillRecieveProps,"%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",e.displayName||"A component"));for(var r in T)t.prototype[r]||(t.prototype[r]=null);return t},injection:{injectMixin:function(e){S.push(e)}}};t.exports=A}).call(this,e("_process"))},{"./Object.assign":170,"./ReactComponent":178,"./ReactElement":200,"./ReactNoopUpdateQueue":217,"./ReactPropTypeLocationNames":220,"./ReactPropTypeLocations":221,_process:146,"fbjs/lib/emptyObject":78,"fbjs/lib/invariant":85,"fbjs/lib/keyMirror":88,"fbjs/lib/keyOf":89,"fbjs/lib/warning":96}],178:[function(e,t,n){(function(n){"use strict";function r(e,t,n){this.props=e,this.context=t,this.refs=a,this.updater=n||o}var o=e("./ReactNoopUpdateQueue"),i=e("./canDefineProperty"),a=e("fbjs/lib/emptyObject"),s=e("fbjs/lib/invariant"),c=e("fbjs/lib/warning");if(r.prototype.isReactComponent={},r.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&("production"!==n.env.NODE_ENV?s(!1,"setState(...): takes an object of state variables to update or a function which returns an object of state variables."):s(!1)),"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&c(null!=e,"setState(...): You passed an undefined or null state object; instead, use forceUpdate()."),this.updater.enqueueSetState(this,e),t&&this.updater.enqueueCallback(this,t)},r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this),e&&this.updater.enqueueCallback(this,e)},"production"!==n.env.NODE_ENV){var l={getDOMNode:["getDOMNode","Use ReactDOM.findDOMNode(component) instead."],isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceProps:["replaceProps","Instead, call render again at the top level."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."],setProps:["setProps","Instead, call render again at the top level."]};for(var u in l)l.hasOwnProperty(u)&&function(e,t){i&&Object.defineProperty(r.prototype,e,{get:function(){"production"!==n.env.NODE_ENV&&c(!1,"%s(...) is deprecated in plain JavaScript React classes. %s",t[0],t[1])}})}(u,l[u])}t.exports=r}).call(this,e("_process"))},{"./ReactNoopUpdateQueue":217,"./canDefineProperty":252,_process:146,"fbjs/lib/emptyObject":78,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],179:[function(e,t,n){"use strict";var r=e("./ReactDOMIDOperations"),o=e("./ReactMount"),i={processChildrenUpdates:r.dangerouslyProcessChildrenUpdates,replaceNodeWithMarkupByID:r.dangerouslyReplaceNodeWithMarkupByID,unmountIDFromEnvironment:function(e){o.purgeID(e)}};t.exports=i},{"./ReactDOMIDOperations":188,"./ReactMount":213}],180:[function(e,t,n){(function(n){"use strict";var r=e("fbjs/lib/invariant"),o=!1,i={unmountIDFromEnvironment:null,replaceNodeWithMarkupByID:null,processChildrenUpdates:null,injection:{injectEnvironment:function(e){o&&("production"!==n.env.NODE_ENV?r(!1,"ReactCompositeComponent: injectEnvironment() can only be called once."):r(!1)),i.unmountIDFromEnvironment=e.unmountIDFromEnvironment,i.replaceNodeWithMarkupByID=e.replaceNodeWithMarkupByID,i.processChildrenUpdates=e.processChildrenUpdates,o=!0}}};t.exports=i}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],181:[function(e,t,n){(function(n){"use strict";function r(e){var t=e._currentElement._owner||null;if(t){var n=t.getName();if(n)return" Check the render method of `"+n+"`."}return""}function o(e){}var i=e("./ReactComponentEnvironment"),a=e("./ReactCurrentOwner"),s=e("./ReactElement"),c=e("./ReactInstanceMap"),l=e("./ReactPerf"),u=e("./ReactPropTypeLocations"),p=e("./ReactPropTypeLocationNames"),d=e("./ReactReconciler"),f=e("./ReactUpdateQueue"),h=e("./Object.assign"),m=e("fbjs/lib/emptyObject"),g=e("fbjs/lib/invariant"),v=e("./shouldUpdateReactComponent"),y=e("fbjs/lib/warning");o.prototype.render=function(){return(0,c.get(this)._currentElement.type)(this.props,this.context,this.updater)};var b=1,_={construct:function(e){this._currentElement=e,this._rootNodeID=null,this._instance=null,this._pendingElement=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._renderedComponent=null,this._context=null,this._mountOrder=0,this._topLevelWrapper=null,this._pendingCallbacks=null},mountComponent:function(e,t,r){this._context=r,this._mountOrder=b++,this._rootNodeID=e;var i,l,u=this._processProps(this._currentElement.props),p=this._processContext(r),h=this._currentElement.type,v="prototype"in h;if(v)if("production"!==n.env.NODE_ENV){a.current=this;try{i=new h(u,p,f)}finally{a.current=null}}else i=new h(u,p,f);v&&null!==i&&!1!==i&&!s.isValidElement(i)||(l=i,i=new o(h)),"production"!==n.env.NODE_ENV&&(null==i.render?"production"!==n.env.NODE_ENV&&y(!1,"%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`, returned null/false from a stateless component, or tried to render an element whose type is a function that isn't a React component.",h.displayName||h.name||"Component"):"production"!==n.env.NODE_ENV&&y(h.prototype&&h.prototype.isReactComponent||!v||!(i instanceof h),"%s(...): React component classes must extend React.Component.",h.displayName||h.name||"Component")),i.props=u,i.context=p,i.refs=m,i.updater=f,this._instance=i,c.set(i,this),"production"!==n.env.NODE_ENV&&("production"!==n.env.NODE_ENV&&y(!i.getInitialState||i.getInitialState.isReactClassApproved,"getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",this.getName()||"a component"),"production"!==n.env.NODE_ENV&&y(!i.getDefaultProps||i.getDefaultProps.isReactClassApproved,"getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",this.getName()||"a component"),"production"!==n.env.NODE_ENV&&y(!i.propTypes,"propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",this.getName()||"a component"),"production"!==n.env.NODE_ENV&&y(!i.contextTypes,"contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",this.getName()||"a component"),"production"!==n.env.NODE_ENV&&y("function"!=typeof i.componentShouldUpdate,"%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",this.getName()||"A component"),"production"!==n.env.NODE_ENV&&y("function"!=typeof i.componentDidUnmount,"%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",this.getName()||"A component"),"production"!==n.env.NODE_ENV&&y("function"!=typeof i.componentWillRecieveProps,"%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",this.getName()||"A component"));var _=i.state;void 0===_&&(i.state=_=null),("object"!=typeof _||Array.isArray(_))&&("production"!==n.env.NODE_ENV?g(!1,"%s.state: must be set to an object or null",this.getName()||"ReactCompositeComponent"):g(!1)),this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,i.componentWillMount&&(i.componentWillMount(),this._pendingStateQueue&&(i.state=this._processPendingState(i.props,i.context))),void 0===l&&(l=this._renderValidatedComponent()),this._renderedComponent=this._instantiateReactComponent(l);var E=d.mountComponent(this._renderedComponent,e,t,this._processChildContext(r));return i.componentDidMount&&t.getReactMountReady().enqueue(i.componentDidMount,i),E},unmountComponent:function(){var e=this._instance;e.componentWillUnmount&&e.componentWillUnmount(),d.unmountComponent(this._renderedComponent),this._renderedComponent=null,this._instance=null,this._pendingStateQueue=null,this._pendingReplaceState=!1,this._pendingForceUpdate=!1,this._pendingCallbacks=null,this._pendingElement=null,this._context=null,this._rootNodeID=null,this._topLevelWrapper=null,c.remove(e)},_maskContext:function(e){var t=null,n=this._currentElement.type.contextTypes;if(!n)return m;t={};for(var r in n)t[r]=e[r];return t},_processContext:function(e){var t=this._maskContext(e);if("production"!==n.env.NODE_ENV){var r=this._currentElement.type;r.contextTypes&&this._checkPropTypes(r.contextTypes,t,u.context)}return t},_processChildContext:function(e){var t=this._currentElement.type,r=this._instance,o=r.getChildContext&&r.getChildContext();if(o){"object"!=typeof t.childContextTypes&&("production"!==n.env.NODE_ENV?g(!1,"%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",this.getName()||"ReactCompositeComponent"):g(!1)),"production"!==n.env.NODE_ENV&&this._checkPropTypes(t.childContextTypes,o,u.childContext);for(var i in o)i in t.childContextTypes||("production"!==n.env.NODE_ENV?g(!1,'%s.getChildContext(): key "%s" is not defined in childContextTypes.',this.getName()||"ReactCompositeComponent",i):g(!1));return h({},e,o)}return e},_processProps:function(e){if("production"!==n.env.NODE_ENV){var t=this._currentElement.type;t.propTypes&&this._checkPropTypes(t.propTypes,e,u.prop)}return e},_checkPropTypes:function(e,t,o){var i=this.getName();for(var a in e)if(e.hasOwnProperty(a)){var s;try{"function"!=typeof e[a]&&("production"!==n.env.NODE_ENV?g(!1,"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",i||"React class",p[o],a):g(!1)),s=e[a](t,a,i,o,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){s=e}if(s instanceof Error){var c=r(this);o===u.prop?"production"!==n.env.NODE_ENV&&y(!1,"Failed Composite propType: %s%s",s.message,c):"production"!==n.env.NODE_ENV&&y(!1,"Failed Context Types: %s%s",s.message,c)}}},receiveComponent:function(e,t,n){var r=this._currentElement,o=this._context;this._pendingElement=null,this.updateComponent(t,r,e,o,n)},performUpdateIfNecessary:function(e){null!=this._pendingElement&&d.receiveComponent(this,this._pendingElement||this._currentElement,e,this._context),(null!==this._pendingStateQueue||this._pendingForceUpdate)&&this.updateComponent(e,this._currentElement,this._currentElement,this._context,this._context)},updateComponent:function(e,t,r,o,i){var a,s=this._instance,c=this._context===i?s.context:this._processContext(i);t===r?a=r.props:(a=this._processProps(r.props),s.componentWillReceiveProps&&s.componentWillReceiveProps(a,c));var l=this._processPendingState(a,c),u=this._pendingForceUpdate||!s.shouldComponentUpdate||s.shouldComponentUpdate(a,l,c);"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&y(void 0!==u,"%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",this.getName()||"ReactCompositeComponent"),u?(this._pendingForceUpdate=!1,this._performComponentUpdate(r,a,l,c,e,i)):(this._currentElement=r,this._context=i,s.props=a,s.state=l,s.context=c)},_processPendingState:function(e,t){var n=this._instance,r=this._pendingStateQueue,o=this._pendingReplaceState;if(this._pendingReplaceState=!1,this._pendingStateQueue=null,!r)return n.state;if(o&&1===r.length)return r[0];for(var i=h({},o?r[0]:n.state),a=o?1:0;a<r.length;a++){var s=r[a];h(i,"function"==typeof s?s.call(n,i,e,t):s)}return i},_performComponentUpdate:function(e,t,n,r,o,i){var a,s,c,l=this._instance,u=Boolean(l.componentDidUpdate);u&&(a=l.props,s=l.state,c=l.context),l.componentWillUpdate&&l.componentWillUpdate(t,n,r),this._currentElement=e,this._context=i,l.props=t,l.state=n,l.context=r,this._updateRenderedComponent(o,i),u&&o.getReactMountReady().enqueue(l.componentDidUpdate.bind(l,a,s,c),l)},_updateRenderedComponent:function(e,t){var n=this._renderedComponent,r=n._currentElement,o=this._renderValidatedComponent();if(v(r,o))d.receiveComponent(n,o,e,this._processChildContext(t));else{var i=this._rootNodeID,a=n._rootNodeID;d.unmountComponent(n),this._renderedComponent=this._instantiateReactComponent(o);var s=d.mountComponent(this._renderedComponent,i,e,this._processChildContext(t));this._replaceNodeWithMarkupByID(a,s)}},_replaceNodeWithMarkupByID:function(e,t){i.replaceNodeWithMarkupByID(e,t)},_renderValidatedComponentWithoutOwnerOrContext:function(){var e=this._instance,t=e.render();return"production"!==n.env.NODE_ENV&&void 0===t&&e.render._isMockFunction&&(t=null),t},_renderValidatedComponent:function(){var e;a.current=this;try{e=this._renderValidatedComponentWithoutOwnerOrContext()}finally{a.current=null}return null===e||!1===e||s.isValidElement(e)||("production"!==n.env.NODE_ENV?g(!1,"%s.render(): A valid ReactComponent must be returned. You may have returned undefined, an array or some other invalid object.",this.getName()||"ReactCompositeComponent"):g(!1)),e},attachRef:function(e,t){var r=this.getPublicInstance();null==r&&("production"!==n.env.NODE_ENV?g(!1,"Stateless function components cannot have refs."):g(!1));var o=t.getPublicInstance();if("production"!==n.env.NODE_ENV){var i=t&&t.getName?t.getName():"a component";"production"!==n.env.NODE_ENV&&y(null!=o,'Stateless function components cannot be given refs (See ref "%s" in %s created by %s). Attempts to access this ref will fail.',e,i,this.getName())}(r.refs===m?r.refs={}:r.refs)[e]=o},detachRef:function(e){delete this.getPublicInstance().refs[e]},getName:function(){var e=this._currentElement.type,t=this._instance&&this._instance.constructor;return e.displayName||t&&t.displayName||e.name||t&&t.name||null},getPublicInstance:function(){var e=this._instance;return e instanceof o?null:e},_instantiateReactComponent:null};l.measureMethods(_,"ReactCompositeComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent",_renderValidatedComponent:"_renderValidatedComponent"});var E={Mixin:_};t.exports=E}).call(this,e("_process"))},{"./Object.assign":170,"./ReactComponentEnvironment":180,"./ReactCurrentOwner":182,"./ReactElement":200,"./ReactInstanceMap":210,"./ReactPerf":219,"./ReactPropTypeLocationNames":220,"./ReactPropTypeLocations":221,"./ReactReconciler":224,"./ReactUpdateQueue":230,"./shouldUpdateReactComponent":274,_process:146,"fbjs/lib/emptyObject":78,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],182:[function(e,t,n){"use strict";var r={current:null};t.exports=r},{}],183:[function(e,t,n){(function(n){"use strict";var r=e("./ReactCurrentOwner"),o=e("./ReactDOMTextComponent"),i=e("./ReactDefaultInjection"),a=e("./ReactInstanceHandles"),s=e("./ReactMount"),c=e("./ReactPerf"),l=e("./ReactReconciler"),u=e("./ReactUpdates"),p=e("./ReactVersion"),d=e("./findDOMNode"),f=e("./renderSubtreeIntoContainer"),h=e("fbjs/lib/warning");i.inject();var m={findDOMNode:d,render:c.measure("React","render",s.render),unmountComponentAtNode:s.unmountComponentAtNode,version:p,unstable_batchedUpdates:u.batchedUpdates,unstable_renderSubtreeIntoContainer:f};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({CurrentOwner:r,InstanceHandles:a,Mount:s,Reconciler:l,TextComponent:o}),"production"!==n.env.NODE_ENV&&e("fbjs/lib/ExecutionEnvironment").canUseDOM&&window.top===window.self){"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&(navigator.userAgent.indexOf("Chrome")>-1&&-1===navigator.userAgent.indexOf("Edge")||navigator.userAgent.indexOf("Firefox")>-1)&&console.debug("Download the React DevTools for a better development experience: https://fb.me/react-devtools");var g=document.documentMode&&document.documentMode<8;"production"!==n.env.NODE_ENV&&h(!g,'Internet Explorer is running in compatibility mode; please add the following tag to your HTML to prevent this from happening: <meta http-equiv="X-UA-Compatible" content="IE=edge" />');for(var v=[Array.isArray,Array.prototype.every,Array.prototype.forEach,Array.prototype.indexOf,Array.prototype.map,Date.now,Function.prototype.bind,Object.keys,String.prototype.split,String.prototype.trim,Object.create,Object.freeze],y=0;y<v.length;y++)if(!v[y]){console.error("One or more ES5 shim/shams expected by React are not available: https://fb.me/react-warning-polyfills");break}}t.exports=m}).call(this,e("_process"))},{"./ReactCurrentOwner":182,"./ReactDOMTextComponent":194,"./ReactDefaultInjection":197,"./ReactInstanceHandles":209,"./ReactMount":213,"./ReactPerf":219,"./ReactReconciler":224,"./ReactUpdates":231,"./ReactVersion":232,"./findDOMNode":256,"./renderSubtreeIntoContainer":271,_process:146,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/warning":96}],184:[function(e,t,n){"use strict";var r={onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0},o={getNativeProps:function(e,t,n){if(!t.disabled)return t;var o={};for(var i in t)t.hasOwnProperty(i)&&!r[i]&&(o[i]=t[i]);return o}};t.exports=o},{}],185:[function(e,t,n){(function(n){"use strict";function r(e){if(e){var t=e._currentElement._owner||null;if(t){var n=t.getName();if(n)return" This DOM node was rendered by `"+n+"`."}}return""}function o(){if("production"!==n.env.NODE_ENV){var e=this._reactInternalComponent;"production"!==n.env.NODE_ENV&&G(!1,"ReactDOMComponent: Do not access .getDOMNode() of a DOM node; instead, use the node directly.%s",r(e))}return this}function i(){var e=this._reactInternalComponent;return"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&G(!1,"ReactDOMComponent: Do not access .isMounted() of a DOM node.%s",r(e)),!!e}function a(){if("production"!==n.env.NODE_ENV){var e=this._reactInternalComponent;"production"!==n.env.NODE_ENV&&G(!1,"ReactDOMComponent: Do not access .setState(), .replaceState(), or .forceUpdate() of a DOM node. This is a no-op.%s",r(e))}}function s(e,t){var o=this._reactInternalComponent;"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&G(!1,"ReactDOMComponent: Do not access .setProps() of a DOM node. Instead, call ReactDOM.render again at the top level.%s",r(o)),o&&(L.enqueueSetPropsInternal(o,e),t&&L.enqueueCallbackInternal(o,t))}function c(e,t){var o=this._reactInternalComponent;"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&G(!1,"ReactDOMComponent: Do not access .replaceProps() of a DOM node. Instead, call ReactDOM.render again at the top level.%s",r(o)),o&&(L.enqueueReplacePropsInternal(o,e),t&&L.enqueueCallbackInternal(o,t))}function l(e){if("object"==typeof e){if(Array.isArray(e))return"["+e.map(l).join(", ")+"]";var t=[];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=/^[a-z$_][\w$_]*$/i.test(n)?n:JSON.stringify(n);t.push(r+": "+l(e[n]))}return"{"+t.join(", ")+"}"}return"string"==typeof e?JSON.stringify(e):"function"==typeof e?"[function object]":String(e)}function u(e,t,r){if(null!=e&&null!=t&&!K(e,t)){var o,i=r._tag,a=r._currentElement._owner;a&&(o=a.getName());var s=o+"|"+i;re.hasOwnProperty(s)||(re[s]=!0,"production"!==n.env.NODE_ENV&&G(!1,"`%s` was passed a style object that has previously been mutated. Mutating `style` is deprecated. Consider cloning it beforehand. Check the `render` %s. Previous style: %s. Mutated style: %s.",i,a?"of `"+o+"`":"using <"+i+">",l(e),l(t)))}}function p(e,t){t&&("production"!==n.env.NODE_ENV&&se[e._tag]&&"production"!==n.env.NODE_ENV&&G(null==t.children&&null==t.dangerouslySetInnerHTML,"%s is a void element tag and must not have `children` or use `props.dangerouslySetInnerHTML`.%s",e._tag,e._currentElement._owner?" Check the render method of "+e._currentElement._owner.getName()+".":""),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&("production"!==n.env.NODE_ENV?V(!1,"Can only set one of `children` or `props.dangerouslySetInnerHTML`."):V(!1)),"object"==typeof t.dangerouslySetInnerHTML&&te in t.dangerouslySetInnerHTML||("production"!==n.env.NODE_ENV?V(!1,"`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://fb.me/react-invariant-dangerously-set-inner-html for more information."):V(!1))),"production"!==n.env.NODE_ENV&&("production"!==n.env.NODE_ENV&&G(null==t.innerHTML,"Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),"production"!==n.env.NODE_ENV&&G(!t.contentEditable||null==t.children,"A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional.")),null!=t.style&&"object"!=typeof t.style&&("production"!==n.env.NODE_ENV?V(!1,"The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.%s",r(e)):V(!1)))}function d(e,t,r,o){"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&G("onScroll"!==t||q("scroll",!0),"This browser doesn't support the `onScroll` event");var i=I.findReactContainerForID(e);if(i){var a=i.nodeType===ne?i.ownerDocument:i;J(t,a)}o.getReactMountReady().enqueue(f,{id:e,registrationName:t,listener:r})}function f(){var e=this;N.putListener(e.id,e.registrationName,e.listener)}function h(){var e=this;e._rootNodeID||("production"!==n.env.NODE_ENV?V(!1,"Must be mounted to trap events"):V(!1));var t=I.getNode(e._rootNodeID);switch(t||("production"!==n.env.NODE_ENV?V(!1,"trapBubbledEvent(...): Requires node to be rendered."):V(!1)),e._tag){case"iframe":e._wrapperState.listeners=[N.trapBubbledEvent(S.topLevelTypes.topLoad,"load",t)];break;case"video":case"audio":e._wrapperState.listeners=[];for(var r in oe)oe.hasOwnProperty(r)&&e._wrapperState.listeners.push(N.trapBubbledEvent(S.topLevelTypes[r],oe[r],t));break;case"img":e._wrapperState.listeners=[N.trapBubbledEvent(S.topLevelTypes.topError,"error",t),N.trapBubbledEvent(S.topLevelTypes.topLoad,"load",t)];break;case"form":e._wrapperState.listeners=[N.trapBubbledEvent(S.topLevelTypes.topReset,"reset",t),N.trapBubbledEvent(S.topLevelTypes.topSubmit,"submit",t)]}}function m(){D.mountReadyWrapper(this)}function g(){A.postUpdateWrapper(this)}function v(e){ue.call(le,e)||(ce.test(e)||("production"!==n.env.NODE_ENV?V(!1,"Invalid tag: %s",e):V(!1)),le[e]=!0)}function y(e,t){var n=(e=F({},e))[Y.ancestorInfoContextKey];return e[Y.ancestorInfoContextKey]=Y.updatedAncestorInfo(n,t._tag,t),e}function b(e,t){return e.indexOf("-")>=0||null!=t.is}function _(e){v(e),this._tag=e.toLowerCase(),this._renderedChildren=null,this._previousStyle=null,this._previousStyleCopy=null,this._rootNodeID=null,this._wrapperState=null,this._topLevelWrapper=null,this._nodeWithLegacyProperties=null,"production"!==n.env.NODE_ENV&&(this._unprocessedContextDev=null,this._processedContextDev=null)}var E,w=e("./AutoFocusUtils"),k=e("./CSSPropertyOperations"),x=e("./DOMProperty"),C=e("./DOMPropertyOperations"),S=e("./EventConstants"),N=e("./ReactBrowserEventEmitter"),T=e("./ReactComponentBrowserEnvironment"),O=e("./ReactDOMButton"),D=e("./ReactDOMInput"),R=e("./ReactDOMOption"),A=e("./ReactDOMSelect"),P=e("./ReactDOMTextarea"),I=e("./ReactMount"),j=e("./ReactMultiChild"),M=e("./ReactPerf"),L=e("./ReactUpdateQueue"),F=e("./Object.assign"),U=e("./canDefineProperty"),B=e("./escapeTextContentForBrowser"),V=e("fbjs/lib/invariant"),q=e("./isEventSupported"),H=e("fbjs/lib/keyOf"),W=e("./setInnerHTML"),z=e("./setTextContent"),K=e("fbjs/lib/shallowEqual"),Y=e("./validateDOMNesting"),G=e("fbjs/lib/warning"),$=N.deleteListener,J=N.listenTo,X=N.registrationNameModules,Q={string:!0,number:!0},Z=H({children:null}),ee=H({style:null}),te=H({__html:null}),ne=1;"production"!==n.env.NODE_ENV&&(E={props:{enumerable:!1,get:function(){var e=this._reactInternalComponent;return"production"!==n.env.NODE_ENV&&G(!1,"ReactDOMComponent: Do not access .props of a DOM node; instead, recreate the props as `render` did originally or read the DOM properties/attributes directly from this node (e.g., this.refs.box.className).%s",r(e)),e._currentElement.props}}});var re={},oe={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},ie={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},ae={listing:!0,pre:!0,textarea:!0},se=F({menuitem:!0},ie),ce=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,le={},ue={}.hasOwnProperty;_.displayName="ReactDOMComponent",_.Mixin={construct:function(e){this._currentElement=e},mountComponent:function(e,t,r){this._rootNodeID=e;var o=this._currentElement.props;switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":this._wrapperState={listeners:null},t.getReactMountReady().enqueue(h,this);break;case"button":o=O.getNativeProps(this,o,r);break;case"input":D.mountWrapper(this,o,r),o=D.getNativeProps(this,o,r);break;case"option":R.mountWrapper(this,o,r),o=R.getNativeProps(this,o,r);break;case"select":A.mountWrapper(this,o,r),o=A.getNativeProps(this,o,r),r=A.processChildContext(this,o,r);break;case"textarea":P.mountWrapper(this,o,r),o=P.getNativeProps(this,o,r)}p(this,o),"production"!==n.env.NODE_ENV&&r[Y.ancestorInfoContextKey]&&Y(this._tag,this,r[Y.ancestorInfoContextKey]),"production"!==n.env.NODE_ENV&&(this._unprocessedContextDev=r,this._processedContextDev=y(r,this),r=this._processedContextDev);var i;if(t.useCreateElement){var a=r[I.ownerDocumentContextKey].createElement(this._currentElement.type);C.setAttributeForID(a,this._rootNodeID),I.getID(a),this._updateDOMProperties({},o,t,a),this._createInitialChildren(t,o,r,a),i=a}else{var s=this._createOpenTagMarkupAndPutListeners(t,o),c=this._createContentMarkup(t,o,r);i=!c&&ie[this._tag]?s+"/>":s+">"+c+"</"+this._currentElement.type+">"}switch(this._tag){case"input":t.getReactMountReady().enqueue(m,this);case"button":case"select":case"textarea":o.autoFocus&&t.getReactMountReady().enqueue(w.focusDOMComponent,this)}return i},_createOpenTagMarkupAndPutListeners:function(e,t){var r="<"+this._currentElement.type;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];if(null!=i)if(X.hasOwnProperty(o))i&&d(this._rootNodeID,o,i,e);else{o===ee&&(i&&("production"!==n.env.NODE_ENV&&(this._previousStyle=i),i=this._previousStyleCopy=F({},t.style)),i=k.createMarkupForStyles(i));var a=null;null!=this._tag&&b(this._tag,t)?o!==Z&&(a=C.createMarkupForCustomAttribute(o,i)):a=C.createMarkupForProperty(o,i),a&&(r+=" "+a)}}return e.renderToStaticMarkup?r:r+" "+C.createMarkupForID(this._rootNodeID)},_createContentMarkup:function(e,t,n){var r="",o=t.dangerouslySetInnerHTML;if(null!=o)null!=o.__html&&(r=o.__html);else{var i=Q[typeof t.children]?t.children:null,a=null!=i?null:t.children;null!=i?r=B(i):null!=a&&(r=this.mountChildren(a,e,n).join(""))}return ae[this._tag]&&"\n"===r.charAt(0)?"\n"+r:r},_createInitialChildren:function(e,t,n,r){var o=t.dangerouslySetInnerHTML;if(null!=o)null!=o.__html&&W(r,o.__html);else{var i=Q[typeof t.children]?t.children:null,a=null!=i?null:t.children;if(null!=i)z(r,i);else if(null!=a)for(var s=this.mountChildren(a,e,n),c=0;c<s.length;c++)r.appendChild(s[c])}},receiveComponent:function(e,t,n){var r=this._currentElement;this._currentElement=e,this.updateComponent(t,r,e,n)},updateComponent:function(e,t,r,o){var i=t.props,a=this._currentElement.props;switch(this._tag){case"button":i=O.getNativeProps(this,i),a=O.getNativeProps(this,a);break;case"input":D.updateWrapper(this),i=D.getNativeProps(this,i),a=D.getNativeProps(this,a);break;case"option":i=R.getNativeProps(this,i),a=R.getNativeProps(this,a);break;case"select":i=A.getNativeProps(this,i),a=A.getNativeProps(this,a);break;case"textarea":P.updateWrapper(this),i=P.getNativeProps(this,i),a=P.getNativeProps(this,a)}"production"!==n.env.NODE_ENV&&(this._unprocessedContextDev!==o&&(this._unprocessedContextDev=o,this._processedContextDev=y(o,this)),o=this._processedContextDev),p(this,a),this._updateDOMProperties(i,a,e,null),this._updateDOMChildren(i,a,e,o),!U&&this._nodeWithLegacyProperties&&(this._nodeWithLegacyProperties.props=a),"select"===this._tag&&e.getReactMountReady().enqueue(g,this)},_updateDOMProperties:function(e,t,r,o){var i,a,s;for(i in e)if(!t.hasOwnProperty(i)&&e.hasOwnProperty(i))if(i===ee){var c=this._previousStyleCopy;for(a in c)c.hasOwnProperty(a)&&((s=s||{})[a]="");this._previousStyleCopy=null}else X.hasOwnProperty(i)?e[i]&&$(this._rootNodeID,i):(x.properties[i]||x.isCustomAttribute(i))&&(o||(o=I.getNode(this._rootNodeID)),C.deleteValueForProperty(o,i));for(i in t){var l=t[i],p=i===ee?this._previousStyleCopy:e[i];if(t.hasOwnProperty(i)&&l!==p)if(i===ee)if(l?("production"!==n.env.NODE_ENV&&(u(this._previousStyleCopy,this._previousStyle,this),this._previousStyle=l),l=this._previousStyleCopy=F({},l)):this._previousStyleCopy=null,p){for(a in p)!p.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||((s=s||{})[a]="");for(a in l)l.hasOwnProperty(a)&&p[a]!==l[a]&&((s=s||{})[a]=l[a])}else s=l;else X.hasOwnProperty(i)?l?d(this._rootNodeID,i,l,r):p&&$(this._rootNodeID,i):b(this._tag,t)?(o||(o=I.getNode(this._rootNodeID)),i===Z&&(l=null),C.setValueForAttribute(o,i,l)):(x.properties[i]||x.isCustomAttribute(i))&&(o||(o=I.getNode(this._rootNodeID)),null!=l?C.setValueForProperty(o,i,l):C.deleteValueForProperty(o,i))}s&&(o||(o=I.getNode(this._rootNodeID)),k.setValueForStyles(o,s))},_updateDOMChildren:function(e,t,n,r){var o=Q[typeof e.children]?e.children:null,i=Q[typeof t.children]?t.children:null,a=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,s=t.dangerouslySetInnerHTML&&t.dangerouslySetInnerHTML.__html,c=null!=o?null:e.children,l=null!=i?null:t.children,u=null!=o||null!=a,p=null!=i||null!=s;null!=c&&null==l?this.updateChildren(null,n,r):u&&!p&&this.updateTextContent(""),null!=i?o!==i&&this.updateTextContent(""+i):null!=s?a!==s&&this.updateMarkup(""+s):null!=l&&this.updateChildren(l,n,r)},unmountComponent:function(){switch(this._tag){case"iframe":case"img":case"form":case"video":case"audio":var e=this._wrapperState.listeners;if(e)for(var t=0;t<e.length;t++)e[t].remove();break;case"input":D.unmountWrapper(this);break;case"html":case"head":case"body":"production"!==n.env.NODE_ENV?V(!1,"<%s> tried to unmount. Because of cross-browser quirks it is impossible to unmount some top-level components (eg <html>, <head>, and <body>) reliably and efficiently. To fix this, have a single top-level component that never unmounts render these elements.",this._tag):V(!1)}this.unmountChildren(),N.deleteAllListeners(this._rootNodeID),T.unmountIDFromEnvironment(this._rootNodeID),this._rootNodeID=null,this._wrapperState=null,this._nodeWithLegacyProperties&&(this._nodeWithLegacyProperties._reactInternalComponent=null,this._nodeWithLegacyProperties=null)},getPublicInstance:function(){if(!this._nodeWithLegacyProperties){var e=I.getNode(this._rootNodeID);e._reactInternalComponent=this,e.getDOMNode=o,e.isMounted=i,e.setState=a,e.replaceState=a,e.forceUpdate=a,e.setProps=s,e.replaceProps=c,"production"!==n.env.NODE_ENV&&U?Object.defineProperties(e,E):e.props=this._currentElement.props,this._nodeWithLegacyProperties=e}return this._nodeWithLegacyProperties}},M.measureMethods(_,"ReactDOMComponent",{mountComponent:"mountComponent",updateComponent:"updateComponent"}),F(_.prototype,_.Mixin,j.Mixin),t.exports=_}).call(this,e("_process"))},{"./AutoFocusUtils":149,"./CSSPropertyOperations":152,"./DOMProperty":157,"./DOMPropertyOperations":158,"./EventConstants":162,"./Object.assign":170,"./ReactBrowserEventEmitter":174,"./ReactComponentBrowserEnvironment":179,"./ReactDOMButton":184,"./ReactDOMInput":189,"./ReactDOMOption":190,"./ReactDOMSelect":191,"./ReactDOMTextarea":195,"./ReactMount":213,"./ReactMultiChild":214,"./ReactPerf":219,"./ReactUpdateQueue":230,"./canDefineProperty":252,"./escapeTextContentForBrowser":255,"./isEventSupported":267,"./setInnerHTML":272,"./setTextContent":273,"./validateDOMNesting":276,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/keyOf":89,"fbjs/lib/shallowEqual":94,"fbjs/lib/warning":96}],186:[function(e,t,n){(function(n){"use strict";var r=e("./ReactElement"),o=e("./ReactElementValidator"),i=e("fbjs/lib/mapObject")({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hgroup:"hgroup",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul",var:"var",video:"video",wbr:"wbr",circle:"circle",clipPath:"clipPath",defs:"defs",ellipse:"ellipse",g:"g",image:"image",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},function(e){return"production"!==n.env.NODE_ENV?o.createFactory(e):r.createFactory(e)});t.exports=i}).call(this,e("_process"))},{"./ReactElement":200,"./ReactElementValidator":201,_process:146,"fbjs/lib/mapObject":90}],187:[function(e,t,n){"use strict";var r={useCreateElement:!1};t.exports=r},{}],188:[function(e,t,n){(function(n){"use strict";var r=e("./DOMChildrenOperations"),o=e("./DOMPropertyOperations"),i=e("./ReactMount"),a=e("./ReactPerf"),s=e("fbjs/lib/invariant"),c={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:function(e,t,r){var a=i.getNode(e);c.hasOwnProperty(t)&&("production"!==n.env.NODE_ENV?s(!1,"updatePropertyByID(...): %s",c[t]):s(!1)),null!=r?o.setValueForProperty(a,t,r):o.deleteValueForProperty(a,t)},dangerouslyReplaceNodeWithMarkupByID:function(e,t){var n=i.getNode(e);r.dangerouslyReplaceNodeWithMarkup(n,t)},dangerouslyProcessChildrenUpdates:function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=i.getNode(e[n].parentID);r.processUpdates(e,t)}};a.measureMethods(l,"ReactDOMIDOperations",{dangerouslyReplaceNodeWithMarkupByID:"dangerouslyReplaceNodeWithMarkupByID",dangerouslyProcessChildrenUpdates:"dangerouslyProcessChildrenUpdates"}),t.exports=l}).call(this,e("_process"))},{"./DOMChildrenOperations":156,"./DOMPropertyOperations":158,"./ReactMount":213,"./ReactPerf":219,_process:146,"fbjs/lib/invariant":85}],189:[function(e,t,n){(function(n){"use strict";function r(){this._rootNodeID&&d.updateWrapper(this)}function o(e){var t=this._currentElement.props,o=a.executeOnChange(t,e);c.asap(r,this);var i=t.name;if("radio"===t.type&&null!=i){for(var l=s.getNode(this._rootNodeID),d=l;d.parentNode;)d=d.parentNode;for(var f=d.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),h=0;h<f.length;h++){var m=f[h];if(m!==l&&m.form===l.form){var g=s.getID(m);g||("production"!==n.env.NODE_ENV?u(!1,"ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported."):u(!1));var v=p[g];v||("production"!==n.env.NODE_ENV?u(!1,"ReactDOMInput: Unknown radio button ID %s.",g):u(!1)),c.asap(r,v)}}}return o}var i=e("./ReactDOMIDOperations"),a=e("./LinkedValueUtils"),s=e("./ReactMount"),c=e("./ReactUpdates"),l=e("./Object.assign"),u=e("fbjs/lib/invariant"),p={},d={getNativeProps:function(e,t,n){var r=a.getValue(t),o=a.getChecked(t);return l({},t,{defaultChecked:void 0,defaultValue:void 0,value:null!=r?r:e._wrapperState.initialValue,checked:null!=o?o:e._wrapperState.initialChecked,onChange:e._wrapperState.onChange})},mountWrapper:function(e,t){"production"!==n.env.NODE_ENV&&a.checkPropTypes("input",t,e._currentElement._owner);var r=t.defaultValue;e._wrapperState={initialChecked:t.defaultChecked||!1,initialValue:null!=r?r:null,onChange:o.bind(e)}},mountReadyWrapper:function(e){p[e._rootNodeID]=e},unmountWrapper:function(e){delete p[e._rootNodeID]},updateWrapper:function(e){var t=e._currentElement.props,n=t.checked;null!=n&&i.updatePropertyByID(e._rootNodeID,"checked",n||!1);var r=a.getValue(t);null!=r&&i.updatePropertyByID(e._rootNodeID,"value",""+r)}};t.exports=d}).call(this,e("_process"))},{"./LinkedValueUtils":169,"./Object.assign":170,"./ReactDOMIDOperations":188,"./ReactMount":213,"./ReactUpdates":231,_process:146,"fbjs/lib/invariant":85}],190:[function(e,t,n){(function(n){"use strict";var r=e("./ReactChildren"),o=e("./ReactDOMSelect"),i=e("./Object.assign"),a=e("fbjs/lib/warning"),s=o.valueContextKey,c={mountWrapper:function(e,t,r){"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&a(null==t.selected,"Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>.");var o=r[s],i=null;if(null!=o)if(i=!1,Array.isArray(o)){for(var c=0;c<o.length;c++)if(""+o[c]==""+t.value){i=!0;break}}else i=""+o==""+t.value;e._wrapperState={selected:i}},getNativeProps:function(e,t,o){var s=i({selected:void 0,children:void 0},t);null!=e._wrapperState.selected&&(s.selected=e._wrapperState.selected);var c="";return r.forEach(t.children,function(e){null!=e&&("string"==typeof e||"number"==typeof e?c+=e:"production"!==n.env.NODE_ENV&&a(!1,"Only strings and numbers are supported as <option> children."))}),c&&(s.children=c),s}};t.exports=c}).call(this,e("_process"))},{"./Object.assign":170,"./ReactChildren":176,"./ReactDOMSelect":191,_process:146,"fbjs/lib/warning":96}],191:[function(e,t,n){(function(n){"use strict";function r(){if(this._rootNodeID&&this._wrapperState.pendingUpdate){this._wrapperState.pendingUpdate=!1;var e=this._currentElement.props,t=c.getValue(e);null!=t&&a(this,Boolean(e.multiple),t)}}function o(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}function i(e,t){var r=e._currentElement._owner;c.checkPropTypes("select",t,r);for(var i=0;i<h.length;i++){var a=h[i];null!=t[a]&&(t.multiple?"production"!==n.env.NODE_ENV&&d(Array.isArray(t[a]),"The `%s` prop supplied to <select> must be an array if `multiple` is true.%s",a,o(r)):"production"!==n.env.NODE_ENV&&d(!Array.isArray(t[a]),"The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.%s",a,o(r)))}}function a(e,t,n){var r,o,i=l.getNode(e._rootNodeID).options;if(t){for(r={},o=0;o<n.length;o++)r[""+n[o]]=!0;for(o=0;o<i.length;o++){var a=r.hasOwnProperty(i[o].value);i[o].selected!==a&&(i[o].selected=a)}}else{for(r=""+n,o=0;o<i.length;o++)if(i[o].value===r)return void(i[o].selected=!0);i.length&&(i[0].selected=!0)}}function s(e){var t=this._currentElement.props,n=c.executeOnChange(t,e);return this._wrapperState.pendingUpdate=!0,u.asap(r,this),n}var c=e("./LinkedValueUtils"),l=e("./ReactMount"),u=e("./ReactUpdates"),p=e("./Object.assign"),d=e("fbjs/lib/warning"),f="__ReactDOMSelect_value$"+Math.random().toString(36).slice(2),h=["value","defaultValue"],m={valueContextKey:f,getNativeProps:function(e,t,n){return p({},t,{onChange:e._wrapperState.onChange,value:void 0})},mountWrapper:function(e,t){"production"!==n.env.NODE_ENV&&i(e,t);var r=c.getValue(t);e._wrapperState={pendingUpdate:!1,initialValue:null!=r?r:t.defaultValue,onChange:s.bind(e),wasMultiple:Boolean(t.multiple)}},processChildContext:function(e,t,n){var r=p({},n);return r[f]=e._wrapperState.initialValue,r},postUpdateWrapper:function(e){var t=e._currentElement.props;e._wrapperState.initialValue=void 0;var n=e._wrapperState.wasMultiple;e._wrapperState.wasMultiple=Boolean(t.multiple);var r=c.getValue(t);null!=r?(e._wrapperState.pendingUpdate=!1,a(e,Boolean(t.multiple),r)):n!==Boolean(t.multiple)&&(null!=t.defaultValue?a(e,Boolean(t.multiple),t.defaultValue):a(e,Boolean(t.multiple),t.multiple?[]:""))}};t.exports=m}).call(this,e("_process"))},{"./LinkedValueUtils":169,"./Object.assign":170,"./ReactMount":213,"./ReactUpdates":231,_process:146,"fbjs/lib/warning":96}],192:[function(e,t,n){"use strict";function r(e,t,n,r){return e===n&&t===r}var o=e("fbjs/lib/ExecutionEnvironment"),i=e("./getNodeForCharacterOffset"),a=e("./getTextContentAccessor"),s=o.canUseDOM&&"selection"in document&&!("getSelection"in window),c={getOffsets:s?function(e){var t=document.selection.createRange(),n=t.text.length,r=t.duplicate();r.moveToElementText(e),r.setEndPoint("EndToStart",t);var o=r.text.length;return{start:o,end:o+n}}:function(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var n=t.anchorNode,o=t.anchorOffset,i=t.focusNode,a=t.focusOffset,s=t.getRangeAt(0);try{s.startContainer.nodeType,s.endContainer.nodeType}catch(e){return null}var c=r(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)?0:s.toString().length,l=s.cloneRange();l.selectNodeContents(e),l.setEnd(s.startContainer,s.startOffset);var u=r(l.startContainer,l.startOffset,l.endContainer,l.endOffset)?0:l.toString().length,p=u+c,d=document.createRange();d.setStart(n,o),d.setEnd(i,a);var f=d.collapsed;return{start:f?p:u,end:f?u:p}},setOffsets:s?function(e,t){var n,r,o=document.selection.createRange().duplicate();void 0===t.end?r=n=t.start:t.start>t.end?(n=t.end,r=t.start):(n=t.start,r=t.end),o.moveToElementText(e),o.moveStart("character",n),o.setEndPoint("EndToStart",o),o.moveEnd("character",r-n),o.select()}:function(e,t){if(window.getSelection){var n=window.getSelection(),r=e[a()].length,o=Math.min(t.start,r),s=void 0===t.end?o:Math.min(t.end,r);if(!n.extend&&o>s){var c=s;s=o,o=c}var l=i(e,o),u=i(e,s);if(l&&u){var p=document.createRange();p.setStart(l.node,l.offset),n.removeAllRanges(),o>s?(n.addRange(p),n.extend(u.node,u.offset)):(p.setEnd(u.node,u.offset),n.addRange(p))}}}};t.exports=c},{"./getNodeForCharacterOffset":264,"./getTextContentAccessor":265,"fbjs/lib/ExecutionEnvironment":71}],193:[function(e,t,n){"use strict";var r=e("./ReactDefaultInjection"),o=e("./ReactServerRendering"),i=e("./ReactVersion");r.inject();var a={renderToString:o.renderToString,renderToStaticMarkup:o.renderToStaticMarkup,version:i};t.exports=a},{"./ReactDefaultInjection":197,"./ReactServerRendering":228,"./ReactVersion":232}],194:[function(e,t,n){(function(n){"use strict";var r=e("./DOMChildrenOperations"),o=e("./DOMPropertyOperations"),i=e("./ReactComponentBrowserEnvironment"),a=e("./ReactMount"),s=e("./Object.assign"),c=e("./escapeTextContentForBrowser"),l=e("./setTextContent"),u=e("./validateDOMNesting"),p=function(e){};s(p.prototype,{construct:function(e){this._currentElement=e,this._stringText=""+e,this._rootNodeID=null,this._mountIndex=0},mountComponent:function(e,t,r){if("production"!==n.env.NODE_ENV&&r[u.ancestorInfoContextKey]&&u("span",null,r[u.ancestorInfoContextKey]),this._rootNodeID=e,t.useCreateElement){var i=r[a.ownerDocumentContextKey].createElement("span");return o.setAttributeForID(i,e),a.getID(i),l(i,this._stringText),i}var s=c(this._stringText);return t.renderToStaticMarkup?s:"<span "+o.createMarkupForID(e)+">"+s+"</span>"},receiveComponent:function(e,t){if(e!==this._currentElement){this._currentElement=e;var n=""+e;if(n!==this._stringText){this._stringText=n;var o=a.getNode(this._rootNodeID);r.updateTextContent(o,n)}}},unmountComponent:function(){i.unmountIDFromEnvironment(this._rootNodeID)}}),t.exports=p}).call(this,e("_process"))},{"./DOMChildrenOperations":156,"./DOMPropertyOperations":158,"./Object.assign":170,"./ReactComponentBrowserEnvironment":179,"./ReactMount":213,"./escapeTextContentForBrowser":255,"./setTextContent":273,"./validateDOMNesting":276,_process:146}],195:[function(e,t,n){(function(n){"use strict";function r(){this._rootNodeID&&p.updateWrapper(this)}function o(e){var t=this._currentElement.props,n=i.executeOnChange(t,e);return s.asap(r,this),n}var i=e("./LinkedValueUtils"),a=e("./ReactDOMIDOperations"),s=e("./ReactUpdates"),c=e("./Object.assign"),l=e("fbjs/lib/invariant"),u=e("fbjs/lib/warning"),p={getNativeProps:function(e,t,r){return null!=t.dangerouslySetInnerHTML&&("production"!==n.env.NODE_ENV?l(!1,"`dangerouslySetInnerHTML` does not make sense on <textarea>."):l(!1)),c({},t,{defaultValue:void 0,value:void 0,children:e._wrapperState.initialValue,onChange:e._wrapperState.onChange})},mountWrapper:function(e,t){"production"!==n.env.NODE_ENV&&i.checkPropTypes("textarea",t,e._currentElement._owner);var r=t.defaultValue,a=t.children;null!=a&&("production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&u(!1,"Use the `defaultValue` or `value` props instead of setting children on <textarea>."),null!=r&&("production"!==n.env.NODE_ENV?l(!1,"If you supply `defaultValue` on a <textarea>, do not pass children."):l(!1)),Array.isArray(a)&&(a.length<=1||("production"!==n.env.NODE_ENV?l(!1,"<textarea> can only have at most one child."):l(!1)),a=a[0]),r=""+a),null==r&&(r="");var s=i.getValue(t);e._wrapperState={initialValue:""+(null!=s?s:r),onChange:o.bind(e)}},updateWrapper:function(e){var t=e._currentElement.props,n=i.getValue(t);null!=n&&a.updatePropertyByID(e._rootNodeID,"value",""+n)}};t.exports=p}).call(this,e("_process"))},{"./LinkedValueUtils":169,"./Object.assign":170,"./ReactDOMIDOperations":188,"./ReactUpdates":231,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],196:[function(e,t,n){"use strict";function r(){this.reinitializeTransaction()}var o=e("./ReactUpdates"),i=e("./Transaction"),a=e("./Object.assign"),s=e("fbjs/lib/emptyFunction"),c={initialize:s,close:function(){p.isBatchingUpdates=!1}},l=[{initialize:s,close:o.flushBatchedUpdates.bind(o)},c];a(r.prototype,i.Mixin,{getTransactionWrappers:function(){return l}});var u=new r,p={isBatchingUpdates:!1,batchedUpdates:function(e,t,n,r,o,i){var a=p.isBatchingUpdates;p.isBatchingUpdates=!0,a?e(t,n,r,o,i):u.perform(e,null,t,n,r,o,i)}};t.exports=p},{"./Object.assign":170,"./ReactUpdates":231,"./Transaction":248,"fbjs/lib/emptyFunction":77}],197:[function(e,t,n){(function(n){"use strict";var r=e("./BeforeInputEventPlugin"),o=e("./ChangeEventPlugin"),i=e("./ClientReactRootIndex"),a=e("./DefaultEventPluginOrder"),s=e("./EnterLeaveEventPlugin"),c=e("fbjs/lib/ExecutionEnvironment"),l=e("./HTMLDOMPropertyConfig"),u=e("./ReactBrowserComponentMixin"),p=e("./ReactComponentBrowserEnvironment"),d=e("./ReactDefaultBatchingStrategy"),f=e("./ReactDOMComponent"),h=e("./ReactDOMTextComponent"),m=e("./ReactEventListener"),g=e("./ReactInjection"),v=e("./ReactInstanceHandles"),y=e("./ReactMount"),b=e("./ReactReconcileTransaction"),_=e("./SelectEventPlugin"),E=e("./ServerReactRootIndex"),w=e("./SimpleEventPlugin"),k=e("./SVGDOMPropertyConfig"),x=!1;t.exports={inject:function(){if(!x&&(x=!0,g.EventEmitter.injectReactEventListener(m),g.EventPluginHub.injectEventPluginOrder(a),g.EventPluginHub.injectInstanceHandle(v),g.EventPluginHub.injectMount(y),g.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:w,EnterLeaveEventPlugin:s,ChangeEventPlugin:o,SelectEventPlugin:_,BeforeInputEventPlugin:r}),g.NativeComponent.injectGenericComponentClass(f),g.NativeComponent.injectTextComponentClass(h),g.Class.injectMixin(u),g.DOMProperty.injectDOMPropertyConfig(l),g.DOMProperty.injectDOMPropertyConfig(k),g.EmptyComponent.injectEmptyComponent("noscript"),g.Updates.injectReconcileTransaction(b),g.Updates.injectBatchingStrategy(d),g.RootIndex.injectCreateReactRootIndex(c.canUseDOM?i.createReactRootIndex:E.createReactRootIndex),g.Component.injectEnvironment(p),"production"!==n.env.NODE_ENV)){var t=c.canUseDOM&&window.location.href||"";/[?&]react_perf\b/.test(t)&&e("./ReactDefaultPerf").start()}}}}).call(this,e("_process"))},{"./BeforeInputEventPlugin":150,"./ChangeEventPlugin":154,"./ClientReactRootIndex":155,"./DefaultEventPluginOrder":160,"./EnterLeaveEventPlugin":161,"./HTMLDOMPropertyConfig":168,"./ReactBrowserComponentMixin":173,"./ReactComponentBrowserEnvironment":179,"./ReactDOMComponent":185,"./ReactDOMTextComponent":194,"./ReactDefaultBatchingStrategy":196,"./ReactDefaultPerf":198,"./ReactEventListener":206,"./ReactInjection":207,"./ReactInstanceHandles":209,"./ReactMount":213,"./ReactReconcileTransaction":223,"./SVGDOMPropertyConfig":233,"./SelectEventPlugin":234,"./ServerReactRootIndex":235,"./SimpleEventPlugin":236,_process:146,"fbjs/lib/ExecutionEnvironment":71}],198:[function(e,t,n){"use strict";function r(e){return Math.floor(100*e)/100}function o(e,t,n){e[t]=(e[t]||0)+n}var i=e("./DOMProperty"),a=e("./ReactDefaultPerfAnalysis"),s=e("./ReactMount"),c=e("./ReactPerf"),l=e("fbjs/lib/performanceNow"),u={_allMeasurements:[],_mountStack:[0],_injected:!1,start:function(){u._injected||c.injection.injectMeasure(u.measure),u._allMeasurements.length=0,c.enableMeasure=!0},stop:function(){c.enableMeasure=!1},getLastMeasurements:function(){return u._allMeasurements},printExclusive:function(e){e=e||u._allMeasurements;var t=a.getExclusiveSummary(e);console.table(t.map(function(e){return{"Component class name":e.componentName,"Total inclusive time (ms)":r(e.inclusive),"Exclusive mount time (ms)":r(e.exclusive),"Exclusive render time (ms)":r(e.render),"Mount time per instance (ms)":r(e.exclusive/e.count),"Render time per instance (ms)":r(e.render/e.count),Instances:e.count}}))},printInclusive:function(e){e=e||u._allMeasurements;var t=a.getInclusiveSummary(e);console.table(t.map(function(e){return{"Owner > component":e.componentName,"Inclusive time (ms)":r(e.time),Instances:e.count}})),console.log("Total time:",a.getTotalTime(e).toFixed(2)+" ms")},getMeasurementsSummaryMap:function(e){return a.getInclusiveSummary(e,!0).map(function(e){return{"Owner > component":e.componentName,"Wasted time (ms)":e.time,Instances:e.count}})},printWasted:function(e){e=e||u._allMeasurements,console.table(u.getMeasurementsSummaryMap(e)),console.log("Total time:",a.getTotalTime(e).toFixed(2)+" ms")},printDOM:function(e){e=e||u._allMeasurements;var t=a.getDOMSummary(e);console.table(t.map(function(e){var t={};return t[i.ID_ATTRIBUTE_NAME]=e.id,t.type=e.type,t.args=JSON.stringify(e.args),t})),console.log("Total time:",a.getTotalTime(e).toFixed(2)+" ms")},_recordWrite:function(e,t,n,r){var o=u._allMeasurements[u._allMeasurements.length-1].writes;o[e]=o[e]||[],o[e].push({type:t,time:n,args:r})},measure:function(e,t,n){return function(){for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];var c,p,d;if("_renderNewRootComponent"===t||"flushBatchedUpdates"===t)return u._allMeasurements.push({exclusive:{},inclusive:{},render:{},counts:{},writes:{},displayNames:{},totalTime:0,created:{}}),d=l(),p=n.apply(this,i),u._allMeasurements[u._allMeasurements.length-1].totalTime=l()-d,p;if("_mountImageIntoNode"===t||"ReactBrowserEventEmitter"===e||"ReactDOMIDOperations"===e||"CSSPropertyOperations"===e||"DOMChildrenOperations"===e||"DOMPropertyOperations"===e){if(d=l(),p=n.apply(this,i),c=l()-d,"_mountImageIntoNode"===t){var f=s.getID(i[1]);u._recordWrite(f,t,c,i[0])}else if("dangerouslyProcessChildrenUpdates"===t)i[0].forEach(function(e){var t={};null!==e.fromIndex&&(t.fromIndex=e.fromIndex),null!==e.toIndex&&(t.toIndex=e.toIndex),null!==e.textContent&&(t.textContent=e.textContent),null!==e.markupIndex&&(t.markup=i[1][e.markupIndex]),u._recordWrite(e.parentID,e.type,c,t)});else{var h=i[0];"object"==typeof h&&(h=s.getID(i[0])),u._recordWrite(h,t,c,Array.prototype.slice.call(i,1))}return p}if("ReactCompositeComponent"!==e||"mountComponent"!==t&&"updateComponent"!==t&&"_renderValidatedComponent"!==t)return n.apply(this,i);if(this._currentElement.type===s.TopLevelWrapper)return n.apply(this,i);var m="mountComponent"===t?i[0]:this._rootNodeID,g="_renderValidatedComponent"===t,v="mountComponent"===t,y=u._mountStack,b=u._allMeasurements[u._allMeasurements.length-1];if(g?o(b.counts,m,1):v&&(b.created[m]=!0,y.push(0)),d=l(),p=n.apply(this,i),c=l()-d,g)o(b.render,m,c);else if(v){var _=y.pop();y[y.length-1]+=c,o(b.exclusive,m,c-_),o(b.inclusive,m,c)}else o(b.inclusive,m,c);return b.displayNames[m]={current:this.getName(),owner:this._currentElement._owner?this._currentElement._owner.getName():"<root>"},p}}};t.exports=u},{"./DOMProperty":157,"./ReactDefaultPerfAnalysis":199,"./ReactMount":213,"./ReactPerf":219,"fbjs/lib/performanceNow":93}],199:[function(e,t,n){"use strict";function r(e){var t={},n=Object.keys(e.writes),r=o({},e.exclusive,e.inclusive);for(var i in r){for(var a=!1,s=0;s<n.length;s++)if(0===n[s].indexOf(i)){a=!0;break}e.created[i]&&(a=!0),!a&&e.counts[i]>0&&(t[i]=!0)}return t}var o=e("./Object.assign"),i=1.2,a={_mountImageIntoNode:"set innerHTML",INSERT_MARKUP:"set innerHTML",MOVE_EXISTING:"move",REMOVE_NODE:"remove",SET_MARKUP:"set innerHTML",TEXT_CONTENT:"set textContent",setValueForProperty:"update attribute",setValueForAttribute:"update attribute",deleteValueForProperty:"remove attribute",setValueForStyles:"update styles",replaceNodeWithMarkup:"replace",updateTextContent:"set textContent"},s={getExclusiveSummary:function(e){for(var t,n={},r=0;r<e.length;r++){var a=e[r],s=o({},a.exclusive,a.inclusive);for(var c in s)n[t=a.displayNames[c].current]=n[t]||{componentName:t,inclusive:0,exclusive:0,render:0,count:0},a.render[c]&&(n[t].render+=a.render[c]),a.exclusive[c]&&(n[t].exclusive+=a.exclusive[c]),a.inclusive[c]&&(n[t].inclusive+=a.inclusive[c]),a.counts[c]&&(n[t].count+=a.counts[c])}var l=[];for(t in n)n[t].exclusive>=i&&l.push(n[t]);return l.sort(function(e,t){return t.exclusive-e.exclusive}),l},getInclusiveSummary:function(e,t){for(var n,a={},s=0;s<e.length;s++){var c,l=e[s],u=o({},l.exclusive,l.inclusive);t&&(c=r(l));for(var p in u)if(!t||c[p]){var d=l.displayNames[p];a[n=d.owner+" > "+d.current]=a[n]||{componentName:n,time:0,count:0},l.inclusive[p]&&(a[n].time+=l.inclusive[p]),l.counts[p]&&(a[n].count+=l.counts[p])}}var f=[];for(n in a)a[n].time>=i&&f.push(a[n]);return f.sort(function(e,t){return t.time-e.time}),f},getDOMSummary:function(e){var t=[];return e.forEach(function(e){Object.keys(e.writes).forEach(function(n){e.writes[n].forEach(function(e){t.push({id:n,type:a[e.type]||e.type,args:e.args})})})}),t},getTotalTime:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].totalTime;return t}};t.exports=s},{"./Object.assign":170}],200:[function(e,t,n){(function(n){"use strict";var r=e("./ReactCurrentOwner"),o=e("./Object.assign"),i=e("./canDefineProperty"),a="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,s={key:!0,ref:!0,__self:!0,__source:!0},c=function(e,t,r,o,s,c,l){var u={$$typeof:a,type:e,key:t,ref:r,props:l,_owner:c};return"production"!==n.env.NODE_ENV&&(u._store={},i?(Object.defineProperty(u._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(u,"_self",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(u,"_source",{configurable:!1,enumerable:!1,writable:!1,value:s})):(u._store.validated=!1,u._self=o,u._source=s),Object.freeze(u.props),Object.freeze(u)),u};c.createElement=function(e,t,n){var o,i={},a=null,l=null,u=null,p=null;if(null!=t){l=void 0===t.ref?null:t.ref,a=void 0===t.key?null:""+t.key,u=void 0===t.__self?null:t.__self,p=void 0===t.__source?null:t.__source;for(o in t)t.hasOwnProperty(o)&&!s.hasOwnProperty(o)&&(i[o]=t[o])}var d=arguments.length-2;if(1===d)i.children=n;else if(d>1){for(var f=Array(d),h=0;h<d;h++)f[h]=arguments[h+2];i.children=f}if(e&&e.defaultProps){var m=e.defaultProps;for(o in m)void 0===i[o]&&(i[o]=m[o])}return c(e,a,l,u,p,r.current,i)},c.createFactory=function(e){var t=c.createElement.bind(null,e);return t.type=e,t},c.cloneAndReplaceKey=function(e,t){return c(e.type,t,e.ref,e._self,e._source,e._owner,e.props)},c.cloneAndReplaceProps=function(e,t){var r=c(e.type,e.key,e.ref,e._self,e._source,e._owner,t);return"production"!==n.env.NODE_ENV&&(r._store.validated=e._store.validated),r},c.cloneElement=function(e,t,n){var i,a=o({},e.props),l=e.key,u=e.ref,p=e._self,d=e._source,f=e._owner;if(null!=t){void 0!==t.ref&&(u=t.ref,f=r.current),void 0!==t.key&&(l=""+t.key);for(i in t)t.hasOwnProperty(i)&&!s.hasOwnProperty(i)&&(a[i]=t[i])}var h=arguments.length-2;if(1===h)a.children=n;else if(h>1){for(var m=Array(h),g=0;g<h;g++)m[g]=arguments[g+2];a.children=m}return c(e.type,l,u,p,d,f,a)},c.isValidElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.exports=c}).call(this,e("_process"))},{"./Object.assign":170,"./ReactCurrentOwner":182,"./canDefineProperty":252,_process:146}],201:[function(e,t,n){(function(n){"use strict";function r(){if(d.current){var e=d.current.getName();if(e)return" Check the render method of `"+e+"`."}return""}function o(e,t){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var r=i("uniqueKey",e,t);null!==r&&"production"!==n.env.NODE_ENV&&g(!1,'Each child in an array or iterator should have a unique "key" prop.%s%s%s',r.parentOrOwner||"",r.childOwner||"",r.url||"")}}function i(e,t,n){var o=r();if(!o){var i="string"==typeof n?n:n.displayName||n.name;i&&(o=" Check the top-level render call using <"+i+">.")}var a=v[e]||(v[e]={});if(a[o])return null;a[o]=!0;var s={parentOrOwner:o,url:" See https://fb.me/react-warning-keys for more information.",childOwner:null};return t&&t._owner&&t._owner!==d.current&&(s.childOwner=" It was passed a child from "+t._owner.getName()+"."),s}function a(e,t){if("object"==typeof e)if(Array.isArray(e))for(var n=0;n<e.length;n++){var r=e[n];l.isValidElement(r)&&o(r,t)}else if(l.isValidElement(e))e._store&&(e._store.validated=!0);else if(e){var i=h(e);if(i&&i!==e.entries)for(var a,s=i.call(e);!(a=s.next()).done;)l.isValidElement(a.value)&&o(a.value,t)}}function s(e,t,o,i){for(var a in t)if(t.hasOwnProperty(a)){var s;try{"function"!=typeof t[a]&&("production"!==n.env.NODE_ENV?m(!1,"%s: %s type `%s` is invalid; it must be a function, usually from React.PropTypes.",e||"React class",p[i],a):m(!1)),s=t[a](o,a,e,i,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){s=e}if("production"!==n.env.NODE_ENV&&g(!s||s instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",e||"React class",p[i],a,typeof s),s instanceof Error&&!(s.message in y)){y[s.message]=!0;var c=r();"production"!==n.env.NODE_ENV&&g(!1,"Failed propType: %s%s",s.message,c)}}}function c(e){var t=e.type;if("function"==typeof t){var r=t.displayName||t.name;t.propTypes&&s(r,t.propTypes,e.props,u.prop),"function"==typeof t.getDefaultProps&&"production"!==n.env.NODE_ENV&&g(t.getDefaultProps.isReactClassApproved,"getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}var l=e("./ReactElement"),u=e("./ReactPropTypeLocations"),p=e("./ReactPropTypeLocationNames"),d=e("./ReactCurrentOwner"),f=e("./canDefineProperty"),h=e("./getIteratorFn"),m=e("fbjs/lib/invariant"),g=e("fbjs/lib/warning"),v={},y={},b={createElement:function(e,t,o){var i="string"==typeof e||"function"==typeof e;"production"!==n.env.NODE_ENV&&g(i,"React.createElement: type should not be null, undefined, boolean, or number. It should be a string (for DOM elements) or a ReactClass (for composite components).%s",r());var s=l.createElement.apply(this,arguments);if(null==s)return s;if(i)for(var u=2;u<arguments.length;u++)a(arguments[u],e);return c(s),s},createFactory:function(e){var t=b.createElement.bind(null,e);return t.type=e,"production"!==n.env.NODE_ENV&&f&&Object.defineProperty(t,"type",{enumerable:!1,get:function(){return"production"!==n.env.NODE_ENV&&g(!1,"Factory.type is deprecated. Access the class directly before passing it to createFactory."),Object.defineProperty(this,"type",{value:e}),e}}),t},cloneElement:function(e,t,n){for(var r=l.cloneElement.apply(this,arguments),o=2;o<arguments.length;o++)a(arguments[o],r.type);return c(r),r}};t.exports=b}).call(this,e("_process"))},{"./ReactCurrentOwner":182,"./ReactElement":200,"./ReactPropTypeLocationNames":220,"./ReactPropTypeLocations":221,"./canDefineProperty":252,"./getIteratorFn":263,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],202:[function(e,t,n){"use strict";function r(){a.registerNullComponentID(this._rootNodeID)}var o,i=e("./ReactElement"),a=e("./ReactEmptyComponentRegistry"),s=e("./ReactReconciler"),c={injectEmptyComponent:function(e){o=i.createElement(e)}},l=function(e){this._currentElement=null,this._rootNodeID=null,this._renderedComponent=e(o)};e("./Object.assign")(l.prototype,{construct:function(e){},mountComponent:function(e,t,n){return t.getReactMountReady().enqueue(r,this),this._rootNodeID=e,s.mountComponent(this._renderedComponent,e,t,n)},receiveComponent:function(){},unmountComponent:function(e,t,n){s.unmountComponent(this._renderedComponent),a.deregisterNullComponentID(this._rootNodeID),this._rootNodeID=null,this._renderedComponent=null}}),l.injection=c,t.exports=l},{"./Object.assign":170,"./ReactElement":200,"./ReactEmptyComponentRegistry":203,"./ReactReconciler":224}],203:[function(e,t,n){"use strict";var r={},o={isNullComponentID:function(e){return!!r[e]},registerNullComponentID:function(e){r[e]=!0},deregisterNullComponentID:function(e){delete r[e]}};t.exports=o},{}],204:[function(e,t,n){(function(e){"use strict";function n(e,t,n,o){try{return t(n,o)}catch(e){return void(null===r&&(r=e))}}var r=null,o={invokeGuardedCallback:n,invokeGuardedCallbackWithCatch:n,rethrowCaughtError:function(){if(r){var e=r;throw r=null,e}}};if("production"!==e.env.NODE_ENV&&"undefined"!=typeof window&&"function"==typeof window.dispatchEvent&&"undefined"!=typeof document&&"function"==typeof document.createEvent){var i=document.createElement("react");o.invokeGuardedCallback=function(e,t,n,r){var o=t.bind(null,n,r),a="react-"+e;i.addEventListener(a,o,!1);var s=document.createEvent("Event");s.initEvent(a,!1,!1),i.dispatchEvent(s),i.removeEventListener(a,o,!1)}}t.exports=o}).call(this,e("_process"))},{_process:146}],205:[function(e,t,n){"use strict";function r(e){o.enqueueEvents(e),o.processEventQueue(!1)}var o=e("./EventPluginHub"),i={handleTopLevel:function(e,t,n,i,a){r(o.extractEvents(e,t,n,i,a))}};t.exports=i},{"./EventPluginHub":163}],206:[function(e,t,n){"use strict";function r(e){var t=d.getID(e),n=p.getReactRootIDFromNodeID(t),r=d.findReactContainerForID(n);return d.getFirstReactDOM(r)}function o(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function i(e){a(e)}function a(e){for(var t=d.getFirstReactDOM(m(e.nativeEvent))||window,n=t;n;)e.ancestors.push(n),n=r(n);for(var o=0;o<e.ancestors.length;o++){t=e.ancestors[o];var i=d.getID(t)||"";v._handleTopLevel(e.topLevelType,t,i,e.nativeEvent,m(e.nativeEvent))}}function s(e){e(g(window))}var c=e("fbjs/lib/EventListener"),l=e("fbjs/lib/ExecutionEnvironment"),u=e("./PooledClass"),p=e("./ReactInstanceHandles"),d=e("./ReactMount"),f=e("./ReactUpdates"),h=e("./Object.assign"),m=e("./getEventTarget"),g=e("fbjs/lib/getUnboundedScrollPosition");h(o.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),u.addPoolingTo(o,u.twoArgumentPooler);var v={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:l.canUseDOM?window:null,setHandleTopLevel:function(e){v._handleTopLevel=e},setEnabled:function(e){v._enabled=!!e},isEnabled:function(){return v._enabled},trapBubbledEvent:function(e,t,n){var r=n;return r?c.listen(r,t,v.dispatchEvent.bind(null,e)):null},trapCapturedEvent:function(e,t,n){var r=n;return r?c.capture(r,t,v.dispatchEvent.bind(null,e)):null},monitorScrollValue:function(e){var t=s.bind(null,e);c.listen(window,"scroll",t)},dispatchEvent:function(e,t){if(v._enabled){var n=o.getPooled(e,t);try{f.batchedUpdates(i,n)}finally{o.release(n)}}}};t.exports=v},{"./Object.assign":170,"./PooledClass":171,"./ReactInstanceHandles":209,"./ReactMount":213,"./ReactUpdates":231,"./getEventTarget":262,"fbjs/lib/EventListener":70,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/getUnboundedScrollPosition":82}],207:[function(e,t,n){"use strict";var r=e("./DOMProperty"),o=e("./EventPluginHub"),i=e("./ReactComponentEnvironment"),a=e("./ReactClass"),s=e("./ReactEmptyComponent"),c=e("./ReactBrowserEventEmitter"),l=e("./ReactNativeComponent"),u=e("./ReactPerf"),p=e("./ReactRootIndex"),d=e("./ReactUpdates"),f={Component:i.injection,Class:a.injection,DOMProperty:r.injection,EmptyComponent:s.injection,EventPluginHub:o.injection,EventEmitter:c.injection,NativeComponent:l.injection,Perf:u.injection,RootIndex:p.injection,Updates:d.injection};t.exports=f},{"./DOMProperty":157,"./EventPluginHub":163,"./ReactBrowserEventEmitter":174,"./ReactClass":177,"./ReactComponentEnvironment":180,"./ReactEmptyComponent":202,"./ReactNativeComponent":216,"./ReactPerf":219,"./ReactRootIndex":226,"./ReactUpdates":231}],208:[function(e,t,n){"use strict";function r(e){return i(document.documentElement,e)}var o=e("./ReactDOMSelection"),i=e("fbjs/lib/containsNode"),a=e("fbjs/lib/focusNode"),s=e("fbjs/lib/getActiveElement"),c={hasSelectionCapabilities:function(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&"text"===e.type||"textarea"===t||"true"===e.contentEditable)},getSelectionInformation:function(){var e=s();return{focusedElem:e,selectionRange:c.hasSelectionCapabilities(e)?c.getSelection(e):null}},restoreSelection:function(e){var t=s(),n=e.focusedElem,o=e.selectionRange;t!==n&&r(n)&&(c.hasSelectionCapabilities(n)&&c.setSelection(n,o),a(n))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=o.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,r=t.end;if(void 0===r&&(r=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(r,e.value.length);else if(document.selection&&e.nodeName&&"input"===e.nodeName.toLowerCase()){var i=e.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",r-n),i.select()}else o.setOffsets(e,t)}};t.exports=c},{"./ReactDOMSelection":192,"fbjs/lib/containsNode":74,"fbjs/lib/focusNode":79,"fbjs/lib/getActiveElement":80}],209:[function(e,t,n){(function(n){"use strict";function r(e){return f+e.toString(36)}function o(e,t){return e.charAt(t)===f||t===e.length}function i(e){return""===e||e.charAt(0)===f&&e.charAt(e.length-1)!==f}function a(e,t){return 0===t.indexOf(e)&&o(t,e.length)}function s(e){return e?e.substr(0,e.lastIndexOf(f)):""}function c(e,t){if(i(e)&&i(t)||("production"!==n.env.NODE_ENV?d(!1,"getNextDescendantID(%s, %s): Received an invalid React DOM ID.",e,t):d(!1)),a(e,t)||("production"!==n.env.NODE_ENV?d(!1,"getNextDescendantID(...): React has made an invalid assumption about the DOM hierarchy. Expected `%s` to be an ancestor of `%s`.",e,t):d(!1)),e===t)return e;var r;for(r=e.length+h;r<t.length&&!o(t,r);r++);return t.substr(0,r)}function l(e,t){var r=Math.min(e.length,t.length);if(0===r)return"";for(var a=0,s=0;s<=r;s++)if(o(e,s)&&o(t,s))a=s;else if(e.charAt(s)!==t.charAt(s))break;var c=e.substr(0,a);return i(c)||("production"!==n.env.NODE_ENV?d(!1,"getFirstCommonAncestorID(%s, %s): Expected a valid React DOM ID: %s",e,t,c):d(!1)),c}function u(e,t,r,o,i,l){(e=e||"")===(t=t||"")&&("production"!==n.env.NODE_ENV?d(!1,"traverseParentPath(...): Cannot traverse from and to the same ID, `%s`.",e):d(!1));var u=a(t,e);u||a(e,t)||("production"!==n.env.NODE_ENV?d(!1,"traverseParentPath(%s, %s, ...): Cannot traverse from two IDs that do not have a parent path.",e,t):d(!1));for(var p=0,f=u?s:c,h=e;;h=f(h,t)){var g;if(i&&h===e||l&&h===t||(g=r(h,u,o)),!1===g||h===t)break;p++<m||("production"!==n.env.NODE_ENV?d(!1,"traverseParentPath(%s, %s, ...): Detected an infinite loop while traversing the React DOM ID tree. This may be due to malformed IDs: %s",e,t,h):d(!1))}}var p=e("./ReactRootIndex"),d=e("fbjs/lib/invariant"),f=".",h=f.length,m=1e4,g={createReactRootID:function(){return r(p.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===f&&e.length>1){var t=e.indexOf(f,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,r,o){var i=l(e,t);i!==e&&u(e,i,n,r,!1,!0),i!==t&&u(i,t,n,o,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(u("",e,t,n,!0,!1),u(e,"",t,n,!1,!0))},traverseTwoPhaseSkipTarget:function(e,t,n){e&&(u("",e,t,n,!0,!0),u(e,"",t,n,!0,!0))},traverseAncestors:function(e,t,n){u("",e,t,n,!0,!1)},getFirstCommonAncestorID:l,_getNextDescendantID:c,isAncestorIDOf:a,SEPARATOR:f};t.exports=g}).call(this,e("_process"))},{"./ReactRootIndex":226,_process:146,"fbjs/lib/invariant":85}],210:[function(e,t,n){"use strict";var r={remove:function(e){e._reactInternalInstance=void 0},get:function(e){return e._reactInternalInstance},has:function(e){return void 0!==e._reactInternalInstance},set:function(e,t){e._reactInternalInstance=t}};t.exports=r},{}],211:[function(e,t,n){(function(n){"use strict";var r=e("./ReactChildren"),o=e("./ReactComponent"),i=e("./ReactClass"),a=e("./ReactDOMFactories"),s=e("./ReactElement"),c=e("./ReactElementValidator"),l=e("./ReactPropTypes"),u=e("./ReactVersion"),p=e("./Object.assign"),d=e("./onlyChild"),f=s.createElement,h=s.createFactory,m=s.cloneElement;"production"!==n.env.NODE_ENV&&(f=c.createElement,h=c.createFactory,m=c.cloneElement);var g={Children:{map:r.map,forEach:r.forEach,count:r.count,toArray:r.toArray,only:d},Component:o,createElement:f,cloneElement:m,isValidElement:s.isValidElement,PropTypes:l,createClass:i.createClass,createFactory:h,createMixin:function(e){return e},DOM:a,version:u,__spread:p};t.exports=g}).call(this,e("_process"))},{"./Object.assign":170,"./ReactChildren":176,"./ReactClass":177,"./ReactComponent":178,"./ReactDOMFactories":186,"./ReactElement":200,"./ReactElementValidator":201,"./ReactPropTypes":222,"./ReactVersion":232,"./onlyChild":269,_process:146}],212:[function(e,t,n){"use strict";var r=e("./adler32"),o=/\/?>/,i={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=r(e);return e.replace(o," "+i.CHECKSUM_ATTR_NAME+'="'+t+'"$&')},canReuseMarkup:function(e,t){var n=t.getAttribute(i.CHECKSUM_ATTR_NAME);return n=n&&parseInt(n,10),r(e)===n}};t.exports=i},{"./adler32":251}],213:[function(e,t,n){(function(n){"use strict";function r(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++)if(e.charAt(r)!==t.charAt(r))return r;return e.length===t.length?-1:n}function o(e){return e?e.nodeType===U?e.documentElement:e.firstChild:null}function i(e){var t=o(e);return t&&Y.getID(t)}function a(e){return e&&e.getAttribute&&e.getAttribute(L)||""}function s(e,t){if(e){a(e)!==t&&("production"!==n.env.NODE_ENV?A(!1,"ReactMount: Unexpected modification of `%s`",L):A(!1));var r=Y.findReactContainerForID(t);if(r&&D(r,e))return!0}return!1}function c(e){var t=F[e];if(!t||!s(t,e))return!1;z=t}function l(e){z=null,E.traverseAncestors(e,c);var t=z;return z=null,t}function u(e,t,r,o,i,a){if(y.useCreateElement&&(a=T({},a),r.nodeType===U?a[B]=r:a[B]=r.ownerDocument),"production"!==n.env.NODE_ENV){a===O&&(a={});var s=r.nodeName.toLowerCase();a[j.ancestorInfoContextKey]=j.updatedAncestorInfo(null,s,null)}var c=C.mountComponent(e,t,o,a);e._renderedComponent._topLevelWrapper=e,Y._mountImageIntoNode(c,r,i,o)}function p(e,t,n,r,o){var i=N.ReactReconcileTransaction.getPooled(r);i.perform(u,null,e,t,n,i,r,o),N.ReactReconcileTransaction.release(i)}function d(e,t){for(C.unmountComponent(e),t.nodeType===U&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)}function f(e){var t=i(e);return!!t&&t!==E.getReactRootIDFromNodeID(t)}function h(e){for(;e&&e.parentNode!==e;e=e.parentNode)if(1===e.nodeType){var t=a(e);if(t){var n,r=E.getReactRootIDFromNodeID(t),o=e;do{if(n=a(o),null==(o=o.parentNode))return null}while(n!==r);if(o===q[r])return e}}return null}var m=e("./DOMProperty"),g=e("./ReactBrowserEventEmitter"),v=e("./ReactCurrentOwner"),y=e("./ReactDOMFeatureFlags"),b=e("./ReactElement"),_=e("./ReactEmptyComponentRegistry"),E=e("./ReactInstanceHandles"),w=e("./ReactInstanceMap"),k=e("./ReactMarkupChecksum"),x=e("./ReactPerf"),C=e("./ReactReconciler"),S=e("./ReactUpdateQueue"),N=e("./ReactUpdates"),T=e("./Object.assign"),O=e("fbjs/lib/emptyObject"),D=e("fbjs/lib/containsNode"),R=e("./instantiateReactComponent"),A=e("fbjs/lib/invariant"),P=e("./setInnerHTML"),I=e("./shouldUpdateReactComponent"),j=e("./validateDOMNesting"),M=e("fbjs/lib/warning"),L=m.ID_ATTRIBUTE_NAME,F={},U=9,B="__ReactMount_ownerDocument$"+Math.random().toString(36).slice(2),V={},q={};if("production"!==n.env.NODE_ENV)var H={};var W=[],z=null,K=function(){};K.prototype.isReactComponent={},"production"!==n.env.NODE_ENV&&(K.displayName="TopLevelWrapper"),K.prototype.render=function(){return this.props};var Y={TopLevelWrapper:K,_instancesByReactRootID:V,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,r,a){return Y.scrollMonitor(r,function(){S.enqueueElementInternal(e,t),a&&S.enqueueCallbackInternal(e,a)}),"production"!==n.env.NODE_ENV&&(H[i(r)]=o(r)),e},_registerComponent:function(e,t){(!t||1!==t.nodeType&&t.nodeType!==U&&11!==t.nodeType)&&("production"!==n.env.NODE_ENV?A(!1,"_registerComponent(...): Target container is not a DOM element."):A(!1)),g.ensureScrollValueMonitoring();var r=Y.registerContainer(t);return V[r]=e,r},_renderNewRootComponent:function(e,t,r,i){"production"!==n.env.NODE_ENV&&M(null==v.current,"_renderNewRootComponent(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate. Check the render method of %s.",v.current&&v.current.getName()||"ReactCompositeComponent");var a=R(e,null),s=Y._registerComponent(a,t);return N.batchedUpdates(p,a,s,t,r,i),"production"!==n.env.NODE_ENV&&(H[s]=o(t)),a},renderSubtreeIntoContainer:function(e,t,r,o){return(null==e||null==e._reactInternalInstance)&&("production"!==n.env.NODE_ENV?A(!1,"parentComponent must be a valid React Component"):A(!1)),Y._renderSubtreeIntoContainer(e,t,r,o)},_renderSubtreeIntoContainer:function(e,t,r,s){b.isValidElement(t)||("production"!==n.env.NODE_ENV?A(!1,"ReactDOM.render(): Invalid component element.%s","string"==typeof t?" Instead of passing an element string, make sure to instantiate it by passing it to React.createElement.":"function"==typeof t?" Instead of passing a component class, make sure to instantiate it by passing it to React.createElement.":null!=t&&void 0!==t.props?" This may be caused by unintentionally loading two independent copies of React.":""):A(!1)),"production"!==n.env.NODE_ENV&&M(!r||!r.tagName||"BODY"!==r.tagName.toUpperCase(),"render(): Rendering components directly into document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try rendering into a container element created for your app.");var c=new b(K,null,null,null,null,null,t),l=V[i(r)];if(l){var u=l._currentElement.props;if(I(u,t)){var p=l._renderedComponent.getPublicInstance(),d=s&&function(){s.call(p)};return Y._updateRootComponent(l,c,r,d),p}Y.unmountComponentAtNode(r)}var h=o(r),m=h&&!!a(h),g=f(r);if("production"!==n.env.NODE_ENV&&("production"!==n.env.NODE_ENV&&M(!g,"render(...): Replacing React-rendered children with a new root component. If you intended to update the children of this node, you should instead have the existing children update their state and render the new components instead of calling ReactDOM.render."),!m||h.nextSibling))for(var v=h;v;){if(a(v)){"production"!==n.env.NODE_ENV&&M(!1,"render(): Target node has markup rendered by React, but there are unrelated nodes as well. This is most commonly caused by white-space inserted around server-rendered markup.");break}v=v.nextSibling}var y=m&&!l&&!g,_=Y._renderNewRootComponent(c,r,y,null!=e?e._reactInternalInstance._processChildContext(e._reactInternalInstance._context):O)._renderedComponent.getPublicInstance();return s&&s.call(_),_},render:function(e,t,n){return Y._renderSubtreeIntoContainer(null,e,t,n)},registerContainer:function(e){var t=i(e);return t&&(t=E.getReactRootIDFromNodeID(t)),t||(t=E.createReactRootID()),q[t]=e,t},unmountComponentAtNode:function(e){"production"!==n.env.NODE_ENV&&M(null==v.current,"unmountComponentAtNode(): Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate. Check the render method of %s.",v.current&&v.current.getName()||"ReactCompositeComponent"),(!e||1!==e.nodeType&&e.nodeType!==U&&11!==e.nodeType)&&("production"!==n.env.NODE_ENV?A(!1,"unmountComponentAtNode(...): Target container is not a DOM element."):A(!1));var t=i(e),r=V[t];if(!r){var o=f(e),s=a(e),c=s&&s===E.getReactRootIDFromNodeID(s);return"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&M(!o,"unmountComponentAtNode(): The node you're attempting to unmount was rendered by React and is not a top-level container. %s",c?"You may have accidentally passed in a React root node instead of its container.":"Instead, have the parent component update its state and rerender in order to remove this component."),!1}return N.batchedUpdates(d,r,e),delete V[t],delete q[t],"production"!==n.env.NODE_ENV&&delete H[t],!0},findReactContainerForID:function(e){var t=E.getReactRootIDFromNodeID(e),r=q[t];if("production"!==n.env.NODE_ENV){var o=H[t];if(o&&o.parentNode!==r){"production"!==n.env.NODE_ENV&&M(a(o)===t,"ReactMount: Root element ID differed from reactRootID.");var i=r.firstChild;i&&t===a(i)?H[t]=i:"production"!==n.env.NODE_ENV&&M(!1,"ReactMount: Root element has been removed from its original container. New container: %s",o.parentNode)}}return r},findReactNodeByID:function(e){var t=Y.findReactContainerForID(e);return Y.findComponentRoot(t,e)},getFirstReactDOM:function(e){return h(e)},findComponentRoot:function(e,t){var r=W,o=0,i=l(t)||e;for("production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&M(null!=i,"React can't find the root component node for data-reactid value `%s`. If you're seeing this message, it probably means that you've loaded two copies of React on the page. At this time, only a single copy of React can be loaded at a time.",t),r[0]=i.firstChild,r.length=1;o<r.length;){for(var a,s=r[o++];s;){var c=Y.getID(s);c?t===c?a=s:E.isAncestorIDOf(c,t)&&(r.length=o=0,r.push(s.firstChild)):r.push(s.firstChild),s=s.nextSibling}if(a)return r.length=0,a}r.length=0,"production"!==n.env.NODE_ENV?A(!1,"findComponentRoot(..., %s): Unable to find element. This probably means the DOM was unexpectedly mutated (e.g., by the browser), usually due to forgetting a <tbody> when using tables, nesting tags like <form>, <p>, or <a>, or using non-SVG elements in an <svg> parent. Try inspecting the child nodes of the element with React ID `%s`.",t,Y.getID(e)):A(!1)},_mountImageIntoNode:function(e,t,i,a){if((!t||1!==t.nodeType&&t.nodeType!==U&&11!==t.nodeType)&&("production"!==n.env.NODE_ENV?A(!1,"mountComponentIntoNode(...): Target container is not valid."):A(!1)),i){var s=o(t);if(k.canReuseMarkup(e,s))return;var c=s.getAttribute(k.CHECKSUM_ATTR_NAME);s.removeAttribute(k.CHECKSUM_ATTR_NAME);var l=s.outerHTML;s.setAttribute(k.CHECKSUM_ATTR_NAME,c);var u=e;if("production"!==n.env.NODE_ENV){var p;1===t.nodeType?((p=document.createElement("div")).innerHTML=e,u=p.innerHTML):(p=document.createElement("iframe"),document.body.appendChild(p),p.contentDocument.write(e),u=p.contentDocument.documentElement.outerHTML,document.body.removeChild(p))}var d=r(u,l),f=" (client) "+u.substring(d-20,d+20)+"\n (server) "+l.substring(d-20,d+20);t.nodeType===U&&("production"!==n.env.NODE_ENV?A(!1,"You're trying to render a component to the document using server rendering but the checksum was invalid. This usually means you rendered a different component type or props on the client from the one on the server, or your render() methods are impure. React cannot handle this case due to cross-browser quirks by rendering at the document root. You should look for environment dependent code in your components and ensure the props are the same client and server side:\n%s",f):A(!1)),"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&M(!1,"React attempted to reuse markup in a container but the checksum was invalid. This generally means that you are using server rendering and the markup generated on the server was not what the client was expecting. React injected new markup to compensate which works but you have lost many of the benefits of server rendering. Instead, figure out why the markup being generated is different on the client or server:\n%s",f)}if(t.nodeType===U&&("production"!==n.env.NODE_ENV?A(!1,"You're trying to render a component to the document but you didn't use server rendering. We can't do this without using server rendering due to cross-browser quirks. See ReactDOMServer.renderToString() for server rendering."):A(!1)),a.useCreateElement){for(;t.lastChild;)t.removeChild(t.lastChild);t.appendChild(e)}else P(t,e)},ownerDocumentContextKey:B,getReactRootID:i,getID:function(e){var t=a(e);if(t)if(F.hasOwnProperty(t)){var r=F[t];r!==e&&(s(r,t)&&("production"!==n.env.NODE_ENV?A(!1,"ReactMount: Two valid but unequal nodes with the same `%s`: %s",L,t):A(!1)),F[t]=e)}else F[t]=e;return t},setID:function(e,t){var n=a(e);n!==t&&delete F[n],e.setAttribute(L,t),F[t]=e},getNode:function(e){return F.hasOwnProperty(e)&&s(F[e],e)||(F[e]=Y.findReactNodeByID(e)),F[e]},getNodeFromInstance:function(e){var t=w.get(e)._rootNodeID;return _.isNullComponentID(t)?null:(F.hasOwnProperty(t)&&s(F[t],t)||(F[t]=Y.findReactNodeByID(t)),F[t])},isValid:s,purgeID:function(e){delete F[e]}};x.measureMethods(Y,"ReactMount",{_renderNewRootComponent:"_renderNewRootComponent",_mountImageIntoNode:"_mountImageIntoNode"}),t.exports=Y}).call(this,e("_process"))},{"./DOMProperty":157,"./Object.assign":170,"./ReactBrowserEventEmitter":174,"./ReactCurrentOwner":182,"./ReactDOMFeatureFlags":187,"./ReactElement":200,"./ReactEmptyComponentRegistry":203,"./ReactInstanceHandles":209,"./ReactInstanceMap":210,"./ReactMarkupChecksum":212,"./ReactPerf":219,"./ReactReconciler":224,"./ReactUpdateQueue":230,"./ReactUpdates":231,"./instantiateReactComponent":266,"./setInnerHTML":272,"./shouldUpdateReactComponent":274,"./validateDOMNesting":276,_process:146,"fbjs/lib/containsNode":74,"fbjs/lib/emptyObject":78,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],214:[function(e,t,n){(function(n){"use strict";function r(e,t,n){v.push({parentID:e,parentNode:null,type:p.INSERT_MARKUP,markupIndex:y.push(t)-1,content:null,fromIndex:null,toIndex:n})}function o(e,t,n){v.push({parentID:e,parentNode:null,type:p.MOVE_EXISTING,markupIndex:null,content:null,fromIndex:t,toIndex:n})}function i(e,t){v.push({parentID:e,parentNode:null,type:p.REMOVE_NODE,markupIndex:null,content:null,fromIndex:t,toIndex:null})}function a(e,t){v.push({parentID:e,parentNode:null,type:p.SET_MARKUP,markupIndex:null,content:t,fromIndex:null,toIndex:null})}function s(e,t){v.push({parentID:e,parentNode:null,type:p.TEXT_CONTENT,markupIndex:null,content:t,fromIndex:null,toIndex:null})}function c(){v.length&&(u.processChildrenUpdates(v,y),l())}function l(){v.length=0,y.length=0}var u=e("./ReactComponentEnvironment"),p=e("./ReactMultiChildUpdateTypes"),d=e("./ReactCurrentOwner"),f=e("./ReactReconciler"),h=e("./ReactChildReconciler"),m=e("./flattenChildren"),g=0,v=[],y=[],b={Mixin:{_reconcilerInstantiateChildren:function(e,t,r){if("production"!==n.env.NODE_ENV&&this._currentElement)try{return d.current=this._currentElement._owner,h.instantiateChildren(e,t,r)}finally{d.current=null}return h.instantiateChildren(e,t,r)},_reconcilerUpdateChildren:function(e,t,r,o){var i;if("production"!==n.env.NODE_ENV&&this._currentElement){try{d.current=this._currentElement._owner,i=m(t)}finally{d.current=null}return h.updateChildren(e,i,r,o)}return i=m(t),h.updateChildren(e,i,r,o)},mountChildren:function(e,t,n){var r=this._reconcilerInstantiateChildren(e,t,n);this._renderedChildren=r;var o=[],i=0;for(var a in r)if(r.hasOwnProperty(a)){var s=r[a],c=this._rootNodeID+a,l=f.mountComponent(s,c,t,n);s._mountIndex=i++,o.push(l)}return o},updateTextContent:function(e){g++;var t=!0;try{var n=this._renderedChildren;h.unmountChildren(n);for(var r in n)n.hasOwnProperty(r)&&this._unmountChild(n[r]);this.setTextContent(e),t=!1}finally{--g||(t?l():c())}},updateMarkup:function(e){g++;var t=!0;try{var n=this._renderedChildren;h.unmountChildren(n);for(var r in n)n.hasOwnProperty(r)&&this._unmountChildByName(n[r],r);this.setMarkup(e),t=!1}finally{--g||(t?l():c())}},updateChildren:function(e,t,n){g++;var r=!0;try{this._updateChildren(e,t,n),r=!1}finally{--g||(r?l():c())}},_updateChildren:function(e,t,n){var r=this._renderedChildren,o=this._reconcilerUpdateChildren(r,e,t,n);if(this._renderedChildren=o,o||r){var i,a=0,s=0;for(i in o)if(o.hasOwnProperty(i)){var c=r&&r[i],l=o[i];c===l?(this.moveChild(c,s,a),a=Math.max(c._mountIndex,a),c._mountIndex=s):(c&&(a=Math.max(c._mountIndex,a),this._unmountChild(c)),this._mountChildByNameAtIndex(l,i,s,t,n)),s++}for(i in r)!r.hasOwnProperty(i)||o&&o.hasOwnProperty(i)||this._unmountChild(r[i])}},unmountChildren:function(){var e=this._renderedChildren;h.unmountChildren(e),this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&o(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){r(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){i(this._rootNodeID,e._mountIndex)},setTextContent:function(e){s(this._rootNodeID,e)},setMarkup:function(e){a(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,r,o){var i=this._rootNodeID+t,a=f.mountComponent(e,i,r,o);e._mountIndex=n,this.createChild(e,a)},_unmountChild:function(e){this.removeChild(e),e._mountIndex=null}}};t.exports=b}).call(this,e("_process"))},{"./ReactChildReconciler":175,"./ReactComponentEnvironment":180,"./ReactCurrentOwner":182,"./ReactMultiChildUpdateTypes":215,"./ReactReconciler":224,"./flattenChildren":257,_process:146}],215:[function(e,t,n){"use strict";var r=e("fbjs/lib/keyMirror")({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,SET_MARKUP:null,TEXT_CONTENT:null});t.exports=r},{"fbjs/lib/keyMirror":88}],216:[function(e,t,n){(function(n){"use strict";var r=e("./Object.assign"),o=e("fbjs/lib/invariant"),i=null,a=null,s={},c=null,l={getComponentClassForElement:function(e){if("function"==typeof e.type)return e.type;var t=e.type,n=s[t];return null==n&&(s[t]=n=i(t)),n},createInternalComponent:function(e){return a||("production"!==n.env.NODE_ENV?o(!1,"There is no registered component for the tag %s",e.type):o(!1)),new a(e.type,e.props)},createInstanceForText:function(e){return new c(e)},isTextComponent:function(e){return e instanceof c},injection:{injectGenericComponentClass:function(e){a=e},injectTextComponentClass:function(e){c=e},injectComponentClasses:function(e){r(s,e)}}};t.exports=l}).call(this,e("_process"))},{"./Object.assign":170,_process:146,"fbjs/lib/invariant":85}],217:[function(e,t,n){(function(n){"use strict";function r(e,t){"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&o(!1,"%s(...): Can only update a mounted or mounting component. This usually means you called %s() on an unmounted component. This is a no-op. Please check the code for the %s component.",t,t,e.constructor&&e.constructor.displayName||"")}var o=e("fbjs/lib/warning"),i={isMounted:function(e){return!1},enqueueCallback:function(e,t){},enqueueForceUpdate:function(e){r(e,"forceUpdate")},enqueueReplaceState:function(e,t){r(e,"replaceState")},enqueueSetState:function(e,t){r(e,"setState")},enqueueSetProps:function(e,t){r(e,"setProps")},enqueueReplaceProps:function(e,t){r(e,"replaceProps")}};t.exports=i}).call(this,e("_process"))},{_process:146,"fbjs/lib/warning":96}],218:[function(e,t,n){(function(n){"use strict";var r=e("fbjs/lib/invariant"),o={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,i){o.isValidOwner(i)||("production"!==n.env.NODE_ENV?r(!1,"addComponentAsRefTo(...): Only a ReactOwner can have refs. You might be adding a ref to a component that was not created inside a component's `render` method, or you have multiple copies of React loaded (details: https://fb.me/react-refs-must-have-owner)."):r(!1)),i.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,i){o.isValidOwner(i)||("production"!==n.env.NODE_ENV?r(!1,"removeComponentAsRefFrom(...): Only a ReactOwner can have refs. You might be removing a ref to a component that was not created inside a component's `render` method, or you have multiple copies of React loaded (details: https://fb.me/react-refs-must-have-owner)."):r(!1)),i.getPublicInstance().refs[t]===e.getPublicInstance()&&i.detachRef(t)}};t.exports=o}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],219:[function(e,t,n){(function(e){"use strict";var n={enableMeasure:!1,storedMeasure:function(e,t,n){return n},measureMethods:function(t,r,o){if("production"!==e.env.NODE_ENV)for(var i in o)o.hasOwnProperty(i)&&(t[i]=n.measure(r,o[i],t[i]))},measure:function(t,r,o){if("production"!==e.env.NODE_ENV){var i=null,a=function(){return n.enableMeasure?(i||(i=n.storedMeasure(t,r,o)),i.apply(this,arguments)):o.apply(this,arguments)};return a.displayName=t+"_"+r,a}return o},injection:{injectMeasure:function(e){n.storedMeasure=e}}};t.exports=n}).call(this,e("_process"))},{_process:146}],220:[function(e,t,n){(function(e){"use strict";var n={};"production"!==e.env.NODE_ENV&&(n={prop:"prop",context:"context",childContext:"child context"}),t.exports=n}).call(this,e("_process"))},{_process:146}],221:[function(e,t,n){"use strict";var r=e("fbjs/lib/keyMirror")({prop:null,context:null,childContext:null});t.exports=r},{"fbjs/lib/keyMirror":88}],222:[function(e,t,n){"use strict";function r(e){function t(t,n,r,o,i,a){if(o=o||f,a=a||r,null==n[r]){var s=u[i];return t?new Error("Required "+s+" `"+a+"` was not specified in `"+o+"`."):null}return e(n,r,o,i,a)}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function o(e){return r(function(t,n,r,o,i){var c=t[n];if(a(c)!==e){var l=u[o],p=s(c);return new Error("Invalid "+l+" `"+i+"` of type `"+p+"` supplied to `"+r+"`, expected `"+e+"`.")}return null})}function i(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(i);if(null===e||l.isValidElement(e))return!0;var t=d(e);if(!t)return!1;var n,r=t.call(e);if(t!==e.entries){for(;!(n=r.next()).done;)if(!i(n.value))return!1}else for(;!(n=r.next()).done;){var o=n.value;if(o&&!i(o[1]))return!1}return!0;default:return!1}}function a(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function s(e){var t=a(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function c(e){return e.constructor&&e.constructor.name?e.constructor.name:"<<anonymous>>"}var l=e("./ReactElement"),u=e("./ReactPropTypeLocationNames"),p=e("fbjs/lib/emptyFunction"),d=e("./getIteratorFn"),f="<<anonymous>>",h={array:o("array"),bool:o("boolean"),func:o("function"),number:o("number"),object:o("object"),string:o("string"),any:r(p.thatReturns(null)),arrayOf:function(e){return r(function(t,n,r,o,i){var s=t[n];if(!Array.isArray(s)){var c=u[o],l=a(s);return new Error("Invalid "+c+" `"+i+"` of type `"+l+"` supplied to `"+r+"`, expected an array.")}for(var p=0;p<s.length;p++){var d=e(s,p,r,o,i+"["+p+"]","SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(d instanceof Error)return d}return null})},element:function(){return r(function(e,t,n,r,o){if(!l.isValidElement(e[t])){var i=u[r];return new Error("Invalid "+i+" `"+o+"` supplied to `"+n+"`, expected a single ReactElement.")}return null})}(),instanceOf:function(e){return r(function(t,n,r,o,i){if(!(t[n]instanceof e)){var a=u[o],s=e.name||f,l=c(t[n]);return new Error("Invalid "+a+" `"+i+"` of type `"+l+"` supplied to `"+r+"`, expected instance of `"+s+"`.")}return null})},node:function(){return r(function(e,t,n,r,o){if(!i(e[t])){var a=u[r];return new Error("Invalid "+a+" `"+o+"` supplied to `"+n+"`, expected a ReactNode.")}return null})}(),objectOf:function(e){return r(function(t,n,r,o,i){var s=t[n],c=a(s);if("object"!==c){var l=u[o];return new Error("Invalid "+l+" `"+i+"` of type `"+c+"` supplied to `"+r+"`, expected an object.")}for(var p in s)if(s.hasOwnProperty(p)){var d=e(s,p,r,o,i+"."+p,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(d instanceof Error)return d}return null})},oneOf:function(e){return r(Array.isArray(e)?function(t,n,r,o,i){for(var a=t[n],s=0;s<e.length;s++)if(a===e[s])return null;var c=u[o],l=JSON.stringify(e);return new Error("Invalid "+c+" `"+i+"` of value `"+a+"` supplied to `"+r+"`, expected one of "+l+".")}:function(){return new Error("Invalid argument supplied to oneOf, expected an instance of array.")})},oneOfType:function(e){return r(Array.isArray(e)?function(t,n,r,o,i){for(var a=0;a<e.length;a++)if(null==(0,e[a])(t,n,r,o,i,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"))return null;var s=u[o];return new Error("Invalid "+s+" `"+i+"` supplied to `"+r+"`.")}:function(){return new Error("Invalid argument supplied to oneOfType, expected an instance of array.")})},shape:function(e){return r(function(t,n,r,o,i){var s=t[n],c=a(s);if("object"!==c){var l=u[o];return new Error("Invalid "+l+" `"+i+"` of type `"+c+"` supplied to `"+r+"`, expected `object`.")}for(var p in e){var d=e[p];if(d){var f=d(s,p,r,o,i+"."+p,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED");if(f)return f}}return null})}};t.exports=h},{"./ReactElement":200,"./ReactPropTypeLocationNames":220,"./getIteratorFn":263,"fbjs/lib/emptyFunction":77}],223:[function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=o.getPooled(null),this.useCreateElement=!e&&s.useCreateElement}var o=e("./CallbackQueue"),i=e("./PooledClass"),a=e("./ReactBrowserEventEmitter"),s=e("./ReactDOMFeatureFlags"),c=e("./ReactInputSelection"),l=e("./Transaction"),u=e("./Object.assign"),p=[{initialize:c.getSelectionInformation,close:c.restoreSelection},{initialize:function(){var e=a.isEnabled();return a.setEnabled(!1),e},close:function(e){a.setEnabled(e)}},{initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}}],d={getTransactionWrappers:function(){return p},getReactMountReady:function(){return this.reactMountReady},destructor:function(){o.release(this.reactMountReady),this.reactMountReady=null}};u(r.prototype,l.Mixin,d),i.addPoolingTo(r),t.exports=r},{"./CallbackQueue":153,"./Object.assign":170,"./PooledClass":171,"./ReactBrowserEventEmitter":174,"./ReactDOMFeatureFlags":187,"./ReactInputSelection":208,"./Transaction":248}],224:[function(e,t,n){"use strict";function r(){o.attachRefs(this,this._currentElement)}var o=e("./ReactRef"),i={mountComponent:function(e,t,n,o){var i=e.mountComponent(t,n,o);return e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(r,e),i},unmountComponent:function(e){o.detachRefs(e,e._currentElement),e.unmountComponent()},receiveComponent:function(e,t,n,i){var a=e._currentElement;if(t!==a||i!==e._context){var s=o.shouldUpdateRefs(a,t);s&&o.detachRefs(e,a),e.receiveComponent(t,n,i),s&&e._currentElement&&null!=e._currentElement.ref&&n.getReactMountReady().enqueue(r,e)}},performUpdateIfNecessary:function(e,t){e.performUpdateIfNecessary(t)}};t.exports=i},{"./ReactRef":225}],225:[function(e,t,n){"use strict";function r(e,t,n){"function"==typeof e?e(t.getPublicInstance()):i.addComponentAsRefTo(t,e,n)}function o(e,t,n){"function"==typeof e?e(null):i.removeComponentAsRefFrom(t,e,n)}var i=e("./ReactOwner"),a={};a.attachRefs=function(e,t){if(null!==t&&!1!==t){var n=t.ref;null!=n&&r(n,e,t._owner)}},a.shouldUpdateRefs=function(e,t){var n=null===e||!1===e,r=null===t||!1===t;return n||r||t._owner!==e._owner||t.ref!==e.ref},a.detachRefs=function(e,t){if(null!==t&&!1!==t){var n=t.ref;null!=n&&o(n,e,t._owner)}},t.exports=a},{"./ReactOwner":218}],226:[function(e,t,n){"use strict";var r={createReactRootIndex:null,injection:{injectCreateReactRootIndex:function(e){r.createReactRootIndex=e}}};t.exports=r},{}],227:[function(e,t,n){"use strict";var r={isBatchingUpdates:!1,batchedUpdates:function(e){}};t.exports=r},{}],228:[function(e,t,n){(function(n){"use strict";var r=e("./ReactDefaultBatchingStrategy"),o=e("./ReactElement"),i=e("./ReactInstanceHandles"),a=e("./ReactMarkupChecksum"),s=e("./ReactServerBatchingStrategy"),c=e("./ReactServerRenderingTransaction"),l=e("./ReactUpdates"),u=e("fbjs/lib/emptyObject"),p=e("./instantiateReactComponent"),d=e("fbjs/lib/invariant");t.exports={renderToString:function(e){o.isValidElement(e)||("production"!==n.env.NODE_ENV?d(!1,"renderToString(): You must pass a valid ReactElement."):d(!1));var t;try{l.injection.injectBatchingStrategy(s);var f=i.createReactRootID();return(t=c.getPooled(!1)).perform(function(){var n=p(e,null).mountComponent(f,t,u);return a.addChecksumToMarkup(n)},null)}finally{c.release(t),l.injection.injectBatchingStrategy(r)}},renderToStaticMarkup:function(e){o.isValidElement(e)||("production"!==n.env.NODE_ENV?d(!1,"renderToStaticMarkup(): You must pass a valid ReactElement."):d(!1));var t;try{l.injection.injectBatchingStrategy(s);var a=i.createReactRootID();return(t=c.getPooled(!0)).perform(function(){return p(e,null).mountComponent(a,t,u)},null)}finally{c.release(t),l.injection.injectBatchingStrategy(r)}}}}).call(this,e("_process"))},{"./ReactDefaultBatchingStrategy":196,"./ReactElement":200,"./ReactInstanceHandles":209,"./ReactMarkupChecksum":212,"./ReactServerBatchingStrategy":227,"./ReactServerRenderingTransaction":229,"./ReactUpdates":231,"./instantiateReactComponent":266,_process:146,"fbjs/lib/emptyObject":78,"fbjs/lib/invariant":85}],229:[function(e,t,n){"use strict";function r(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=i.getPooled(null),this.useCreateElement=!1}var o=e("./PooledClass"),i=e("./CallbackQueue"),a=e("./Transaction"),s=e("./Object.assign"),c=[{initialize:function(){this.reactMountReady.reset()},close:e("fbjs/lib/emptyFunction")}],l={getTransactionWrappers:function(){return c},getReactMountReady:function(){return this.reactMountReady},destructor:function(){i.release(this.reactMountReady),this.reactMountReady=null}};s(r.prototype,a.Mixin,l),o.addPoolingTo(r),t.exports=r},{"./CallbackQueue":153,"./Object.assign":170,"./PooledClass":171,"./Transaction":248,"fbjs/lib/emptyFunction":77}],230:[function(e,t,n){(function(n){"use strict";function r(e){c.enqueueUpdate(e)}function o(e,t){var r=s.get(e);return r?("production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&p(null==i.current,"%s(...): Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state.",t),r):("production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&p(!t,"%s(...): Can only update a mounted or mounting component. This usually means you called %s() on an unmounted component. This is a no-op. Please check the code for the %s component.",t,t,e.constructor.displayName),null)}var i=e("./ReactCurrentOwner"),a=e("./ReactElement"),s=e("./ReactInstanceMap"),c=e("./ReactUpdates"),l=e("./Object.assign"),u=e("fbjs/lib/invariant"),p=e("fbjs/lib/warning"),d={isMounted:function(e){if("production"!==n.env.NODE_ENV){var t=i.current;null!==t&&("production"!==n.env.NODE_ENV&&p(t._warnedAboutRefsInRender,"%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",t.getName()||"A component"),t._warnedAboutRefsInRender=!0)}var r=s.get(e);return!!r&&!!r._renderedComponent},enqueueCallback:function(e,t){"function"!=typeof t&&("production"!==n.env.NODE_ENV?u(!1,"enqueueCallback(...): You called `setProps`, `replaceProps`, `setState`, `replaceState`, or `forceUpdate` with a callback that isn't callable."):u(!1));var i=o(e);if(!i)return null;i._pendingCallbacks?i._pendingCallbacks.push(t):i._pendingCallbacks=[t],r(i)},enqueueCallbackInternal:function(e,t){"function"!=typeof t&&("production"!==n.env.NODE_ENV?u(!1,"enqueueCallback(...): You called `setProps`, `replaceProps`, `setState`, `replaceState`, or `forceUpdate` with a callback that isn't callable."):u(!1)),e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t],r(e)},enqueueForceUpdate:function(e){var t=o(e,"forceUpdate");t&&(t._pendingForceUpdate=!0,r(t))},enqueueReplaceState:function(e,t){var n=o(e,"replaceState");n&&(n._pendingStateQueue=[t],n._pendingReplaceState=!0,r(n))},enqueueSetState:function(e,t){var n=o(e,"setState");n&&((n._pendingStateQueue||(n._pendingStateQueue=[])).push(t),r(n))},enqueueSetProps:function(e,t){var n=o(e,"setProps");n&&d.enqueueSetPropsInternal(n,t)},enqueueSetPropsInternal:function(e,t){var o=e._topLevelWrapper;o||("production"!==n.env.NODE_ENV?u(!1,"setProps(...): You called `setProps` on a component with a parent. This is an anti-pattern since props will get reactively updated when rendered. Instead, change the owner's `render` method to pass the correct value as props to the component where it is created."):u(!1));var i=o._pendingElement||o._currentElement,s=i.props,c=l({},s.props,t);o._pendingElement=a.cloneAndReplaceProps(i,a.cloneAndReplaceProps(s,c)),r(o)},enqueueReplaceProps:function(e,t){var n=o(e,"replaceProps");n&&d.enqueueReplacePropsInternal(n,t)},enqueueReplacePropsInternal:function(e,t){var o=e._topLevelWrapper;o||("production"!==n.env.NODE_ENV?u(!1,"replaceProps(...): You called `replaceProps` on a component with a parent. This is an anti-pattern since props will get reactively updated when rendered. Instead, change the owner's `render` method to pass the correct value as props to the component where it is created."):u(!1));var i=o._pendingElement||o._currentElement,s=i.props;o._pendingElement=a.cloneAndReplaceProps(i,a.cloneAndReplaceProps(s,t)),r(o)},enqueueElementInternal:function(e,t){e._pendingElement=t,r(e)}};t.exports=d}).call(this,e("_process"))},{"./Object.assign":170,"./ReactCurrentOwner":182,"./ReactElement":200,"./ReactInstanceMap":210,"./ReactUpdates":231,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],231:[function(e,t,n){(function(n){"use strict";function r(){E.ReactReconcileTransaction&&y||("production"!==n.env.NODE_ENV?h(!1,"ReactUpdates: must inject a reconcile transaction class and batching strategy"):h(!1))}function o(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=c.getPooled(),this.reconcileTransaction=E.ReactReconcileTransaction.getPooled(!1)}function i(e,t){return e._mountOrder-t._mountOrder}function a(e){var t=e.dirtyComponentsLength;t!==m.length&&("production"!==n.env.NODE_ENV?h(!1,"Expected flush transaction's stored dirty-components length (%s) to match dirty-components array length (%s).",t,m.length):h(!1)),m.sort(i);for(var r=0;r<t;r++){var o=m[r],a=o._pendingCallbacks;if(o._pendingCallbacks=null,p.performUpdateIfNecessary(o,e.reconcileTransaction),a)for(var s=0;s<a.length;s++)e.callbackQueue.enqueue(a[s],o.getPublicInstance())}}function s(e){r(),y.isBatchingUpdates?m.push(e):y.batchedUpdates(s,e)}var c=e("./CallbackQueue"),l=e("./PooledClass"),u=e("./ReactPerf"),p=e("./ReactReconciler"),d=e("./Transaction"),f=e("./Object.assign"),h=e("fbjs/lib/invariant"),m=[],g=c.getPooled(),v=!1,y=null,b=[{initialize:function(){this.dirtyComponentsLength=m.length},close:function(){this.dirtyComponentsLength!==m.length?(m.splice(0,this.dirtyComponentsLength),_()):m.length=0}},{initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}}];f(o.prototype,d.Mixin,{getTransactionWrappers:function(){return b},destructor:function(){this.dirtyComponentsLength=null,c.release(this.callbackQueue),this.callbackQueue=null,E.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,n){return d.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,n)}}),l.addPoolingTo(o);var _=function(){for(;m.length||v;){if(m.length){var e=o.getPooled();e.perform(a,null,e),o.release(e)}if(v){v=!1;var t=g;g=c.getPooled(),t.notifyAll(),c.release(t)}}},E={ReactReconcileTransaction:null,batchedUpdates:function(e,t,n,o,i,a){r(),y.batchedUpdates(e,t,n,o,i,a)},enqueueUpdate:s,flushBatchedUpdates:_=u.measure("ReactUpdates","flushBatchedUpdates",_),injection:{injectReconcileTransaction:function(e){e||("production"!==n.env.NODE_ENV?h(!1,"ReactUpdates: must provide a reconcile transaction class"):h(!1)),E.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){e||("production"!==n.env.NODE_ENV?h(!1,"ReactUpdates: must provide a batching strategy"):h(!1)),"function"!=typeof e.batchedUpdates&&("production"!==n.env.NODE_ENV?h(!1,"ReactUpdates: must provide a batchedUpdates() function"):h(!1)),"boolean"!=typeof e.isBatchingUpdates&&("production"!==n.env.NODE_ENV?h(!1,"ReactUpdates: must provide an isBatchingUpdates boolean attribute"):h(!1)),y=e}},asap:function(e,t){y.isBatchingUpdates||("production"!==n.env.NODE_ENV?h(!1,"ReactUpdates.asap: Can't enqueue an asap callback in a context whereupdates are not being batched."):h(!1)),g.enqueue(e,t),v=!0}};t.exports=E}).call(this,e("_process"))},{"./CallbackQueue":153,"./Object.assign":170,"./PooledClass":171,"./ReactPerf":219,"./ReactReconciler":224,"./Transaction":248,_process:146,"fbjs/lib/invariant":85}],232:[function(e,t,n){"use strict";t.exports="0.14.9"},{}],233:[function(e,t,n){"use strict";var r=e("./DOMProperty").injection.MUST_USE_ATTRIBUTE,o={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},i={Properties:{clipPath:r,cx:r,cy:r,d:r,dx:r,dy:r,fill:r,fillOpacity:r,fontFamily:r,fontSize:r,fx:r,fy:r,gradientTransform:r,gradientUnits:r,markerEnd:r,markerMid:r,markerStart:r,offset:r,opacity:r,patternContentUnits:r,patternUnits:r,points:r,preserveAspectRatio:r,r:r,rx:r,ry:r,spreadMethod:r,stopColor:r,stopOpacity:r,stroke:r,strokeDasharray:r,strokeLinecap:r,strokeOpacity:r,strokeWidth:r,textAnchor:r,transform:r,version:r,viewBox:r,x1:r,x2:r,x:r,xlinkActuate:r,xlinkArcrole:r,xlinkHref:r,xlinkRole:r,xlinkShow:r,xlinkTitle:r,xlinkType:r,xmlBase:r,xmlLang:r,xmlSpace:r,y1:r,y2:r,y:r},DOMAttributeNamespaces:{xlinkActuate:o.xlink,xlinkArcrole:o.xlink,xlinkHref:o.xlink,xlinkRole:o.xlink,xlinkShow:o.xlink,xlinkTitle:o.xlink,xlinkType:o.xlink,xmlBase:o.xml,xmlLang:o.xml,xmlSpace:o.xml},DOMAttributeNames:{clipPath:"clip-path",fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox",xlinkActuate:"xlink:actuate",xlinkArcrole:"xlink:arcrole",xlinkHref:"xlink:href",xlinkRole:"xlink:role",xlinkShow:"xlink:show",xlinkTitle:"xlink:title",xlinkType:"xlink:type",xmlBase:"xml:base",xmlLang:"xml:lang",xmlSpace:"xml:space"}};t.exports=i},{"./DOMProperty":157}],234:[function(e,t,n){"use strict";function r(e){if("selectionStart"in e&&c.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}if(document.selection){var n=document.selection.createRange();return{parentElement:n.parentElement(),text:n.text,top:n.boundingTop,left:n.boundingLeft}}}function o(e,t){if(_||null==v||v!==u())return null;var n=r(v);if(!b||!f(b,n)){b=n;var o=l.getPooled(g.select,y,e,t);return o.type="select",o.target=v,a.accumulateTwoPhaseDispatches(o),o}return null}var i=e("./EventConstants"),a=e("./EventPropagators"),s=e("fbjs/lib/ExecutionEnvironment"),c=e("./ReactInputSelection"),l=e("./SyntheticEvent"),u=e("fbjs/lib/getActiveElement"),p=e("./isTextInputElement"),d=e("fbjs/lib/keyOf"),f=e("fbjs/lib/shallowEqual"),h=i.topLevelTypes,m=s.canUseDOM&&"documentMode"in document&&document.documentMode<=11,g={select:{phasedRegistrationNames:{bubbled:d({onSelect:null}),captured:d({onSelectCapture:null})},dependencies:[h.topBlur,h.topContextMenu,h.topFocus,h.topKeyDown,h.topMouseDown,h.topMouseUp,h.topSelectionChange]}},v=null,y=null,b=null,_=!1,E=!1,w=d({onSelect:null}),k={eventTypes:g,extractEvents:function(e,t,n,r,i){if(!E)return null;switch(e){case h.topFocus:(p(t)||"true"===t.contentEditable)&&(v=t,y=n,b=null);break;case h.topBlur:v=null,y=null,b=null;break;case h.topMouseDown:_=!0;break;case h.topContextMenu:case h.topMouseUp:return _=!1,o(r,i);case h.topSelectionChange:if(m)break;case h.topKeyDown:case h.topKeyUp:return o(r,i)}return null},didPutListener:function(e,t,n){t===w&&(E=!0)}};t.exports=k},{"./EventConstants":162,"./EventPropagators":166,"./ReactInputSelection":208,"./SyntheticEvent":240,"./isTextInputElement":268,"fbjs/lib/ExecutionEnvironment":71,"fbjs/lib/getActiveElement":80,"fbjs/lib/keyOf":89,"fbjs/lib/shallowEqual":94}],235:[function(e,t,n){"use strict";var r=Math.pow(2,53),o={createReactRootIndex:function(){return Math.ceil(Math.random()*r)}};t.exports=o},{}],236:[function(e,t,n){(function(n){"use strict";var r=e("./EventConstants"),o=e("fbjs/lib/EventListener"),i=e("./EventPropagators"),a=e("./ReactMount"),s=e("./SyntheticClipboardEvent"),c=e("./SyntheticEvent"),l=e("./SyntheticFocusEvent"),u=e("./SyntheticKeyboardEvent"),p=e("./SyntheticMouseEvent"),d=e("./SyntheticDragEvent"),f=e("./SyntheticTouchEvent"),h=e("./SyntheticUIEvent"),m=e("./SyntheticWheelEvent"),g=e("fbjs/lib/emptyFunction"),v=e("./getEventCharCode"),y=e("fbjs/lib/invariant"),b=e("fbjs/lib/keyOf"),_=r.topLevelTypes,E={abort:{phasedRegistrationNames:{bubbled:b({onAbort:!0}),captured:b({onAbortCapture:!0})}},blur:{phasedRegistrationNames:{bubbled:b({onBlur:!0}),captured:b({onBlurCapture:!0})}},canPlay:{phasedRegistrationNames:{bubbled:b({onCanPlay:!0}),captured:b({onCanPlayCapture:!0})}},canPlayThrough:{phasedRegistrationNames:{bubbled:b({onCanPlayThrough:!0}),captured:b({onCanPlayThroughCapture:!0})}},click:{phasedRegistrationNames:{bubbled:b({onClick:!0}),captured:b({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:b({onContextMenu:!0}),captured:b({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:b({onCopy:!0}),captured:b({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:b({onCut:!0}),captured:b({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:b({onDoubleClick:!0}),captured:b({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:b({onDrag:!0}),captured:b({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:b({onDragEnd:!0}),captured:b({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:b({onDragEnter:!0}),captured:b({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:b({onDragExit:!0}),captured:b({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:b({onDragLeave:!0}),captured:b({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:b({onDragOver:!0}),captured:b({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:b({onDragStart:!0}),captured:b({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:b({onDrop:!0}),captured:b({onDropCapture:!0})}},durationChange:{phasedRegistrationNames:{bubbled:b({onDurationChange:!0}),captured:b({onDurationChangeCapture:!0})}},emptied:{phasedRegistrationNames:{bubbled:b({onEmptied:!0}),captured:b({onEmptiedCapture:!0})}},encrypted:{phasedRegistrationNames:{bubbled:b({onEncrypted:!0}),captured:b({onEncryptedCapture:!0})}},ended:{phasedRegistrationNames:{bubbled:b({onEnded:!0}),captured:b({onEndedCapture:!0})}},error:{phasedRegistrationNames:{bubbled:b({onError:!0}),captured:b({onErrorCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:b({onFocus:!0}),captured:b({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:b({onInput:!0}),captured:b({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:b({onKeyDown:!0}),captured:b({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:b({onKeyPress:!0}),captured:b({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:b({onKeyUp:!0}),captured:b({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:b({onLoad:!0}),captured:b({onLoadCapture:!0})}},loadedData:{phasedRegistrationNames:{bubbled:b({onLoadedData:!0}),captured:b({onLoadedDataCapture:!0})}},loadedMetadata:{phasedRegistrationNames:{bubbled:b({onLoadedMetadata:!0}),captured:b({onLoadedMetadataCapture:!0})}},loadStart:{phasedRegistrationNames:{bubbled:b({onLoadStart:!0}),captured:b({onLoadStartCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:b({onMouseDown:!0}),captured:b({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:b({onMouseMove:!0}),captured:b({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:b({onMouseOut:!0}),captured:b({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:b({onMouseOver:!0}),captured:b({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:b({onMouseUp:!0}),captured:b({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:b({onPaste:!0}),captured:b({onPasteCapture:!0})}},pause:{phasedRegistrationNames:{bubbled:b({onPause:!0}),captured:b({onPauseCapture:!0})}},play:{phasedRegistrationNames:{bubbled:b({onPlay:!0}),captured:b({onPlayCapture:!0})}},playing:{phasedRegistrationNames:{bubbled:b({onPlaying:!0}),captured:b({onPlayingCapture:!0})}},progress:{phasedRegistrationNames:{bubbled:b({onProgress:!0}),captured:b({onProgressCapture:!0})}},rateChange:{phasedRegistrationNames:{bubbled:b({onRateChange:!0}),captured:b({onRateChangeCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:b({onReset:!0}),captured:b({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:b({onScroll:!0}),captured:b({onScrollCapture:!0})}},seeked:{phasedRegistrationNames:{bubbled:b({onSeeked:!0}),captured:b({onSeekedCapture:!0})}},seeking:{phasedRegistrationNames:{bubbled:b({onSeeking:!0}),captured:b({onSeekingCapture:!0})}},stalled:{phasedRegistrationNames:{bubbled:b({onStalled:!0}),captured:b({onStalledCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:b({onSubmit:!0}),captured:b({onSubmitCapture:!0})}},suspend:{phasedRegistrationNames:{bubbled:b({onSuspend:!0}),captured:b({onSuspendCapture:!0})}},timeUpdate:{phasedRegistrationNames:{bubbled:b({onTimeUpdate:!0}),captured:b({onTimeUpdateCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:b({onTouchCancel:!0}),captured:b({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:b({onTouchEnd:!0}),captured:b({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:b({onTouchMove:!0}),captured:b({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:b({onTouchStart:!0}),captured:b({onTouchStartCapture:!0})}},volumeChange:{phasedRegistrationNames:{bubbled:b({onVolumeChange:!0}),captured:b({onVolumeChangeCapture:!0})}},waiting:{phasedRegistrationNames:{bubbled:b({onWaiting:!0}),captured:b({onWaitingCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:b({onWheel:!0}),captured:b({onWheelCapture:!0})}}},w={topAbort:E.abort,topBlur:E.blur,topCanPlay:E.canPlay,topCanPlayThrough:E.canPlayThrough,topClick:E.click,topContextMenu:E.contextMenu,topCopy:E.copy,topCut:E.cut,topDoubleClick:E.doubleClick,topDrag:E.drag,topDragEnd:E.dragEnd,topDragEnter:E.dragEnter,topDragExit:E.dragExit,topDragLeave:E.dragLeave,topDragOver:E.dragOver,topDragStart:E.dragStart,topDrop:E.drop,topDurationChange:E.durationChange,topEmptied:E.emptied,topEncrypted:E.encrypted,topEnded:E.ended,topError:E.error,topFocus:E.focus,topInput:E.input,topKeyDown:E.keyDown,topKeyPress:E.keyPress,topKeyUp:E.keyUp,topLoad:E.load,topLoadedData:E.loadedData,topLoadedMetadata:E.loadedMetadata,topLoadStart:E.loadStart,topMouseDown:E.mouseDown,topMouseMove:E.mouseMove,topMouseOut:E.mouseOut,topMouseOver:E.mouseOver,topMouseUp:E.mouseUp,topPaste:E.paste,topPause:E.pause,topPlay:E.play,topPlaying:E.playing,topProgress:E.progress,topRateChange:E.rateChange,topReset:E.reset,topScroll:E.scroll,topSeeked:E.seeked,topSeeking:E.seeking,topStalled:E.stalled,topSubmit:E.submit,topSuspend:E.suspend,topTimeUpdate:E.timeUpdate,topTouchCancel:E.touchCancel,topTouchEnd:E.touchEnd,topTouchMove:E.touchMove,topTouchStart:E.touchStart,topVolumeChange:E.volumeChange,topWaiting:E.waiting,topWheel:E.wheel};for(var k in w)w[k].dependencies=[k];var x=b({onClick:null}),C={},S={eventTypes:E,extractEvents:function(e,t,r,o,a){var g=w[e];if(!g)return null;var b;switch(e){case _.topAbort:case _.topCanPlay:case _.topCanPlayThrough:case _.topDurationChange:case _.topEmptied:case _.topEncrypted:case _.topEnded:case _.topError:case _.topInput:case _.topLoad:case _.topLoadedData:case _.topLoadedMetadata:case _.topLoadStart:case _.topPause:case _.topPlay:case _.topPlaying:case _.topProgress:case _.topRateChange:case _.topReset:case _.topSeeked:case _.topSeeking:case _.topStalled:case _.topSubmit:case _.topSuspend:case _.topTimeUpdate:case _.topVolumeChange:case _.topWaiting:b=c;break;case _.topKeyPress:if(0===v(o))return null;case _.topKeyDown:case _.topKeyUp:b=u;break;case _.topBlur:case _.topFocus:b=l;break;case _.topClick:if(2===o.button)return null;case _.topContextMenu:case _.topDoubleClick:case _.topMouseDown:case _.topMouseMove:case _.topMouseOut:case _.topMouseOver:case _.topMouseUp:b=p;break;case _.topDrag:case _.topDragEnd:case _.topDragEnter:case _.topDragExit:case _.topDragLeave:case _.topDragOver:case _.topDragStart:case _.topDrop:b=d;break;case _.topTouchCancel:case _.topTouchEnd:case _.topTouchMove:case _.topTouchStart:b=f;break;case _.topScroll:b=h;break;case _.topWheel:b=m;break;case _.topCopy:case _.topCut:case _.topPaste:b=s}b||("production"!==n.env.NODE_ENV?y(!1,"SimpleEventPlugin: Unhandled event type, `%s`.",e):y(!1));var E=b.getPooled(g,r,o,a);return i.accumulateTwoPhaseDispatches(E),E},didPutListener:function(e,t,n){if(t===x){var r=a.getNode(e);C[e]||(C[e]=o.listen(r,"click",g))}},willDeleteListener:function(e,t){t===x&&(C[e].remove(),delete C[e])}};t.exports=S}).call(this,e("_process"))},{"./EventConstants":162,"./EventPropagators":166,"./ReactMount":213,"./SyntheticClipboardEvent":237,"./SyntheticDragEvent":239,"./SyntheticEvent":240,"./SyntheticFocusEvent":241,"./SyntheticKeyboardEvent":243,"./SyntheticMouseEvent":244,"./SyntheticTouchEvent":245,"./SyntheticUIEvent":246,"./SyntheticWheelEvent":247,"./getEventCharCode":259,_process:146,"fbjs/lib/EventListener":70,"fbjs/lib/emptyFunction":77,"fbjs/lib/invariant":85,"fbjs/lib/keyOf":89}],237:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticEvent"),i={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};o.augmentClass(r,i),t.exports=r},{"./SyntheticEvent":240}],238:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticEvent"),i={data:null};o.augmentClass(r,i),t.exports=r},{"./SyntheticEvent":240}],239:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticMouseEvent"),i={dataTransfer:null};o.augmentClass(r,i),t.exports=r},{"./SyntheticMouseEvent":244}],240:[function(e,t,n){(function(n){"use strict";function r(e,t,n,r){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n;var o=this.constructor.Interface;for(var i in o)if(o.hasOwnProperty(i)){var s=o[i];s?this[i]=s(n):"target"===i?this.target=r:this[i]=n[i]}var c=null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue;this.isDefaultPrevented=c?a.thatReturnsTrue:a.thatReturnsFalse,this.isPropagationStopped=a.thatReturnsFalse}var o=e("./PooledClass"),i=e("./Object.assign"),a=e("fbjs/lib/emptyFunction"),s=e("fbjs/lib/warning"),c={type:null,target:null,currentTarget:a.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};i(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&s(e,"This synthetic event is reused for performance reasons. If you're seeing this, you're calling `preventDefault` on a released/nullified synthetic event. This is a no-op. See https://fb.me/react-event-pooling for more information."),e&&(e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=a.thatReturnsTrue)},stopPropagation:function(){var e=this.nativeEvent;"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&s(e,"This synthetic event is reused for performance reasons. If you're seeing this, you're calling `stopPropagation` on a released/nullified synthetic event. This is a no-op. See https://fb.me/react-event-pooling for more information."),e&&(e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=a.thatReturnsTrue)},persist:function(){this.isPersistent=a.thatReturnsTrue},isPersistent:a.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),r.Interface=c,r.augmentClass=function(e,t){var n=this,r=Object.create(n.prototype);i(r,e.prototype),e.prototype=r,e.prototype.constructor=e,e.Interface=i({},n.Interface,t),e.augmentClass=n.augmentClass,o.addPoolingTo(e,o.fourArgumentPooler)},o.addPoolingTo(r,o.fourArgumentPooler),t.exports=r}).call(this,e("_process"))},{"./Object.assign":170,"./PooledClass":171,_process:146,"fbjs/lib/emptyFunction":77,"fbjs/lib/warning":96}],241:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticUIEvent"),i={relatedTarget:null};o.augmentClass(r,i),t.exports=r},{"./SyntheticUIEvent":246}],242:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticEvent"),i={data:null};o.augmentClass(r,i),t.exports=r},{"./SyntheticEvent":240}],243:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticUIEvent"),i=e("./getEventCharCode"),a={key:e("./getEventKey"),location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:e("./getEventModifierState"),charCode:function(e){return"keypress"===e.type?i(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?i(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}};o.augmentClass(r,a),t.exports=r},{"./SyntheticUIEvent":246,"./getEventCharCode":259,"./getEventKey":260,"./getEventModifierState":261}],244:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticUIEvent"),i=e("./ViewportMetrics"),a={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:e("./getEventModifierState"),button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+i.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+i.currentScrollTop}};o.augmentClass(r,a),t.exports=r},{"./SyntheticUIEvent":246,"./ViewportMetrics":249,"./getEventModifierState":261}],245:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticUIEvent"),i={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:e("./getEventModifierState")};o.augmentClass(r,i),t.exports=r},{"./SyntheticUIEvent":246,"./getEventModifierState":261}],246:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticEvent"),i=e("./getEventTarget"),a={view:function(e){if(e.view)return e.view;var t=i(e);if(null!=t&&t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window},detail:function(e){return e.detail||0}};o.augmentClass(r,a),t.exports=r},{"./SyntheticEvent":240,"./getEventTarget":262}],247:[function(e,t,n){"use strict";function r(e,t,n,r){o.call(this,e,t,n,r)}var o=e("./SyntheticMouseEvent"),i={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};o.augmentClass(r,i),t.exports=r},{"./SyntheticMouseEvent":244}],248:[function(e,t,n){(function(n){"use strict";var r=e("fbjs/lib/invariant"),o={Mixin:{reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,o,i,a,s,c,l){this.isInTransaction()&&("production"!==n.env.NODE_ENV?r(!1,"Transaction.perform(...): Cannot initialize a transaction when there is already an outstanding transaction."):r(!1));var u,p;try{this._isInTransaction=!0,u=!0,this.initializeAll(0),p=e.call(t,o,i,a,s,c,l),u=!1}finally{try{if(u)try{this.closeAll(0)}catch(e){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return p},initializeAll:function(e){for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r=t[n];try{this.wrapperInitData[n]=o.OBSERVED_ERROR,this.wrapperInitData[n]=r.initialize?r.initialize.call(this):null}finally{if(this.wrapperInitData[n]===o.OBSERVED_ERROR)try{this.initializeAll(n+1)}catch(e){}}}},closeAll:function(e){this.isInTransaction()||("production"!==n.env.NODE_ENV?r(!1,"Transaction.closeAll(): Cannot close transaction when none are open."):r(!1));for(var t=this.transactionWrappers,i=e;i<t.length;i++){var a,s=t[i],c=this.wrapperInitData[i];try{a=!0,c!==o.OBSERVED_ERROR&&s.close&&s.close.call(this,c),a=!1}finally{if(a)try{this.closeAll(i+1)}catch(e){}}}this.wrapperInitData.length=0}},OBSERVED_ERROR:{}};t.exports=o}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],249:[function(e,t,n){"use strict";var r={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(e){r.currentScrollLeft=e.x,r.currentScrollTop=e.y}};t.exports=r},{}],250:[function(e,t,n){(function(n){"use strict";var r=e("fbjs/lib/invariant");t.exports=function(e,t){if(null==t&&("production"!==n.env.NODE_ENV?r(!1,"accumulateInto(...): Accumulated items must not be null or undefined."):r(!1)),null==e)return t;var o=Array.isArray(e),i=Array.isArray(t);return o&&i?(e.push.apply(e,t),e):o?(e.push(t),e):i?[e].concat(t):[e,t]}}).call(this,e("_process"))},{_process:146,"fbjs/lib/invariant":85}],251:[function(e,t,n){"use strict";var r=65521;t.exports=function(e){for(var t=1,n=0,o=0,i=e.length,a=-4&i;o<a;){for(;o<Math.min(o+4096,a);o+=4)n+=(t+=e.charCodeAt(o))+(t+=e.charCodeAt(o+1))+(t+=e.charCodeAt(o+2))+(t+=e.charCodeAt(o+3));t%=r,n%=r}for(;o<i;o++)n+=t+=e.charCodeAt(o);return t%=r,n%=r,t|n<<16}},{}],252:[function(e,t,n){(function(e){"use strict";var n=!1;if("production"!==e.env.NODE_ENV)try{Object.defineProperty({},"x",{get:function(){}}),n=!0}catch(e){}t.exports=n}).call(this,e("_process"))},{_process:146}],253:[function(e,t,n){"use strict";var r=e("./CSSProperty").isUnitlessNumber;t.exports=function(e,t){return null==t||"boolean"==typeof t||""===t?"":isNaN(t)||0===t||r.hasOwnProperty(e)&&r[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}},{"./CSSProperty":151}],254:[function(e,t,n){(function(n){"use strict";var r=e("./Object.assign"),o=e("fbjs/lib/warning");t.exports=function(e,t,i,a,s){var c=!1;if("production"!==n.env.NODE_ENV)return r(function(){return"production"!==n.env.NODE_ENV&&o(c,"React.%s is deprecated. Please use %s.%s from require('%s') instead.",e,t,e,i),c=!0,s.apply(a,arguments)},s);return s}}).call(this,e("_process"))},{"./Object.assign":170,_process:146,"fbjs/lib/warning":96}],255:[function(e,t,n){"use strict";function r(e){return o[e]}var o={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},i=/[&><"']/g;t.exports=function(e){return(""+e).replace(i,r)}},{}],256:[function(e,t,n){(function(n){"use strict";var r=e("./ReactCurrentOwner"),o=e("./ReactInstanceMap"),i=e("./ReactMount"),a=e("fbjs/lib/invariant"),s=e("fbjs/lib/warning");t.exports=function(e){if("production"!==n.env.NODE_ENV){var t=r.current;null!==t&&("production"!==n.env.NODE_ENV&&s(t._warnedAboutRefsInRender,"%s is accessing getDOMNode or findDOMNode inside its render(). render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",t.getName()||"A component"),t._warnedAboutRefsInRender=!0)}return null==e?null:1===e.nodeType?e:o.has(e)?i.getNodeFromInstance(e):(null!=e.render&&"function"==typeof e.render&&("production"!==n.env.NODE_ENV?a(!1,"findDOMNode was called on an unmounted component."):a(!1)),void("production"!==n.env.NODE_ENV?a(!1,"Element appears to be neither ReactComponent nor DOMNode (keys: %s)",Object.keys(e)):a(!1)))}}).call(this,e("_process"))},{"./ReactCurrentOwner":182,"./ReactInstanceMap":210,"./ReactMount":213,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],257:[function(e,t,n){(function(n){"use strict";function r(e,t,r){var o=e,a=void 0===o[r];"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&i(a,"flattenChildren(...): Encountered two children with the same key, `%s`. Child keys must be unique; when two children share a key, only the first child will be used.",r),a&&null!=t&&(o[r]=t)}var o=e("./traverseAllChildren"),i=e("fbjs/lib/warning");t.exports=function(e){if(null==e)return e;var t={};return o(e,r,t),t}}).call(this,e("_process"))},{"./traverseAllChildren":275,_process:146,"fbjs/lib/warning":96}],258:[function(e,t,n){"use strict";t.exports=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}},{}],259:[function(e,t,n){"use strict";t.exports=function(e){var t,n=e.keyCode;return"charCode"in e?0===(t=e.charCode)&&13===n&&(t=13):t=n,t>=32||13===t?t:0}},{}],260:[function(e,t,n){"use strict";var r=e("./getEventCharCode"),o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=function(e){if(e.key){var t=o[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n=r(e);return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?i[e.keyCode]||"Unidentified":""}},{"./getEventCharCode":259}],261:[function(e,t,n){"use strict";function r(e){var t=this.nativeEvent;if(t.getModifierState)return t.getModifierState(e);var n=o[e];return!!n&&!!t[n]}var o={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=function(e){return r}},{}],262:[function(e,t,n){"use strict";t.exports=function(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}},{}],263:[function(e,t,n){"use strict";var r="function"==typeof Symbol&&Symbol.iterator,o="@@iterator";t.exports=function(e){var t=e&&(r&&e[r]||e[o]);if("function"==typeof t)return t}},{}],264:[function(e,t,n){"use strict";function r(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function o(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}t.exports=function(e,t){for(var n=r(e),i=0,a=0;n;){if(3===n.nodeType){if(a=i+n.textContent.length,i<=t&&a>=t)return{node:n,offset:t-i};i=a}n=r(o(n))}}},{}],265:[function(e,t,n){"use strict";var r=e("fbjs/lib/ExecutionEnvironment"),o=null;t.exports=function(){return!o&&r.canUseDOM&&(o="textContent"in document.documentElement?"textContent":"innerText"),o}},{"fbjs/lib/ExecutionEnvironment":71}],266:[function(e,t,n){(function(n){"use strict";function r(e){if(e){var t=e.getName();if(t)return" Check the render method of `"+t+"`."}return""}function o(e){return"function"==typeof e&&void 0!==e.prototype&&"function"==typeof e.prototype.mountComponent&&"function"==typeof e.prototype.receiveComponent}function i(e){var t;if(null===e||!1===e)t=new s(i);else if("object"==typeof e){var a=e;(!a||"function"!=typeof a.type&&"string"!=typeof a.type)&&("production"!==n.env.NODE_ENV?u(!1,"Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",null==a.type?a.type:typeof a.type,r(a._owner)):u(!1)),t="string"==typeof a.type?c.createInternalComponent(a):o(a.type)?new a.type(a):new d}else"string"==typeof e||"number"==typeof e?t=c.createInstanceForText(e):"production"!==n.env.NODE_ENV?u(!1,"Encountered invalid React node of type %s",typeof e):u(!1);return"production"!==n.env.NODE_ENV&&"production"!==n.env.NODE_ENV&&p("function"==typeof t.construct&&"function"==typeof t.mountComponent&&"function"==typeof t.receiveComponent&&"function"==typeof t.unmountComponent,"Only React Components can be mounted."),t.construct(e),t._mountIndex=0,t._mountImage=null,"production"!==n.env.NODE_ENV&&(t._isOwnerNecessary=!1,t._warnedAboutRefsInRender=!1),"production"!==n.env.NODE_ENV&&Object.preventExtensions&&Object.preventExtensions(t),t}var a=e("./ReactCompositeComponent"),s=e("./ReactEmptyComponent"),c=e("./ReactNativeComponent"),l=e("./Object.assign"),u=e("fbjs/lib/invariant"),p=e("fbjs/lib/warning"),d=function(){};l(d.prototype,a.Mixin,{_instantiateReactComponent:i}),t.exports=i}).call(this,e("_process"))},{"./Object.assign":170,"./ReactCompositeComponent":181,"./ReactEmptyComponent":202,"./ReactNativeComponent":216,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],267:[function(e,t,n){"use strict";var r,o=e("fbjs/lib/ExecutionEnvironment");o.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),t.exports=function(e,t){if(!o.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,i=n in document;if(!i){var a=document.createElement("div");a.setAttribute(n,"return;"),i="function"==typeof a[n]}return!i&&r&&"wheel"===e&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}},{"fbjs/lib/ExecutionEnvironment":71}],268:[function(e,t,n){"use strict";var r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=function(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&r[e.type]||"textarea"===t)}},{}],269:[function(e,t,n){(function(n){"use strict";var r=e("./ReactElement"),o=e("fbjs/lib/invariant");t.exports=function(e){return r.isValidElement(e)||("production"!==n.env.NODE_ENV?o(!1,"onlyChild must be passed a children with exactly one child."):o(!1)),e}}).call(this,e("_process"))},{"./ReactElement":200,_process:146,"fbjs/lib/invariant":85}],270:[function(e,t,n){"use strict";var r=e("./escapeTextContentForBrowser");t.exports=function(e){return'"'+r(e)+'"'}},{"./escapeTextContentForBrowser":255}],271:[function(e,t,n){"use strict";var r=e("./ReactMount");t.exports=r.renderSubtreeIntoContainer},{"./ReactMount":213}],272:[function(e,t,n){"use strict";var r=e("fbjs/lib/ExecutionEnvironment"),o=/^[ \r\n\t\f]/,i=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,a=function(e,t){e.innerHTML=t};if("undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction&&(a=function(e,t){MSApp.execUnsafeLocalFunction(function(){e.innerHTML=t})}),r.canUseDOM){var s=document.createElement("div");s.innerHTML=" ",""===s.innerHTML&&(a=function(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),o.test(t)||"<"===t[0]&&i.test(t)){e.innerHTML=String.fromCharCode(65279)+t;var n=e.firstChild;1===n.data.length?e.removeChild(n):n.deleteData(0,1)}else e.innerHTML=t})}t.exports=a},{"fbjs/lib/ExecutionEnvironment":71}],273:[function(e,t,n){"use strict";var r=e("fbjs/lib/ExecutionEnvironment"),o=e("./escapeTextContentForBrowser"),i=e("./setInnerHTML"),a=function(e,t){e.textContent=t};r.canUseDOM&&("textContent"in document.documentElement||(a=function(e,t){i(e,o(t))})),t.exports=a},{"./escapeTextContentForBrowser":255,"./setInnerHTML":272,"fbjs/lib/ExecutionEnvironment":71}],274:[function(e,t,n){"use strict";t.exports=function(e,t){var n=null===e||!1===e,r=null===t||!1===t;if(n||r)return n===r;var o=typeof e,i=typeof t;return"string"===o||"number"===o?"string"===i||"number"===i:"object"===i&&e.type===t.type&&e.key===t.key}},{}],275:[function(e,t,n){(function(n){"use strict";function r(e){return g[e]}function o(e,t){return e&&null!=e.key?a(e.key):t.toString(36)}function i(e){return(""+e).replace(v,r)}function a(e){return"$"+i(e)}function s(e,t,r,i){var u=typeof e;if("undefined"!==u&&"boolean"!==u||(e=null),null===e||"string"===u||"number"===u||l.isValidElement(e))return r(i,e,""===t?h+o(e,0):t),1;var g,v=0,b=""===t?h:t+m;if(Array.isArray(e))for(var _=0;_<e.length;_++)v+=s(g=e[_],b+o(g,_),r,i);else{var E=p(e);if(E){var w,k=E.call(e);if(E!==e.entries)for(var x=0;!(w=k.next()).done;)v+=s(g=w.value,b+o(g,x++),r,i);else for("production"!==n.env.NODE_ENV&&("production"!==n.env.NODE_ENV&&f(y,"Using Maps as children is not yet fully supported. It is an experimental feature that might be removed. Convert it to a sequence / iterable of keyed ReactElements instead."),y=!0);!(w=k.next()).done;){var C=w.value;C&&(v+=s(g=C[1],b+a(C[0])+m+o(g,0),r,i))}}else if("object"===u){var S="";if("production"!==n.env.NODE_ENV&&(S=" If you meant to render a collection of children, use an array instead or wrap the object using createFragment(object) from the React add-ons.",e._isReactElement&&(S=" It looks like you're using an element created by a different version of React. Make sure to use only one copy of React."),c.current)){var N=c.current.getName();N&&(S+=" Check the render method of `"+N+"`.")}var T=String(e);"production"!==n.env.NODE_ENV?d(!1,"Objects are not valid as a React child (found: %s).%s","[object Object]"===T?"object with keys {"+Object.keys(e).join(", ")+"}":T,S):d(!1)}}return v}var c=e("./ReactCurrentOwner"),l=e("./ReactElement"),u=e("./ReactInstanceHandles"),p=e("./getIteratorFn"),d=e("fbjs/lib/invariant"),f=e("fbjs/lib/warning"),h=u.SEPARATOR,m=":",g={"=":"=0",".":"=1",":":"=2"},v=/[=.:]/g,y=!1;t.exports=function(e,t,n){return null==e?0:s(e,"",t,n)}}).call(this,e("_process"))},{"./ReactCurrentOwner":182,"./ReactElement":200,"./ReactInstanceHandles":209,"./getIteratorFn":263,_process:146,"fbjs/lib/invariant":85,"fbjs/lib/warning":96}],276:[function(e,t,n){(function(n){"use strict";var r=e("./Object.assign"),o=e("fbjs/lib/emptyFunction"),i=e("fbjs/lib/warning"),a=o;if("production"!==n.env.NODE_ENV){var s=["address","applet","area","article","aside","base","basefont","bgsound","blockquote","body","br","button","caption","center","col","colgroup","dd","details","dir","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","isindex","li","link","listing","main","marquee","menu","menuitem","meta","nav","noembed","noframes","noscript","object","ol","p","param","plaintext","pre","script","section","select","source","style","summary","table","tbody","td","template","textarea","tfoot","th","thead","title","tr","track","ul","wbr","xmp"],c=["applet","caption","html","table","td","th","marquee","object","template","foreignObject","desc","title"],l=c.concat(["button"]),u=["dd","dt","li","option","optgroup","p","rp","rt"],p={parentTag:null,formTag:null,aTagInScope:null,buttonTagInScope:null,nobrTagInScope:null,pTagInButtonScope:null,listItemTagAutoclosing:null,dlItemTagAutoclosing:null},d=function(e,t){switch(t){case"select":return"option"===e||"optgroup"===e||"#text"===e;case"optgroup":return"option"===e||"#text"===e;case"option":return"#text"===e;case"tr":return"th"===e||"td"===e||"style"===e||"script"===e||"template"===e;case"tbody":case"thead":case"tfoot":return"tr"===e||"style"===e||"script"===e||"template"===e;case"colgroup":return"col"===e||"template"===e;case"table":return"caption"===e||"colgroup"===e||"tbody"===e||"tfoot"===e||"thead"===e||"style"===e||"script"===e||"template"===e;case"head":return"base"===e||"basefont"===e||"bgsound"===e||"link"===e||"meta"===e||"title"===e||"noscript"===e||"noframes"===e||"style"===e||"script"===e||"template"===e;case"html":return"head"===e||"body"===e}switch(e){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return"h1"!==t&&"h2"!==t&&"h3"!==t&&"h4"!==t&&"h5"!==t&&"h6"!==t;case"rp":case"rt":return-1===u.indexOf(t);case"caption":case"col":case"colgroup":case"frame":case"head":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return null==t}return!0},f=function(e,t){switch(e){case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"menu":case"nav":case"ol":case"p":case"section":case"summary":case"ul":case"pre":case"listing":case"table":case"hr":case"xmp":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return t.pTagInButtonScope;case"form":return t.formTag||t.pTagInButtonScope;case"li":return t.listItemTagAutoclosing;case"dd":case"dt":return t.dlItemTagAutoclosing;case"button":return t.buttonTagInScope;case"a":return t.aTagInScope;case"nobr":return t.nobrTagInScope}return null},h=function(e){if(!e)return[];var t=[];do{t.push(e)}while(e=e._currentElement._owner);return t.reverse(),t},m={};(a=function(e,t,r){var o=(r=r||p).parentTag,a=o&&o.tag,s=d(e,a)?null:o,c=s?null:f(e,r),l=s||c;if(l){var u,g=l.tag,v=l.instance,y=t&&t._currentElement._owner,b=v&&v._currentElement._owner,_=h(y),E=h(b),w=Math.min(_.length,E.length),k=-1;for(u=0;u<w&&_[u]===E[u];u++)k=u;var x=_.slice(k+1).map(function(e){return e.getName()||"(unknown)"}),C=E.slice(k+1).map(function(e){return e.getName()||"(unknown)"}),S=[].concat(-1!==k?_[k].getName()||"(unknown)":[],C,g,c?["..."]:[],x,e).join(" > "),N=!!s+"|"+e+"|"+g+"|"+S;if(m[N])return;if(m[N]=!0,s){var T="";"table"===g&&"tr"===e&&(T+=" Add a <tbody> to your code to match the DOM tree generated by the browser."),"production"!==n.env.NODE_ENV&&i(!1,"validateDOMNesting(...): <%s> cannot appear as a child of <%s>. See %s.%s",e,g,S,T)}else"production"!==n.env.NODE_ENV&&i(!1,"validateDOMNesting(...): <%s> cannot appear as a descendant of <%s>. See %s.",e,g,S)}}).ancestorInfoContextKey="__validateDOMNesting_ancestorInfo$"+Math.random().toString(36).slice(2),a.updatedAncestorInfo=function(e,t,n){var o=r({},e||p),i={tag:t,instance:n};return-1!==c.indexOf(t)&&(o.aTagInScope=null,o.buttonTagInScope=null,o.nobrTagInScope=null),-1!==l.indexOf(t)&&(o.pTagInButtonScope=null),-1!==s.indexOf(t)&&"address"!==t&&"div"!==t&&"p"!==t&&(o.listItemTagAutoclosing=null,o.dlItemTagAutoclosing=null),o.parentTag=i,"form"===t&&(o.formTag=i),"a"===t&&(o.aTagInScope=i),"button"===t&&(o.buttonTagInScope=i),"nobr"===t&&(o.nobrTagInScope=i),"p"===t&&(o.pTagInButtonScope=i),"li"===t&&(o.listItemTagAutoclosing=i),"dd"!==t&&"dt"!==t||(o.dlItemTagAutoclosing=i),o},a.isTagValidInContext=function(e,t){var n=(t=t||p).parentTag,r=n&&n.tag;return d(e,r)&&!f(e,t)}}t.exports=a}).call(this,e("_process"))},{"./Object.assign":170,_process:146,"fbjs/lib/emptyFunction":77,"fbjs/lib/warning":96}],277:[function(e,t,n){"use strict";t.exports=e("./lib/React")},{"./lib/React":172}],278:[function(e,t,n){t.exports=e("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":279}],279:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);l.call(this,e),u.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",o)}function o(){this.allowHalfOpen||this._writableState.ended||a(i,this)}function i(e){e.end()}var a=e("process-nextick-args"),s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};t.exports=r;var c=e("core-util-is");c.inherits=e("inherits");var l=e("./_stream_readable"),u=e("./_stream_writable");c.inherits(r,l);for(var p=s(u.prototype),d=0;d<p.length;d++){var f=p[d];r.prototype[f]||(r.prototype[f]=u.prototype[f])}Object.defineProperty(r.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),r.prototype._destroy=function(e,t){this.push(null),this.end(),a(t,e)}},{"./_stream_readable":281,"./_stream_writable":283,"core-util-is":57,inherits:100,"process-nextick-args":145}],280:[function(e,t,n){"use strict";function r(e){if(!(this instanceof r))return new r(e);o.call(this,e)}t.exports=r;var o=e("./_stream_transform"),i=e("core-util-is");i.inherits=e("inherits"),i.inherits(r,o),r.prototype._transform=function(e,t,n){n(null,e)}},{"./_stream_transform":282,"core-util-is":57,inherits:100}],281:[function(e,t,n){(function(n,r){"use strict";function o(e){return L.from(e)}function i(e){return L.isBuffer(e)||e instanceof F}function a(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?I(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}function s(t,n){P=P||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof P&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var r=t.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new H,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(q||(q=e("string_decoder/").StringDecoder),this.decoder=new q(t.encoding),this.encoding=t.encoding)}function c(t){if(P=P||e("./_stream_duplex"),!(this instanceof c))return new c(t);this._readableState=new s(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),M.call(this)}function l(e,t,n,r,i){var a=e._readableState;if(null===t)a.reading=!1,m(e,a);else{var s;i||(s=p(a,t)),s?e.emit("error",s):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===L.prototype||(t=o(t)),r?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):u(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?u(e,a,t,!1):y(e,a)):u(e,a,t,!1))):r||(a.reading=!1)}return d(a)}function u(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&g(e)),y(e,t)}function p(e,t){var n;return i(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function d(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function f(e){return e>=K?e=K:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function h(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=f(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function m(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,g(e)}}function g(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(V("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?A(v,e):v(e))}function v(e){V("emit readable"),e.emit("readable"),x(e)}function y(e,t){t.readingMore||(t.readingMore=!0,A(b,e,t))}function b(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(V("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function _(e){return function(){var t=e._readableState;V("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&j(e,"data")&&(t.flowing=!0,x(e))}}function E(e){V("readable nexttick read 0"),e.read(0)}function w(e,t){t.resumeScheduled||(t.resumeScheduled=!0,A(k,e,t))}function k(e,t){t.reading||(V("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),x(e),t.flowing&&!t.reading&&e.read(0)}function x(e){var t=e._readableState;for(V("flow",t.flowing);t.flowing&&null!==e.read(););}function C(e,t){if(0===t.length)return null;var n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=S(e,t.buffer,t.decoder),n}function S(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?N(e,t):T(e,t),r}function N(e,t){var n=t.head,r=1,o=n.data;for(e-=o.length;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(a===i.length?o+=i:o+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(a));break}++r}return t.length-=r,o}function T(e,t){var n=L.allocUnsafe(e),r=t.head,o=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(n,n.length-e,0,a),0===(e-=a)){a===i.length?(++o,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(a));break}++o}return t.length-=o,n}function O(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,A(D,t,e))}function D(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function R(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}var A=e("process-nextick-args");t.exports=c;var P,I=e("isarray");c.ReadableState=s;e("events").EventEmitter;var j=function(e,t){return e.listeners(t).length},M=e("./internal/streams/stream"),L=e("safe-buffer").Buffer,F=r.Uint8Array||function(){},U=e("core-util-is");U.inherits=e("inherits");var B=e("util"),V=void 0;V=B&&B.debuglog?B.debuglog("stream"):function(){};var q,H=e("./internal/streams/BufferList"),W=e("./internal/streams/destroy");U.inherits(c,M);var z=["error","close","destroy","pause","resume"];Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),c.prototype.destroy=W.destroy,c.prototype._undestroy=W.undestroy,c.prototype._destroy=function(e,t){this.push(null),t(e)},c.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=L.from(e,t),t=""),n=!0),l(this,e,t,!1,n)},c.prototype.unshift=function(e){return l(this,e,null,!0,!1)},c.prototype.isPaused=function(){return!1===this._readableState.flowing},c.prototype.setEncoding=function(t){return q||(q=e("string_decoder/").StringDecoder),this._readableState.decoder=new q(t),this._readableState.encoding=t,this};var K=8388608;c.prototype.read=function(e){V("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return V("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?O(this):g(this),null;if(0===(e=h(e,t))&&t.ended)return 0===t.length&&O(this),null;var r=t.needReadable;V("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&V("length less than watermark",r=!0),t.ended||t.reading?V("reading or ended",r=!1):r&&(V("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=h(n,t)));var o;return null===(o=e>0?C(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&O(this)),null!==o&&this.emit("data",o),o},c.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},c.prototype.pipe=function(e,t){function r(e,t){V("onunpipe"),e===d&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,i())}function o(){V("onend"),e.end()}function i(){V("cleanup"),e.removeListener("close",l),e.removeListener("finish",u),e.removeListener("drain",m),e.removeListener("error",c),e.removeListener("unpipe",r),d.removeListener("end",o),d.removeListener("end",p),d.removeListener("data",s),g=!0,!f.awaitDrain||e._writableState&&!e._writableState.needDrain||m()}function s(t){V("ondata"),v=!1,!1!==e.write(t)||v||((1===f.pipesCount&&f.pipes===e||f.pipesCount>1&&-1!==R(f.pipes,e))&&!g&&(V("false write response, pause",d._readableState.awaitDrain),d._readableState.awaitDrain++,v=!0),d.pause())}function c(t){V("onerror",t),p(),e.removeListener("error",c),0===j(e,"error")&&e.emit("error",t)}function l(){e.removeListener("finish",u),p()}function u(){V("onfinish"),e.removeListener("close",l),p()}function p(){V("unpipe"),d.unpipe(e)}var d=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=e;break;case 1:f.pipes=[f.pipes,e];break;default:f.pipes.push(e)}f.pipesCount+=1,V("pipe count=%d opts=%j",f.pipesCount,t);var h=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?o:p;f.endEmitted?A(h):d.once("end",h),e.on("unpipe",r);var m=_(d);e.on("drain",m);var g=!1,v=!1;return d.on("data",s),a(e,"error",c),e.once("close",l),e.once("finish",u),e.emit("pipe",d),f.flowing||(V("pipe resume"),d.resume()),e},c.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n),this);if(!e){var r=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<o;i++)r[i].emit("unpipe",this,n);return this}var a=R(t.pipes,e);return-1===a?this:(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n),this)},c.prototype.on=function(e,t){var n=M.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&g(this):A(E,this))}return n},c.prototype.addListener=c.prototype.on,c.prototype.resume=function(){var e=this._readableState;return e.flowing||(V("resume"),e.flowing=!0,w(this,e)),this},c.prototype.pause=function(){return V("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(V("pause"),this._readableState.flowing=!1,this.emit("pause")),this},c.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(V("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(o){V("wrapped data"),t.decoder&&(o=t.decoder.write(o)),(!t.objectMode||null!==o&&void 0!==o)&&(t.objectMode||o&&o.length)&&(r.push(o)||(n=!0,e.pause()))});for(var o in e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));for(var i=0;i<z.length;i++)e.on(z[i],r.emit.bind(r,z[i]));return r._read=function(t){V("wrapped _read",t),n&&(n=!1,e.resume())},r},c._fromList=C}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":279,"./internal/streams/BufferList":284,"./internal/streams/destroy":285,"./internal/streams/stream":286,_process:146,"core-util-is":57,events:69,inherits:100,isarray:102,"process-nextick-args":145,"safe-buffer":292,"string_decoder/":287,util:52}],282:[function(e,t,n){"use strict";function r(e){this.afterTransform=function(t,n){return o(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function o(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),o(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}function i(e){if(!(this instanceof i))return new i(e);s.call(this,e),this._transformState=new r(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,n){a(t,e,n)}):a(t)})}function a(e,t,n){if(t)return e.emit("error",t);null!==n&&void 0!==n&&e.push(n);var r=e._writableState,o=e._transformState;if(r.length)throw new Error("Calling transform done when ws.length != 0");if(o.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}t.exports=i;var s=e("./_stream_duplex"),c=e("core-util-is");c.inherits=e("inherits"),c.inherits(i,s),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},i.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},i.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},i.prototype._destroy=function(e,t){var n=this;s.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},{"./_stream_duplex":279,"core-util-is":57,inherits:100}],283:[function(e,t,n){(function(n,r){"use strict";function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){S(t,e)}}function i(e){return P.from(e)}function a(e){return P.isBuffer(e)||e instanceof I}function s(){}function c(t,n){T=T||e("./_stream_duplex"),t=t||{},this.objectMode=!!t.objectMode,n instanceof T&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var r=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:i,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===t.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){v(n,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function l(t){if(T=T||e("./_stream_duplex"),!(M.call(l,this)||this instanceof T))return new l(t);this._writableState=new c(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),A.call(this)}function u(e,t){var n=new Error("write after end");e.emit("error",n),N(t,n)}function p(e,t,n,r){var o=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),N(r,i),o=!1),o}function d(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=P.from(t,n)),t}function f(e,t,n,r,o,i){if(!n){var a=d(t,r,o);r!==a&&(n=!0,o="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:o,isBuf:n,callback:i,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else h(e,t,!1,s,r,o,i);return c}function h(e,t,n,r,o,i,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function m(e,t,n,r,o){--t.pendingcb,n?(N(o,r),N(x,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(o(r),e._writableState.errorEmitted=!0,e.emit("error",r),x(e,t))}function g(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function v(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(g(n),t)m(e,n,r,t,o);else{var i=E(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||_(e,n),r?O(y,e,n,i,o):y(e,n,i,o)}}function y(e,t,n,r){n||b(e,t),t.pendingcb--,r(),x(e,t)}function b(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function _(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,c=!0;n;)i[s]=n,n.isBuf||(c=!1),n=n.next,s+=1;i.allBuffers=c,h(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t)}else{for(;n;){var l=n.chunk,u=n.encoding,p=n.callback;if(h(e,t,!1,t.objectMode?1:l.length,l,u,p),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function E(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function w(e,t){e._final(function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),x(e,t)})}function k(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,N(w,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function x(e,t){var n=E(t);return n&&(k(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}function C(e,t,n){t.ending=!0,x(e,t),n&&(t.finished?N(n):e.once("finish",n)),t.ended=!0,e.writable=!1}function S(e,t,n){var r=e.entry;for(e.entry=null;r;){var o=r.callback;t.pendingcb--,o(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var N=e("process-nextick-args");t.exports=l;var T,O=!n.browser&&["v0.10","v0.9."].indexOf(n.version.slice(0,5))>-1?setImmediate:N;l.WritableState=c;var D=e("core-util-is");D.inherits=e("inherits");var R={deprecate:e("util-deprecate")},A=e("./internal/streams/stream"),P=e("safe-buffer").Buffer,I=r.Uint8Array||function(){},j=e("./internal/streams/destroy");D.inherits(l,A),c.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(c.prototype,"buffer",{get:R.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var M;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(M=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return!!M.call(this,e)||e&&e._writableState instanceof c}})):M=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(e,t,n){var r=this._writableState,o=!1,c=a(e)&&!r.objectMode;return c&&!P.isBuffer(e)&&(e=i(e)),"function"==typeof t&&(n=t,t=null),c?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=s),r.ended?u(this,n):(c||p(this,r,e,n))&&(r.pendingcb++,o=f(this,r,c,e,t,n)),o},l.prototype.cork=function(){this._writableState.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||_(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},l.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||C(this,r,n)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),l.prototype.destroy=j.destroy,l.prototype._undestroy=j.undestroy,l.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":279,"./internal/streams/destroy":285,"./internal/streams/stream":286,_process:146,"core-util-is":57,inherits:100,"process-nextick-args":145,"safe-buffer":292,"util-deprecate":311}],284:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t,n){e.copy(t,n)}var i=e("safe-buffer").Buffer;t.exports=function(){function e(){r(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t=i.allocUnsafe(e>>>0),n=this.head,r=0;n;)o(n.data,t,r),r+=n.data.length,n=n.next;return t},e}()},{"safe-buffer":292}],285:[function(e,t,n){"use strict";function r(e,t){e.emit("error",t)}var o=e("process-nextick-args");t.exports={destroy:function(e,t){var n=this,i=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;i||a?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||o(r,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(o(r,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)}))},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":145}],286:[function(e,t,n){t.exports=e("events").EventEmitter},{events:69}],287:[function(e,t,n){"use strict";function r(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function o(e){var t=r(e);if("string"!=typeof t&&(g.isEncoding===v||!v(e)))throw new Error("Unknown encoding: "+e);return t||e}function i(e){this.encoding=o(e);var t;switch(this.encoding){case"utf16le":this.text=u,this.end=p,t=4;break;case"utf8":this.fillLast=l,t=4;break;case"base64":this.text=d,this.end=f,t=3;break;default:return this.write=h,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=g.allocUnsafe(t)}function a(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function s(e,t,n){var r=t.length-1;if(r<n)return 0;var o=a(t[r]);return o>=0?(o>0&&(e.lastNeed=o-1),o):--r<n?0:(o=a(t[r]))>=0?(o>0&&(e.lastNeed=o-2),o):--r<n?0:(o=a(t[r]))>=0?(o>0&&(2===o?o=0:e.lastNeed=o-3),o):0}function c(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"�".repeat(n);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�".repeat(n+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�".repeat(n+2)}}function l(e){var t=this.lastTotal-this.lastNeed,n=c(this,e,t);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function d(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}var g=e("safe-buffer").Buffer,v=g.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};n.StringDecoder=i,i.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},i.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�".repeat(this.lastTotal-this.lastNeed):t},i.prototype.text=function(e,t){var n=s(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":292}],288:[function(e,t,n){t.exports=e("./readable").PassThrough},{"./readable":289}],289:[function(e,t,n){(n=t.exports=e("./lib/_stream_readable.js")).Stream=n,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":279,"./lib/_stream_passthrough.js":280,"./lib/_stream_readable.js":281,"./lib/_stream_transform.js":282,"./lib/_stream_writable.js":283}],290:[function(e,t,n){t.exports=e("./readable").Transform},{"./readable":289}],291:[function(e,t,n){t.exports=e("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":283}],292:[function(e,t,n){function r(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return a(e,t,n)}var i=e("buffer"),a=i.Buffer;a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=i:(r(i,n),n.Buffer=o),r(a,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return a(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=a(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return a(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},{buffer:56}],293:[function(e,t,n){(function(){var e={}.hasOwnProperty,n=[].slice;t.exports=function(t,r){var o,i,a,s;i=[],s=[];for(o in r)e.call(r,o)&&(a=r[o],"this"!==o&&(i.push(o),s.push(a)));return Function.apply(null,n.call(i).concat([t])).apply(r.this,s)}}).call(this)},{}],294:[function(e,t,n){!function(e){if("object"==typeof n)t.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var r;try{r=window}catch(e){r=self}r.SparkMD5=e()}}(function(e){"use strict";function t(e,t,n,r,o,i){return t=b(b(t,e),b(r,i)),b(t<<o|t>>>32-o,n)}function n(e,n,r,o,i,a,s){return t(n&r|~n&o,e,n,i,a,s)}function r(e,n,r,o,i,a,s){return t(n&o|r&~o,e,n,i,a,s)}function o(e,n,r,o,i,a,s){return t(n^r^o,e,n,i,a,s)}function i(e,n,r,o,i,a,s){return t(r^(n|~o),e,n,i,a,s)}function a(e,t){var a=e[0],s=e[1],c=e[2],l=e[3];s=i(s=i(s=i(s=i(s=o(s=o(s=o(s=o(s=r(s=r(s=r(s=r(s=n(s=n(s=n(s=n(s,c=n(c,l=n(l,a=n(a,s,c,l,t[0],7,-680876936),s,c,t[1],12,-389564586),a,s,t[2],17,606105819),l,a,t[3],22,-1044525330),c=n(c,l=n(l,a=n(a,s,c,l,t[4],7,-176418897),s,c,t[5],12,1200080426),a,s,t[6],17,-1473231341),l,a,t[7],22,-45705983),c=n(c,l=n(l,a=n(a,s,c,l,t[8],7,1770035416),s,c,t[9],12,-1958414417),a,s,t[10],17,-42063),l,a,t[11],22,-1990404162),c=n(c,l=n(l,a=n(a,s,c,l,t[12],7,1804603682),s,c,t[13],12,-40341101),a,s,t[14],17,-1502002290),l,a,t[15],22,1236535329),c=r(c,l=r(l,a=r(a,s,c,l,t[1],5,-165796510),s,c,t[6],9,-1069501632),a,s,t[11],14,643717713),l,a,t[0],20,-373897302),c=r(c,l=r(l,a=r(a,s,c,l,t[5],5,-701558691),s,c,t[10],9,38016083),a,s,t[15],14,-660478335),l,a,t[4],20,-405537848),c=r(c,l=r(l,a=r(a,s,c,l,t[9],5,568446438),s,c,t[14],9,-1019803690),a,s,t[3],14,-187363961),l,a,t[8],20,1163531501),c=r(c,l=r(l,a=r(a,s,c,l,t[13],5,-1444681467),s,c,t[2],9,-51403784),a,s,t[7],14,1735328473),l,a,t[12],20,-1926607734),c=o(c,l=o(l,a=o(a,s,c,l,t[5],4,-378558),s,c,t[8],11,-2022574463),a,s,t[11],16,1839030562),l,a,t[14],23,-35309556),c=o(c,l=o(l,a=o(a,s,c,l,t[1],4,-1530992060),s,c,t[4],11,1272893353),a,s,t[7],16,-155497632),l,a,t[10],23,-1094730640),c=o(c,l=o(l,a=o(a,s,c,l,t[13],4,681279174),s,c,t[0],11,-358537222),a,s,t[3],16,-722521979),l,a,t[6],23,76029189),c=o(c,l=o(l,a=o(a,s,c,l,t[9],4,-640364487),s,c,t[12],11,-421815835),a,s,t[15],16,530742520),l,a,t[2],23,-995338651),c=i(c,l=i(l,a=i(a,s,c,l,t[0],6,-198630844),s,c,t[7],10,1126891415),a,s,t[14],15,-1416354905),l,a,t[5],21,-57434055),c=i(c,l=i(l,a=i(a,s,c,l,t[12],6,1700485571),s,c,t[3],10,-1894986606),a,s,t[10],15,-1051523),l,a,t[1],21,-2054922799),c=i(c,l=i(l,a=i(a,s,c,l,t[8],6,1873313359),s,c,t[15],10,-30611744),a,s,t[6],15,-1560198380),l,a,t[13],21,1309151649),c=i(c,l=i(l,a=i(a,s,c,l,t[4],6,-145523070),s,c,t[11],10,-1120210379),a,s,t[2],15,718787259),l,a,t[9],21,-343485551),e[0]=b(a,e[0]),e[1]=b(s,e[1]),e[2]=b(c,e[2]),e[3]=b(l,e[3])}function s(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function c(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function l(e){var t,n,r,o,i,c,l=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)a(u,s(e.substring(t-64,t)));for(n=(e=e.substring(t-64)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(a(u,r),t=0;t<16;t+=1)r[t]=0;return o=8*l,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),c=parseInt(o[1],16)||0,r[14]=i,r[15]=c,a(u,r),u}function u(e){var t,n,r,o,i,s,l=e.length,u=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)a(u,c(e.subarray(t-64,t)));for(n=(e=t-64<l?e.subarray(t-64):new Uint8Array(0)).length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)r[t>>2]|=e[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(a(u,r),t=0;t<16;t+=1)r[t]=0;return o=8*l,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),s=parseInt(o[1],16)||0,r[14]=i,r[15]=s,a(u,r),u}function p(e){var t,n="";for(t=0;t<4;t+=1)n+=_[e>>8*t+4&15]+_[e>>8*t&15];return n}function d(e){var t;for(t=0;t<e.length;t+=1)e[t]=p(e[t]);return e.join("")}function f(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function h(e,t){var n,r=e.length,o=new ArrayBuffer(r),i=new Uint8Array(o);for(n=0;n<r;n+=1)i[n]=e.charCodeAt(n);return t?i:o}function m(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function g(e,t,n){var r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e)),r.set(new Uint8Array(t),e.byteLength),n?r:r.buffer}function v(e){var t,n=[],r=e.length;for(t=0;t<r-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function y(){this.reset()}var b=function(e,t){return e+t&4294967295},_=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==d(l("hello"))&&(b=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(n,r){var o,i,a,s,c=this.byteLength,l=t(n,c),u=c;return r!==e&&(u=t(r,c)),l>u?new ArrayBuffer(0):(o=u-l,i=new ArrayBuffer(o),a=new Uint8Array(i),s=new Uint8Array(this,l,o),a.set(s),i)}}(),y.prototype.append=function(e){return this.appendBinary(f(e)),this},y.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,n=this._buff.length;for(t=64;t<=n;t+=64)a(this._hash,s(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},y.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),n=d(this._hash),e&&(n=v(n)),this.reset(),n},y.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},y.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},y.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},y.prototype._finish=function(e,t){var n,r,o,i=t;if(e[i>>2]|=128<<(i%4<<3),i>55)for(a(this._hash,e),i=0;i<16;i+=1)e[i]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=r,e[15]=o,a(this._hash,e)},y.hash=function(e,t){return y.hashBinary(f(e),t)},y.hashBinary=function(e,t){var n=d(l(e));return t?v(n):n},y.ArrayBuffer=function(){this.reset()},y.ArrayBuffer.prototype.append=function(e){var t,n=g(this._buff.buffer,e,!0),r=n.length;for(this._length+=e.byteLength,t=64;t<=r;t+=64)a(this._hash,c(n.subarray(t-64,t)));return this._buff=t-64<r?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},y.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=r[t]<<(t%4<<3);return this._finish(i,o),n=d(this._hash),e&&(n=v(n)),this.reset(),n},y.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},y.ArrayBuffer.prototype.getState=function(){var e=y.prototype.getState.call(this);return e.buff=m(e.buff),e},y.ArrayBuffer.prototype.setState=function(e){return e.buff=h(e.buff,!0),y.prototype.setState.call(this,e)},y.ArrayBuffer.prototype.destroy=y.prototype.destroy,y.ArrayBuffer.prototype._finish=y.prototype._finish,y.ArrayBuffer.hash=function(e,t){var n=d(u(new Uint8Array(e)));return t?v(n):n},y})},{}],295:[function(e,t,n){function r(){o.call(this)}t.exports=r;var o=e("events").EventEmitter;e("inherits")(r,o),r.Readable=e("readable-stream/readable.js"),r.Writable=e("readable-stream/writable.js"),r.Duplex=e("readable-stream/duplex.js"),r.Transform=e("readable-stream/transform.js"),r.PassThrough=e("readable-stream/passthrough.js"),r.Stream=r,r.prototype.pipe=function(e,t){function n(t){e.writable&&!1===e.write(t)&&l.pause&&l.pause()}function r(){l.readable&&l.resume&&l.resume()}function i(){u||(u=!0,e.end())}function a(){u||(u=!0,"function"==typeof e.destroy&&e.destroy())}function s(e){if(c(),0===o.listenerCount(this,"error"))throw e}function c(){l.removeListener("data",n),e.removeListener("drain",r),l.removeListener("end",i),l.removeListener("close",a),l.removeListener("error",s),e.removeListener("error",s),l.removeListener("end",c),l.removeListener("close",c),e.removeListener("close",c)}var l=this;l.on("data",n),e.on("drain",r),e._isStdio||t&&!1===t.end||(l.on("end",i),l.on("close",a));var u=!1;return l.on("error",s),e.on("error",s),l.on("end",c),l.on("close",c),e.on("close",c),e.emit("pipe",l),e}},{events:69,inherits:100,"readable-stream/duplex.js":278,"readable-stream/passthrough.js":288,"readable-stream/readable.js":289,"readable-stream/transform.js":290,"readable-stream/writable.js":291}],296:[function(e,t,n){function r(e){if(e&&!c(e))throw new Error("Unknown encoding: "+e)}function o(e){return e.toString(this.encoding)}function i(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function a(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}var s=e("buffer").Buffer,c=s.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},l=n.StringDecoder=function(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),r(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=i;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=a;break;default:return void(this.write=o)}this.charBuffer=new s(6),this.charReceived=0,this.charLength=0};l.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((o=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&o<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);r=e.length;this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,r),r-=this.charReceived);var r=(t+=e.toString(this.encoding,0,r)).length-1,o=t.charCodeAt(r);if(o>=55296&&o<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),e.copy(this.charBuffer,0,0,i),t.substring(0,r)}return t},l.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},l.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,o=this.encoding;t+=r.slice(0,n).toString(o)}return t}},{buffer:56}],297:[function(e,t,n){t.exports={encode:function(e){return"ÿ"+e[0]+"ÿ"+e[1]},decode:function(e){var t=e.toString(),n=t.indexOf("ÿ",1);return[t.substring(1,n),t.substring(n+1)]},lowerBound:"\0",upperBound:"ÿ"}},{}],298:[function(e,t,n){var r=e("errno").create,o=r("LevelUPError"),i=r("NotFoundError",o);i.prototype.notFound=!0,i.prototype.status=404,t.exports={LevelUPError:o,InitializationError:r("InitializationError",o),OpenError:r("OpenError",o),ReadError:r("ReadError",o),WriteError:r("WriteError",o),NotFoundError:i,EncodingError:r("EncodingError",o)}},{errno:67}],299:[function(e,t,n){var r=e("./nut"),o=e("./shell"),i=new(e("level-codec")),a=e("./read-stream"),s=e("./codec/legacy");t.exports=function(e){return o(r(e,s,i),[],a,e.options)}},{"./codec/legacy":297,"./nut":300,"./read-stream":301,"./shell":302,"level-codec":104}],300:[function(e,t,n){function r(e){return"function"==typeof e}function o(e){return null==e?e:r(e.prefix)?e.prefix():e}function i(e){var t={};for(var n in e)t[n]=e[n];return t}var a=e("ltgt");t.exports=function(e,t,n,s){function c(e,r,o,i){return t.encode([e,n.encodeKey(r,o,i)])}function l(e,t){return t&&t.options&&(e.keyEncoding=e.keyEncoding||t.options.keyEncoding,e.valueEncoding=e.valueEncoding||t.options.valueEncoding),e}function u(){for(d=!0;p.length;)p.shift()()}var p=[],d=!1;return r(e.isOpen)&&e.isOpen()?d=!0:e.open(u),{apply:function(t,r,i){for(var a=0;a<t.length;a++){var s=t[a];l(s,s.prefix),s.prefix=o(s.prefix)}if("object"!=typeof(r=r||{}))throw new Error("opts must be object, was:"+r);"function"==typeof r&&(i=r,r={}),t.length?(e.db||e).batch(t.map(function(e){return{key:c(e.prefix,e.key,r,e),value:"del"!==e.type?n.encodeValue(e.value,r,e):void 0,type:e.type||(void 0===e.value?"del":"put")}}),r,function(e){if(e)return i(e);i()}):i()},get:function(t,r,o,i){return o.asBuffer=n.valueAsBuffer(o),(e.db||e).get(c(r,t,o),o,function(e,t){e?i(e):i(null,n.decodeValue(t,o))})},createDecoder:function(e){return function(r,o){return{key:n.decodeKey(t.decode(r)[1],e),value:n.decodeValue(o,e)}}},isOpen:function(){return e.db&&r(e.db.isOpen)?e.db.isOpen():e.isOpen()},isClosed:function(){return e.db&&r(e.db.isClosed)?e.db.isClosed():e.isClosed()},close:function(t){return e.close(t)},iterator:function(r,o){function s(e){return{next:function(t){return e.next(t)},end:function(t){e.end(t)}}}var l=i(r||{}),u=r.prefix||[];if(a.toLtgt(r,l,function(e){return c(u,e,l,{})},t.lowerBound,t.upperBound),l.prefix=null,l.keyAsBuffer=l.valueAsBuffer=!1,"number"!=typeof l.limit&&(l.limit=-1),l.keyAsBuffer=t.buffer,l.valueAsBuffer=n.valueAsBuffer(l),d)return s((e.db||e).iterator(l));p.push(function(){o(null,s((e.db||e).iterator(l)))})}}}},{ltgt:304}],301:[function(e,t,n){function r(e,t){if(!(this instanceof r))return new r(e,t);o.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this._waiting=!1,this._options=e,this._makeData=t}var o=e("readable-stream").Readable,i=e("inherits"),a=e("./errors").EncodingError;i(r,o),r.prototype.setIterator=function(e){return this._iterator=e,this._destroyed?e.end(function(){}):this._waiting?(this._waiting=!1,this._read()):this},r.prototype._read=function(){var e=this;if(!e._destroyed)return e._iterator?void e._iterator.next(function(t,n,r){if(t||void 0===n&&void 0===r)return t||e._destroyed||e.push(null),e._cleanup(t);try{r=e._makeData(n,r)}catch(t){return e._cleanup(new a(t))}e._destroyed||e.push(r)}):this._waiting=!0},r.prototype._cleanup=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;e&&t.emit("error",e),t._iterator?t._iterator.end(function(){t._iterator=null,t.emit("close")}):t.emit("close")}},r.prototype.destroy=function(){this._cleanup()},r.prototype.toString=function(){return"LevelUP.ReadStream"},t.exports=r},{"./errors":298,inherits:100,"readable-stream":310}],302:[function(e,t,n){(function(n){var r=e("events").EventEmitter,o=e("./errors"),i=t.exports=function(e,t,a,s){function c(e){e&&u.emit("error",e)}function l(e){var t={};if(s)for(var n in s)void 0!=s[n]&&(t[n]=s[n]);if(e)for(var n in e)void 0!=e[n]&&(t[n]=e[n]);return t}var u=new r;return u.sublevels={},u.options=s,u.version="6.5.4",u.methods={},t=t||[],u.put=function(n,r,o,i){"function"==typeof o&&(i=o,o={}),i||(i=c),e.apply([{key:n,value:r,prefix:t.slice(),type:"put"}],l(o),function(e){if(e||(u.emit("put",n,r),i(null)),e)return i(e)})},u.prefix=function(){return t.slice()},u.del=function(n,r,o){"function"==typeof r&&(o=r,r={}),o||(o=c),e.apply([{key:n,prefix:t.slice(),type:"del"}],l(r),function(e){if(e||(u.emit("del",n),o(null)),e)return o(e)})},u.batch=function(n,r,o){"function"==typeof r&&(o=r,r={}),o||(o=c),n=n.map(function(e){return{key:e.key,value:e.value,prefix:e.prefix||t,keyEncoding:e.keyEncoding,valueEncoding:e.valueEncoding,type:e.type}}),e.apply(n,l(r),function(e){if(e||(u.emit("batch",n),o(null)),e)return o(e)})},u.get=function(n,r,i){"function"==typeof r&&(i=r,r={}),e.get(n,t,l(r),function(e,t){e?i(new o.NotFoundError("Key not found in database",e)):i(null,t)})},u.clone=function(n){return i(e,t,a,l(n))},u.sublevel=function(n,r){return u.sublevels[n]=u.sublevels[n]||i(e,t.concat(n),a,l(r))},u.readStream=u.createReadStream=function(n){(n=l(n)).prefix=t;var r,o=e.iterator(n,function(e,t){r.setIterator(t)});return r=a(n,e.createDecoder(n)),o&&r.setIterator(o),r},u.valueStream=u.createValueStream=function(e){return e=e||{},e.values=!0,e.keys=!1,u.createReadStream(e)},u.keyStream=u.createKeyStream=function(e){return e=e||{},e.values=!1,e.keys=!0,u.createReadStream(e)},u.close=function(r){r=r||function(){},t.length?n.nextTick(r):e.close(r)},u.isOpen=e.isOpen,u.isClosed=e.isClosed,u}}).call(this,e("_process"))},{"./errors":298,_process:146,events:69}],303:[function(e,t,n){arguments[4][108][0].apply(n,arguments)},{dup:108}],304:[function(e,t,n){(function(e){function t(e,t){return Object.hasOwnProperty.call(e,t)}function r(e){return void 0!==e&&""!==e}function t(e,t){return Object.hasOwnProperty.call(e,t)}function o(e,t){return Object.hasOwnProperty.call(e,t)&&t}function i(e){return e}n.compare=function(t,n){if(e.isBuffer(t)){for(var r=Math.min(t.length,n.length),o=0;o<r;o++){var i=t[o]-n[o];if(i)return i}return t.length-n.length}return t<n?-1:t>n?1:0};var a=n.lowerBoundKey=function(e){return o(e,"gt")||o(e,"gte")||o(e,"min")||(e.reverse?o(e,"end"):o(e,"start"))||void 0},s=n.lowerBound=function(e){var t=a(e);return t&&e[t]};n.lowerBoundInclusive=function(e){return!t(e,"gt")},n.upperBoundInclusive=function(e){return!(t(e,"lt")||!e.minEx)};var c=n.lowerBoundExclusive=function(e){return!(!t(e,"gt")&&!e.minEx)},l=n.upperBoundExclusive=function(e){return!!t(e,"lt")},u=n.upperBoundKey=function(e){return o(e,"lt")||o(e,"lte")||o(e,"max")||(e.reverse?o(e,"start"):o(e,"end"))||void 0},p=n.upperBound=function(e){var t=u(e);return t&&e[t]};n.toLtgt=function(e,r,o,a,s){r=r||{},o=o||i;var c=arguments.length>3,l=n.lowerBoundKey(e),u=n.upperBoundKey(e);return l?"gt"===l?r.gt=o(e.gt,!1):r.gte=o(e[l],!1):c&&(r.gte=o(a,!1)),u?"lt"===u?r.lt=o(e.lt,!0):r.lte=o(e[u],!0):c&&(r.lte=o(s,!0)),null!=e.reverse&&(r.reverse=!!e.reverse),t(r,"max")&&delete r.max,t(r,"min")&&delete r.min,t(r,"start")&&delete r.start,t(r,"end")&&delete r.end,r},n.contains=function(e,t,o){o=o||n.compare;var i=s(e);if(r(i)&&((u=o(t,i))<0||0===u&&c(e)))return!1;var a=p(e);if(r(a)){var u=o(t,a);if(u>0||0===u&&l(e))return!1}return!0},n.filter=function(e,t){return function(r){return n.contains(e,r,t)}}}).call(this,{isBuffer:e("../../../is-buffer/index.js")})},{"../../../is-buffer/index.js":101}],305:[function(e,t,n){arguments[4][109][0].apply(n,arguments)},{"./_stream_readable":307,"./_stream_writable":309,_process:146,"core-util-is":57,dup:109,inherits:100}],306:[function(e,t,n){arguments[4][110][0].apply(n,arguments)},{"./_stream_transform":308,"core-util-is":57,dup:110,inherits:100}],307:[function(e,t,n){(function(n){function r(t,n){var r=(t=t||{}).highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!t.objectMode,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(T||(T=e("string_decoder/").StringDecoder),this.decoder=new T(t.encoding),this.encoding=t.encoding)}function o(e){if(!(this instanceof o))return new o(e);this._readableState=new r(e,this),this.readable=!0,S.call(this)}function i(e,t,n,r,o){var i=l(t,n);if(i)e.emit("error",i);else if(null===n||void 0===n)t.reading=!1,t.ended||u(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!o){s=new Error("stream.push() after EOF");e.emit("error",s)}else if(t.endEmitted&&o){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else!t.decoder||o||r||(n=t.decoder.write(n)),t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):(t.reading=!1,t.buffer.push(n)),t.needReadable&&p(e),f(e,t);else o||(t.reading=!1);return a(t)}function a(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function s(e){if(e>=O)e=O;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}function c(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=s(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function l(e,t){var n=null;return x.isBuffer(t)||"string"==typeof t||null===t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function u(e,t){if(t.decoder&&!t.ended){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.length>0?p(e):_(e)}function p(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,t.sync?n.nextTick(function(){d(e)}):d(e))}function d(e){e.emit("readable")}function f(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(function(){h(e,t)}))}function h(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function m(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&g(e)}}function g(e){function t(e,t,o){!1===e.write(n)&&r.awaitDrain++}var n,r=e._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=e.read());)if(1===r.pipesCount?t(r.pipes):E(r.pipes,t),e.emit("data",n),r.awaitDrain>0)return;if(0===r.pipesCount)return r.flowing=!1,void(C.listenerCount(e,"data")>0&&y(e));r.ranOut=!0}function v(){this._readableState.ranOut&&(this._readableState.ranOut=!1,g(this))}function y(e,t){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var r=t||!1,o=!1;e.readable=!0,e.pipe=S.prototype.pipe,e.on=e.addListener=S.prototype.on,e.on("readable",function(){o=!0;for(var t;!r&&null!==(t=e.read());)e.emit("data",t);null===t&&(o=!1,e._readableState.needReadable=!0)}),e.pause=function(){r=!0,this.emit("pause")},e.resume=function(){r=!1,o?n.nextTick(function(){e.emit("readable")}):this.read(0),this.emit("resume")},e.emit("readable")}function b(e,t){var n,r=t.buffer,o=t.length,i=!!t.decoder,a=!!t.objectMode;if(0===r.length)return null;if(0===o)n=null;else if(a)n=r.shift();else if(!e||e>=o)n=i?r.join(""):x.concat(r,o),r.length=0;else if(e<r[0].length)n=(u=r[0]).slice(0,e),r[0]=u.slice(e);else if(e===r[0].length)n=r.shift();else{n=i?"":new x(e);for(var s=0,c=0,l=r.length;c<l&&s<e;c++){var u=r[0],p=Math.min(e-s,u.length);i?n+=u.slice(0,p):u.copy(n,s,0,p),p<u.length?r[0]=u.slice(p):r.shift(),s+=p}}return n}function _(e){var t=e._readableState;if(t.length>0)throw new Error("endReadable called on non-empty stream");!t.endEmitted&&t.calledRead&&(t.ended=!0,n.nextTick(function(){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}))}function E(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)}function w(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}t.exports=o;var k=e("isarray"),x=e("buffer").Buffer;o.ReadableState=r;var C=e("events").EventEmitter;C.listenerCount||(C.listenerCount=function(e,t){return e.listeners(t).length});var S=e("stream"),N=e("core-util-is");N.inherits=e("inherits");var T;N.inherits(o,S),o.prototype.push=function(e,t){var n=this._readableState;return"string"!=typeof e||n.objectMode||(t=t||n.defaultEncoding)!==n.encoding&&(e=new x(e,t),t=""),i(this,n,e,t,!1)},o.prototype.unshift=function(e){return i(this,this._readableState,e,"",!0)},o.prototype.setEncoding=function(t){T||(T=e("string_decoder/").StringDecoder),this._readableState.decoder=new T(t),this._readableState.encoding=t};var O=8388608;o.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var n,r=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p(this),null;if(0===(e=c(e,t))&&t.ended)return n=null,t.length>0&&t.decoder&&(n=b(e,t),t.length-=n.length),0===t.length&&_(this),n;var o=t.needReadable;return t.length-e<=t.highWaterMark&&(o=!0),(t.ended||t.reading)&&(o=!1),o&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),o&&!t.reading&&(e=c(r,t)),null===(n=e>0?b(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&_(this),n},o.prototype._read=function(e){this.emit("error",new Error("not implemented"))},o.prototype.pipe=function(e,t){function r(e){e===u&&i()}function o(){e.end()}function i(){e.removeListener("close",s),e.removeListener("finish",c),e.removeListener("drain",f),e.removeListener("error",a),e.removeListener("unpipe",r),u.removeListener("end",o),u.removeListener("end",i),e._writableState&&!e._writableState.needDrain||f()}function a(t){l(),e.removeListener("error",a),0===C.listenerCount(e,"error")&&e.emit("error",t)}function s(){e.removeListener("finish",c),l()}function c(){e.removeListener("close",s),l()}function l(){u.unpipe(e)}var u=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=e;break;case 1:p.pipes=[p.pipes,e];break;default:p.pipes.push(e)}p.pipesCount+=1;var d=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?o:i;p.endEmitted?n.nextTick(d):u.once("end",d),e.on("unpipe",r);var f=m(u);return e.on("drain",f),e._events&&e._events.error?k(e._events.error)?e._events.error.unshift(a):e._events.error=[a,e._events.error]:e.on("error",a),e.once("close",s),e.once("finish",c),e.emit("pipe",u),p.flowing||(this.on("readable",v),p.flowing=!0,n.nextTick(function(){g(u)})),e},o.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",v),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",v),t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this);return this}return-1===(o=w(t.pipes,e))?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},o.prototype.on=function(e,t){var n=S.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||y(this),"readable"===e&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&p(this):this.read(0))}return n},o.prototype.addListener=o.prototype.on,o.prototype.resume=function(){y(this),this.read(0),this.emit("resume")},o.prototype.pause=function(){y(this,!0),this.emit("pause")},o.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;e.on("end",function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(o){t.decoder&&(o=t.decoder.write(o)),(!t.objectMode||null!==o&&void 0!==o)&&(t.objectMode||o&&o.length)&&(r.push(o)||(n=!0,e.pause()))});for(var o in e)"function"==typeof e[o]&&void 0===this[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));return E(["error","close","destroy","pause","resume"],function(t){e.on(t,r.emit.bind(r,t))}),r._read=function(t){n&&(n=!1,e.resume())},r},o._fromList=b}).call(this,e("_process"))},{_process:146,buffer:56,"core-util-is":57,events:69,inherits:100,isarray:303,stream:295,"string_decoder/":296}],308:[function(e,t,n){function r(e,t){this.afterTransform=function(e,n){return o(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&e.push(n),o&&o(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}function i(e){if(!(this instanceof i))return new i(e);s.call(this,e);this._transformState=new r(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(e){a(t,e)}):a(t)})}function a(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=(e._readableState,e._transformState);if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}t.exports=i;var s=e("./_stream_duplex"),c=e("core-util-is");c.inherits=e("inherits"),c.inherits(i,s),i.prototype.push=function(e,t){return this._transformState.needTransform=!1,s.prototype.push.call(this,e,t)},i.prototype._transform=function(e,t,n){throw new Error("not implemented")},i.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},i.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},{"./_stream_duplex":305,"core-util-is":57,inherits:100}],309:[function(e,t,n){(function(n){function r(e,t,n){this.chunk=e,this.encoding=t,this.callback=n}function o(e,t){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){f(t,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function i(t){var n=e("./_stream_duplex");if(!(this instanceof i||this instanceof n))return new i(t);this._writableState=new o(t,this),this.writable=!0,w.call(this)}function a(e,t,r){var o=new Error("write after end");e.emit("error",o),n.nextTick(function(){r(o)})}function s(e,t,r,o){var i=!0;if(!_.isBuffer(r)&&"string"!=typeof r&&null!==r&&void 0!==r&&!t.objectMode){var a=new TypeError("Invalid non-string/buffer chunk");e.emit("error",a),n.nextTick(function(){o(a)}),i=!1}return i}function c(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new _(t,n)),t}function l(e,t,n,o,i){n=c(t,n,o),_.isBuffer(n)&&(o="buffer");var a=t.objectMode?1:n.length;t.length+=a;var s=t.length<t.highWaterMark;return s||(t.needDrain=!0),t.writing?t.buffer.push(new r(n,o,i)):u(e,t,a,n,o,i),s}function u(e,t,n,r,o,i){t.writelen=n,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,o,t.onwrite),t.sync=!1}function p(e,t,r,o,i){r?n.nextTick(function(){i(o)}):i(o),e._writableState.errorEmitted=!0,e.emit("error",o)}function d(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function f(e,t){var r=e._writableState,o=r.sync,i=r.writecb;if(d(r),t)p(e,r,o,t,i);else{var a=v(e,r);a||r.bufferProcessing||!r.buffer.length||g(e,r),o?n.nextTick(function(){h(e,r,a,i)}):h(e,r,a,i)}}function h(e,t,n,r){n||m(e,t),r(),n&&y(e,t)}function m(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function g(e,t){t.bufferProcessing=!0;for(var n=0;n<t.buffer.length;n++){var r=t.buffer[n],o=r.chunk,i=r.encoding,a=r.callback;if(u(e,t,t.objectMode?1:o.length,o,i,a),t.writing){n++;break}}t.bufferProcessing=!1,n<t.buffer.length?t.buffer=t.buffer.slice(n):t.buffer.length=0}function v(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function y(e,t){var n=v(e,t);return n&&(t.finished=!0,e.emit("finish")),n}function b(e,t,r){t.ending=!0,y(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r)),t.ended=!0}t.exports=i;var _=e("buffer").Buffer;i.WritableState=o;var E=e("core-util-is");E.inherits=e("inherits");var w=e("stream");E.inherits(i,w),i.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},i.prototype.write=function(e,t,n){var r=this._writableState,o=!1;return"function"==typeof t&&(n=t,t=null),_.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=function(){}),r.ended?a(this,0,n):s(this,r,e,n)&&(o=l(this,r,e,t,n)),o},i.prototype._write=function(e,t,n){n(new Error("not implemented"))},i.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),void 0!==e&&null!==e&&this.write(e,t),r.ending||r.finished||b(this,r,n)}}).call(this,e("_process"))},{"./_stream_duplex":305,_process:146,buffer:56,"core-util-is":57,inherits:100,stream:295}],310:[function(e,t,n){var r=e("stream");(n=t.exports=e("./lib/_stream_readable.js")).Stream=r,n.Readable=n,n.Writable=e("./lib/_stream_writable.js"),n.Duplex=e("./lib/_stream_duplex.js"),n.Transform=e("./lib/_stream_transform.js"),n.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":305,"./lib/_stream_passthrough.js":306,"./lib/_stream_readable.js":307,"./lib/_stream_transform.js":308,"./lib/_stream_writable.js":309,stream:295}],311:[function(e,t,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(e){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],312:[function(e,t,n){"use strict";function r(e,t,n){var r=n[n.length-1];e===r.element&&(n.pop(),r=n[n.length-1]);var o=r.element,i=r.index;Array.isArray(o)?o.push(e):i===t.length-2?o[t.pop()]=e:t.push(e)}n.stringify=function(e){var t=[];t.push({obj:e});for(var n,r,o,i,a,s,c,l,u,p,d,f="";n=t.pop();)if(r=n.obj,o=n.prefix||"",i=n.val||"",f+=o,i)f+=i;else if("object"!=typeof r)f+=void 0===r?null:JSON.stringify(r);else if(null===r)f+="null";else if(Array.isArray(r)){for(t.push({val:"]"}),a=r.length-1;a>=0;a--)s=0===a?"":",",t.push({obj:r[a],prefix:s});t.push({val:"["})}else{c=[];for(l in r)r.hasOwnProperty(l)&&c.push(l);for(t.push({val:"}"}),a=c.length-1;a>=0;a--)p=r[u=c[a]],d=a>0?",":"",d+=JSON.stringify(u)+":",t.push({obj:p,prefix:d});t.push({val:"{"})}return f},n.parse=function(e){for(var t,n,o,i,a,s,c,l,u,p=[],d=[],f=0;;)if("}"!==(t=e[f++])&&"]"!==t&&void 0!==t)switch(t){case" ":case"\t":case"\n":case":":case",":break;case"n":f+=3,r(null,p,d);break;case"t":f+=3,r(!0,p,d);break;case"f":f+=4,r(!1,p,d);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(n="",f--;;){if(o=e[f++],!/[\d\.\-e\+]/.test(o)){f--;break}n+=o}r(parseFloat(n),p,d);break;case'"':for(i="",a=void 0,s=0;;){if('"'===(c=e[f++])&&("\\"!==a||s%2!=1))break;i+=c,"\\"===(a=c)?s++:s=0}r(JSON.parse('"'+i+'"'),p,d);break;case"[":l={element:[],index:p.length},p.push(l.element),d.push(l);break;case"{":u={element:{},index:p.length},p.push(u.element),d.push(u);break;default:throw new Error("unexpectedly reached end of input: "+t)}else{if(1===p.length)return p.pop();r(p.pop(),p,d)}}},{}],313:[function(e,t,n){t.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e};var r=Object.prototype.hasOwnProperty},{}]},{},[1]);